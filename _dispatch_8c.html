<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HyperDbg: hyperdbg/hprdbghv/code/interface/Dispatch.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">HyperDbg
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('_dispatch_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Dispatch.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Implementation of debugger functions for dispatching, triggering and emulating events.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;pch.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:afe94c002465675302db8afbbd3a33a64"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_dispatch_8c.html#afe94c002465675302db8afbbd3a33a64">DispatchEventEferSysret</a> (<a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu, PVOID <a class="el" href="hprdbghv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>)</td></tr>
<tr class="memdesc:afe94c002465675302db8afbbd3a33a64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to SYSRET events.  <br /></td></tr>
<tr class="separator:afe94c002465675302db8afbbd3a33a64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae4505a785c7a1984413ade6de7ba6bd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_dispatch_8c.html#aae4505a785c7a1984413ade6de7ba6bd">DispatchEventEferSyscall</a> (<a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu, PVOID <a class="el" href="hprdbghv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>)</td></tr>
<tr class="memdesc:aae4505a785c7a1984413ade6de7ba6bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to SYSCALL events.  <br /></td></tr>
<tr class="separator:aae4505a785c7a1984413ade6de7ba6bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c9d9d43e2cffb256cd84481e0cce22f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_dispatch_8c.html#a5c9d9d43e2cffb256cd84481e0cce22f">DispatchEventCpuid</a> (<a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu)</td></tr>
<tr class="memdesc:a5c9d9d43e2cffb256cd84481e0cce22f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to CPUID events.  <br /></td></tr>
<tr class="separator:a5c9d9d43e2cffb256cd84481e0cce22f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61e2dcbd730450008e8f6f4dcc6c7b42"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_dispatch_8c.html#a61e2dcbd730450008e8f6f4dcc6c7b42">DispatchEventTsc</a> (<a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu, <a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> IsRdtscp)</td></tr>
<tr class="memdesc:a61e2dcbd730450008e8f6f4dcc6c7b42"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to RDTSC/RDTSCP events.  <br /></td></tr>
<tr class="separator:a61e2dcbd730450008e8f6f4dcc6c7b42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3eb1bf639bc9644cf1c1f44c2eb8dff"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_dispatch_8c.html#ac3eb1bf639bc9644cf1c1f44c2eb8dff">DispatchEventVmcall</a> (<a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu)</td></tr>
<tr class="memdesc:ac3eb1bf639bc9644cf1c1f44c2eb8dff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to VMCALL events.  <br /></td></tr>
<tr class="separator:ac3eb1bf639bc9644cf1c1f44c2eb8dff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9beef1729154452db4d14e11fbfa4478"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_dispatch_8c.html#a9beef1729154452db4d14e11fbfa4478">DispatchEventIO</a> (<a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu)</td></tr>
<tr class="memdesc:a9beef1729154452db4d14e11fbfa4478"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to IO events.  <br /></td></tr>
<tr class="separator:a9beef1729154452db4d14e11fbfa4478"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40a5898e33596b5af4a62b43410c7729"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_dispatch_8c.html#a40a5898e33596b5af4a62b43410c7729">DispatchEventRdmsr</a> (<a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu)</td></tr>
<tr class="memdesc:a40a5898e33596b5af4a62b43410c7729"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to RDMSR events.  <br /></td></tr>
<tr class="separator:a40a5898e33596b5af4a62b43410c7729"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3de50c27b4f63f330bc3b3f3948d74a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_dispatch_8c.html#ae3de50c27b4f63f330bc3b3f3948d74a">DispatchEventWrmsr</a> (<a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu)</td></tr>
<tr class="memdesc:ae3de50c27b4f63f330bc3b3f3948d74a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to WRMSR events.  <br /></td></tr>
<tr class="separator:ae3de50c27b4f63f330bc3b3f3948d74a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bcf13ef8771eef5a5d7d2f375d3225f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_dispatch_8c.html#a3bcf13ef8771eef5a5d7d2f375d3225f">DispatchEventRdpmc</a> (<a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu)</td></tr>
<tr class="memdesc:a3bcf13ef8771eef5a5d7d2f375d3225f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to RDPMC events.  <br /></td></tr>
<tr class="separator:a3bcf13ef8771eef5a5d7d2f375d3225f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab29357f2d04f132cb67577cb62162ec8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_dispatch_8c.html#ab29357f2d04f132cb67577cb62162ec8">DispatchEventMov2DebugRegs</a> (<a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu)</td></tr>
<tr class="memdesc:ab29357f2d04f132cb67577cb62162ec8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to MOV 2 DR events.  <br /></td></tr>
<tr class="separator:ab29357f2d04f132cb67577cb62162ec8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbc945909fecd8ece6818d3424af63eb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_dispatch_8c.html#acbc945909fecd8ece6818d3424af63eb">DispatchEventMovToFromControlRegisters</a> (<a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu)</td></tr>
<tr class="memdesc:acbc945909fecd8ece6818d3424af63eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to mov to/from CR events.  <br /></td></tr>
<tr class="separator:acbc945909fecd8ece6818d3424af63eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b171149691c87a529b854ff8e2eb0b7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_dispatch_8c.html#a2b171149691c87a529b854ff8e2eb0b7">DispatchEventException</a> (<a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu)</td></tr>
<tr class="memdesc:a2b171149691c87a529b854ff8e2eb0b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to EXCEPTION events.  <br /></td></tr>
<tr class="separator:a2b171149691c87a529b854ff8e2eb0b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6c52a1c64aea43b90fcc571912d12ce"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_dispatch_8c.html#af6c52a1c64aea43b90fcc571912d12ce">DispatchEventExternalInterrupts</a> (<a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu)</td></tr>
<tr class="memdesc:af6c52a1c64aea43b90fcc571912d12ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to external-interrupt events.  <br /></td></tr>
<tr class="separator:af6c52a1c64aea43b90fcc571912d12ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32237d4ff3cbaf648ff111a2ddbcdd03"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_dispatch_8c.html#a32237d4ff3cbaf648ff111a2ddbcdd03">DispatchEventHiddenHookExecCc</a> (<a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu, PVOID <a class="el" href="hprdbghv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>)</td></tr>
<tr class="memdesc:a32237d4ff3cbaf648ff111a2ddbcdd03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to hidden hook exec CC events.  <br /></td></tr>
<tr class="separator:a32237d4ff3cbaf648ff111a2ddbcdd03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdd5d2cff9ea39a842046b1af7a72c51"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_dispatch_8c.html#abdd5d2cff9ea39a842046b1af7a72c51">DispatchEventHiddenHookExecDetours</a> (<a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu, PVOID <a class="el" href="hprdbghv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>)</td></tr>
<tr class="memdesc:abdd5d2cff9ea39a842046b1af7a72c51"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to hidden hook exec detours events.  <br /></td></tr>
<tr class="separator:abdd5d2cff9ea39a842046b1af7a72c51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6048cec3cc762c6c25a7a4c56f1c9e7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_dispatch_8c.html#ac6048cec3cc762c6c25a7a4c56f1c9e7">DispatchEventHiddenHookPageReadWriteWritePreEvent</a> (<a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu, PVOID <a class="el" href="hprdbghv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>, <a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> *IsTriggeringPostEventAllowed)</td></tr>
<tr class="memdesc:ac6048cec3cc762c6c25a7a4c56f1c9e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to read &amp; write, write events (pre)  <br /></td></tr>
<tr class="separator:ac6048cec3cc762c6c25a7a4c56f1c9e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf10d45341868fb3378f123b59fc99ec"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_dispatch_8c.html#abf10d45341868fb3378f123b59fc99ec">DispatchEventHiddenHookPageReadWriteReadPreEvent</a> (<a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu, PVOID <a class="el" href="hprdbghv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>, <a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> *IsTriggeringPostEventAllowed)</td></tr>
<tr class="memdesc:abf10d45341868fb3378f123b59fc99ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to read &amp; write, read events (pre)  <br /></td></tr>
<tr class="separator:abf10d45341868fb3378f123b59fc99ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f597ca816a9f741c68a6f4d82029832"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_dispatch_8c.html#a8f597ca816a9f741c68a6f4d82029832">DispatchEventHiddenHookPageReadWriteWritePostEvent</a> (<a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu, PVOID <a class="el" href="hprdbghv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>)</td></tr>
<tr class="memdesc:a8f597ca816a9f741c68a6f4d82029832"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to read &amp; write, write events (post)  <br /></td></tr>
<tr class="separator:a8f597ca816a9f741c68a6f4d82029832"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d7798fa8814952dab180285f3771e8e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_dispatch_8c.html#a4d7798fa8814952dab180285f3771e8e">DispatchEventHiddenHookPageReadWriteReadPostEvent</a> (<a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu, PVOID <a class="el" href="hprdbghv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>)</td></tr>
<tr class="memdesc:a4d7798fa8814952dab180285f3771e8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to read &amp; write, read events (post)  <br /></td></tr>
<tr class="separator:a4d7798fa8814952dab180285f3771e8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementation of debugger functions for dispatching, triggering and emulating events. </p>
<dl class="section author"><dt>Author</dt><dd>Sina Karvandi (<a href="#" onclick="location.href='mai'+'lto:'+'sin'+'a@'+'hyp'+'er'+'dbg'+'.o'+'rg'; return false;">sina@<span class="obfuscator">.nosp@m.</span>hype<span class="obfuscator">.nosp@m.</span>rdbg.<span class="obfuscator">.nosp@m.</span>org</a>)</dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2022-09-21</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>This project is released under the GNU Public License v3. </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a5c9d9d43e2cffb256cd84481e0cce22f" name="a5c9d9d43e2cffb256cd84481e0cce22f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c9d9d43e2cffb256cd84481e0cce22f">&#9670;&#160;</a></span>DispatchEventCpuid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventCpuid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *&#160;</td>
          <td class="paramname"><em>VCpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to CPUID events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  115</span>{</div>
<div class="line"><span class="lineno">  116</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>                                    <a class="code hl_variable" href="hprdbghv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>;</div>
<div class="line"><span class="lineno">  117</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno">  118</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  119</span> </div>
<div class="line"><span class="lineno">  120</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  121</span>    <span class="comment">// Check if attaching is for command dispatching in user debugger</span></div>
<div class="line"><span class="lineno">  122</span>    <span class="comment">// or a regular CPUID</span></div>
<div class="line"><span class="lineno">  123</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  124</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="_global_variables_8h.html#aa97473c862a98f925b05ef0272432090">g_Callbacks</a>.<a class="code hl_variable" href="struct___v_m_m___c_a_l_l_b_a_c_k_s.html#ab0d2caf9709eefa640c62964b4b3c20d">UdCheckForCommand</a> != NULL &amp;&amp; <a class="code hl_variable" href="_global_variables_8h.html#aa97473c862a98f925b05ef0272432090">g_Callbacks</a>.<a class="code hl_variable" href="struct___v_m_m___c_a_l_l_b_a_c_k_s.html#ab0d2caf9709eefa640c62964b4b3c20d">UdCheckForCommand</a>())</div>
<div class="line"><span class="lineno">  125</span>    {</div>
<div class="line"><span class="lineno">  126</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  127</span>        <span class="comment">// It&#39;s a thread command for user debugger, no need to run the</span></div>
<div class="line"><span class="lineno">  128</span>        <span class="comment">// actual CPUID instruction and change the registers</span></div>
<div class="line"><span class="lineno">  129</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  130</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  131</span>    }</div>
<div class="line"><span class="lineno">  132</span> </div>
<div class="line"><span class="lineno">  133</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  134</span>    <span class="comment">// As the context to event trigger, we send the eax before the cpuid</span></div>
<div class="line"><span class="lineno">  135</span>    <span class="comment">// so that the debugger can both read the eax as it&#39;s now changed by</span></div>
<div class="line"><span class="lineno">  136</span>    <span class="comment">// the cpuid instruction and also can modify the results</span></div>
<div class="line"><span class="lineno">  137</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  138</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="_global_variables_8h.html#a90a1c733b10e8c67d5386fe109c4c572">g_TriggerEventForCpuids</a>)</div>
<div class="line"><span class="lineno">  139</span>    {</div>
<div class="line"><span class="lineno">  140</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  141</span>        <span class="comment">// Adjusting the core context (save eax for the debugger)</span></div>
<div class="line"><span class="lineno">  142</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  143</span>        <a class="code hl_variable" href="hprdbghv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a> = VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>-&gt;<a class="code hl_variable" href="struct_g_u_e_s_t___r_e_g_s.html#a346ed6ae20503154a9a8031491706b3e">rax</a>;</div>
<div class="line"><span class="lineno">  144</span> </div>
<div class="line"><span class="lineno">  145</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  146</span>        <span class="comment">// Triggering the pre-event</span></div>
<div class="line"><span class="lineno">  147</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  148</span>        EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da241b6e0e595d9cb958190ad87217c06b">CPUID_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  149</span>                                                      <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  150</span>                                                      <a class="code hl_variable" href="hprdbghv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno">  151</span>                                                      &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  152</span>                                                      VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  155</span>        <span class="comment">// Check whether we need to short-circuiting event emulation or not</span></div>
<div class="line"><span class="lineno">  156</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  157</span>        <span class="keywordflow">if</span> (EventTriggerResult != <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno">  158</span>        {</div>
<div class="line"><span class="lineno">  159</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  160</span>            <span class="comment">// Handle the CPUID event in the case of triggering event</span></div>
<div class="line"><span class="lineno">  161</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  162</span>            <a class="code hl_function" href="_hv_8c.html#a8e659558abb0c1a6977e68c59130dbc9">HvHandleCpuid</a>(VCpu);</div>
<div class="line"><span class="lineno">  163</span>        }</div>
<div class="line"><span class="lineno">  164</span> </div>
<div class="line"><span class="lineno">  165</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  166</span>        <span class="comment">// Check for the post-event triggering needs</span></div>
<div class="line"><span class="lineno">  167</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  168</span>        <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno">  169</span>        {</div>
<div class="line"><span class="lineno">  170</span>            <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da241b6e0e595d9cb958190ad87217c06b">CPUID_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  171</span>                                     <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  172</span>                                     <a class="code hl_variable" href="hprdbghv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno">  173</span>                                     NULL,</div>
<div class="line"><span class="lineno">  174</span>                                     VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  175</span>        }</div>
<div class="line"><span class="lineno">  176</span>    }</div>
<div class="line"><span class="lineno">  177</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  178</span>    {</div>
<div class="line"><span class="lineno">  179</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  180</span>        <span class="comment">// Otherwise and if there is no event, we should handle the CPUID</span></div>
<div class="line"><span class="lineno">  181</span>        <span class="comment">// normally</span></div>
<div class="line"><span class="lineno">  182</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  183</span>        <a class="code hl_function" href="_hv_8c.html#a8e659558abb0c1a6977e68c59130dbc9">HvHandleCpuid</a>(VCpu);</div>
<div class="line"><span class="lineno">  184</span>    }</div>
<div class="line"><span class="lineno">  185</span>}</div>
<div class="ttc" id="a_callback_8c_html_a3b2b1cd1025b5caa035e0834e17fe925"><div class="ttname"><a href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a></div><div class="ttdeci">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE VmmCallbackTriggerEvents(VMM_EVENT_TYPE_ENUM EventType, VMM_CALLBACK_EVENT_CALLING_STAGE_TYPE CallingStage, PVOID Context, BOOLEAN *PostEventRequired, GUEST_REGS *Regs)</div><div class="ttdoc">routines callback to trigger events</div><div class="ttdef"><b>Definition:</b> Callback.c:133</div></div>
<div class="ttc" id="a_global_variables_8h_html_a90a1c733b10e8c67d5386fe109c4c572"><div class="ttname"><a href="_global_variables_8h.html#a90a1c733b10e8c67d5386fe109c4c572">g_TriggerEventForCpuids</a></div><div class="ttdeci">BOOLEAN g_TriggerEventForCpuids</div><div class="ttdoc">Showes whether the cpuid handler is allowed to trigger an event or not.</div><div class="ttdef"><b>Definition:</b> GlobalVariables.h:138</div></div>
<div class="ttc" id="a_global_variables_8h_html_aa97473c862a98f925b05ef0272432090"><div class="ttname"><a href="_global_variables_8h.html#aa97473c862a98f925b05ef0272432090">g_Callbacks</a></div><div class="ttdeci">VMM_CALLBACKS g_Callbacks</div><div class="ttdoc">List of callbacks.</div><div class="ttdef"><b>Definition:</b> GlobalVariables.h:32</div></div>
<div class="ttc" id="a_hv_8c_html_a8e659558abb0c1a6977e68c59130dbc9"><div class="ttname"><a href="_hv_8c.html#a8e659558abb0c1a6977e68c59130dbc9">HvHandleCpuid</a></div><div class="ttdeci">VOID HvHandleCpuid(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Handle Cpuid Vmexits.</div><div class="ttdef"><b>Definition:</b> Hv.c:67</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h_html_a1cb18096b299d23458d3c7b85fd86555"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></div><div class="ttdeci">UCHAR BOOLEAN</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:37</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:49</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h_html_aae17ebb9ef7279d026817fb22f8aebe9"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></div><div class="ttdeci">unsigned __int64 UINT64</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:19</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_events_8h_html_a3510cc0182b1b0735d97a3dc67ebe432"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a></div><div class="ttdeci">enum _VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</div><div class="ttdoc">The status of triggering events.</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_events_8h_html_a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a></div><div class="ttdeci">@ VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</div><div class="ttdef"><b>Definition:</b> Events.h:80</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652da241b6e0e595d9cb958190ad87217c06b"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da241b6e0e595d9cb958190ad87217c06b">CPUID_INSTRUCTION_EXECUTION</a></div><div class="ttdeci">@ CPUID_INSTRUCTION_EXECUTION</div><div class="ttdef"><b>Definition:</b> Events.h:118</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_events_8h_html_ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a></div><div class="ttdeci">@ VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</div><div class="ttdef"><b>Definition:</b> Events.h:92</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_events_8h_html_ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a></div><div class="ttdeci">@ VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</div><div class="ttdef"><b>Definition:</b> Events.h:93</div></div>
<div class="ttc" id="ahprdbghv_2header_2common_2_dpc_8h_html_a446af93100756f0d846f1bfe80e30b4b"><div class="ttname"><a href="hprdbghv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a></div><div class="ttdeci">NTKERNELAPI _In_opt_ PVOID Context</div><div class="ttdef"><b>Definition:</b> Dpc.h:25</div></div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html_aae00ab92fdce5f90e65edb3bd10ae696"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">_VIRTUAL_MACHINE_STATE::Regs</a></div><div class="ttdeci">GUEST_REGS * Regs</div><div class="ttdef"><b>Definition:</b> State.h:223</div></div>
<div class="ttc" id="astruct___v_m_m___c_a_l_l_b_a_c_k_s_html_ab0d2caf9709eefa640c62964b4b3c20d"><div class="ttname"><a href="struct___v_m_m___c_a_l_l_b_a_c_k_s.html#ab0d2caf9709eefa640c62964b4b3c20d">_VMM_CALLBACKS::UdCheckForCommand</a></div><div class="ttdeci">UD_CHECK_FOR_COMMAND UdCheckForCommand</div><div class="ttdef"><b>Definition:</b> VMM.h:203</div></div>
<div class="ttc" id="astruct_g_u_e_s_t___r_e_g_s_html_a346ed6ae20503154a9a8031491706b3e"><div class="ttname"><a href="struct_g_u_e_s_t___r_e_g_s.html#a346ed6ae20503154a9a8031491706b3e">GUEST_REGS::rax</a></div><div class="ttdeci">UINT64 rax</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:70</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aae4505a785c7a1984413ade6de7ba6bd" name="aae4505a785c7a1984413ade6de7ba6bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae4505a785c7a1984413ade6de7ba6bd">&#9670;&#160;</a></span>DispatchEventEferSyscall()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventEferSyscall </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *&#160;</td>
          <td class="paramname"><em>VCpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID&#160;</td>
          <td class="paramname"><em>Context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to SYSCALL events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CoreIndex</td><td>Current core's index </td></tr>
    <tr><td class="paramname">Regs</td><td>Guest's gp register </td></tr>
    <tr><td class="paramname">Context</td><td>Context of triggering the event </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   71</span>{</div>
<div class="line"><span class="lineno">   72</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">   73</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno">   74</span> </div>
<div class="line"><span class="lineno">   75</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   76</span>    <span class="comment">// We should trigger the event of SYSCALL here, we send the</span></div>
<div class="line"><span class="lineno">   77</span>    <span class="comment">// syscall number in rax</span></div>
<div class="line"><span class="lineno">   78</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   79</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da101288c457f5b31c0bff4cda6af0f331">SYSCALL_HOOK_EFER_SYSCALL</a>,</div>
<div class="line"><span class="lineno">   80</span>                                                  <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">   81</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>-&gt;<a class="code hl_variable" href="struct_g_u_e_s_t___r_e_g_s.html#a346ed6ae20503154a9a8031491706b3e">rax</a>,</div>
<div class="line"><span class="lineno">   82</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">   83</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   86</span>    <span class="comment">// Check whether we need to short-circuiting event emulation or not</span></div>
<div class="line"><span class="lineno">   87</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   88</span>    <span class="keywordflow">if</span> (EventTriggerResult != <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno">   89</span>    {</div>
<div class="line"><span class="lineno">   90</span>        <a class="code hl_function" href="_efer_hook_8c.html#ac90baba1bf06921f9a5e8f0a7c0836a4">SyscallHookEmulateSYSCALL</a>(VCpu);</div>
<div class="line"><span class="lineno">   91</span>        <a class="code hl_function" href="_hv_8c.html#a384185281b4d93ce4a401d66848d9049">HvSuppressRipIncrement</a>(VCpu);</div>
<div class="line"><span class="lineno">   92</span>    }</div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   95</span>    <span class="comment">// Check for the post-event triggering needs</span></div>
<div class="line"><span class="lineno">   96</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   97</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno">   98</span>    {</div>
<div class="line"><span class="lineno">   99</span>        <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da101288c457f5b31c0bff4cda6af0f331">SYSCALL_HOOK_EFER_SYSCALL</a>,</div>
<div class="line"><span class="lineno">  100</span>                                 <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  101</span>                                 VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>-&gt;<a class="code hl_variable" href="struct_g_u_e_s_t___r_e_g_s.html#a346ed6ae20503154a9a8031491706b3e">rax</a>,</div>
<div class="line"><span class="lineno">  102</span>                                 NULL,</div>
<div class="line"><span class="lineno">  103</span>                                 VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  104</span>    }</div>
<div class="line"><span class="lineno">  105</span>}</div>
<div class="ttc" id="a_efer_hook_8c_html_ac90baba1bf06921f9a5e8f0a7c0836a4"><div class="ttname"><a href="_efer_hook_8c.html#ac90baba1bf06921f9a5e8f0a7c0836a4">SyscallHookEmulateSYSCALL</a></div><div class="ttdeci">_Use_decl_annotations_ BOOLEAN SyscallHookEmulateSYSCALL(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">This function emulates the SYSCALL execution.</div><div class="ttdef"><b>Definition:</b> EferHook.c:115</div></div>
<div class="ttc" id="a_hv_8c_html_a384185281b4d93ce4a401d66848d9049"><div class="ttname"><a href="_hv_8c.html#a384185281b4d93ce4a401d66848d9049">HvSuppressRipIncrement</a></div><div class="ttdeci">VOID HvSuppressRipIncrement(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Supress the incrementation of RIP.</div><div class="ttdef"><b>Definition:</b> Hv.c:325</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652da101288c457f5b31c0bff4cda6af0f331"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da101288c457f5b31c0bff4cda6af0f331">SYSCALL_HOOK_EFER_SYSCALL</a></div><div class="ttdeci">@ SYSCALL_HOOK_EFER_SYSCALL</div><div class="ttdef"><b>Definition:</b> Events.h:115</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afe94c002465675302db8afbbd3a33a64" name="afe94c002465675302db8afbbd3a33a64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe94c002465675302db8afbbd3a33a64">&#9670;&#160;</a></span>DispatchEventEferSysret()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventEferSysret </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *&#160;</td>
          <td class="paramname"><em>VCpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID&#160;</td>
          <td class="paramname"><em>Context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to SYSRET events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CoreIndex</td><td>Current core's index </td></tr>
    <tr><td class="paramname">Regs</td><td>Guest's gp register </td></tr>
    <tr><td class="paramname">Context</td><td>Context of triggering the event </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   26</span>{</div>
<div class="line"><span class="lineno">   27</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">   28</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno">   29</span> </div>
<div class="line"><span class="lineno">   30</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   31</span>    <span class="comment">// We should trigger the event of SYSRET here</span></div>
<div class="line"><span class="lineno">   32</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   33</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652daeee3aa3ce1846c251a566625ec524190">SYSCALL_HOOK_EFER_SYSRET</a>,</div>
<div class="line"><span class="lineno">   34</span>                                                  <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">   35</span>                                                  <a class="code hl_variable" href="hprdbghv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno">   36</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">   37</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">   38</span> </div>
<div class="line"><span class="lineno">   39</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   40</span>    <span class="comment">// Check whether we need to short-circuiting event emulation or not</span></div>
<div class="line"><span class="lineno">   41</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   42</span>    <span class="keywordflow">if</span> (EventTriggerResult != <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno">   43</span>    {</div>
<div class="line"><span class="lineno">   44</span>        <a class="code hl_function" href="_efer_hook_8c.html#a3dfdd8d0afe5e4efafb11314e1660823">SyscallHookEmulateSYSRET</a>(VCpu);</div>
<div class="line"><span class="lineno">   45</span>        <a class="code hl_function" href="_hv_8c.html#a384185281b4d93ce4a401d66848d9049">HvSuppressRipIncrement</a>(VCpu);</div>
<div class="line"><span class="lineno">   46</span>    }</div>
<div class="line"><span class="lineno">   47</span> </div>
<div class="line"><span class="lineno">   48</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   49</span>    <span class="comment">// Check for the post-event triggering needs</span></div>
<div class="line"><span class="lineno">   50</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   51</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno">   52</span>    {</div>
<div class="line"><span class="lineno">   53</span>        <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652daeee3aa3ce1846c251a566625ec524190">SYSCALL_HOOK_EFER_SYSRET</a>,</div>
<div class="line"><span class="lineno">   54</span>                                 <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">   55</span>                                 <a class="code hl_variable" href="hprdbghv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno">   56</span>                                 NULL,</div>
<div class="line"><span class="lineno">   57</span>                                 VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">   58</span>    }</div>
<div class="line"><span class="lineno">   59</span>}</div>
<div class="ttc" id="a_efer_hook_8c_html_a3dfdd8d0afe5e4efafb11314e1660823"><div class="ttname"><a href="_efer_hook_8c.html#a3dfdd8d0afe5e4efafb11314e1660823">SyscallHookEmulateSYSRET</a></div><div class="ttdeci">_Use_decl_annotations_ BOOLEAN SyscallHookEmulateSYSRET(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">This function emulates the SYSRET execution.</div><div class="ttdef"><b>Definition:</b> EferHook.c:182</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652daeee3aa3ce1846c251a566625ec524190"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652daeee3aa3ce1846c251a566625ec524190">SYSCALL_HOOK_EFER_SYSRET</a></div><div class="ttdeci">@ SYSCALL_HOOK_EFER_SYSRET</div><div class="ttdef"><b>Definition:</b> Events.h:116</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2b171149691c87a529b854ff8e2eb0b7" name="a2b171149691c87a529b854ff8e2eb0b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b171149691c87a529b854ff8e2eb0b7">&#9670;&#160;</a></span>DispatchEventException()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventException </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *&#160;</td>
          <td class="paramname"><em>VCpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to EXCEPTION events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  640</span>{</div>
<div class="line"><span class="lineno">  641</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno">  642</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  643</span>    VMEXIT_INTERRUPT_INFORMATION              InterruptExit       = {0};</div>
<div class="line"><span class="lineno">  644</span> </div>
<div class="line"><span class="lineno">  645</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  646</span>    <span class="comment">// read the exit interruption information</span></div>
<div class="line"><span class="lineno">  647</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  648</span>    __vmx_vmread(VMCS_VMEXIT_INTERRUPTION_INFORMATION, &amp;InterruptExit);</div>
<div class="line"><span class="lineno">  649</span> </div>
<div class="line"><span class="lineno">  650</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  651</span>    <span class="comment">// This type of vm-exit, can be either because of an !exception event,</span></div>
<div class="line"><span class="lineno">  652</span>    <span class="comment">// or it might be because we triggered APIC or X2APIC to generate an</span></div>
<div class="line"><span class="lineno">  653</span>    <span class="comment">// NMI, we want to halt the debuggee. We perform the checks here to</span></div>
<div class="line"><span class="lineno">  654</span>    <span class="comment">// avoid triggering an event for NMIs when the debuggee requested it</span></div>
<div class="line"><span class="lineno">  655</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  656</span>    <span class="keywordflow">if</span> (InterruptExit.InterruptionType == <a class="code hl_enumvalue" href="hprdbghv_2header_2vmm_2vmx_2_events_8h.html#ade7b98ff2f26b359a8d902773a55df03aac69152d78fe2d37d38dbb5b1c637519">INTERRUPT_TYPE_NMI</a> &amp;&amp;</div>
<div class="line"><span class="lineno">  657</span>        InterruptExit.Vector == <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#af9640e4f7e36f7a6bf7c56e30a860349a3ac343b035094c215523687b053bb3f1">EXCEPTION_VECTOR_NMI</a>)</div>
<div class="line"><span class="lineno">  658</span>    {</div>
<div class="line"><span class="lineno">  659</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  660</span>        <span class="comment">// Check if we&#39;re waiting for an NMI on this core and if the guest is NOT in</span></div>
<div class="line"><span class="lineno">  661</span>        <span class="comment">// a instrument step-in (&#39;i&#39; command) routine</span></div>
<div class="line"><span class="lineno">  662</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  663</span>        <span class="keywordflow">if</span> (!VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#ac54b9b284d5db3c9e776ec27586af193">RegisterBreakOnMtf</a> &amp;&amp;</div>
<div class="line"><span class="lineno">  664</span>            <a class="code hl_function" href="_vmx_broadcast_8c.html#a4a6e97bfd88306abb8f2851d159fa848">VmxBroadcastNmiHandler</a>(VCpu, <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>))</div>
<div class="line"><span class="lineno">  665</span>        {</div>
<div class="line"><span class="lineno">  666</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  667</span>        }</div>
<div class="line"><span class="lineno">  668</span>    }</div>
<div class="line"><span class="lineno">  669</span> </div>
<div class="line"><span class="lineno">  670</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  671</span>    <span class="comment">// Also, avoid exception when we&#39;re running on a register form MTF (instrumentation step-in)</span></div>
<div class="line"><span class="lineno">  672</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  673</span>    <span class="keywordflow">if</span> (VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#ac54b9b284d5db3c9e776ec27586af193">RegisterBreakOnMtf</a>)</div>
<div class="line"><span class="lineno">  674</span>    {</div>
<div class="line"><span class="lineno">  675</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  676</span>        <span class="comment">// We ignore it because an MTF should handle it as it&#39;s an instrumentation step-in</span></div>
<div class="line"><span class="lineno">  677</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  678</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  679</span>    }</div>
<div class="line"><span class="lineno">  680</span> </div>
<div class="line"><span class="lineno">  681</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  682</span>    <span class="comment">// *** When we reached here it means that this is not a NMI cause by guest,</span></div>
<div class="line"><span class="lineno">  683</span>    <span class="comment">// probably an event ***</span></div>
<div class="line"><span class="lineno">  684</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  685</span> </div>
<div class="line"><span class="lineno">  686</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  687</span>    <span class="comment">// Triggering the pre-event</span></div>
<div class="line"><span class="lineno">  688</span>    <span class="comment">// As the context to event trigger, we send the vector or IDT Index</span></div>
<div class="line"><span class="lineno">  689</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  690</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da44de44f153661b8e9f651882510bc939">EXCEPTION_OCCURRED</a>,</div>
<div class="line"><span class="lineno">  691</span>                                                  <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  692</span>                                                  InterruptExit.Vector,</div>
<div class="line"><span class="lineno">  693</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  694</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  695</span> </div>
<div class="line"><span class="lineno">  696</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  697</span>    <span class="comment">// Now, we check if the guest enabled MTF for debugging (instrumentation stepping)</span></div>
<div class="line"><span class="lineno">  698</span>    <span class="comment">// This is because based on Intel SDM :</span></div>
<div class="line"><span class="lineno">  699</span>    <span class="comment">// If the &quot;monitor trap flag&quot; VM-execution control is 1 and VM entry is</span></div>
<div class="line"><span class="lineno">  700</span>    <span class="comment">// injecting a vectored event, an MTF VM exit is pending on the instruction</span></div>
<div class="line"><span class="lineno">  701</span>    <span class="comment">// boundary before the first instruction following the VM entry</span></div>
<div class="line"><span class="lineno">  702</span>    <span class="comment">// and,</span></div>
<div class="line"><span class="lineno">  703</span>    <span class="comment">// If VM entry is injecting a pending MTF VM exit, an MTF VM exit is pending on the</span></div>
<div class="line"><span class="lineno">  704</span>    <span class="comment">// instruction boundary before the first instruction following the VM entry</span></div>
<div class="line"><span class="lineno">  705</span>    <span class="comment">// This is the case even if the &quot;monitor trap flag&quot; VM-execution control is 0</span></div>
<div class="line"><span class="lineno">  706</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  707</span>    <span class="comment">// So, we&#39;ll ignore the injection of Exception in this case</span></div>
<div class="line"><span class="lineno">  708</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  709</span>    <span class="keywordflow">if</span> (VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#ac54b9b284d5db3c9e776ec27586af193">RegisterBreakOnMtf</a>)</div>
<div class="line"><span class="lineno">  710</span>    {</div>
<div class="line"><span class="lineno">  711</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  712</span>    }</div>
<div class="line"><span class="lineno">  713</span> </div>
<div class="line"><span class="lineno">  714</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  715</span>    <span class="comment">// Check whether we need to short-circuiting event emulation or not</span></div>
<div class="line"><span class="lineno">  716</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  717</span>    <span class="keywordflow">if</span> (EventTriggerResult != <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno">  718</span>    {</div>
<div class="line"><span class="lineno">  719</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  720</span>        <span class="comment">// Handle exception (emulate or inject the event)</span></div>
<div class="line"><span class="lineno">  721</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  722</span>        <a class="code hl_function" href="_idt_emulation_8c.html#a15c1173efc7c60e61dbe11c328549e3c">IdtEmulationHandleExceptionAndNmi</a>(VCpu, InterruptExit);</div>
<div class="line"><span class="lineno">  723</span>    }</div>
<div class="line"><span class="lineno">  724</span> </div>
<div class="line"><span class="lineno">  725</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  726</span>    <span class="comment">// Check for the post-event triggering needs</span></div>
<div class="line"><span class="lineno">  727</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  728</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno">  729</span>    {</div>
<div class="line"><span class="lineno">  730</span>        <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da44de44f153661b8e9f651882510bc939">EXCEPTION_OCCURRED</a>,</div>
<div class="line"><span class="lineno">  731</span>                                 <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  732</span>                                 InterruptExit.Vector,</div>
<div class="line"><span class="lineno">  733</span>                                 NULL,</div>
<div class="line"><span class="lineno">  734</span>                                 VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  735</span>    }</div>
<div class="line"><span class="lineno">  736</span>}</div>
<div class="ttc" id="a_idt_emulation_8c_html_a15c1173efc7c60e61dbe11c328549e3c"><div class="ttname"><a href="_idt_emulation_8c.html#a15c1173efc7c60e61dbe11c328549e3c">IdtEmulationHandleExceptionAndNmi</a></div><div class="ttdeci">VOID IdtEmulationHandleExceptionAndNmi(_Inout_ VIRTUAL_MACHINE_STATE *VCpu, _In_ VMEXIT_INTERRUPT_INFORMATION InterruptExit)</div><div class="ttdoc">Handle Nmi and expection vm-exits.</div><div class="ttdef"><b>Definition:</b> IdtEmulation.c:91</div></div>
<div class="ttc" id="a_vmx_broadcast_8c_html_a4a6e97bfd88306abb8f2851d159fa848"><div class="ttname"><a href="_vmx_broadcast_8c.html#a4a6e97bfd88306abb8f2851d159fa848">VmxBroadcastNmiHandler</a></div><div class="ttdeci">BOOLEAN VmxBroadcastNmiHandler(VIRTUAL_MACHINE_STATE *VCpu, BOOLEAN IsOnVmxNmiHandler)</div><div class="ttdoc">Handle broadcast NMIs in vmx-root mode.</div><div class="ttdef"><b>Definition:</b> VmxBroadcast.c:177</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652da44de44f153661b8e9f651882510bc939"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da44de44f153661b8e9f651882510bc939">EXCEPTION_OCCURRED</a></div><div class="ttdeci">@ EXCEPTION_OCCURRED</div><div class="ttdef"><b>Definition:</b> Events.h:126</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_events_8h_html_af9640e4f7e36f7a6bf7c56e30a860349a3ac343b035094c215523687b053bb3f1"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#af9640e4f7e36f7a6bf7c56e30a860349a3ac343b035094c215523687b053bb3f1">EXCEPTION_VECTOR_NMI</a></div><div class="ttdeci">@ EXCEPTION_VECTOR_NMI</div><div class="ttdef"><b>Definition:</b> Events.h:26</div></div>
<div class="ttc" id="ahprdbghv_2header_2vmm_2vmx_2_events_8h_html_ade7b98ff2f26b359a8d902773a55df03aac69152d78fe2d37d38dbb5b1c637519"><div class="ttname"><a href="hprdbghv_2header_2vmm_2vmx_2_events_8h.html#ade7b98ff2f26b359a8d902773a55df03aac69152d78fe2d37d38dbb5b1c637519">INTERRUPT_TYPE_NMI</a></div><div class="ttdeci">@ INTERRUPT_TYPE_NMI</div><div class="ttdef"><b>Definition:</b> Events.h:33</div></div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html_ac54b9b284d5db3c9e776ec27586af193"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#ac54b9b284d5db3c9e776ec27586af193">_VIRTUAL_MACHINE_STATE::RegisterBreakOnMtf</a></div><div class="ttdeci">BOOLEAN RegisterBreakOnMtf</div><div class="ttdef"><b>Definition:</b> State.h:216</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af6c52a1c64aea43b90fcc571912d12ce" name="af6c52a1c64aea43b90fcc571912d12ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6c52a1c64aea43b90fcc571912d12ce">&#9670;&#160;</a></span>DispatchEventExternalInterrupts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventExternalInterrupts </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *&#160;</td>
          <td class="paramname"><em>VCpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to external-interrupt events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  746</span>{</div>
<div class="line"><span class="lineno">  747</span>    VMEXIT_INTERRUPT_INFORMATION              InterruptExit;</div>
<div class="line"><span class="lineno">  748</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno">  749</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  750</span> </div>
<div class="line"><span class="lineno">  751</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  752</span>    <span class="comment">// read the exit interruption information</span></div>
<div class="line"><span class="lineno">  753</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  754</span>    __vmx_vmread(VMCS_VMEXIT_INTERRUPTION_INFORMATION, &amp;InterruptExit);</div>
<div class="line"><span class="lineno">  755</span> </div>
<div class="line"><span class="lineno">  756</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  757</span>    <span class="comment">// Check for immediate vm-exit mechanism</span></div>
<div class="line"><span class="lineno">  758</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  759</span>    <span class="keywordflow">if</span> (VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#a8e7b60dd13a24ee494ce4f0d8547e671">WaitForImmediateVmexit</a> &amp;&amp;</div>
<div class="line"><span class="lineno">  760</span>        InterruptExit.Vector == <a class="code hl_define" href="_vmx_mechanisms_8h.html#a0c5059c38c6528c2e0010613efc72643">IMMEDIATE_VMEXIT_MECHANISM_VECTOR_FOR_SELF_IPI</a>)</div>
<div class="line"><span class="lineno">  761</span>    {</div>
<div class="line"><span class="lineno">  762</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  763</span>        <span class="comment">// Disable vm-exit on external interrupts</span></div>
<div class="line"><span class="lineno">  764</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  765</span>        <a class="code hl_function" href="_hv_8c.html#a856a41c4038e4065c52eb90db0160ab2">HvSetExternalInterruptExiting</a>(VCpu, <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><span class="lineno">  766</span> </div>
<div class="line"><span class="lineno">  767</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  768</span>        <span class="comment">// Not increase the RIP</span></div>
<div class="line"><span class="lineno">  769</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  770</span>        <a class="code hl_function" href="_hv_8c.html#a384185281b4d93ce4a401d66848d9049">HvSuppressRipIncrement</a>(VCpu);</div>
<div class="line"><span class="lineno">  771</span> </div>
<div class="line"><span class="lineno">  772</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  773</span>        <span class="comment">// Hanlde immediate vm-exit mechanism</span></div>
<div class="line"><span class="lineno">  774</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  775</span>        <a class="code hl_function" href="_vmx_mechanisms_8c.html#a59d03e813d68a957b646f53bc00867b9">VmxMechanismHandleImmediateVmexit</a>(VCpu);</div>
<div class="line"><span class="lineno">  776</span> </div>
<div class="line"><span class="lineno">  777</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  778</span>        <span class="comment">// No need to continue, it&#39;s a HyperDbg mechanism</span></div>
<div class="line"><span class="lineno">  779</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  780</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  781</span>    }</div>
<div class="line"><span class="lineno">  782</span> </div>
<div class="line"><span class="lineno">  783</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  784</span>    <span class="comment">// Check process or thread change detections</span></div>
<div class="line"><span class="lineno">  785</span>    <span class="comment">// we cannot ignore injecting the interrupt to the guest if the target interrupt</span></div>
<div class="line"><span class="lineno">  786</span>    <span class="comment">// and process or thread proved to cause a system halt. it halts the system as</span></div>
<div class="line"><span class="lineno">  787</span>    <span class="comment">// we Windows expects to switch the thread while we&#39;re forcing it to not do it</span></div>
<div class="line"><span class="lineno">  788</span>    <span class="comment">// Windows fires a clk interrupt on core 0 and fires IPI on other cores</span></div>
<div class="line"><span class="lineno">  789</span>    <span class="comment">// to change a thread</span></div>
<div class="line"><span class="lineno">  790</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  791</span>    <span class="keywordflow">if</span> ((VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#ad166851f334095bff309813f73ea394e">CoreId</a> == 0 &amp;&amp; InterruptExit.Vector == <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#af9640e4f7e36f7a6bf7c56e30a860349a960ecb203830d9b67611e6edf3f2c9a5">CLOCK_INTERRUPT</a>) ||</div>
<div class="line"><span class="lineno">  792</span>        (VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#ad166851f334095bff309813f73ea394e">CoreId</a> != 0 &amp;&amp; InterruptExit.Vector == <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#af9640e4f7e36f7a6bf7c56e30a860349a692efc86ae8e8aa1ff92ab7bddbe65d8">IPI_INTERRUPT</a>))</div>
<div class="line"><span class="lineno">  793</span>    {</div>
<div class="line"><span class="lineno">  794</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="_global_variables_8h.html#aa97473c862a98f925b05ef0272432090">g_Callbacks</a>.<a class="code hl_variable" href="struct___v_m_m___c_a_l_l_b_a_c_k_s.html#a2ad2c625492f4f42a0cf63c5a826277e">DebuggerCheckProcessOrThreadChange</a> != NULL)</div>
<div class="line"><span class="lineno">  795</span>        {</div>
<div class="line"><span class="lineno">  796</span>            <a class="code hl_variable" href="_global_variables_8h.html#aa97473c862a98f925b05ef0272432090">g_Callbacks</a>.<a class="code hl_variable" href="struct___v_m_m___c_a_l_l_b_a_c_k_s.html#a2ad2c625492f4f42a0cf63c5a826277e">DebuggerCheckProcessOrThreadChange</a>(VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#ad166851f334095bff309813f73ea394e">CoreId</a>);</div>
<div class="line"><span class="lineno">  797</span>        }</div>
<div class="line"><span class="lineno">  798</span>    }</div>
<div class="line"><span class="lineno">  799</span> </div>
<div class="line"><span class="lineno">  800</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  801</span>    <span class="comment">// Triggering the pre-event</span></div>
<div class="line"><span class="lineno">  802</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  803</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da2603143abecb765f8d5975e4710e5729">EXTERNAL_INTERRUPT_OCCURRED</a>,</div>
<div class="line"><span class="lineno">  804</span>                                                  <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  805</span>                                                  InterruptExit.Vector,</div>
<div class="line"><span class="lineno">  806</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  807</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  808</span> </div>
<div class="line"><span class="lineno">  809</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  810</span>    <span class="comment">// Check whether we need to short-circuiting event emulation or not</span></div>
<div class="line"><span class="lineno">  811</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  812</span>    <span class="keywordflow">if</span> (EventTriggerResult != <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno">  813</span>    {</div>
<div class="line"><span class="lineno">  814</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  815</span>        <span class="comment">// Handle vm-exit and perform changes</span></div>
<div class="line"><span class="lineno">  816</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  817</span>        <a class="code hl_function" href="_idt_emulation_8c.html#a7e398c6b4bc80396994ebdddef64ca16">IdtEmulationHandleExternalInterrupt</a>(VCpu, InterruptExit);</div>
<div class="line"><span class="lineno">  818</span>    }</div>
<div class="line"><span class="lineno">  819</span> </div>
<div class="line"><span class="lineno">  820</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  821</span>    <span class="comment">// Check for the post-event triggering needs</span></div>
<div class="line"><span class="lineno">  822</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  823</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno">  824</span>    {</div>
<div class="line"><span class="lineno">  825</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  826</span>        <span class="comment">// Trigger the event</span></div>
<div class="line"><span class="lineno">  827</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  828</span>        <span class="comment">// As the context to event trigger, we send the vector index</span></div>
<div class="line"><span class="lineno">  829</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  830</span>        <span class="comment">// Keep in mind that interrupt might be inseted in pending list</span></div>
<div class="line"><span class="lineno">  831</span>        <span class="comment">// because the guest is not in a interruptible state and will</span></div>
<div class="line"><span class="lineno">  832</span>        <span class="comment">// be re-injected when the guest is ready for interrupts</span></div>
<div class="line"><span class="lineno">  833</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  834</span>        <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da2603143abecb765f8d5975e4710e5729">EXTERNAL_INTERRUPT_OCCURRED</a>,</div>
<div class="line"><span class="lineno">  835</span>                                 <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  836</span>                                 InterruptExit.Vector,</div>
<div class="line"><span class="lineno">  837</span>                                 NULL,</div>
<div class="line"><span class="lineno">  838</span>                                 VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  839</span>    }</div>
<div class="line"><span class="lineno">  840</span>}</div>
<div class="ttc" id="a_hv_8c_html_a856a41c4038e4065c52eb90db0160ab2"><div class="ttname"><a href="_hv_8c.html#a856a41c4038e4065c52eb90db0160ab2">HvSetExternalInterruptExiting</a></div><div class="ttdeci">VOID HvSetExternalInterruptExiting(VIRTUAL_MACHINE_STATE *VCpu, BOOLEAN Set)</div><div class="ttdoc">Set the External Interrupt Exiting.</div><div class="ttdef"><b>Definition:</b> Hv.c:1032</div></div>
<div class="ttc" id="a_idt_emulation_8c_html_a7e398c6b4bc80396994ebdddef64ca16"><div class="ttname"><a href="_idt_emulation_8c.html#a7e398c6b4bc80396994ebdddef64ca16">IdtEmulationHandleExternalInterrupt</a></div><div class="ttdeci">VOID IdtEmulationHandleExternalInterrupt(_Inout_ VIRTUAL_MACHINE_STATE *VCpu, _In_ VMEXIT_INTERRUPT_INFORMATION InterruptExit)</div><div class="ttdoc">external-interrupt vm-exit handler</div><div class="ttdef"><b>Definition:</b> IdtEmulation.c:262</div></div>
<div class="ttc" id="a_vmx_mechanisms_8c_html_a59d03e813d68a957b646f53bc00867b9"><div class="ttname"><a href="_vmx_mechanisms_8c.html#a59d03e813d68a957b646f53bc00867b9">VmxMechanismHandleImmediateVmexit</a></div><div class="ttdeci">VOID VmxMechanismHandleImmediateVmexit(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Handle immediate vm-exit after vm-entry.</div><div class="ttdef"><b>Definition:</b> VmxMechanisms.c:106</div></div>
<div class="ttc" id="a_vmx_mechanisms_8h_html_a0c5059c38c6528c2e0010613efc72643"><div class="ttname"><a href="_vmx_mechanisms_8h.html#a0c5059c38c6528c2e0010613efc72643">IMMEDIATE_VMEXIT_MECHANISM_VECTOR_FOR_SELF_IPI</a></div><div class="ttdeci">#define IMMEDIATE_VMEXIT_MECHANISM_VECTOR_FOR_SELF_IPI</div><div class="ttdef"><b>Definition:</b> VmxMechanisms.h:18</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652da2603143abecb765f8d5975e4710e5729"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da2603143abecb765f8d5975e4710e5729">EXTERNAL_INTERRUPT_OCCURRED</a></div><div class="ttdeci">@ EXTERNAL_INTERRUPT_OCCURRED</div><div class="ttdef"><b>Definition:</b> Events.h:127</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_events_8h_html_af9640e4f7e36f7a6bf7c56e30a860349a692efc86ae8e8aa1ff92ab7bddbe65d8"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#af9640e4f7e36f7a6bf7c56e30a860349a692efc86ae8e8aa1ff92ab7bddbe65d8">IPI_INTERRUPT</a></div><div class="ttdeci">@ IPI_INTERRUPT</div><div class="ttdef"><b>Definition:</b> Events.h:63</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_events_8h_html_af9640e4f7e36f7a6bf7c56e30a860349a960ecb203830d9b67611e6edf3f2c9a5"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#af9640e4f7e36f7a6bf7c56e30a860349a960ecb203830d9b67611e6edf3f2c9a5">CLOCK_INTERRUPT</a></div><div class="ttdeci">@ CLOCK_INTERRUPT</div><div class="ttdef"><b>Definition:</b> Events.h:62</div></div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html_a8e7b60dd13a24ee494ce4f0d8547e671"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#a8e7b60dd13a24ee494ce4f0d8547e671">_VIRTUAL_MACHINE_STATE::WaitForImmediateVmexit</a></div><div class="ttdeci">BOOLEAN WaitForImmediateVmexit</div><div class="ttdef"><b>Definition:</b> State.h:213</div></div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html_ad166851f334095bff309813f73ea394e"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#ad166851f334095bff309813f73ea394e">_VIRTUAL_MACHINE_STATE::CoreId</a></div><div class="ttdeci">UINT32 CoreId</div><div class="ttdef"><b>Definition:</b> State.h:224</div></div>
<div class="ttc" id="astruct___v_m_m___c_a_l_l_b_a_c_k_s_html_a2ad2c625492f4f42a0cf63c5a826277e"><div class="ttname"><a href="struct___v_m_m___c_a_l_l_b_a_c_k_s.html#a2ad2c625492f4f42a0cf63c5a826277e">_VMM_CALLBACKS::DebuggerCheckProcessOrThreadChange</a></div><div class="ttdeci">INTERCEPTION_CALLBACK_TRIGGER_CLOCK_AND_IPI DebuggerCheckProcessOrThreadChange</div><div class="ttdef"><b>Definition:</b> VMM.h:206</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a32237d4ff3cbaf648ff111a2ddbcdd03" name="a32237d4ff3cbaf648ff111a2ddbcdd03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32237d4ff3cbaf648ff111a2ddbcdd03">&#9670;&#160;</a></span>DispatchEventHiddenHookExecCc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventHiddenHookExecCc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *&#160;</td>
          <td class="paramname"><em>VCpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID&#160;</td>
          <td class="paramname"><em>Context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to hidden hook exec CC events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
    <tr><td class="paramname">Context</td><td>The context of the caller </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  852</span>{</div>
<div class="line"><span class="lineno">  853</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> PostEventTriggerReq = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  854</span> </div>
<div class="line"><span class="lineno">  855</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  856</span>    <span class="comment">// Triggering the pre-event (This command only support the</span></div>
<div class="line"><span class="lineno">  857</span>    <span class="comment">// pre-event, the post-event doesn&#39;t make sense in this command)</span></div>
<div class="line"><span class="lineno">  858</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  859</span>    <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dae6b7bb6d9db9d890b9fdb1c0fb64adea">HIDDEN_HOOK_EXEC_CC</a>,</div>
<div class="line"><span class="lineno">  860</span>                             <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  861</span>                             <a class="code hl_variable" href="hprdbghv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno">  862</span>                             &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  863</span>                             VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>); <span class="comment">// it will crash if we pass it NULL</span></div>
<div class="line"><span class="lineno">  864</span>}</div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652dae6b7bb6d9db9d890b9fdb1c0fb64adea"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dae6b7bb6d9db9d890b9fdb1c0fb64adea">HIDDEN_HOOK_EXEC_CC</a></div><div class="ttdeci">@ HIDDEN_HOOK_EXEC_CC</div><div class="ttdef"><b>Definition:</b> Events.h:113</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abdd5d2cff9ea39a842046b1af7a72c51" name="abdd5d2cff9ea39a842046b1af7a72c51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdd5d2cff9ea39a842046b1af7a72c51">&#9670;&#160;</a></span>DispatchEventHiddenHookExecDetours()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventHiddenHookExecDetours </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *&#160;</td>
          <td class="paramname"><em>VCpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID&#160;</td>
          <td class="paramname"><em>Context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to hidden hook exec detours events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
    <tr><td class="paramname">Context</td><td>The context of the caller </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  876</span>{</div>
<div class="line"><span class="lineno">  877</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> PostEventTriggerReq = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  878</span> </div>
<div class="line"><span class="lineno">  879</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  880</span>    <span class="comment">// Triggering the pre-event (This command only support the</span></div>
<div class="line"><span class="lineno">  881</span>    <span class="comment">// pre-event, the post-event doesn&#39;t make sense in this command)</span></div>
<div class="line"><span class="lineno">  882</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  883</span>    <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da7855c6424b4f6ae73f06fce56de6f8d0">HIDDEN_HOOK_EXEC_DETOURS</a>,</div>
<div class="line"><span class="lineno">  884</span>                             <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  885</span>                             <a class="code hl_variable" href="hprdbghv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno">  886</span>                             &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  887</span>                             VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>); <span class="comment">// it will crash if we pass it NULL</span></div>
<div class="line"><span class="lineno">  888</span>}</div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652da7855c6424b4f6ae73f06fce56de6f8d0"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da7855c6424b4f6ae73f06fce56de6f8d0">HIDDEN_HOOK_EXEC_DETOURS</a></div><div class="ttdeci">@ HIDDEN_HOOK_EXEC_DETOURS</div><div class="ttdef"><b>Definition:</b> Events.h:112</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4d7798fa8814952dab180285f3771e8e" name="a4d7798fa8814952dab180285f3771e8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d7798fa8814952dab180285f3771e8e">&#9670;&#160;</a></span>DispatchEventHiddenHookPageReadWriteReadPostEvent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventHiddenHookPageReadWriteReadPostEvent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *&#160;</td>
          <td class="paramname"><em>VCpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID&#160;</td>
          <td class="paramname"><em>Context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to read &amp; write, read events (post) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
    <tr><td class="paramname">Context</td><td>The context of the caller </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1040</span>{</div>
<div class="line"><span class="lineno"> 1041</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1042</span>    <span class="comment">// Triggering the post-event (for the read hooks)</span></div>
<div class="line"><span class="lineno"> 1043</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1044</span>    <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dae867265e725894418ee56eb70c167607">HIDDEN_HOOK_READ</a>,</div>
<div class="line"><span class="lineno"> 1045</span>                             <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno"> 1046</span>                             <a class="code hl_variable" href="hprdbghv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno"> 1047</span>                             NULL,</div>
<div class="line"><span class="lineno"> 1048</span>                             VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno"> 1049</span> </div>
<div class="line"><span class="lineno"> 1050</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1051</span>    <span class="comment">// Triggering the post-event (for the read &amp; write hooks)</span></div>
<div class="line"><span class="lineno"> 1052</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1053</span>    <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dad808743389ae088141be0ebec72d3e1f">HIDDEN_HOOK_READ_AND_WRITE</a>,</div>
<div class="line"><span class="lineno"> 1054</span>                             <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno"> 1055</span>                             <a class="code hl_variable" href="hprdbghv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno"> 1056</span>                             NULL,</div>
<div class="line"><span class="lineno"> 1057</span>                             VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno"> 1058</span>}</div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652dad808743389ae088141be0ebec72d3e1f"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dad808743389ae088141be0ebec72d3e1f">HIDDEN_HOOK_READ_AND_WRITE</a></div><div class="ttdeci">@ HIDDEN_HOOK_READ_AND_WRITE</div><div class="ttdef"><b>Definition:</b> Events.h:108</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652dae867265e725894418ee56eb70c167607"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dae867265e725894418ee56eb70c167607">HIDDEN_HOOK_READ</a></div><div class="ttdeci">@ HIDDEN_HOOK_READ</div><div class="ttdef"><b>Definition:</b> Events.h:109</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abf10d45341868fb3378f123b59fc99ec" name="abf10d45341868fb3378f123b59fc99ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf10d45341868fb3378f123b59fc99ec">&#9670;&#160;</a></span>DispatchEventHiddenHookPageReadWriteReadPreEvent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> DispatchEventHiddenHookPageReadWriteReadPreEvent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *&#160;</td>
          <td class="paramname"><em>VCpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID&#160;</td>
          <td class="paramname"><em>Context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> *&#160;</td>
          <td class="paramname"><em>IsTriggeringPostEventAllowed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to read &amp; write, read events (pre) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
    <tr><td class="paramname">Context</td><td>The context of the caller </td></tr>
    <tr><td class="paramname">IsTriggeringPostEventAllowed</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  956</span>{</div>
<div class="line"><span class="lineno">  957</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno">  958</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq  = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  959</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   ShortCircuitingEvent = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  960</span> </div>
<div class="line"><span class="lineno">  961</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  962</span>    <span class="comment">// Triggering the pre-event (for the read hooks)</span></div>
<div class="line"><span class="lineno">  963</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  964</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dae867265e725894418ee56eb70c167607">HIDDEN_HOOK_READ</a>,</div>
<div class="line"><span class="lineno">  965</span>                                                  <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  966</span>                                                  <a class="code hl_variable" href="hprdbghv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno">  967</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  968</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  969</span> </div>
<div class="line"><span class="lineno">  970</span>    <span class="keywordflow">if</span> (EventTriggerResult == <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno">  971</span>    {</div>
<div class="line"><span class="lineno">  972</span>        ShortCircuitingEvent = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  973</span>    }</div>
<div class="line"><span class="lineno">  974</span> </div>
<div class="line"><span class="lineno">  975</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno">  976</span>    {</div>
<div class="line"><span class="lineno">  977</span>        *IsTriggeringPostEventAllowed = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  978</span>    }</div>
<div class="line"><span class="lineno">  979</span> </div>
<div class="line"><span class="lineno">  980</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  981</span>    <span class="comment">// Triggering the pre-event (for the read &amp; write hooks)</span></div>
<div class="line"><span class="lineno">  982</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  983</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dad808743389ae088141be0ebec72d3e1f">HIDDEN_HOOK_READ_AND_WRITE</a>,</div>
<div class="line"><span class="lineno">  984</span>                                                  <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  985</span>                                                  <a class="code hl_variable" href="hprdbghv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno">  986</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  987</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  988</span> </div>
<div class="line"><span class="lineno">  989</span>    <span class="keywordflow">if</span> (EventTriggerResult == <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno">  990</span>    {</div>
<div class="line"><span class="lineno">  991</span>        ShortCircuitingEvent = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  992</span>    }</div>
<div class="line"><span class="lineno">  993</span> </div>
<div class="line"><span class="lineno">  994</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno">  995</span>    {</div>
<div class="line"><span class="lineno">  996</span>        *IsTriggeringPostEventAllowed = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  997</span>    }</div>
<div class="line"><span class="lineno">  998</span> </div>
<div class="line"><span class="lineno">  999</span>    <span class="keywordflow">return</span> ShortCircuitingEvent;</div>
<div class="line"><span class="lineno"> 1000</span>}</div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:50</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8f597ca816a9f741c68a6f4d82029832" name="a8f597ca816a9f741c68a6f4d82029832"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f597ca816a9f741c68a6f4d82029832">&#9670;&#160;</a></span>DispatchEventHiddenHookPageReadWriteWritePostEvent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventHiddenHookPageReadWriteWritePostEvent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *&#160;</td>
          <td class="paramname"><em>VCpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID&#160;</td>
          <td class="paramname"><em>Context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to read &amp; write, write events (post) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
    <tr><td class="paramname">Context</td><td>The context of the caller </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1011</span>{</div>
<div class="line"><span class="lineno"> 1012</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1013</span>    <span class="comment">// Triggering the post-event (for the write hooks)</span></div>
<div class="line"><span class="lineno"> 1014</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1015</span>    <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652daf0d6ee52cb6e4c9689dcec72c8ee25cb">HIDDEN_HOOK_WRITE</a>,</div>
<div class="line"><span class="lineno"> 1016</span>                             <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno"> 1017</span>                             <a class="code hl_variable" href="hprdbghv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno"> 1018</span>                             NULL,</div>
<div class="line"><span class="lineno"> 1019</span>                             VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno"> 1020</span> </div>
<div class="line"><span class="lineno"> 1021</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1022</span>    <span class="comment">// Triggering the post-event (for the read &amp; write hooks)</span></div>
<div class="line"><span class="lineno"> 1023</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1024</span>    <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dad808743389ae088141be0ebec72d3e1f">HIDDEN_HOOK_READ_AND_WRITE</a>,</div>
<div class="line"><span class="lineno"> 1025</span>                             <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno"> 1026</span>                             <a class="code hl_variable" href="hprdbghv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno"> 1027</span>                             NULL,</div>
<div class="line"><span class="lineno"> 1028</span>                             VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno"> 1029</span>}</div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652daf0d6ee52cb6e4c9689dcec72c8ee25cb"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652daf0d6ee52cb6e4c9689dcec72c8ee25cb">HIDDEN_HOOK_WRITE</a></div><div class="ttdeci">@ HIDDEN_HOOK_WRITE</div><div class="ttdef"><b>Definition:</b> Events.h:110</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac6048cec3cc762c6c25a7a4c56f1c9e7" name="ac6048cec3cc762c6c25a7a4c56f1c9e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6048cec3cc762c6c25a7a4c56f1c9e7">&#9670;&#160;</a></span>DispatchEventHiddenHookPageReadWriteWritePreEvent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> DispatchEventHiddenHookPageReadWriteWritePreEvent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *&#160;</td>
          <td class="paramname"><em>VCpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID&#160;</td>
          <td class="paramname"><em>Context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> *&#160;</td>
          <td class="paramname"><em>IsTriggeringPostEventAllowed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to read &amp; write, write events (pre) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
    <tr><td class="paramname">Context</td><td>The context of the caller </td></tr>
    <tr><td class="paramname">IsTriggeringPostEventAllowed</td><td>Is the caller required to trigger post event </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  900</span>{</div>
<div class="line"><span class="lineno">  901</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno">  902</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq  = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  903</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   ShortCircuitingEvent = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  904</span> </div>
<div class="line"><span class="lineno">  905</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  906</span>    <span class="comment">// Triggering the pre-event (for the write hooks)</span></div>
<div class="line"><span class="lineno">  907</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  908</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652daf0d6ee52cb6e4c9689dcec72c8ee25cb">HIDDEN_HOOK_WRITE</a>,</div>
<div class="line"><span class="lineno">  909</span>                                                  <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  910</span>                                                  <a class="code hl_variable" href="hprdbghv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno">  911</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  912</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  913</span> </div>
<div class="line"><span class="lineno">  914</span>    <span class="keywordflow">if</span> (EventTriggerResult == <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno">  915</span>    {</div>
<div class="line"><span class="lineno">  916</span>        ShortCircuitingEvent = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  917</span>    }</div>
<div class="line"><span class="lineno">  918</span> </div>
<div class="line"><span class="lineno">  919</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno">  920</span>    {</div>
<div class="line"><span class="lineno">  921</span>        *IsTriggeringPostEventAllowed = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  922</span>    }</div>
<div class="line"><span class="lineno">  923</span> </div>
<div class="line"><span class="lineno">  924</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  925</span>    <span class="comment">// Triggering the pre-event (for the read &amp; write hooks)</span></div>
<div class="line"><span class="lineno">  926</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  927</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dad808743389ae088141be0ebec72d3e1f">HIDDEN_HOOK_READ_AND_WRITE</a>,</div>
<div class="line"><span class="lineno">  928</span>                                                  <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  929</span>                                                  <a class="code hl_variable" href="hprdbghv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno">  930</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  931</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  932</span> </div>
<div class="line"><span class="lineno">  933</span>    <span class="keywordflow">if</span> (EventTriggerResult == <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno">  934</span>    {</div>
<div class="line"><span class="lineno">  935</span>        ShortCircuitingEvent = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  936</span>    }</div>
<div class="line"><span class="lineno">  937</span> </div>
<div class="line"><span class="lineno">  938</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno">  939</span>    {</div>
<div class="line"><span class="lineno">  940</span>        *IsTriggeringPostEventAllowed = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  941</span>    }</div>
<div class="line"><span class="lineno">  942</span> </div>
<div class="line"><span class="lineno">  943</span>    <span class="keywordflow">return</span> ShortCircuitingEvent;</div>
<div class="line"><span class="lineno">  944</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9beef1729154452db4d14e11fbfa4478" name="a9beef1729154452db4d14e11fbfa4478"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9beef1729154452db4d14e11fbfa4478">&#9670;&#160;</a></span>DispatchEventIO()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventIO </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *&#160;</td>
          <td class="paramname"><em>VCpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to IO events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  310</span>{</div>
<div class="line"><span class="lineno">  311</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno">  312</span>    VMX_EXIT_QUALIFICATION_IO_INSTRUCTION     IoQualification     = {.AsUInt = VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#a02c526f56dd4a8b75459fe908e6e14d3">ExitQualification</a>};</div>
<div class="line"><span class="lineno">  313</span>    RFLAGS                                    Flags               = {0};</div>
<div class="line"><span class="lineno">  314</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  315</span> </div>
<div class="line"><span class="lineno">  316</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  317</span>    <span class="comment">// Read Guest&#39;s RFLAGS</span></div>
<div class="line"><span class="lineno">  318</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  319</span>    __vmx_vmread(VMCS_GUEST_RFLAGS, &amp;Flags);</div>
<div class="line"><span class="lineno">  320</span> </div>
<div class="line"><span class="lineno">  321</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  322</span>    <span class="comment">// As the context to event trigger, port address</span></div>
<div class="line"><span class="lineno">  323</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  324</span>    <span class="keywordflow">if</span> (IoQualification.DirectionOfAccess == <a class="code hl_enumvalue" href="_io_handler_8h.html#a94798fdadfbf49a7c658ace669a1d310a9caacbeb555fb90efe8f786a87b7105a">AccessIn</a>)</div>
<div class="line"><span class="lineno">  325</span>    {</div>
<div class="line"><span class="lineno">  326</span>        EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da6a202de571d60ac89bb974578614c435">IN_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  327</span>                                                      <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  328</span>                                                      IoQualification.PortNumber,</div>
<div class="line"><span class="lineno">  329</span>                                                      &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  330</span>                                                      VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  331</span>    }</div>
<div class="line"><span class="lineno">  332</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IoQualification.DirectionOfAccess == <a class="code hl_enumvalue" href="_io_handler_8h.html#a94798fdadfbf49a7c658ace669a1d310a8c9b3e408af80d53be16f30c569710f9">AccessOut</a>)</div>
<div class="line"><span class="lineno">  333</span>    {</div>
<div class="line"><span class="lineno">  334</span>        EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da231fe69249739631c760bf0116db5ebc">OUT_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  335</span>                                                      <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  336</span>                                                      IoQualification.PortNumber,</div>
<div class="line"><span class="lineno">  337</span>                                                      &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  338</span>                                                      VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  339</span>    }</div>
<div class="line"><span class="lineno">  340</span> </div>
<div class="line"><span class="lineno">  341</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  342</span>    <span class="comment">// Check whether we need to short-circuiting event emulation or not</span></div>
<div class="line"><span class="lineno">  343</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  344</span>    <span class="keywordflow">if</span> (EventTriggerResult != <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno">  345</span>    {</div>
<div class="line"><span class="lineno">  346</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  347</span>        <span class="comment">// Call the I/O Handler</span></div>
<div class="line"><span class="lineno">  348</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  349</span>        <a class="code hl_function" href="_io_handler_8c.html#a8c882cef497ffae117ee4badbd7805dd">IoHandleIoVmExits</a>(VCpu, IoQualification, Flags);</div>
<div class="line"><span class="lineno">  350</span>    }</div>
<div class="line"><span class="lineno">  351</span> </div>
<div class="line"><span class="lineno">  352</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  353</span>    <span class="comment">// Check for the post-event triggering needs</span></div>
<div class="line"><span class="lineno">  354</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  355</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno">  356</span>    {</div>
<div class="line"><span class="lineno">  357</span>        <span class="keywordflow">if</span> (IoQualification.DirectionOfAccess == <a class="code hl_enumvalue" href="_io_handler_8h.html#a94798fdadfbf49a7c658ace669a1d310a9caacbeb555fb90efe8f786a87b7105a">AccessIn</a>)</div>
<div class="line"><span class="lineno">  358</span>        {</div>
<div class="line"><span class="lineno">  359</span>            <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da6a202de571d60ac89bb974578614c435">IN_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  360</span>                                     <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  361</span>                                     IoQualification.PortNumber,</div>
<div class="line"><span class="lineno">  362</span>                                     NULL,</div>
<div class="line"><span class="lineno">  363</span>                                     VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  364</span>        }</div>
<div class="line"><span class="lineno">  365</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IoQualification.DirectionOfAccess == <a class="code hl_enumvalue" href="_io_handler_8h.html#a94798fdadfbf49a7c658ace669a1d310a8c9b3e408af80d53be16f30c569710f9">AccessOut</a>)</div>
<div class="line"><span class="lineno">  366</span>        {</div>
<div class="line"><span class="lineno">  367</span>            <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da231fe69249739631c760bf0116db5ebc">OUT_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  368</span>                                     <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  369</span>                                     IoQualification.PortNumber,</div>
<div class="line"><span class="lineno">  370</span>                                     NULL,</div>
<div class="line"><span class="lineno">  371</span>                                     VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  372</span>        }</div>
<div class="line"><span class="lineno">  373</span>    }</div>
<div class="line"><span class="lineno">  374</span>}</div>
<div class="ttc" id="a_io_handler_8c_html_a8c882cef497ffae117ee4badbd7805dd"><div class="ttname"><a href="_io_handler_8c.html#a8c882cef497ffae117ee4badbd7805dd">IoHandleIoVmExits</a></div><div class="ttdeci">VOID IoHandleIoVmExits(VIRTUAL_MACHINE_STATE *VCpu, VMX_EXIT_QUALIFICATION_IO_INSTRUCTION IoQualification, RFLAGS Flags)</div><div class="ttdoc">VM-Exit handler for I/O Instructions (in/out)</div><div class="ttdef"><b>Definition:</b> IoHandler.c:24</div></div>
<div class="ttc" id="a_io_handler_8h_html_a94798fdadfbf49a7c658ace669a1d310a8c9b3e408af80d53be16f30c569710f9"><div class="ttname"><a href="_io_handler_8h.html#a94798fdadfbf49a7c658ace669a1d310a8c9b3e408af80d53be16f30c569710f9">AccessOut</a></div><div class="ttdeci">@ AccessOut</div><div class="ttdef"><b>Definition:</b> IoHandler.h:28</div></div>
<div class="ttc" id="a_io_handler_8h_html_a94798fdadfbf49a7c658ace669a1d310a9caacbeb555fb90efe8f786a87b7105a"><div class="ttname"><a href="_io_handler_8h.html#a94798fdadfbf49a7c658ace669a1d310a9caacbeb555fb90efe8f786a87b7105a">AccessIn</a></div><div class="ttdeci">@ AccessIn</div><div class="ttdef"><b>Definition:</b> IoHandler.h:29</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652da231fe69249739631c760bf0116db5ebc"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da231fe69249739631c760bf0116db5ebc">OUT_INSTRUCTION_EXECUTION</a></div><div class="ttdeci">@ OUT_INSTRUCTION_EXECUTION</div><div class="ttdef"><b>Definition:</b> Events.h:124</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652da6a202de571d60ac89bb974578614c435"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da6a202de571d60ac89bb974578614c435">IN_INSTRUCTION_EXECUTION</a></div><div class="ttdeci">@ IN_INSTRUCTION_EXECUTION</div><div class="ttdef"><b>Definition:</b> Events.h:123</div></div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html_a02c526f56dd4a8b75459fe908e6e14d3"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#a02c526f56dd4a8b75459fe908e6e14d3">_VIRTUAL_MACHINE_STATE::ExitQualification</a></div><div class="ttdeci">UINT32 ExitQualification</div><div class="ttdef"><b>Definition:</b> State.h:226</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab29357f2d04f132cb67577cb62162ec8" name="ab29357f2d04f132cb67577cb62162ec8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab29357f2d04f132cb67577cb62162ec8">&#9670;&#160;</a></span>DispatchEventMov2DebugRegs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventMov2DebugRegs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *&#160;</td>
          <td class="paramname"><em>VCpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to MOV 2 DR events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  519</span>{</div>
<div class="line"><span class="lineno">  520</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno">  521</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  522</span> </div>
<div class="line"><span class="lineno">  523</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  524</span>    <span class="comment">// Handle access to debug registers, if we should not ignore it, it is</span></div>
<div class="line"><span class="lineno">  525</span>    <span class="comment">// because on detecting thread scheduling we ignore the hardware debug</span></div>
<div class="line"><span class="lineno">  526</span>    <span class="comment">// registers modifications</span></div>
<div class="line"><span class="lineno">  527</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  528</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="_global_variables_8h.html#aa97473c862a98f925b05ef0272432090">g_Callbacks</a>.<a class="code hl_variable" href="struct___v_m_m___c_a_l_l_b_a_c_k_s.html#ac3c5e64853124cfbe9a766570cb99e1e">KdQueryDebuggerQueryThreadOrProcessTracingDetailsByCoreId</a> != NULL &amp;&amp;</div>
<div class="line"><span class="lineno">  529</span>        <a class="code hl_variable" href="_global_variables_8h.html#aa97473c862a98f925b05ef0272432090">g_Callbacks</a>.<a class="code hl_variable" href="struct___v_m_m___c_a_l_l_b_a_c_k_s.html#ac3c5e64853124cfbe9a766570cb99e1e">KdQueryDebuggerQueryThreadOrProcessTracingDetailsByCoreId</a>(VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#ad166851f334095bff309813f73ea394e">CoreId</a>,</div>
<div class="line"><span class="lineno">  530</span>                                                                              <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_data_types_8h.html#acfd6753933f87f36dcdc4ca89a98c2bba8a119c7a070b95e9637dde60782d0efd">DEBUGGER_THREAD_PROCESS_TRACING_INTERCEPT_CLOCK_DEBUG_REGISTER_INTERCEPTION</a>))</div>
<div class="line"><span class="lineno">  531</span>    {</div>
<div class="line"><span class="lineno">  532</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  533</span>    }</div>
<div class="line"><span class="lineno">  534</span> </div>
<div class="line"><span class="lineno">  535</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  536</span>    <span class="comment">// Triggering the pre-event</span></div>
<div class="line"><span class="lineno">  537</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  538</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da1049ea359ccd219c39ef6a01f535f543">DEBUG_REGISTERS_ACCESSED</a>,</div>
<div class="line"><span class="lineno">  539</span>                                                  <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  540</span>                                                  NULL,</div>
<div class="line"><span class="lineno">  541</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  542</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  543</span> </div>
<div class="line"><span class="lineno">  544</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  545</span>    <span class="comment">// Check whether we need to short-circuiting event emulation or not</span></div>
<div class="line"><span class="lineno">  546</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  547</span>    <span class="keywordflow">if</span> (EventTriggerResult != <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno">  548</span>    {</div>
<div class="line"><span class="lineno">  549</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  550</span>        <span class="comment">// Handle RDPMC (emulate MOV 2 Debug Registers)</span></div>
<div class="line"><span class="lineno">  551</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  552</span>        <a class="code hl_function" href="_hv_8c.html#a17ca5235cf591dc0e8b36b4a850e4592">HvHandleMovDebugRegister</a>(VCpu);</div>
<div class="line"><span class="lineno">  553</span>    }</div>
<div class="line"><span class="lineno">  554</span> </div>
<div class="line"><span class="lineno">  555</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  556</span>    <span class="comment">// Check for the post-event triggering needs</span></div>
<div class="line"><span class="lineno">  557</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  558</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno">  559</span>    {</div>
<div class="line"><span class="lineno">  560</span>        <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da1049ea359ccd219c39ef6a01f535f543">DEBUG_REGISTERS_ACCESSED</a>,</div>
<div class="line"><span class="lineno">  561</span>                                 <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  562</span>                                 NULL,</div>
<div class="line"><span class="lineno">  563</span>                                 NULL,</div>
<div class="line"><span class="lineno">  564</span>                                 VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  565</span>    }</div>
<div class="line"><span class="lineno">  566</span>}</div>
<div class="ttc" id="a_hv_8c_html_a17ca5235cf591dc0e8b36b4a850e4592"><div class="ttname"><a href="_hv_8c.html#a17ca5235cf591dc0e8b36b4a850e4592">HvHandleMovDebugRegister</a></div><div class="ttdeci">VOID HvHandleMovDebugRegister(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Handle Mov to Debug Registers Exitings.</div><div class="ttdef"><b>Definition:</b> Hv.c:725</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_data_types_8h_html_acfd6753933f87f36dcdc4ca89a98c2bba8a119c7a070b95e9637dde60782d0efd"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_data_types_8h.html#acfd6753933f87f36dcdc4ca89a98c2bba8a119c7a070b95e9637dde60782d0efd">DEBUGGER_THREAD_PROCESS_TRACING_INTERCEPT_CLOCK_DEBUG_REGISTER_INTERCEPTION</a></div><div class="ttdeci">@ DEBUGGER_THREAD_PROCESS_TRACING_INTERCEPT_CLOCK_DEBUG_REGISTER_INTERCEPTION</div><div class="ttdef"><b>Definition:</b> DataTypes.h:81</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652da1049ea359ccd219c39ef6a01f535f543"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da1049ea359ccd219c39ef6a01f535f543">DEBUG_REGISTERS_ACCESSED</a></div><div class="ttdeci">@ DEBUG_REGISTERS_ACCESSED</div><div class="ttdef"><b>Definition:</b> Events.h:129</div></div>
<div class="ttc" id="astruct___v_m_m___c_a_l_l_b_a_c_k_s_html_ac3c5e64853124cfbe9a766570cb99e1e"><div class="ttname"><a href="struct___v_m_m___c_a_l_l_b_a_c_k_s.html#ac3c5e64853124cfbe9a766570cb99e1e">_VMM_CALLBACKS::KdQueryDebuggerQueryThreadOrProcessTracingDetailsByCoreId</a></div><div class="ttdeci">KD_QUERY_DEBUGGER_THREAD_OR_PROCESS_TRACING_DETAILS_BY_CORE_ID KdQueryDebuggerQueryThreadOrProcessTracingDetailsByCoreId</div><div class="ttdef"><b>Definition:</b> VMM.h:208</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acbc945909fecd8ece6818d3424af63eb" name="acbc945909fecd8ece6818d3424af63eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbc945909fecd8ece6818d3424af63eb">&#9670;&#160;</a></span>DispatchEventMovToFromControlRegisters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventMovToFromControlRegisters </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *&#160;</td>
          <td class="paramname"><em>VCpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to mov to/from CR events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  576</span>{</div>
<div class="line"><span class="lineno">  577</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   ModifyReg;</div>
<div class="line"><span class="lineno">  578</span>    VMX_EXIT_QUALIFICATION_MOV_CR *           CrExitQualification;</div>
<div class="line"><span class="lineno">  579</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno">  580</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  581</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a>                                     ExitQualification   = 0;</div>
<div class="line"><span class="lineno">  582</span> </div>
<div class="line"><span class="lineno">  583</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  584</span>    <span class="comment">// Read the exit qualification</span></div>
<div class="line"><span class="lineno">  585</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  586</span>    __vmx_vmread(VMCS_EXIT_QUALIFICATION, &amp;ExitQualification);</div>
<div class="line"><span class="lineno">  587</span> </div>
<div class="line"><span class="lineno">  588</span>    CrExitQualification = (VMX_EXIT_QUALIFICATION_MOV_CR *)&amp;ExitQualification;</div>
<div class="line"><span class="lineno">  589</span> </div>
<div class="line"><span class="lineno">  590</span>    <span class="keywordflow">if</span> (CrExitQualification-&gt;AccessType == VMX_EXIT_QUALIFICATION_ACCESS_MOV_TO_CR)</div>
<div class="line"><span class="lineno">  591</span>    {</div>
<div class="line"><span class="lineno">  592</span>        ModifyReg = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  593</span>    }</div>
<div class="line"><span class="lineno">  594</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  595</span>    {</div>
<div class="line"><span class="lineno">  596</span>        ModifyReg = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  597</span>    }</div>
<div class="line"><span class="lineno">  598</span> </div>
<div class="line"><span class="lineno">  599</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  600</span>    <span class="comment">// Triggering the pre-event</span></div>
<div class="line"><span class="lineno">  601</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  602</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(ModifyReg ? <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da9f2f6a92ab0d60fbdec4fa215adf38f0">CONTROL_REGISTER_MODIFIED</a> : <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da60abbb3ddfdf7dcc63cefa0d14f03433">CONTROL_REGISTER_READ</a>,</div>
<div class="line"><span class="lineno">  603</span>                                                  <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  604</span>                                                  CrExitQualification-&gt;ControlRegister,</div>
<div class="line"><span class="lineno">  605</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  606</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  607</span> </div>
<div class="line"><span class="lineno">  608</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  609</span>    <span class="comment">// Check whether we need to short-circuiting event emulation or not</span></div>
<div class="line"><span class="lineno">  610</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  611</span>    <span class="keywordflow">if</span> (EventTriggerResult != <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno">  612</span>    {</div>
<div class="line"><span class="lineno">  613</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  614</span>        <span class="comment">// Handle mov to/from control registers (emulate CR access)</span></div>
<div class="line"><span class="lineno">  615</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  616</span>        <a class="code hl_function" href="_hv_8c.html#a00cc8024816442f874bee6955dbad89c">HvHandleControlRegisterAccess</a>(VCpu, CrExitQualification);</div>
<div class="line"><span class="lineno">  617</span>    }</div>
<div class="line"><span class="lineno">  618</span> </div>
<div class="line"><span class="lineno">  619</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  620</span>    <span class="comment">// Check for the post-event triggering needs</span></div>
<div class="line"><span class="lineno">  621</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  622</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno">  623</span>    {</div>
<div class="line"><span class="lineno">  624</span>        <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(ModifyReg ? <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da9f2f6a92ab0d60fbdec4fa215adf38f0">CONTROL_REGISTER_MODIFIED</a> : <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da60abbb3ddfdf7dcc63cefa0d14f03433">CONTROL_REGISTER_READ</a>,</div>
<div class="line"><span class="lineno">  625</span>                                 <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  626</span>                                 CrExitQualification-&gt;ControlRegister,</div>
<div class="line"><span class="lineno">  627</span>                                 NULL,</div>
<div class="line"><span class="lineno">  628</span>                                 VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  629</span>    }</div>
<div class="line"><span class="lineno">  630</span>}</div>
<div class="ttc" id="a_hv_8c_html_a00cc8024816442f874bee6955dbad89c"><div class="ttname"><a href="_hv_8c.html#a00cc8024816442f874bee6955dbad89c">HvHandleControlRegisterAccess</a></div><div class="ttdeci">VOID HvHandleControlRegisterAccess(VIRTUAL_MACHINE_STATE *VCpu, VMX_EXIT_QUALIFICATION_MOV_CR *CrExitQualification)</div><div class="ttdoc">Handles Guest Access to control registers.</div><div class="ttdef"><b>Definition:</b> Hv.c:137</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h_html_af632da489ebc3708ec3ab6791ee53fa4"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a></div><div class="ttdeci">unsigned long ULONG</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:35</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652da60abbb3ddfdf7dcc63cefa0d14f03433"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da60abbb3ddfdf7dcc63cefa0d14f03433">CONTROL_REGISTER_READ</a></div><div class="ttdeci">@ CONTROL_REGISTER_READ</div><div class="ttdef"><b>Definition:</b> Events.h:137</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652da9f2f6a92ab0d60fbdec4fa215adf38f0"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da9f2f6a92ab0d60fbdec4fa215adf38f0">CONTROL_REGISTER_MODIFIED</a></div><div class="ttdeci">@ CONTROL_REGISTER_MODIFIED</div><div class="ttdef"><b>Definition:</b> Events.h:136</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a40a5898e33596b5af4a62b43410c7729" name="a40a5898e33596b5af4a62b43410c7729"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40a5898e33596b5af4a62b43410c7729">&#9670;&#160;</a></span>DispatchEventRdmsr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventRdmsr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *&#160;</td>
          <td class="paramname"><em>VCpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to RDMSR events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  384</span>{</div>
<div class="line"><span class="lineno">  385</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno">  386</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  387</span> </div>
<div class="line"><span class="lineno">  388</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  389</span>    <span class="comment">// Triggering the pre-event</span></div>
<div class="line"><span class="lineno">  390</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  391</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da5a3c774cfe921a82c832ce59284a4f93">RDMSR_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  392</span>                                                  <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  393</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>-&gt;<a class="code hl_variable" href="struct_g_u_e_s_t___r_e_g_s.html#a9a9133a328f13d405c31df928307e9fd">rcx</a> &amp; 0xffffffff,</div>
<div class="line"><span class="lineno">  394</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  395</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  396</span> </div>
<div class="line"><span class="lineno">  397</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  398</span>    <span class="comment">// Check whether we need to short-circuiting event emulation or not</span></div>
<div class="line"><span class="lineno">  399</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  400</span>    <span class="keywordflow">if</span> (EventTriggerResult != <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno">  401</span>    {</div>
<div class="line"><span class="lineno">  402</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  403</span>        <span class="comment">// Handle vm-exit and perform changes</span></div>
<div class="line"><span class="lineno">  404</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  405</span>        <a class="code hl_function" href="_msr_handlers_8c.html#acab5fb643fae7a845f5d3d71ce18e9ef">MsrHandleRdmsrVmexit</a>(VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  406</span>    }</div>
<div class="line"><span class="lineno">  407</span> </div>
<div class="line"><span class="lineno">  408</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  409</span>    <span class="comment">// Check for the post-event triggering needs</span></div>
<div class="line"><span class="lineno">  410</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  411</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno">  412</span>    {</div>
<div class="line"><span class="lineno">  413</span>        <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da5a3c774cfe921a82c832ce59284a4f93">RDMSR_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  414</span>                                 <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  415</span>                                 VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>-&gt;<a class="code hl_variable" href="struct_g_u_e_s_t___r_e_g_s.html#a9a9133a328f13d405c31df928307e9fd">rcx</a> &amp; 0xffffffff,</div>
<div class="line"><span class="lineno">  416</span>                                 NULL,</div>
<div class="line"><span class="lineno">  417</span>                                 VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  418</span>    }</div>
<div class="line"><span class="lineno">  419</span>}</div>
<div class="ttc" id="a_msr_handlers_8c_html_acab5fb643fae7a845f5d3d71ce18e9ef"><div class="ttname"><a href="_msr_handlers_8c.html#acab5fb643fae7a845f5d3d71ce18e9ef">MsrHandleRdmsrVmexit</a></div><div class="ttdeci">VOID MsrHandleRdmsrVmexit(PGUEST_REGS GuestRegs)</div><div class="ttdoc">Handles in the cases when RDMSR causes a vm-exit.</div><div class="ttdef"><b>Definition:</b> MsrHandlers.c:21</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652da5a3c774cfe921a82c832ce59284a4f93"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da5a3c774cfe921a82c832ce59284a4f93">RDMSR_INSTRUCTION_EXECUTION</a></div><div class="ttdeci">@ RDMSR_INSTRUCTION_EXECUTION</div><div class="ttdef"><b>Definition:</b> Events.h:120</div></div>
<div class="ttc" id="astruct_g_u_e_s_t___r_e_g_s_html_a9a9133a328f13d405c31df928307e9fd"><div class="ttname"><a href="struct_g_u_e_s_t___r_e_g_s.html#a9a9133a328f13d405c31df928307e9fd">GUEST_REGS::rcx</a></div><div class="ttdeci">UINT64 rcx</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:71</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3bcf13ef8771eef5a5d7d2f375d3225f" name="a3bcf13ef8771eef5a5d7d2f375d3225f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bcf13ef8771eef5a5d7d2f375d3225f">&#9670;&#160;</a></span>DispatchEventRdpmc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventRdpmc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *&#160;</td>
          <td class="paramname"><em>VCpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to RDPMC events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  474</span>{</div>
<div class="line"><span class="lineno">  475</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno">  476</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  477</span> </div>
<div class="line"><span class="lineno">  478</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  479</span>    <span class="comment">// Triggering the pre-event</span></div>
<div class="line"><span class="lineno">  480</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  481</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dab13f256e40f039d31bd0be0f50279170">PMC_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  482</span>                                                  <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  483</span>                                                  NULL,</div>
<div class="line"><span class="lineno">  484</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  485</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  486</span> </div>
<div class="line"><span class="lineno">  487</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  488</span>    <span class="comment">// Check whether we need to short-circuiting event emulation or not</span></div>
<div class="line"><span class="lineno">  489</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  490</span>    <span class="keywordflow">if</span> (EventTriggerResult != <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno">  491</span>    {</div>
<div class="line"><span class="lineno">  492</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  493</span>        <span class="comment">// Handle RDPMC (emulate RDPMC)</span></div>
<div class="line"><span class="lineno">  494</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  495</span>        <a class="code hl_function" href="_counters_8c.html#a6a17cba3d8cbb06782a5856f9c3b766a">CounterEmulateRdpmc</a>(VCpu);</div>
<div class="line"><span class="lineno">  496</span>    }</div>
<div class="line"><span class="lineno">  497</span> </div>
<div class="line"><span class="lineno">  498</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  499</span>    <span class="comment">// Check for the post-event triggering needs</span></div>
<div class="line"><span class="lineno">  500</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  501</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno">  502</span>    {</div>
<div class="line"><span class="lineno">  503</span>        <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dab13f256e40f039d31bd0be0f50279170">PMC_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  504</span>                                 <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  505</span>                                 NULL,</div>
<div class="line"><span class="lineno">  506</span>                                 NULL,</div>
<div class="line"><span class="lineno">  507</span>                                 VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  508</span>    }</div>
<div class="line"><span class="lineno">  509</span>}</div>
<div class="ttc" id="a_counters_8c_html_a6a17cba3d8cbb06782a5856f9c3b766a"><div class="ttname"><a href="_counters_8c.html#a6a17cba3d8cbb06782a5856f9c3b766a">CounterEmulateRdpmc</a></div><div class="ttdeci">VOID CounterEmulateRdpmc(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Emulate RDPMC.</div><div class="ttdef"><b>Definition:</b> Counters.c:62</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652dab13f256e40f039d31bd0be0f50279170"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dab13f256e40f039d31bd0be0f50279170">PMC_INSTRUCTION_EXECUTION</a></div><div class="ttdeci">@ PMC_INSTRUCTION_EXECUTION</div><div class="ttdef"><b>Definition:</b> Events.h:132</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a61e2dcbd730450008e8f6f4dcc6c7b42" name="a61e2dcbd730450008e8f6f4dcc6c7b42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61e2dcbd730450008e8f6f4dcc6c7b42">&#9670;&#160;</a></span>DispatchEventTsc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventTsc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *&#160;</td>
          <td class="paramname"><em>VCpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td>
          <td class="paramname"><em>IsRdtscp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to RDTSC/RDTSCP events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
    <tr><td class="paramname">IsRdtscp</td><td>Is a RDTSCP or RDTSC </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  196</span>{</div>
<div class="line"><span class="lineno">  197</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno">  198</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  199</span> </div>
<div class="line"><span class="lineno">  200</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  201</span>    <span class="comment">// As the context to event trigger, we send the false which means</span></div>
<div class="line"><span class="lineno">  202</span>    <span class="comment">// it&#39;s an rdtsc (for rdtscp we set Context to true)</span></div>
<div class="line"><span class="lineno">  203</span>    <span class="comment">// Note : Using !tsc command in transparent-mode is not allowed</span></div>
<div class="line"><span class="lineno">  204</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  205</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da8d4bc0d80db7c7272aaf0a74ec5823c7">TSC_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  206</span>                                                  <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  207</span>                                                  IsRdtscp,</div>
<div class="line"><span class="lineno">  208</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  209</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  210</span> </div>
<div class="line"><span class="lineno">  211</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  212</span>    <span class="comment">// Check whether we need to short-circuiting event emulation or not</span></div>
<div class="line"><span class="lineno">  213</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  214</span>    <span class="keywordflow">if</span> (EventTriggerResult != <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno">  215</span>    {</div>
<div class="line"><span class="lineno">  216</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  217</span>        <span class="comment">// Handle rdtsc (emulate rdtsc/p)</span></div>
<div class="line"><span class="lineno">  218</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  219</span>        <span class="keywordflow">if</span> (IsRdtscp)</div>
<div class="line"><span class="lineno">  220</span>        {</div>
<div class="line"><span class="lineno">  221</span>            <a class="code hl_function" href="_counters_8c.html#a77b52df7e3438c2d559da7a36d1a0a20">CounterEmulateRdtscp</a>(VCpu);</div>
<div class="line"><span class="lineno">  222</span>        }</div>
<div class="line"><span class="lineno">  223</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  224</span>        {</div>
<div class="line"><span class="lineno">  225</span>            <a class="code hl_function" href="_counters_8c.html#ae3ef454cf87233a1447b2ab674d8bb9f">CounterEmulateRdtsc</a>(VCpu);</div>
<div class="line"><span class="lineno">  226</span>        }</div>
<div class="line"><span class="lineno">  227</span>    }</div>
<div class="line"><span class="lineno">  228</span> </div>
<div class="line"><span class="lineno">  229</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  230</span>    <span class="comment">// Check for the post-event triggering needs</span></div>
<div class="line"><span class="lineno">  231</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  232</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno">  233</span>    {</div>
<div class="line"><span class="lineno">  234</span>        <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da8d4bc0d80db7c7272aaf0a74ec5823c7">TSC_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  235</span>                                 <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  236</span>                                 IsRdtscp,</div>
<div class="line"><span class="lineno">  237</span>                                 NULL,</div>
<div class="line"><span class="lineno">  238</span>                                 VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  239</span>    }</div>
<div class="line"><span class="lineno">  240</span>}</div>
<div class="ttc" id="a_counters_8c_html_a77b52df7e3438c2d559da7a36d1a0a20"><div class="ttname"><a href="_counters_8c.html#a77b52df7e3438c2d559da7a36d1a0a20">CounterEmulateRdtscp</a></div><div class="ttdeci">VOID CounterEmulateRdtscp(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Emulate RDTSCP.</div><div class="ttdef"><b>Definition:</b> Counters.c:43</div></div>
<div class="ttc" id="a_counters_8c_html_ae3ef454cf87233a1447b2ab674d8bb9f"><div class="ttname"><a href="_counters_8c.html#ae3ef454cf87233a1447b2ab674d8bb9f">CounterEmulateRdtsc</a></div><div class="ttdeci">VOID CounterEmulateRdtsc(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Emulate RDTSC.</div><div class="ttdef"><b>Definition:</b> Counters.c:21</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652da8d4bc0d80db7c7272aaf0a74ec5823c7"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da8d4bc0d80db7c7272aaf0a74ec5823c7">TSC_INSTRUCTION_EXECUTION</a></div><div class="ttdeci">@ TSC_INSTRUCTION_EXECUTION</div><div class="ttdef"><b>Definition:</b> Events.h:131</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac3eb1bf639bc9644cf1c1f44c2eb8dff" name="ac3eb1bf639bc9644cf1c1f44c2eb8dff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3eb1bf639bc9644cf1c1f44c2eb8dff">&#9670;&#160;</a></span>DispatchEventVmcall()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventVmcall </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *&#160;</td>
          <td class="paramname"><em>VCpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to VMCALL events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  250</span>{</div>
<div class="line"><span class="lineno">  251</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno">  252</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  255</span>    <span class="comment">// As the context to event trigger, we send NULL</span></div>
<div class="line"><span class="lineno">  256</span>    <span class="comment">// Registers are the best source to know the purpose</span></div>
<div class="line"><span class="lineno">  257</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  258</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="_global_variables_8h.html#a551f1bc8f7fe50864796298011256cbd">g_TriggerEventForVmcalls</a>)</div>
<div class="line"><span class="lineno">  259</span>    {</div>
<div class="line"><span class="lineno">  260</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  261</span>        <span class="comment">// Triggering the pre-event</span></div>
<div class="line"><span class="lineno">  262</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  263</span>        EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652daf3a1c84d32c23f7021ecf9717179fd47">VMCALL_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  264</span>                                                      <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  265</span>                                                      NULL,</div>
<div class="line"><span class="lineno">  266</span>                                                      &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  267</span>                                                      VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  268</span> </div>
<div class="line"><span class="lineno">  269</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  270</span>        <span class="comment">// Check whether we need to short-circuiting event emulation or not</span></div>
<div class="line"><span class="lineno">  271</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  272</span>        <span class="keywordflow">if</span> (EventTriggerResult != <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno">  273</span>        {</div>
<div class="line"><span class="lineno">  274</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  275</span>            <span class="comment">// Handle the VMCALL event in the case of triggering event</span></div>
<div class="line"><span class="lineno">  276</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  277</span>            <a class="code hl_function" href="_vmcall_8c.html#a1ed944cbbb3374497800e8babbdeef2c">VmxHandleVmcallVmExit</a>(VCpu);</div>
<div class="line"><span class="lineno">  278</span>        }</div>
<div class="line"><span class="lineno">  279</span> </div>
<div class="line"><span class="lineno">  280</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  281</span>        <span class="comment">// Check for the post-event triggering needs</span></div>
<div class="line"><span class="lineno">  282</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  283</span>        <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno">  284</span>        {</div>
<div class="line"><span class="lineno">  285</span>            <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da241b6e0e595d9cb958190ad87217c06b">CPUID_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  286</span>                                     <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  287</span>                                     NULL,</div>
<div class="line"><span class="lineno">  288</span>                                     NULL,</div>
<div class="line"><span class="lineno">  289</span>                                     VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  290</span>        }</div>
<div class="line"><span class="lineno">  291</span>    }</div>
<div class="line"><span class="lineno">  292</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  293</span>    {</div>
<div class="line"><span class="lineno">  294</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  295</span>        <span class="comment">// Otherwise and if there is no event, we should handle the VMCALL</span></div>
<div class="line"><span class="lineno">  296</span>        <span class="comment">// normally</span></div>
<div class="line"><span class="lineno">  297</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  298</span>        <a class="code hl_function" href="_vmcall_8c.html#a1ed944cbbb3374497800e8babbdeef2c">VmxHandleVmcallVmExit</a>(VCpu);</div>
<div class="line"><span class="lineno">  299</span>    }</div>
<div class="line"><span class="lineno">  300</span>}</div>
<div class="ttc" id="a_global_variables_8h_html_a551f1bc8f7fe50864796298011256cbd"><div class="ttname"><a href="_global_variables_8h.html#a551f1bc8f7fe50864796298011256cbd">g_TriggerEventForVmcalls</a></div><div class="ttdeci">BOOLEAN g_TriggerEventForVmcalls</div><div class="ttdoc">Showes whether the vmcall handler is allowed to trigger an event or not.</div><div class="ttdef"><b>Definition:</b> GlobalVariables.h:131</div></div>
<div class="ttc" id="a_vmcall_8c_html_a1ed944cbbb3374497800e8babbdeef2c"><div class="ttname"><a href="_vmcall_8c.html#a1ed944cbbb3374497800e8babbdeef2c">VmxHandleVmcallVmExit</a></div><div class="ttdeci">_Use_decl_annotations_ NTSTATUS VmxHandleVmcallVmExit(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Handle vm-exits of VMCALLs.</div><div class="ttdef"><b>Definition:</b> Vmcall.c:66</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652daf3a1c84d32c23f7021ecf9717179fd47"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652daf3a1c84d32c23f7021ecf9717179fd47">VMCALL_INSTRUCTION_EXECUTION</a></div><div class="ttdeci">@ VMCALL_INSTRUCTION_EXECUTION</div><div class="ttdef"><b>Definition:</b> Events.h:134</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae3de50c27b4f63f330bc3b3f3948d74a" name="ae3de50c27b4f63f330bc3b3f3948d74a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3de50c27b4f63f330bc3b3f3948d74a">&#9670;&#160;</a></span>DispatchEventWrmsr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventWrmsr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hprdbghv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *&#160;</td>
          <td class="paramname"><em>VCpu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to WRMSR events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  429</span>{</div>
<div class="line"><span class="lineno">  430</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno">  431</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  432</span> </div>
<div class="line"><span class="lineno">  433</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  434</span>    <span class="comment">// Triggering the pre-event</span></div>
<div class="line"><span class="lineno">  435</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  436</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da9768cd88dc35c3a48b1b0cbf323cc05e">WRMSR_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  437</span>                                                  <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  438</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>-&gt;<a class="code hl_variable" href="struct_g_u_e_s_t___r_e_g_s.html#a9a9133a328f13d405c31df928307e9fd">rcx</a> &amp; 0xffffffff,</div>
<div class="line"><span class="lineno">  439</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  440</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  441</span> </div>
<div class="line"><span class="lineno">  442</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  443</span>    <span class="comment">// Check whether we need to short-circuiting event emulation or not</span></div>
<div class="line"><span class="lineno">  444</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  445</span>    <span class="keywordflow">if</span> (EventTriggerResult != <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno">  446</span>    {</div>
<div class="line"><span class="lineno">  447</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  448</span>        <span class="comment">// Handle vm-exit and perform changes</span></div>
<div class="line"><span class="lineno">  449</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  450</span>        <a class="code hl_function" href="_msr_handlers_8c.html#a45e9291a2ab844cf31a38aa39a6131b9">MsrHandleWrmsrVmexit</a>(VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  451</span>    }</div>
<div class="line"><span class="lineno">  452</span> </div>
<div class="line"><span class="lineno">  453</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  454</span>    <span class="comment">// Check for the post-event triggering needs</span></div>
<div class="line"><span class="lineno">  455</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  456</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno">  457</span>    {</div>
<div class="line"><span class="lineno">  458</span>        <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da9768cd88dc35c3a48b1b0cbf323cc05e">WRMSR_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  459</span>                                 <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  460</span>                                 VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>-&gt;<a class="code hl_variable" href="struct_g_u_e_s_t___r_e_g_s.html#a9a9133a328f13d405c31df928307e9fd">rcx</a> &amp; 0xffffffff,</div>
<div class="line"><span class="lineno">  461</span>                                 NULL,</div>
<div class="line"><span class="lineno">  462</span>                                 VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  463</span>    }</div>
<div class="line"><span class="lineno">  464</span>}</div>
<div class="ttc" id="a_msr_handlers_8c_html_a45e9291a2ab844cf31a38aa39a6131b9"><div class="ttname"><a href="_msr_handlers_8c.html#a45e9291a2ab844cf31a38aa39a6131b9">MsrHandleWrmsrVmexit</a></div><div class="ttdeci">VOID MsrHandleWrmsrVmexit(PGUEST_REGS GuestRegs)</div><div class="ttdoc">Handles in the cases when RDMSR causes a vm-exit.</div><div class="ttdef"><b>Definition:</b> MsrHandlers.c:162</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652da9768cd88dc35c3a48b1b0cbf323cc05e"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da9768cd88dc35c3a48b1b0cbf323cc05e">WRMSR_INSTRUCTION_EXECUTION</a></div><div class="ttdeci">@ WRMSR_INSTRUCTION_EXECUTION</div><div class="ttdef"><b>Definition:</b> Events.h:121</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_53a6cdbae347618e9ee76d4be5c6ea96.html">hyperdbg</a></li><li class="navelem"><a class="el" href="dir_19054a674c4bd5cb8fceb6542228579c.html">hprdbghv</a></li><li class="navelem"><a class="el" href="dir_aac0c9299474d8b4035e61d55763e72a.html">code</a></li><li class="navelem"><a class="el" href="dir_324a3f57123903071951c4f82b1a8c9d.html">interface</a></li><li class="navelem"><a class="el" href="_dispatch_8c.html">Dispatch.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
