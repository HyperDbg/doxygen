<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HyperDbg: hyperdbg/hprdbgkd/header/debugger/commands/DebuggerCommands.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">HyperDbg
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('_debugger_commands_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">DebuggerCommands.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Commands for debugger.  
<a href="#details">More...</a></p>

<p><a href="_debugger_commands_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab8bb200983c48761d01ca416f16ef580"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_debugger_commands_8h.html#ab8bb200983c48761d01ca416f16ef580">DebuggerCommandReadMemory</a> (<a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#aa20edf6a6ccb273f5b16819964b171ac">PDEBUGGER_READ_MEMORY</a> ReadMemRequest, PVOID UserBuffer, PSIZE_T ReturnSize)</td></tr>
<tr class="memdesc:ab8bb200983c48761d01ca416f16ef580"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read memory for different commands.  <br /></td></tr>
<tr class="separator:ab8bb200983c48761d01ca416f16ef580"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70ebcfc9fa35586032ef8a500dcd294e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_debugger_commands_8h.html#a70ebcfc9fa35586032ef8a500dcd294e">DebuggerCommandReadMemoryVmxRoot</a> (<a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#aa20edf6a6ccb273f5b16819964b171ac">PDEBUGGER_READ_MEMORY</a> ReadMemRequest, <a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a> *UserBuffer, PSIZE_T ReturnSize)</td></tr>
<tr class="memdesc:a70ebcfc9fa35586032ef8a500dcd294e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read memory for different commands from vmxroot mode.  <br /></td></tr>
<tr class="separator:a70ebcfc9fa35586032ef8a500dcd294e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0af7ab7231ae69429262b4061e93ccfe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_debugger_commands_8h.html#a0af7ab7231ae69429262b4061e93ccfe">DebuggerCommandEditMemoryVmxRoot</a> (<a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#aa1c158df9e1481468f1dfe46ba0bac86">PDEBUGGER_EDIT_MEMORY</a> EditMemRequest)</td></tr>
<tr class="memdesc:a0af7ab7231ae69429262b4061e93ccfe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Edit physical and virtual memory on vmxroot mode.  <br /></td></tr>
<tr class="separator:a0af7ab7231ae69429262b4061e93ccfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cacf53abe149ebe3e2c43ad68d43e22"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_debugger_commands_8h.html#a6cacf53abe149ebe3e2c43ad68d43e22">DebuggerReadOrWriteMsr</a> (<a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a4d767d7cb2f35f41f4644da283ed779b">PDEBUGGER_READ_AND_WRITE_ON_MSR</a> ReadOrWriteMsrRequest, <a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> *UserBuffer, PSIZE_T ReturnSize)</td></tr>
<tr class="memdesc:a6cacf53abe149ebe3e2c43ad68d43e22"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform rdmsr, wrmsr commands.  <br /></td></tr>
<tr class="separator:a6cacf53abe149ebe3e2c43ad68d43e22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af777c50999a33ad8c4555984d41c5ae5"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_debugger_commands_8h.html#af777c50999a33ad8c4555984d41c5ae5">DebuggerCommandEditMemory</a> (<a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#aa1c158df9e1481468f1dfe46ba0bac86">PDEBUGGER_EDIT_MEMORY</a> EditMemRequest)</td></tr>
<tr class="memdesc:af777c50999a33ad8c4555984d41c5ae5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Edit physical and virtual memory.  <br /></td></tr>
<tr class="separator:af777c50999a33ad8c4555984d41c5ae5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90d49ed0d4f0c40139d885b24e4c5b81"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_debugger_commands_8h.html#a90d49ed0d4f0c40139d885b24e4c5b81">DebuggerCommandSearchMemory</a> (<a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a259329cf5d90fa23392810c8705398cf">PDEBUGGER_SEARCH_MEMORY</a> SearchMemRequest)</td></tr>
<tr class="memdesc:a90d49ed0d4f0c40139d885b24e4c5b81"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start searching memory.  <br /></td></tr>
<tr class="separator:a90d49ed0d4f0c40139d885b24e4c5b81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeaad6ca3d40207e5acacf96ae173aefe"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_debugger_commands_8h.html#aeaad6ca3d40207e5acacf96ae173aefe">DebuggerCommandFlush</a> (<a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#ae01f58601a1fe6b667786f7323256da7">PDEBUGGER_FLUSH_LOGGING_BUFFERS</a> DebuggerFlushBuffersRequest)</td></tr>
<tr class="memdesc:aeaad6ca3d40207e5acacf96ae173aefe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform the flush requests to vmx-root and vmx non-root buffers.  <br /></td></tr>
<tr class="separator:aeaad6ca3d40207e5acacf96ae173aefe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7aa8aa71f33a1a7c56f77864afb4641e"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_debugger_commands_8h.html#a7aa8aa71f33a1a7c56f77864afb4641e">DebuggerCommandSignalExecutionState</a> (<a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a79b3c4ae30c99d53a4287aec1398db44">PDEBUGGER_SEND_COMMAND_EXECUTION_FINISHED_SIGNAL</a> DebuggerFinishedExecutionRequest)</td></tr>
<tr class="memdesc:a7aa8aa71f33a1a7c56f77864afb4641e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform the command finished signal.  <br /></td></tr>
<tr class="separator:a7aa8aa71f33a1a7c56f77864afb4641e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adea94a64fc961c2aa25be87907844586"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_debugger_commands_8h.html#adea94a64fc961c2aa25be87907844586">DebuggerCommandSendMessage</a> (<a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a220681277ea06cfae1cec6d8cd06d3f9">PDEBUGGER_SEND_USERMODE_MESSAGES_TO_DEBUGGER</a> DebuggerSendUsermodeMessageRequest)</td></tr>
<tr class="memdesc:adea94a64fc961c2aa25be87907844586"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send the user-mode buffer to debugger.  <br /></td></tr>
<tr class="separator:adea94a64fc961c2aa25be87907844586"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae149f6dd099f7dc3f64584a3b27f7d56"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_debugger_commands_8h.html#ae149f6dd099f7dc3f64584a3b27f7d56">DebuggerCommandSendGeneralBufferToDebugger</a> (<a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#ad97915c6241a0c1642aa62839e661aa1">PDEBUGGEE_SEND_GENERAL_PACKET_FROM_DEBUGGEE_TO_DEBUGGER</a> DebuggeeBufferRequest)</td></tr>
<tr class="memdesc:ae149f6dd099f7dc3f64584a3b27f7d56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send general buffers from the debuggee to the debugger.  <br /></td></tr>
<tr class="separator:ae149f6dd099f7dc3f64584a3b27f7d56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62dfa3017c983808ae647ec03252a0fe"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_debugger_commands_8h.html#a62dfa3017c983808ae647ec03252a0fe">DebuggerCommandReservePreallocatedPools</a> (<a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a5dcf26594841b272af7f485934e92d24">PDEBUGGER_PREALLOC_COMMAND</a> PreallocRequest)</td></tr>
<tr class="memdesc:a62dfa3017c983808ae647ec03252a0fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reserve and allocate pre-allocated buffers.  <br /></td></tr>
<tr class="separator:a62dfa3017c983808ae647ec03252a0fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Commands for debugger. </p>
<dl class="section author"><dt>Author</dt><dd>Sina Karvandi (<a href="#" onclick="location.href='mai'+'lto:'+'sin'+'a@'+'hyp'+'er'+'dbg'+'.o'+'rg'; return false;">sina@<span class="obfuscator">.nosp@m.</span>hype<span class="obfuscator">.nosp@m.</span>rdbg.<span class="obfuscator">.nosp@m.</span>org</a>)</dd></dl>
<p>This file contains general commands that are implemented for debugger These command mostly start without "!" or "."</p>
<dl class="section version"><dt>Version</dt><dd>0.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2020-04-10</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>This project is released under the GNU Public License v3. </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="af777c50999a33ad8c4555984d41c5ae5" name="af777c50999a33ad8c4555984d41c5ae5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af777c50999a33ad8c4555984d41c5ae5">&#9670;&#160;</a></span>DebuggerCommandEditMemory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS DebuggerCommandEditMemory </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#aa1c158df9e1481468f1dfe46ba0bac86">PDEBUGGER_EDIT_MEMORY</a>&#160;</td>
          <td class="paramname"><em>EditMemRequest</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Edit physical and virtual memory. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">EditMemRequest</td><td>edit memory request </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  305</span>{</div>
<div class="line"><span class="lineno">  306</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>   LengthOfEachChunk  = 0;</div>
<div class="line"><span class="lineno">  307</span>    PVOID    DestinationAddress = 0;</div>
<div class="line"><span class="lineno">  308</span>    PVOID    SourceAddress      = 0;</div>
<div class="line"><span class="lineno">  309</span>    <a class="code hl_struct" href="struct___c_r3___t_y_p_e.html">CR3_TYPE</a> CurrentProcessCr3;</div>
<div class="line"><span class="lineno">  310</span> </div>
<div class="line"><span class="lineno">  311</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  312</span>    <span class="comment">// set chunk size in each modification</span></div>
<div class="line"><span class="lineno">  313</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  314</span>    <span class="keywordflow">if</span> (EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#adc961c153906e8babc1e6460f9f733ef">ByteSize</a> == <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a7b0872a1b7b5ad3d7dc89daa430f4cd0ab4407406c5406a1b8314ceb0dd88c32e">EDIT_BYTE</a>)</div>
<div class="line"><span class="lineno">  315</span>    {</div>
<div class="line"><span class="lineno">  316</span>        LengthOfEachChunk = 1;</div>
<div class="line"><span class="lineno">  317</span>    }</div>
<div class="line"><span class="lineno">  318</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#adc961c153906e8babc1e6460f9f733ef">ByteSize</a> == <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a7b0872a1b7b5ad3d7dc89daa430f4cd0a9093b36693bfb1534f1baf9cfcbe5139">EDIT_DWORD</a>)</div>
<div class="line"><span class="lineno">  319</span>    {</div>
<div class="line"><span class="lineno">  320</span>        LengthOfEachChunk = 4;</div>
<div class="line"><span class="lineno">  321</span>    }</div>
<div class="line"><span class="lineno">  322</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#adc961c153906e8babc1e6460f9f733ef">ByteSize</a> == <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a7b0872a1b7b5ad3d7dc89daa430f4cd0a155392ba36a9e4b809d61a58ff0664ae">EDIT_QWORD</a>)</div>
<div class="line"><span class="lineno">  323</span>    {</div>
<div class="line"><span class="lineno">  324</span>        LengthOfEachChunk = 8;</div>
<div class="line"><span class="lineno">  325</span>    }</div>
<div class="line"><span class="lineno">  326</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  327</span>    {</div>
<div class="line"><span class="lineno">  328</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  329</span>        <span class="comment">// Invalid parameter</span></div>
<div class="line"><span class="lineno">  330</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  331</span>        EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a2781f698e302a08136de0e19fb6766af">Result</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#aeb2f51deac220ae86f8129a9abe6705f">DEBUGGER_ERROR_EDIT_MEMORY_STATUS_INVALID_PARAMETER</a>;</div>
<div class="line"><span class="lineno">  332</span>        <span class="keywordflow">return</span> STATUS_UNSUCCESSFUL;</div>
<div class="line"><span class="lineno">  333</span>    }</div>
<div class="line"><span class="lineno">  334</span> </div>
<div class="line"><span class="lineno">  335</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  336</span>    <span class="comment">// Check if address is valid or not valid (virtual address)</span></div>
<div class="line"><span class="lineno">  337</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  338</span>    <span class="keywordflow">if</span> (EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a60cc85e8d33b351947da0ad1273abcb9">MemoryType</a> == <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a15d4e6c3df2a35e0e0a6ee9b461b5dc5af40a8625548287bf1f0c9a6c72c8a0b9">EDIT_VIRTUAL_MEMORY</a>)</div>
<div class="line"><span class="lineno">  339</span>    {</div>
<div class="line"><span class="lineno">  340</span>        <span class="keywordflow">if</span> (EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a91db707d5f4b15fa4de9006982cdbf50">ProcessId</a> == PsGetCurrentProcessId() &amp;&amp; <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a9c177c471eaf6be292a94d8112fa3f36">VirtualAddressToPhysicalAddress</a>(EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a474f6f7143bd243ef8b0d1d9fd55932e">Address</a>) == 0)</div>
<div class="line"><span class="lineno">  341</span>        {</div>
<div class="line"><span class="lineno">  342</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  343</span>            <span class="comment">// It&#39;s an invalid address in current process</span></div>
<div class="line"><span class="lineno">  344</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  345</span>            EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a2781f698e302a08136de0e19fb6766af">Result</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#a68e4d375f85d62fc6169b228d0cb346a">DEBUGGER_ERROR_EDIT_MEMORY_STATUS_INVALID_ADDRESS_BASED_ON_CURRENT_PROCESS</a>;</div>
<div class="line"><span class="lineno">  346</span>            <span class="keywordflow">return</span> STATUS_UNSUCCESSFUL;</div>
<div class="line"><span class="lineno">  347</span>        }</div>
<div class="line"><span class="lineno">  348</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#adb0d4df682039d23559162b1aa2bd1a2">VirtualAddressToPhysicalAddressByProcessId</a>(EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a474f6f7143bd243ef8b0d1d9fd55932e">Address</a>, EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a91db707d5f4b15fa4de9006982cdbf50">ProcessId</a>) == 0)</div>
<div class="line"><span class="lineno">  349</span>        {</div>
<div class="line"><span class="lineno">  350</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  351</span>            <span class="comment">// It&#39;s an invalid address in another process</span></div>
<div class="line"><span class="lineno">  352</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  353</span>            EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a2781f698e302a08136de0e19fb6766af">Result</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#a3dfaaa0714009886429c605e3cc82e9d">DEBUGGER_ERROR_EDIT_MEMORY_STATUS_INVALID_ADDRESS_BASED_ON_OTHER_PROCESS</a>;</div>
<div class="line"><span class="lineno">  354</span>            <span class="keywordflow">return</span> STATUS_UNSUCCESSFUL;</div>
<div class="line"><span class="lineno">  355</span>        }</div>
<div class="line"><span class="lineno">  356</span> </div>
<div class="line"><span class="lineno">  357</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  358</span>        <span class="comment">// Edit the memory</span></div>
<div class="line"><span class="lineno">  359</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  360</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a7b8bede895701ebb3be2a5bb150c0a8f">CountOf64Chunks</a>; i++)</div>
<div class="line"><span class="lineno">  361</span>        {</div>
<div class="line"><span class="lineno">  362</span>            DestinationAddress = (<a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a474f6f7143bd243ef8b0d1d9fd55932e">Address</a> + (i * LengthOfEachChunk);</div>
<div class="line"><span class="lineno">  363</span>            SourceAddress      = (<a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)EditMemRequest + <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a8b40425317ba4b65485b3092c972187d">SIZEOF_DEBUGGER_EDIT_MEMORY</a> + (i * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>));</div>
<div class="line"><span class="lineno">  364</span> </div>
<div class="line"><span class="lineno">  365</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  366</span>            <span class="comment">// Instead of directly accessing the memory we use the MemoryMapperWriteMemorySafe</span></div>
<div class="line"><span class="lineno">  367</span>            <span class="comment">// It is because the target page might be read-only so we can make it writable</span></div>
<div class="line"><span class="lineno">  368</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  369</span>            <span class="comment">// RtlCopyBytes(DestinationAddress, SourceAddress, LengthOfEachChunk);</span></div>
<div class="line"><span class="lineno">  370</span>            <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a9b7066d65f4a2b794d50b0f855f2bf25">MemoryMapperWriteMemoryUnsafe</a>(DestinationAddress, SourceAddress, LengthOfEachChunk, EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a91db707d5f4b15fa4de9006982cdbf50">ProcessId</a>);</div>
<div class="line"><span class="lineno">  371</span>        }</div>
<div class="line"><span class="lineno">  372</span>    }</div>
<div class="line"><span class="lineno">  373</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a60cc85e8d33b351947da0ad1273abcb9">MemoryType</a> == <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a15d4e6c3df2a35e0e0a6ee9b461b5dc5a37551226140bb71a3c3767d0f333a4de">EDIT_PHYSICAL_MEMORY</a>)</div>
<div class="line"><span class="lineno">  374</span>    {</div>
<div class="line"><span class="lineno">  375</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  376</span>        <span class="comment">// Edit the physical memory</span></div>
<div class="line"><span class="lineno">  377</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  378</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a7b8bede895701ebb3be2a5bb150c0a8f">CountOf64Chunks</a>; i++)</div>
<div class="line"><span class="lineno">  379</span>        {</div>
<div class="line"><span class="lineno">  380</span>            DestinationAddress = (<a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a474f6f7143bd243ef8b0d1d9fd55932e">Address</a> + (i * LengthOfEachChunk);</div>
<div class="line"><span class="lineno">  381</span>            SourceAddress      = (<a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)EditMemRequest + <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a8b40425317ba4b65485b3092c972187d">SIZEOF_DEBUGGER_EDIT_MEMORY</a> + (i * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>));</div>
<div class="line"><span class="lineno">  382</span> </div>
<div class="line"><span class="lineno">  383</span>            <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#aa59828a1cda23251be1cd6c1d10f1b94">MemoryMapperWriteMemorySafeByPhysicalAddress</a>(DestinationAddress, SourceAddress, LengthOfEachChunk);</div>
<div class="line"><span class="lineno">  384</span>        }</div>
<div class="line"><span class="lineno">  385</span>    }</div>
<div class="line"><span class="lineno">  386</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  387</span>    {</div>
<div class="line"><span class="lineno">  388</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  389</span>        <span class="comment">// Invalid parameter</span></div>
<div class="line"><span class="lineno">  390</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  391</span>        EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a2781f698e302a08136de0e19fb6766af">Result</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#aeb2f51deac220ae86f8129a9abe6705f">DEBUGGER_ERROR_EDIT_MEMORY_STATUS_INVALID_PARAMETER</a>;</div>
<div class="line"><span class="lineno">  392</span>        <span class="keywordflow">return</span> STATUS_UNSUCCESSFUL;</div>
<div class="line"><span class="lineno">  393</span>    }</div>
<div class="line"><span class="lineno">  394</span> </div>
<div class="line"><span class="lineno">  395</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  396</span>    <span class="comment">// Set the resutls</span></div>
<div class="line"><span class="lineno">  397</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  398</span>    EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a2781f698e302a08136de0e19fb6766af">Result</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#aed656c58434eecb2d7e8c10e93aecff4">DEBUGGER_OPERATION_WAS_SUCCESSFUL</a>;</div>
<div class="line"><span class="lineno">  399</span> </div>
<div class="line"><span class="lineno">  400</span>    <span class="keywordflow">return</span> STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  401</span>}</div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h_html_aae17ebb9ef7279d026817fb22f8aebe9"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></div><div class="ttdeci">unsigned __int64 UINT64</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:19</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h_html_ae1e6edbbc26d6fbc71a90190d0266018"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></div><div class="ttdeci">unsigned int UINT32</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:46</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h_html_a3dfaaa0714009886429c605e3cc82e9d"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#a3dfaaa0714009886429c605e3cc82e9d">DEBUGGER_ERROR_EDIT_MEMORY_STATUS_INVALID_ADDRESS_BASED_ON_OTHER_PROCESS</a></div><div class="ttdeci">#define DEBUGGER_ERROR_EDIT_MEMORY_STATUS_INVALID_ADDRESS_BASED_ON_OTHER_PROCESS</div><div class="ttdoc">error, an invalid address is specified based on anotehr process's cr3 in !e* or e* commands</div><div class="ttdef"><b>Definition:</b> ErrorCodes.h:114</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h_html_a68e4d375f85d62fc6169b228d0cb346a"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#a68e4d375f85d62fc6169b228d0cb346a">DEBUGGER_ERROR_EDIT_MEMORY_STATUS_INVALID_ADDRESS_BASED_ON_CURRENT_PROCESS</a></div><div class="ttdeci">#define DEBUGGER_ERROR_EDIT_MEMORY_STATUS_INVALID_ADDRESS_BASED_ON_CURRENT_PROCESS</div><div class="ttdoc">error, an invalid address is specified based on current cr3 in !e* or e* commands</div><div class="ttdef"><b>Definition:</b> ErrorCodes.h:106</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h_html_aeb2f51deac220ae86f8129a9abe6705f"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#aeb2f51deac220ae86f8129a9abe6705f">DEBUGGER_ERROR_EDIT_MEMORY_STATUS_INVALID_PARAMETER</a></div><div class="ttdeci">#define DEBUGGER_ERROR_EDIT_MEMORY_STATUS_INVALID_PARAMETER</div><div class="ttdoc">error, invalid parameters in !e* e* commands</div><div class="ttdef"><b>Definition:</b> ErrorCodes.h:99</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h_html_aed656c58434eecb2d7e8c10e93aecff4"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#aed656c58434eecb2d7e8c10e93aecff4">DEBUGGER_OPERATION_WAS_SUCCESSFUL</a></div><div class="ttdeci">#define DEBUGGER_OPERATION_WAS_SUCCESSFUL</div><div class="ttdoc">General value to indicate that the operation or request was successful.</div><div class="ttdef"><b>Definition:</b> ErrorCodes.h:23</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h_html_a15d4e6c3df2a35e0e0a6ee9b461b5dc5a37551226140bb71a3c3767d0f333a4de"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a15d4e6c3df2a35e0e0a6ee9b461b5dc5a37551226140bb71a3c3767d0f333a4de">EDIT_PHYSICAL_MEMORY</a></div><div class="ttdeci">@ EDIT_PHYSICAL_MEMORY</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:413</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h_html_a15d4e6c3df2a35e0e0a6ee9b461b5dc5af40a8625548287bf1f0c9a6c72c8a0b9"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a15d4e6c3df2a35e0e0a6ee9b461b5dc5af40a8625548287bf1f0c9a6c72c8a0b9">EDIT_VIRTUAL_MEMORY</a></div><div class="ttdeci">@ EDIT_VIRTUAL_MEMORY</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:414</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h_html_a7b0872a1b7b5ad3d7dc89daa430f4cd0a155392ba36a9e4b809d61a58ff0664ae"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a7b0872a1b7b5ad3d7dc89daa430f4cd0a155392ba36a9e4b809d61a58ff0664ae">EDIT_QWORD</a></div><div class="ttdeci">@ EDIT_QWORD</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:425</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h_html_a7b0872a1b7b5ad3d7dc89daa430f4cd0a9093b36693bfb1534f1baf9cfcbe5139"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a7b0872a1b7b5ad3d7dc89daa430f4cd0a9093b36693bfb1534f1baf9cfcbe5139">EDIT_DWORD</a></div><div class="ttdeci">@ EDIT_DWORD</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:424</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h_html_a7b0872a1b7b5ad3d7dc89daa430f4cd0ab4407406c5406a1b8314ceb0dd88c32e"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a7b0872a1b7b5ad3d7dc89daa430f4cd0ab4407406c5406a1b8314ceb0dd88c32e">EDIT_BYTE</a></div><div class="ttdeci">@ EDIT_BYTE</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:423</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h_html_a8b40425317ba4b65485b3092c972187d"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a8b40425317ba4b65485b3092c972187d">SIZEOF_DEBUGGER_EDIT_MEMORY</a></div><div class="ttdeci">#define SIZEOF_DEBUGGER_EDIT_MEMORY</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:405</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_a9b7066d65f4a2b794d50b0f855f2bf25"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a9b7066d65f4a2b794d50b0f855f2bf25">MemoryMapperWriteMemoryUnsafe</a></div><div class="ttdeci">IMPORT_EXPORT_VMM BOOLEAN MemoryMapperWriteMemoryUnsafe(_Inout_ UINT64 Destination, _In_ PVOID Source, _In_ SIZE_T SizeToWrite, _In_ UINT32 TargetProcessId)</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_a9c177c471eaf6be292a94d8112fa3f36"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a9c177c471eaf6be292a94d8112fa3f36">VirtualAddressToPhysicalAddress</a></div><div class="ttdeci">IMPORT_EXPORT_VMM UINT64 VirtualAddressToPhysicalAddress(_In_ PVOID VirtualAddress)</div><div class="ttdoc">Converts Virtual Address to Physical Address.</div><div class="ttdef"><b>Definition:</b> Conversion.c:156</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_aa59828a1cda23251be1cd6c1d10f1b94"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#aa59828a1cda23251be1cd6c1d10f1b94">MemoryMapperWriteMemorySafeByPhysicalAddress</a></div><div class="ttdeci">IMPORT_EXPORT_VMM BOOLEAN MemoryMapperWriteMemorySafeByPhysicalAddress(_Inout_ UINT64 DestinationPa, _In_ UINT64 Source, _In_ SIZE_T SizeToWrite)</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_adb0d4df682039d23559162b1aa2bd1a2"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#adb0d4df682039d23559162b1aa2bd1a2">VirtualAddressToPhysicalAddressByProcessId</a></div><div class="ttdeci">IMPORT_EXPORT_VMM UINT64 VirtualAddressToPhysicalAddressByProcessId(_In_ PVOID VirtualAddress, _In_ UINT32 ProcessId)</div></div>
<div class="ttc" id="astruct___c_r3___t_y_p_e_html"><div class="ttname"><a href="struct___c_r3___t_y_p_e.html">_CR3_TYPE</a></div><div class="ttdoc">CR3 Structure.</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:136</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y_html_a2781f698e302a08136de0e19fb6766af"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a2781f698e302a08136de0e19fb6766af">_DEBUGGER_EDIT_MEMORY::Result</a></div><div class="ttdeci">UINT32 Result</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:434</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y_html_a474f6f7143bd243ef8b0d1d9fd55932e"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a474f6f7143bd243ef8b0d1d9fd55932e">_DEBUGGER_EDIT_MEMORY::Address</a></div><div class="ttdeci">UINT64 Address</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:435</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y_html_a60cc85e8d33b351947da0ad1273abcb9"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a60cc85e8d33b351947da0ad1273abcb9">_DEBUGGER_EDIT_MEMORY::MemoryType</a></div><div class="ttdeci">DEBUGGER_EDIT_MEMORY_TYPE MemoryType</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:437</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y_html_a7b8bede895701ebb3be2a5bb150c0a8f"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a7b8bede895701ebb3be2a5bb150c0a8f">_DEBUGGER_EDIT_MEMORY::CountOf64Chunks</a></div><div class="ttdeci">UINT32 CountOf64Chunks</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:439</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y_html_a91db707d5f4b15fa4de9006982cdbf50"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a91db707d5f4b15fa4de9006982cdbf50">_DEBUGGER_EDIT_MEMORY::ProcessId</a></div><div class="ttdeci">UINT32 ProcessId</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:436</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y_html_adc961c153906e8babc1e6460f9f733ef"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#adc961c153906e8babc1e6460f9f733ef">_DEBUGGER_EDIT_MEMORY::ByteSize</a></div><div class="ttdeci">DEBUGGER_EDIT_MEMORY_BYTE_SIZE ByteSize</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:438</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0af7ab7231ae69429262b4061e93ccfe" name="a0af7ab7231ae69429262b4061e93ccfe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0af7ab7231ae69429262b4061e93ccfe">&#9670;&#160;</a></span>DebuggerCommandEditMemoryVmxRoot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> DebuggerCommandEditMemoryVmxRoot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#aa1c158df9e1481468f1dfe46ba0bac86">PDEBUGGER_EDIT_MEMORY</a>&#160;</td>
          <td class="paramname"><em>EditMemRequest</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Edit physical and virtual memory on vmxroot mode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">EditMemRequest</td><td>edit memory request </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  411</span>{</div>
<div class="line"><span class="lineno">  412</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>   LengthOfEachChunk  = 0;</div>
<div class="line"><span class="lineno">  413</span>    PVOID    DestinationAddress = 0;</div>
<div class="line"><span class="lineno">  414</span>    PVOID    SourceAddress      = 0;</div>
<div class="line"><span class="lineno">  415</span>    <a class="code hl_struct" href="struct___c_r3___t_y_p_e.html">CR3_TYPE</a> CurrentProcessCr3;</div>
<div class="line"><span class="lineno">  416</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  417</span>    <span class="comment">// THIS FUNCTION IS SAFE TO BE CALLED FROM VMX ROOT</span></div>
<div class="line"><span class="lineno">  418</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  419</span> </div>
<div class="line"><span class="lineno">  420</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  421</span>    <span class="comment">// set chunk size in each modification</span></div>
<div class="line"><span class="lineno">  422</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  423</span>    <span class="keywordflow">if</span> (EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#adc961c153906e8babc1e6460f9f733ef">ByteSize</a> == <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a7b0872a1b7b5ad3d7dc89daa430f4cd0ab4407406c5406a1b8314ceb0dd88c32e">EDIT_BYTE</a>)</div>
<div class="line"><span class="lineno">  424</span>    {</div>
<div class="line"><span class="lineno">  425</span>        LengthOfEachChunk = 1;</div>
<div class="line"><span class="lineno">  426</span>    }</div>
<div class="line"><span class="lineno">  427</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#adc961c153906e8babc1e6460f9f733ef">ByteSize</a> == <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a7b0872a1b7b5ad3d7dc89daa430f4cd0a9093b36693bfb1534f1baf9cfcbe5139">EDIT_DWORD</a>)</div>
<div class="line"><span class="lineno">  428</span>    {</div>
<div class="line"><span class="lineno">  429</span>        LengthOfEachChunk = 4;</div>
<div class="line"><span class="lineno">  430</span>    }</div>
<div class="line"><span class="lineno">  431</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#adc961c153906e8babc1e6460f9f733ef">ByteSize</a> == <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a7b0872a1b7b5ad3d7dc89daa430f4cd0a155392ba36a9e4b809d61a58ff0664ae">EDIT_QWORD</a>)</div>
<div class="line"><span class="lineno">  432</span>    {</div>
<div class="line"><span class="lineno">  433</span>        LengthOfEachChunk = 8;</div>
<div class="line"><span class="lineno">  434</span>    }</div>
<div class="line"><span class="lineno">  435</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  436</span>    {</div>
<div class="line"><span class="lineno">  437</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  438</span>        <span class="comment">// Invalid parameter</span></div>
<div class="line"><span class="lineno">  439</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  440</span>        EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a2781f698e302a08136de0e19fb6766af">Result</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#aeb2f51deac220ae86f8129a9abe6705f">DEBUGGER_ERROR_EDIT_MEMORY_STATUS_INVALID_PARAMETER</a>;</div>
<div class="line"><span class="lineno">  441</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  442</span>    }</div>
<div class="line"><span class="lineno">  443</span> </div>
<div class="line"><span class="lineno">  444</span>    <span class="keywordflow">if</span> (EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a60cc85e8d33b351947da0ad1273abcb9">MemoryType</a> == <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a15d4e6c3df2a35e0e0a6ee9b461b5dc5af40a8625548287bf1f0c9a6c72c8a0b9">EDIT_VIRTUAL_MEMORY</a>)</div>
<div class="line"><span class="lineno">  445</span>    {</div>
<div class="line"><span class="lineno">  446</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  447</span>        <span class="comment">// Check whether the virtual memory is available in the current</span></div>
<div class="line"><span class="lineno">  448</span>        <span class="comment">// memory layout and also is present in the RAM</span></div>
<div class="line"><span class="lineno">  449</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  450</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a240789bd1c3cf023cd1403d4ea32bb19">CheckAccessValidityAndSafety</a>(EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a474f6f7143bd243ef8b0d1d9fd55932e">Address</a>,</div>
<div class="line"><span class="lineno">  451</span>                                          EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#adc961c153906e8babc1e6460f9f733ef">ByteSize</a> * EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a7b8bede895701ebb3be2a5bb150c0a8f">CountOf64Chunks</a>))</div>
<div class="line"><span class="lineno">  452</span>        {</div>
<div class="line"><span class="lineno">  453</span>            EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a854b5ad7d425f115dd559d28a400c8f5">KernelStatus</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#ac1b8dbae6748b88abe05844e42c29952">DEBUGGER_ERROR_INVALID_ADDRESS</a>;</div>
<div class="line"><span class="lineno">  454</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  455</span>        }</div>
<div class="line"><span class="lineno">  456</span> </div>
<div class="line"><span class="lineno">  457</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  458</span>        <span class="comment">// Edit the memory</span></div>
<div class="line"><span class="lineno">  459</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  460</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a7b8bede895701ebb3be2a5bb150c0a8f">CountOf64Chunks</a>; i++)</div>
<div class="line"><span class="lineno">  461</span>        {</div>
<div class="line"><span class="lineno">  462</span>            DestinationAddress = (<a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a474f6f7143bd243ef8b0d1d9fd55932e">Address</a> + (i * LengthOfEachChunk);</div>
<div class="line"><span class="lineno">  463</span>            SourceAddress      = (<a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)EditMemRequest + <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a8b40425317ba4b65485b3092c972187d">SIZEOF_DEBUGGER_EDIT_MEMORY</a> + (i * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>));</div>
<div class="line"><span class="lineno">  464</span> </div>
<div class="line"><span class="lineno">  465</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  466</span>            <span class="comment">// Instead of directly accessing the memory we use the MemoryMapperWriteMemorySafeOnTargetProcess</span></div>
<div class="line"><span class="lineno">  467</span>            <span class="comment">// It is because the target page might be read-only so we can make it writable</span></div>
<div class="line"><span class="lineno">  468</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  469</span> </div>
<div class="line"><span class="lineno">  470</span>            <span class="comment">// RtlCopyBytes(DestinationAddress, SourceAddress, LengthOfEachChunk);</span></div>
<div class="line"><span class="lineno">  471</span>            <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a5720c98f26c84e14c67e264ea5b65c9a">MemoryMapperWriteMemorySafeOnTargetProcess</a>(DestinationAddress, SourceAddress, LengthOfEachChunk);</div>
<div class="line"><span class="lineno">  472</span>        }</div>
<div class="line"><span class="lineno">  473</span>    }</div>
<div class="line"><span class="lineno">  474</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a60cc85e8d33b351947da0ad1273abcb9">MemoryType</a> == <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a15d4e6c3df2a35e0e0a6ee9b461b5dc5a37551226140bb71a3c3767d0f333a4de">EDIT_PHYSICAL_MEMORY</a>)</div>
<div class="line"><span class="lineno">  475</span>    {</div>
<div class="line"><span class="lineno">  476</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  477</span>        <span class="comment">// Edit the physical memory</span></div>
<div class="line"><span class="lineno">  478</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  479</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a7b8bede895701ebb3be2a5bb150c0a8f">CountOf64Chunks</a>; i++)</div>
<div class="line"><span class="lineno">  480</span>        {</div>
<div class="line"><span class="lineno">  481</span>            DestinationAddress = (<a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a474f6f7143bd243ef8b0d1d9fd55932e">Address</a> + (i * LengthOfEachChunk);</div>
<div class="line"><span class="lineno">  482</span>            SourceAddress      = (<a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)EditMemRequest + <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a8b40425317ba4b65485b3092c972187d">SIZEOF_DEBUGGER_EDIT_MEMORY</a> + (i * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>));</div>
<div class="line"><span class="lineno">  483</span> </div>
<div class="line"><span class="lineno">  484</span>            <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#aa59828a1cda23251be1cd6c1d10f1b94">MemoryMapperWriteMemorySafeByPhysicalAddress</a>(DestinationAddress, SourceAddress, LengthOfEachChunk);</div>
<div class="line"><span class="lineno">  485</span>        }</div>
<div class="line"><span class="lineno">  486</span>    }</div>
<div class="line"><span class="lineno">  487</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  488</span>    {</div>
<div class="line"><span class="lineno">  489</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  490</span>        <span class="comment">// Invalid parameter</span></div>
<div class="line"><span class="lineno">  491</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  492</span>        EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a2781f698e302a08136de0e19fb6766af">Result</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#aeb2f51deac220ae86f8129a9abe6705f">DEBUGGER_ERROR_EDIT_MEMORY_STATUS_INVALID_PARAMETER</a>;</div>
<div class="line"><span class="lineno">  493</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  494</span>    }</div>
<div class="line"><span class="lineno">  495</span> </div>
<div class="line"><span class="lineno">  496</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  497</span>    <span class="comment">// Set the resutls</span></div>
<div class="line"><span class="lineno">  498</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  499</span>    EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a2781f698e302a08136de0e19fb6766af">Result</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#aed656c58434eecb2d7e8c10e93aecff4">DEBUGGER_OPERATION_WAS_SUCCESSFUL</a>;</div>
<div class="line"><span class="lineno">  500</span> </div>
<div class="line"><span class="lineno">  501</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  502</span>}</div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:50</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:49</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h_html_ac1b8dbae6748b88abe05844e42c29952"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#ac1b8dbae6748b88abe05844e42c29952">DEBUGGER_ERROR_INVALID_ADDRESS</a></div><div class="ttdeci">#define DEBUGGER_ERROR_INVALID_ADDRESS</div><div class="ttdoc">error, invalid address specified for debugger</div><div class="ttdef"><b>Definition:</b> ErrorCodes.h:63</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_a240789bd1c3cf023cd1403d4ea32bb19"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a240789bd1c3cf023cd1403d4ea32bb19">CheckAccessValidityAndSafety</a></div><div class="ttdeci">IMPORT_EXPORT_VMM BOOLEAN CheckAccessValidityAndSafety(UINT64 TargetAddress, UINT32 Size)</div><div class="ttdoc">Check the safety to access the memory.</div><div class="ttdef"><b>Definition:</b> common.cpp:1038</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_a5720c98f26c84e14c67e264ea5b65c9a"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a5720c98f26c84e14c67e264ea5b65c9a">MemoryMapperWriteMemorySafeOnTargetProcess</a></div><div class="ttdeci">IMPORT_EXPORT_VMM BOOLEAN MemoryMapperWriteMemorySafeOnTargetProcess(_Inout_ UINT64 Destination, _In_ PVOID Source, _In_ SIZE_T Size)</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y_html_a854b5ad7d425f115dd559d28a400c8f5"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a854b5ad7d425f115dd559d28a400c8f5">_DEBUGGER_EDIT_MEMORY::KernelStatus</a></div><div class="ttdeci">UINT32 KernelStatus</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:441</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aeaad6ca3d40207e5acacf96ae173aefe" name="aeaad6ca3d40207e5acacf96ae173aefe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeaad6ca3d40207e5acacf96ae173aefe">&#9670;&#160;</a></span>DebuggerCommandFlush()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS DebuggerCommandFlush </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#ae01f58601a1fe6b667786f7323256da7">PDEBUGGER_FLUSH_LOGGING_BUFFERS</a>&#160;</td>
          <td class="paramname"><em>DebuggerFlushBuffersRequest</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform the flush requests to vmx-root and vmx non-root buffers. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">DebuggerFlushBuffersRequest</td><td>Request to flush the buffers </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1088</span>{</div>
<div class="line"><span class="lineno"> 1089</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1090</span>    <span class="comment">// We try to flush buffers for both vmx-root and regular kernel buffer</span></div>
<div class="line"><span class="lineno"> 1091</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1092</span>    DebuggerFlushBuffersRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___f_l_u_s_h___l_o_g_g_i_n_g___b_u_f_f_e_r_s.html#a09e09b7c4094d0118e60286632bd832b">CountOfMessagesThatSetAsReadFromVmxRoot</a>    = <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_hyper_log_imports_8h.html#af6bee52ac15cdac51ead480b856c1139">LogMarkAllAsRead</a>(<a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><span class="lineno"> 1093</span>    DebuggerFlushBuffersRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___f_l_u_s_h___l_o_g_g_i_n_g___b_u_f_f_e_r_s.html#a4bbc1ed12ba1d1c451f6fda086ea4af2">CountOfMessagesThatSetAsReadFromVmxNonRoot</a> = <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_hyper_log_imports_8h.html#af6bee52ac15cdac51ead480b856c1139">LogMarkAllAsRead</a>(<a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><span class="lineno"> 1094</span>    DebuggerFlushBuffersRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___f_l_u_s_h___l_o_g_g_i_n_g___b_u_f_f_e_r_s.html#a58d48d4a871935399b264dfd8c70331c">KernelStatus</a>                               = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#aed656c58434eecb2d7e8c10e93aecff4">DEBUGGER_OPERATION_WAS_SUCCESSFUL</a>;</div>
<div class="line"><span class="lineno"> 1095</span> </div>
<div class="line"><span class="lineno"> 1096</span>    <span class="keywordflow">return</span> STATUS_SUCCESS;</div>
<div class="line"><span class="lineno"> 1097</span>}</div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_hyper_log_imports_8h_html_af6bee52ac15cdac51ead480b856c1139"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_hyper_log_imports_8h.html#af6bee52ac15cdac51ead480b856c1139">LogMarkAllAsRead</a></div><div class="ttdeci">IMPORT_EXPORT_HYPERLOG UINT32 LogMarkAllAsRead(BOOLEAN IsVmxRoot)</div><div class="ttdoc">Mark all buffers as read.</div><div class="ttdef"><b>Definition:</b> Logging.c:448</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___f_l_u_s_h___l_o_g_g_i_n_g___b_u_f_f_e_r_s_html_a09e09b7c4094d0118e60286632bd832b"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___f_l_u_s_h___l_o_g_g_i_n_g___b_u_f_f_e_r_s.html#a09e09b7c4094d0118e60286632bd832b">_DEBUGGER_FLUSH_LOGGING_BUFFERS::CountOfMessagesThatSetAsReadFromVmxRoot</a></div><div class="ttdeci">UINT32 CountOfMessagesThatSetAsReadFromVmxRoot</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:240</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___f_l_u_s_h___l_o_g_g_i_n_g___b_u_f_f_e_r_s_html_a4bbc1ed12ba1d1c451f6fda086ea4af2"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___f_l_u_s_h___l_o_g_g_i_n_g___b_u_f_f_e_r_s.html#a4bbc1ed12ba1d1c451f6fda086ea4af2">_DEBUGGER_FLUSH_LOGGING_BUFFERS::CountOfMessagesThatSetAsReadFromVmxNonRoot</a></div><div class="ttdeci">UINT32 CountOfMessagesThatSetAsReadFromVmxNonRoot</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:241</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___f_l_u_s_h___l_o_g_g_i_n_g___b_u_f_f_e_r_s_html_a58d48d4a871935399b264dfd8c70331c"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___f_l_u_s_h___l_o_g_g_i_n_g___b_u_f_f_e_r_s.html#a58d48d4a871935399b264dfd8c70331c">_DEBUGGER_FLUSH_LOGGING_BUFFERS::KernelStatus</a></div><div class="ttdeci">UINT32 KernelStatus</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:239</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab8bb200983c48761d01ca416f16ef580" name="ab8bb200983c48761d01ca416f16ef580"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8bb200983c48761d01ca416f16ef580">&#9670;&#160;</a></span>DebuggerCommandReadMemory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> DebuggerCommandReadMemory </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#aa20edf6a6ccb273f5b16819964b171ac">PDEBUGGER_READ_MEMORY</a>&#160;</td>
          <td class="paramname"><em>ReadMemRequest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID&#160;</td>
          <td class="paramname"><em>UserBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PSIZE_T&#160;</td>
          <td class="paramname"><em>ReturnSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read memory for different commands. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ReadMemRequest</td><td>request structure for reading memory </td></tr>
    <tr><td class="paramname">UserBuffer</td><td>user buffer to copy the memory </td></tr>
    <tr><td class="paramname">ReturnSize</td><td>size that should be returned to user mode buffers</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   26</span>{</div>
<div class="line"><span class="lineno">   27</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>                    Pid;</div>
<div class="line"><span class="lineno">   28</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>                    Size;</div>
<div class="line"><span class="lineno">   29</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>                    <a class="code hl_variable" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>;</div>
<div class="line"><span class="lineno">   30</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a6f202a103e130d55c5ed5b55d5511cab">DEBUGGER_READ_MEMORY_TYPE</a> MemType;</div>
<div class="line"><span class="lineno">   31</span> </div>
<div class="line"><span class="lineno">   32</span>    Pid     = ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a685a67cc05100b749ea071e9d9f7ff87">Pid</a>;</div>
<div class="line"><span class="lineno">   33</span>    Size    = ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a215597b2a3418b4413fe5286b1d1c685">Size</a>;</div>
<div class="line"><span class="lineno">   34</span>    <a class="code hl_variable" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a> = ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#ae8a91a39973addb850d6fce45eba6b15">Address</a>;</div>
<div class="line"><span class="lineno">   35</span>    MemType = ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#ae6709d92b51f2c0ec9417a778b2cfa9f">MemoryType</a>;</div>
<div class="line"><span class="lineno">   36</span> </div>
<div class="line"><span class="lineno">   37</span>    <span class="keywordflow">if</span> (Size &amp;&amp; <a class="code hl_variable" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a> != NULL)</div>
<div class="line"><span class="lineno">   38</span>    {</div>
<div class="line"><span class="lineno">   39</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a611301ec5042b5afe767a37562dbbf27">MemoryManagerReadProcessMemoryNormal</a>((HANDLE)Pid, <a class="code hl_variable" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>, MemType, (PVOID)UserBuffer, Size, ReturnSize);</div>
<div class="line"><span class="lineno">   40</span>    }</div>
<div class="line"><span class="lineno">   41</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   42</span>    {</div>
<div class="line"><span class="lineno">   43</span>        <span class="keywordflow">return</span> STATUS_UNSUCCESSFUL;</div>
<div class="line"><span class="lineno">   44</span>    }</div>
<div class="line"><span class="lineno">   45</span>}</div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h_html_a6f202a103e130d55c5ed5b55d5511cab"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a6f202a103e130d55c5ed5b55d5511cab">DEBUGGER_READ_MEMORY_TYPE</a></div><div class="ttdeci">enum _DEBUGGER_READ_MEMORY_TYPE DEBUGGER_READ_MEMORY_TYPE</div><div class="ttdoc">different type of addresses</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_script_imports_8h_html_a3f7c5b71d899e923be0a80d4ac7902fe"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a></div><div class="ttdeci">UINT64 Address</div><div class="ttdef"><b>Definition:</b> HyperDbgScriptImports.h:56</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_a611301ec5042b5afe767a37562dbbf27"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a611301ec5042b5afe767a37562dbbf27">MemoryManagerReadProcessMemoryNormal</a></div><div class="ttdeci">IMPORT_EXPORT_VMM BOOLEAN MemoryManagerReadProcessMemoryNormal(HANDLE PID, PVOID Address, DEBUGGER_READ_MEMORY_TYPE MemType, PVOID UserBuffer, SIZE_T Size, PSIZE_T ReturnSize)</div><div class="ttdoc">Read process memory.</div><div class="ttdef"><b>Definition:</b> MemoryManager.c:29</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y_html_a215597b2a3418b4413fe5286b1d1c685"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a215597b2a3418b4413fe5286b1d1c685">_DEBUGGER_READ_MEMORY::Size</a></div><div class="ttdeci">UINT32 Size</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:217</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y_html_a685a67cc05100b749ea071e9d9f7ff87"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a685a67cc05100b749ea071e9d9f7ff87">_DEBUGGER_READ_MEMORY::Pid</a></div><div class="ttdeci">UINT32 Pid</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:215</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y_html_ae6709d92b51f2c0ec9417a778b2cfa9f"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#ae6709d92b51f2c0ec9417a778b2cfa9f">_DEBUGGER_READ_MEMORY::MemoryType</a></div><div class="ttdeci">DEBUGGER_READ_MEMORY_TYPE MemoryType</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:218</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y_html_ae8a91a39973addb850d6fce45eba6b15"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#ae8a91a39973addb850d6fce45eba6b15">_DEBUGGER_READ_MEMORY::Address</a></div><div class="ttdeci">UINT64 Address</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:216</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a70ebcfc9fa35586032ef8a500dcd294e" name="a70ebcfc9fa35586032ef8a500dcd294e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70ebcfc9fa35586032ef8a500dcd294e">&#9670;&#160;</a></span>DebuggerCommandReadMemoryVmxRoot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> DebuggerCommandReadMemoryVmxRoot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#aa20edf6a6ccb273f5b16819964b171ac">PDEBUGGER_READ_MEMORY</a>&#160;</td>
          <td class="paramname"><em>ReadMemRequest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a> *&#160;</td>
          <td class="paramname"><em>UserBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PSIZE_T&#160;</td>
          <td class="paramname"><em>ReturnSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read memory for different commands from vmxroot mode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ReadMemRequest</td><td>request structure for reading memory </td></tr>
    <tr><td class="paramname">UserBuffer</td><td>user buffer to copy the memory </td></tr>
    <tr><td class="paramname">ReturnSize</td><td>size that should be returned to user mode buffers </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   57</span>{</div>
<div class="line"><span class="lineno">   58</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>                    Pid;</div>
<div class="line"><span class="lineno">   59</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>                    Size;</div>
<div class="line"><span class="lineno">   60</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>                    <a class="code hl_variable" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>;</div>
<div class="line"><span class="lineno">   61</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>                    OffsetInUserBuffer;</div>
<div class="line"><span class="lineno">   62</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a6f202a103e130d55c5ed5b55d5511cab">DEBUGGER_READ_MEMORY_TYPE</a> MemType;</div>
<div class="line"><span class="lineno">   63</span>    PLIST_ENTRY               TempList = 0;</div>
<div class="line"><span class="lineno">   64</span> </div>
<div class="line"><span class="lineno">   65</span>    Pid     = ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a685a67cc05100b749ea071e9d9f7ff87">Pid</a>;</div>
<div class="line"><span class="lineno">   66</span>    Size    = ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a215597b2a3418b4413fe5286b1d1c685">Size</a>;</div>
<div class="line"><span class="lineno">   67</span>    <a class="code hl_variable" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a> = ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#ae8a91a39973addb850d6fce45eba6b15">Address</a>;</div>
<div class="line"><span class="lineno">   68</span>    MemType = ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#ae6709d92b51f2c0ec9417a778b2cfa9f">MemoryType</a>;</div>
<div class="line"><span class="lineno">   69</span> </div>
<div class="line"><span class="lineno">   70</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   71</span>    <span class="comment">// read memory safe</span></div>
<div class="line"><span class="lineno">   72</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   73</span>    <span class="keywordflow">if</span> (MemType == <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#afcd781e8aa8c0d7e70540647a24a8432a447255089e36bc1778a161e2713f8888">DEBUGGER_READ_PHYSICAL_ADDRESS</a>)</div>
<div class="line"><span class="lineno">   74</span>    {</div>
<div class="line"><span class="lineno">   75</span>        <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#ac7274d7ee0dbbd0ca0cec9b225a6c4ad">MemoryMapperReadMemorySafeByPhysicalAddress</a>(<a class="code hl_variable" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>, UserBuffer, Size);</div>
<div class="line"><span class="lineno">   76</span>    }</div>
<div class="line"><span class="lineno">   77</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (MemType == <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#afcd781e8aa8c0d7e70540647a24a8432ad7f19a8eee9857bada355d107f2ffc97">DEBUGGER_READ_VIRTUAL_ADDRESS</a>)</div>
<div class="line"><span class="lineno">   78</span>    {</div>
<div class="line"><span class="lineno">   79</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   80</span>        <span class="comment">// Check whether the virtual memory is available in the current</span></div>
<div class="line"><span class="lineno">   81</span>        <span class="comment">// memory layout and also is present in the RAM</span></div>
<div class="line"><span class="lineno">   82</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   83</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a240789bd1c3cf023cd1403d4ea32bb19">CheckAccessValidityAndSafety</a>(<a class="code hl_variable" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>, Size))</div>
<div class="line"><span class="lineno">   84</span>        {</div>
<div class="line"><span class="lineno">   85</span>            ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a0eb19dcba59d45b95f2157eb674476d8">KernelStatus</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#ac1b8dbae6748b88abe05844e42c29952">DEBUGGER_ERROR_INVALID_ADDRESS</a>;</div>
<div class="line"><span class="lineno">   86</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">   87</span>        }</div>
<div class="line"><span class="lineno">   88</span> </div>
<div class="line"><span class="lineno">   89</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   90</span>        <span class="comment">// Read memory safely</span></div>
<div class="line"><span class="lineno">   91</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   92</span>        <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#adce5c38c4030404a4cb1163a59fbcbb5">MemoryMapperReadMemorySafeOnTargetProcess</a>(<a class="code hl_variable" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>, UserBuffer, Size);</div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   95</span>        <span class="comment">// Check if the target memory is filled with breakpoint of &#39;bp&#39; commands</span></div>
<div class="line"><span class="lineno">   96</span>        <span class="comment">// if the memory is changed due to this command, then we&#39;ll changes it to</span></div>
<div class="line"><span class="lineno">   97</span>        <span class="comment">// the previous byte</span></div>
<div class="line"><span class="lineno">   98</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   99</span> </div>
<div class="line"><span class="lineno">  100</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  101</span>        <span class="comment">// Iterate through the breakpoint list</span></div>
<div class="line"><span class="lineno">  102</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  103</span>        TempList = &amp;<a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#abca944290c6a683f0821a9096472f7d4">g_BreakpointsListHead</a>;</div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span>        <span class="keywordflow">while</span> (&amp;<a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#abca944290c6a683f0821a9096472f7d4">g_BreakpointsListHead</a> != TempList-&gt;Flink)</div>
<div class="line"><span class="lineno">  106</span>        {</div>
<div class="line"><span class="lineno">  107</span>            TempList                                      = TempList-&gt;Flink;</div>
<div class="line"><span class="lineno">  108</span>            <a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html">PDEBUGGEE_BP_DESCRIPTOR</a> CurrentBreakpointDesc = <a class="code hl_define" href="list_8h.html#adec42d53dc3b3e16ab7a1cd98af1c5fc">CONTAINING_RECORD</a>(TempList, <a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html">DEBUGGEE_BP_DESCRIPTOR</a>, BreakpointsList);</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>            <span class="keywordflow">if</span> (CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a6ee164edb59fd20f9e69048564dd435a">Address</a> &gt;= <a class="code hl_variable" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a> &amp;&amp; CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a6ee164edb59fd20f9e69048564dd435a">Address</a> &lt;= <a class="code hl_variable" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a> + Size)</div>
<div class="line"><span class="lineno">  111</span>            {</div>
<div class="line"><span class="lineno">  112</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  113</span>                <span class="comment">// The address is found, we have to swap the byte if the target</span></div>
<div class="line"><span class="lineno">  114</span>                <span class="comment">// byte is 0xcc</span></div>
<div class="line"><span class="lineno">  115</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  116</span> </div>
<div class="line"><span class="lineno">  117</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  118</span>                <span class="comment">// Find the address location at user buffer</span></div>
<div class="line"><span class="lineno">  119</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  120</span>                OffsetInUserBuffer = CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a6ee164edb59fd20f9e69048564dd435a">Address</a> - <a class="code hl_variable" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>;</div>
<div class="line"><span class="lineno">  121</span> </div>
<div class="line"><span class="lineno">  122</span>                <span class="keywordflow">if</span> (UserBuffer[OffsetInUserBuffer] == 0xcc)</div>
<div class="line"><span class="lineno">  123</span>                {</div>
<div class="line"><span class="lineno">  124</span>                    UserBuffer[OffsetInUserBuffer] = CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a5a31f78cc97ef4c9fdb0ab7a9a3d9bad">PreviousByte</a>;</div>
<div class="line"><span class="lineno">  125</span>                }</div>
<div class="line"><span class="lineno">  126</span>            }</div>
<div class="line"><span class="lineno">  127</span>        }</div>
<div class="line"><span class="lineno">  128</span>    }</div>
<div class="line"><span class="lineno">  129</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  130</span>    {</div>
<div class="line"><span class="lineno">  131</span>        ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a0eb19dcba59d45b95f2157eb674476d8">KernelStatus</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#aac9cc9511b87f4fb8676e7f60fb5a320">DEBUGGER_ERROR_MEMORY_TYPE_INVALID</a>;</div>
<div class="line"><span class="lineno">  132</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  133</span>    }</div>
<div class="line"><span class="lineno">  134</span>    ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a0eb19dcba59d45b95f2157eb674476d8">KernelStatus</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#aed656c58434eecb2d7e8c10e93aecff4">DEBUGGER_OPERATION_WAS_SUCCESSFUL</a>;</div>
<div class="line"><span class="lineno">  135</span>    *ReturnSize                  = Size;</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  138</span>}</div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h_html_aac9cc9511b87f4fb8676e7f60fb5a320"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#aac9cc9511b87f4fb8676e7f60fb5a320">DEBUGGER_ERROR_MEMORY_TYPE_INVALID</a></div><div class="ttdeci">#define DEBUGGER_ERROR_MEMORY_TYPE_INVALID</div><div class="ttdoc">error, memory type is invalid</div><div class="ttdef"><b>Definition:</b> ErrorCodes.h:214</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h_html_afcd781e8aa8c0d7e70540647a24a8432a447255089e36bc1778a161e2713f8888"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#afcd781e8aa8c0d7e70540647a24a8432a447255089e36bc1778a161e2713f8888">DEBUGGER_READ_PHYSICAL_ADDRESS</a></div><div class="ttdeci">@ DEBUGGER_READ_PHYSICAL_ADDRESS</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:189</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h_html_afcd781e8aa8c0d7e70540647a24a8432ad7f19a8eee9857bada355d107f2ffc97"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#afcd781e8aa8c0d7e70540647a24a8432ad7f19a8eee9857bada355d107f2ffc97">DEBUGGER_READ_VIRTUAL_ADDRESS</a></div><div class="ttdeci">@ DEBUGGER_READ_VIRTUAL_ADDRESS</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:190</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_ac7274d7ee0dbbd0ca0cec9b225a6c4ad"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#ac7274d7ee0dbbd0ca0cec9b225a6c4ad">MemoryMapperReadMemorySafeByPhysicalAddress</a></div><div class="ttdeci">IMPORT_EXPORT_VMM BOOLEAN MemoryMapperReadMemorySafeByPhysicalAddress(_In_ UINT64 PaAddressToRead, _Inout_ UINT64 BufferToSaveMemory, _In_ SIZE_T SizeToRead)</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_adce5c38c4030404a4cb1163a59fbcbb5"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#adce5c38c4030404a4cb1163a59fbcbb5">MemoryMapperReadMemorySafeOnTargetProcess</a></div><div class="ttdeci">IMPORT_EXPORT_VMM BOOLEAN MemoryMapperReadMemorySafeOnTargetProcess(_In_ UINT64 VaAddressToRead, _Inout_ PVOID BufferToSaveMemory, _In_ SIZE_T SizeToRead)</div></div>
<div class="ttc" id="ahprdbgkd_2header_2globals_2_global_8h_html_abca944290c6a683f0821a9096472f7d4"><div class="ttname"><a href="hprdbgkd_2header_2globals_2_global_8h.html#abca944290c6a683f0821a9096472f7d4">g_BreakpointsListHead</a></div><div class="ttdeci">LIST_ENTRY g_BreakpointsListHead</div><div class="ttdoc">List header of breakpoints for debugger-mode.</div><div class="ttdef"><b>Definition:</b> Global.h:85</div></div>
<div class="ttc" id="alist_8h_html_adec42d53dc3b3e16ab7a1cd98af1c5fc"><div class="ttname"><a href="list_8h.html#adec42d53dc3b3e16ab7a1cd98af1c5fc">CONTAINING_RECORD</a></div><div class="ttdeci">#define CONTAINING_RECORD(address, type, field)</div><div class="ttdef"><b>Definition:</b> list.h:14</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html">_DEBUGGEE_BP_DESCRIPTOR</a></div><div class="ttdoc">The structure of storing breakpoints.</div><div class="ttdef"><b>Definition:</b> State.h:72</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html_a5a31f78cc97ef4c9fdb0ab7a9a3d9bad"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a5a31f78cc97ef4c9fdb0ab7a9a3d9bad">_DEBUGGEE_BP_DESCRIPTOR::PreviousByte</a></div><div class="ttdeci">BYTE PreviousByte</div><div class="ttdef"><b>Definition:</b> State.h:82</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html_a6ee164edb59fd20f9e69048564dd435a"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a6ee164edb59fd20f9e69048564dd435a">_DEBUGGEE_BP_DESCRIPTOR::Address</a></div><div class="ttdeci">UINT64 Address</div><div class="ttdef"><b>Definition:</b> State.h:76</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y_html_a0eb19dcba59d45b95f2157eb674476d8"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a0eb19dcba59d45b95f2157eb674476d8">_DEBUGGER_READ_MEMORY::KernelStatus</a></div><div class="ttdeci">UINT32 KernelStatus</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:223</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a62dfa3017c983808ae647ec03252a0fe" name="a62dfa3017c983808ae647ec03252a0fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62dfa3017c983808ae647ec03252a0fe">&#9670;&#160;</a></span>DebuggerCommandReservePreallocatedPools()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS DebuggerCommandReservePreallocatedPools </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a5dcf26594841b272af7f485934e92d24">PDEBUGGER_PREALLOC_COMMAND</a>&#160;</td>
          <td class="paramname"><em>PreallocRequest</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reserve and allocate pre-allocated buffers. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PreallocRequest</td><td>Request details of needed buffers to be reserved </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1171</span>{</div>
<div class="line"><span class="lineno"> 1172</span>    <span class="keywordflow">switch</span> (PreallocRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___p_r_e_a_l_l_o_c___c_o_m_m_a_n_d.html#a6adbe0996a6cbf21690afd90352a1498">Type</a>)</div>
<div class="line"><span class="lineno"> 1173</span>    {</div>
<div class="line"><span class="lineno"> 1174</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a8b2f1e9a8e3317ece5edce1f633d85baa12eaac4806014a376257d95999b7344d">DEBUGGER_PREALLOC_COMMAND_TYPE_MONITOR</a>:</div>
<div class="line"><span class="lineno"> 1175</span> </div>
<div class="line"><span class="lineno"> 1176</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1177</span>        <span class="comment">// Perform the allocations for !monitor command</span></div>
<div class="line"><span class="lineno"> 1178</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1179</span>        <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#afc02d13f2deb423891f6a40a943368dd">VmFuncEptHookAllocateExtraHookingPages</a>(PreallocRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___p_r_e_a_l_l_o_c___c_o_m_m_a_n_d.html#a3cf611a54d3824a1f26c797e99ce2568">Count</a>);</div>
<div class="line"><span class="lineno"> 1180</span> </div>
<div class="line"><span class="lineno"> 1181</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1182</span> </div>
<div class="line"><span class="lineno"> 1183</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a8b2f1e9a8e3317ece5edce1f633d85baa7ae24692de1d370b040c1e9305366bf0">DEBUGGER_PREALLOC_COMMAND_TYPE_THREAD_INTERCEPTION</a>:</div>
<div class="line"><span class="lineno"> 1184</span> </div>
<div class="line"><span class="lineno"> 1185</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1186</span>        <span class="comment">// Request pages to be allocated for thread interception mechanism</span></div>
<div class="line"><span class="lineno"> 1187</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1188</span>        <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#aea915a9cf9f226a53f538d496ea7fa40">PoolManagerRequestAllocation</a>(<span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">USERMODE_DEBUGGING_THREAD_HOLDER</a>),</div>
<div class="line"><span class="lineno"> 1189</span>                                     PreallocRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___p_r_e_a_l_l_o_c___c_o_m_m_a_n_d.html#a3cf611a54d3824a1f26c797e99ce2568">Count</a>,</div>
<div class="line"><span class="lineno"> 1190</span>                                     <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63a13119f414e55e917801c5e61a2d98518">PROCESS_THREAD_HOLDER</a>);</div>
<div class="line"><span class="lineno"> 1191</span> </div>
<div class="line"><span class="lineno"> 1192</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1193</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1194</span> </div>
<div class="line"><span class="lineno"> 1195</span>        PreallocRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___p_r_e_a_l_l_o_c___c_o_m_m_a_n_d.html#a9baab220a9a337168c044a3553817555">KernelStatus</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#a38aeca539089d3d847e570e03bb0dc83">DEBUGGER_ERROR_COULD_NOT_FIND_ALLOCATION_TYPE</a>;</div>
<div class="line"><span class="lineno"> 1196</span>        <span class="keywordflow">return</span> STATUS_UNSUCCESSFUL;</div>
<div class="line"><span class="lineno"> 1197</span>    }</div>
<div class="line"><span class="lineno"> 1198</span> </div>
<div class="line"><span class="lineno"> 1199</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1200</span>    <span class="comment">// Invalidate and perform the allocations as we&#39;re in PASSIVE_LEVEL</span></div>
<div class="line"><span class="lineno"> 1201</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1202</span>    <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#aec6c6461389ae5501f4d00b902a7706d">PoolManagerCheckAndPerformAllocationAndDeallocation</a>();</div>
<div class="line"><span class="lineno"> 1203</span> </div>
<div class="line"><span class="lineno"> 1204</span>    PreallocRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___p_r_e_a_l_l_o_c___c_o_m_m_a_n_d.html#a9baab220a9a337168c044a3553817555">KernelStatus</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#aed656c58434eecb2d7e8c10e93aecff4">DEBUGGER_OPERATION_WAS_SUCCESSFUL</a>;</div>
<div class="line"><span class="lineno"> 1205</span> </div>
<div class="line"><span class="lineno"> 1206</span>    <span class="keywordflow">return</span> STATUS_SUCCESS;</div>
<div class="line"><span class="lineno"> 1207</span>}</div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_data_types_8h_html_ad130f0bae4db97169873223d0aad9a63a13119f414e55e917801c5e61a2d98518"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63a13119f414e55e917801c5e61a2d98518">PROCESS_THREAD_HOLDER</a></div><div class="ttdeci">@ PROCESS_THREAD_HOLDER</div><div class="ttdef"><b>Definition:</b> DataTypes.h:46</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h_html_a38aeca539089d3d847e570e03bb0dc83"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#a38aeca539089d3d847e570e03bb0dc83">DEBUGGER_ERROR_COULD_NOT_FIND_ALLOCATION_TYPE</a></div><div class="ttdeci">#define DEBUGGER_ERROR_COULD_NOT_FIND_ALLOCATION_TYPE</div><div class="ttdoc">error, could not find the type of allocation</div><div class="ttdef"><b>Definition:</b> ErrorCodes.h:282</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h_html_a8b2f1e9a8e3317ece5edce1f633d85baa12eaac4806014a376257d95999b7344d"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a8b2f1e9a8e3317ece5edce1f633d85baa12eaac4806014a376257d95999b7344d">DEBUGGER_PREALLOC_COMMAND_TYPE_MONITOR</a></div><div class="ttdeci">@ DEBUGGER_PREALLOC_COMMAND_TYPE_MONITOR</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:149</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h_html_a8b2f1e9a8e3317ece5edce1f633d85baa7ae24692de1d370b040c1e9305366bf0"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a8b2f1e9a8e3317ece5edce1f633d85baa7ae24692de1d370b040c1e9305366bf0">DEBUGGER_PREALLOC_COMMAND_TYPE_THREAD_INTERCEPTION</a></div><div class="ttdeci">@ DEBUGGER_PREALLOC_COMMAND_TYPE_THREAD_INTERCEPTION</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:150</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_aea915a9cf9f226a53f538d496ea7fa40"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#aea915a9cf9f226a53f538d496ea7fa40">PoolManagerRequestAllocation</a></div><div class="ttdeci">IMPORT_EXPORT_VMM BOOLEAN PoolManagerRequestAllocation(SIZE_T Size, UINT32 Count, POOL_ALLOCATION_INTENTION Intention)</div><div class="ttdoc">Request to allocate new buffers.</div><div class="ttdef"><b>Definition:</b> PoolManager.c:442</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_aec6c6461389ae5501f4d00b902a7706d"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#aec6c6461389ae5501f4d00b902a7706d">PoolManagerCheckAndPerformAllocationAndDeallocation</a></div><div class="ttdeci">IMPORT_EXPORT_VMM BOOLEAN PoolManagerCheckAndPerformAllocationAndDeallocation()</div><div class="ttdoc">This function performs allocations from VMX non-root based on g_RequestNewAllocation.</div><div class="ttdef"><b>Definition:</b> PoolManager.c:328</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_afc02d13f2deb423891f6a40a943368dd"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#afc02d13f2deb423891f6a40a943368dd">VmFuncEptHookAllocateExtraHookingPages</a></div><div class="ttdeci">IMPORT_EXPORT_VMM VOID VmFuncEptHookAllocateExtraHookingPages(UINT32 Count)</div><div class="ttdoc">Allocate (reserve) extra pages for storing details of page hooks.</div><div class="ttdef"><b>Definition:</b> Export.c:609</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___p_r_e_a_l_l_o_c___c_o_m_m_a_n_d_html_a3cf611a54d3824a1f26c797e99ce2568"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___p_r_e_a_l_l_o_c___c_o_m_m_a_n_d.html#a3cf611a54d3824a1f26c797e99ce2568">_DEBUGGER_PREALLOC_COMMAND::Count</a></div><div class="ttdeci">UINT64 Count</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:163</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___p_r_e_a_l_l_o_c___c_o_m_m_a_n_d_html_a6adbe0996a6cbf21690afd90352a1498"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___p_r_e_a_l_l_o_c___c_o_m_m_a_n_d.html#a6adbe0996a6cbf21690afd90352a1498">_DEBUGGER_PREALLOC_COMMAND::Type</a></div><div class="ttdeci">DEBUGGER_PREALLOC_COMMAND_TYPE Type</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:162</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___p_r_e_a_l_l_o_c___c_o_m_m_a_n_d_html_a9baab220a9a337168c044a3553817555"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___p_r_e_a_l_l_o_c___c_o_m_m_a_n_d.html#a9baab220a9a337168c044a3553817555">_DEBUGGER_PREALLOC_COMMAND::KernelStatus</a></div><div class="ttdeci">UINT32 KernelStatus</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:164</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r_html"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">_USERMODE_DEBUGGING_THREAD_HOLDER</a></div><div class="ttdoc">The holder for detail of each thread in process.</div><div class="ttdef"><b>Definition:</b> ThreadHolder.h:47</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a90d49ed0d4f0c40139d885b24e4c5b81" name="a90d49ed0d4f0c40139d885b24e4c5b81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90d49ed0d4f0c40139d885b24e4c5b81">&#9670;&#160;</a></span>DebuggerCommandSearchMemory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS DebuggerCommandSearchMemory </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a259329cf5d90fa23392810c8705398cf">PDEBUGGER_SEARCH_MEMORY</a>&#160;</td>
          <td class="paramname"><em>SearchMemRequest</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start searching memory. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">SearchMemRequest</td><td>Request to search memory </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  982</span>{</div>
<div class="line"><span class="lineno">  983</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ad413c7f23e00f0764dfa0ab21b6442a0">PUINT64</a> SearchResultsStorage = NULL;</div>
<div class="line"><span class="lineno">  984</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ad413c7f23e00f0764dfa0ab21b6442a0">PUINT64</a> UsermodeBuffer       = NULL;</div>
<div class="line"><span class="lineno">  985</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>  AddressFrom          = 0;</div>
<div class="line"><span class="lineno">  986</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>  AddressTo            = 0;</div>
<div class="line"><span class="lineno">  987</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>  CurrentValue         = 0;</div>
<div class="line"><span class="lineno">  988</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>  ResultsIndex         = 0;</div>
<div class="line"><span class="lineno">  989</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>  CountOfResults       = 0;</div>
<div class="line"><span class="lineno">  990</span> </div>
<div class="line"><span class="lineno">  991</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  992</span>    <span class="comment">// Check if process id is valid or not</span></div>
<div class="line"><span class="lineno">  993</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  994</span>    <span class="keywordflow">if</span> (SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a2286bb7292ad9a907133af3a8de82ac7">ProcessId</a> != PsGetCurrentProcessId() &amp;&amp; !<a class="code hl_function" href="hprdbgkd_2code_2common_2_common_8c.html#ae93e2ecf590a45b6ef7e67e137cc2e62">CommonIsProcessExist</a>(SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a2286bb7292ad9a907133af3a8de82ac7">ProcessId</a>))</div>
<div class="line"><span class="lineno">  995</span>    {</div>
<div class="line"><span class="lineno">  996</span>        <span class="keywordflow">return</span> STATUS_INVALID_PARAMETER;</div>
<div class="line"><span class="lineno">  997</span>    }</div>
<div class="line"><span class="lineno">  998</span> </div>
<div class="line"><span class="lineno">  999</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1000</span>    <span class="comment">// User-mode buffer is same as SearchMemRequest</span></div>
<div class="line"><span class="lineno"> 1001</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1002</span>    UsermodeBuffer = SearchMemRequest;</div>
<div class="line"><span class="lineno"> 1003</span> </div>
<div class="line"><span class="lineno"> 1004</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1005</span>    <span class="comment">// We store the user-mode data in a seprate variable because</span></div>
<div class="line"><span class="lineno"> 1006</span>    <span class="comment">// we will use them later when we Zeroed the SearchMemRequest</span></div>
<div class="line"><span class="lineno"> 1007</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1008</span>    AddressFrom = SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a93f60f8bba58373d242567705f2d147a">Address</a>;</div>
<div class="line"><span class="lineno"> 1009</span>    AddressTo   = SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a93f60f8bba58373d242567705f2d147a">Address</a> + SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a20e406adff161a193962c60ae4501632">Length</a>;</div>
<div class="line"><span class="lineno"> 1010</span> </div>
<div class="line"><span class="lineno"> 1011</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1012</span>    <span class="comment">// We support up to MaximumSearchResults search results</span></div>
<div class="line"><span class="lineno"> 1013</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1014</span>    SearchResultsStorage = ExAllocatePoolWithTag(NonPagedPool, <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_constants_8h.html#a919acdd5bb356f5a912d3b23b1b927a7">MaximumSearchResults</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>), <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_constants_8h.html#ab7f91e71074ce1488e61869adbc44d8d">POOLTAG</a>);</div>
<div class="line"><span class="lineno"> 1015</span> </div>
<div class="line"><span class="lineno"> 1016</span>    <span class="keywordflow">if</span> (SearchResultsStorage == NULL)</div>
<div class="line"><span class="lineno"> 1017</span>    {</div>
<div class="line"><span class="lineno"> 1018</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1019</span>        <span class="comment">// Not enough memory</span></div>
<div class="line"><span class="lineno"> 1020</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1021</span>        <span class="keywordflow">return</span> STATUS_INSUFFICIENT_RESOURCES;</div>
<div class="line"><span class="lineno"> 1022</span>    }</div>
<div class="line"><span class="lineno"> 1023</span> </div>
<div class="line"><span class="lineno"> 1024</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1025</span>    <span class="comment">// Make sure there is nothing else in the buffer</span></div>
<div class="line"><span class="lineno"> 1026</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1027</span>    RtlZeroMemory(SearchResultsStorage, <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_constants_8h.html#a919acdd5bb356f5a912d3b23b1b927a7">MaximumSearchResults</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>));</div>
<div class="line"><span class="lineno"> 1028</span> </div>
<div class="line"><span class="lineno"> 1029</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1030</span>    <span class="comment">// Call the wrapper</span></div>
<div class="line"><span class="lineno"> 1031</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1032</span>    <a class="code hl_function" href="_debugger_commands_8c.html#aa2b3b7d14e79251d6e4b20dff257500a">SearchAddressWrapper</a>(SearchResultsStorage, SearchMemRequest, AddressFrom, AddressTo, <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, &amp;CountOfResults);</div>
<div class="line"><span class="lineno"> 1033</span> </div>
<div class="line"><span class="lineno"> 1034</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1035</span>    <span class="comment">// In this point, we to store the results (if any) to the user-mode</span></div>
<div class="line"><span class="lineno"> 1036</span>    <span class="comment">// buffer SearchMemRequest itself is the user-mode buffer and we also</span></div>
<div class="line"><span class="lineno"> 1037</span>    <span class="comment">// checked from the previous function that the output buffer is at</span></div>
<div class="line"><span class="lineno"> 1038</span>    <span class="comment">// least SearchMemRequest bigger or equal to MaximumSearchResults * sizeof(UINT64)</span></div>
<div class="line"><span class="lineno"> 1039</span>    <span class="comment">// so we need to clear everything here, and also we should keep in mind that</span></div>
<div class="line"><span class="lineno"> 1040</span>    <span class="comment">// SearchMemRequest is no longer valid</span></div>
<div class="line"><span class="lineno"> 1041</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1042</span>    RtlZeroMemory(SearchMemRequest, <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_constants_8h.html#a919acdd5bb356f5a912d3b23b1b927a7">MaximumSearchResults</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>));</div>
<div class="line"><span class="lineno"> 1043</span> </div>
<div class="line"><span class="lineno"> 1044</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1045</span>    <span class="comment">// It&#39;s time to move the results from our temporary buffer to the user-mode</span></div>
<div class="line"><span class="lineno"> 1046</span>    <span class="comment">// buffer, also there is something that we should check and that&#39;s the fact</span></div>
<div class="line"><span class="lineno"> 1047</span>    <span class="comment">// that we used aligned page addresses so the results should be checked to</span></div>
<div class="line"><span class="lineno"> 1048</span>    <span class="comment">// see whether the results are between the user&#39;s entered addresses or not</span></div>
<div class="line"><span class="lineno"> 1049</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1050</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_constants_8h.html#a919acdd5bb356f5a912d3b23b1b927a7">MaximumSearchResults</a>; i++)</div>
<div class="line"><span class="lineno"> 1051</span>    {</div>
<div class="line"><span class="lineno"> 1052</span>        CurrentValue = SearchResultsStorage[i];</div>
<div class="line"><span class="lineno"> 1053</span> </div>
<div class="line"><span class="lineno"> 1054</span>        <span class="keywordflow">if</span> (CurrentValue == NULL)</div>
<div class="line"><span class="lineno"> 1055</span>        {</div>
<div class="line"><span class="lineno"> 1056</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1057</span>            <span class="comment">// Nothing left to move</span></div>
<div class="line"><span class="lineno"> 1058</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1059</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1060</span>        }</div>
<div class="line"><span class="lineno"> 1061</span> </div>
<div class="line"><span class="lineno"> 1062</span>        <span class="keywordflow">if</span> (CurrentValue &gt;= AddressFrom &amp;&amp; CurrentValue &lt;= AddressTo)</div>
<div class="line"><span class="lineno"> 1063</span>        {</div>
<div class="line"><span class="lineno"> 1064</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1065</span>            <span class="comment">// Move the variable</span></div>
<div class="line"><span class="lineno"> 1066</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1067</span>            UsermodeBuffer[ResultsIndex] = CurrentValue;</div>
<div class="line"><span class="lineno"> 1068</span>            ResultsIndex++;</div>
<div class="line"><span class="lineno"> 1069</span>        }</div>
<div class="line"><span class="lineno"> 1070</span>    }</div>
<div class="line"><span class="lineno"> 1071</span> </div>
<div class="line"><span class="lineno"> 1072</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1073</span>    <span class="comment">// Free the results pool</span></div>
<div class="line"><span class="lineno"> 1074</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1075</span>    ExFreePoolWithTag(SearchResultsStorage, <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_constants_8h.html#ab7f91e71074ce1488e61869adbc44d8d">POOLTAG</a>);</div>
<div class="line"><span class="lineno"> 1076</span> </div>
<div class="line"><span class="lineno"> 1077</span>    <span class="keywordflow">return</span> STATUS_SUCCESS;</div>
<div class="line"><span class="lineno"> 1078</span>}</div>
<div class="ttc" id="a_debugger_commands_8c_html_aa2b3b7d14e79251d6e4b20dff257500a"><div class="ttname"><a href="_debugger_commands_8c.html#aa2b3b7d14e79251d6e4b20dff257500a">SearchAddressWrapper</a></div><div class="ttdeci">BOOLEAN SearchAddressWrapper(PUINT64 AddressToSaveResults, PDEBUGGER_SEARCH_MEMORY SearchMemRequest, UINT64 StartAddress, UINT64 EndAddress, BOOLEAN IsDebuggeePaused, PUINT32 CountOfMatchedCases)</div><div class="ttdoc">The wrapper to check for validity of addresses and call the search routines for both physical and vir...</div><div class="ttdef"><b>Definition:</b> DebuggerCommands.c:810</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h_html_ad413c7f23e00f0764dfa0ab21b6442a0"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ad413c7f23e00f0764dfa0ab21b6442a0">PUINT64</a></div><div class="ttdeci">unsigned __int64 * PUINT64</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:19</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_constants_8h_html_a919acdd5bb356f5a912d3b23b1b927a7"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_constants_8h.html#a919acdd5bb356f5a912d3b23b1b927a7">MaximumSearchResults</a></div><div class="ttdeci">#define MaximumSearchResults</div><div class="ttdoc">maximum results that will be returned by !s* s* command</div><div class="ttdef"><b>Definition:</b> Constants.h:469</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_constants_8h_html_ab7f91e71074ce1488e61869adbc44d8d"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_constants_8h.html#ab7f91e71074ce1488e61869adbc44d8d">POOLTAG</a></div><div class="ttdeci">#define POOLTAG</div><div class="ttdoc">Pool tag.</div><div class="ttdef"><b>Definition:</b> Constants.h:377</div></div>
<div class="ttc" id="ahprdbgkd_2code_2common_2_common_8c_html_ae93e2ecf590a45b6ef7e67e137cc2e62"><div class="ttname"><a href="hprdbgkd_2code_2common_2_common_8c.html#ae93e2ecf590a45b6ef7e67e137cc2e62">CommonIsProcessExist</a></div><div class="ttdeci">BOOLEAN CommonIsProcessExist(UINT32 ProcId)</div><div class="ttdoc">Checks whether the process with ProcId exists or not.</div><div class="ttdef"><b>Definition:</b> Common.c:24</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y_html_a20e406adff161a193962c60ae4501632"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a20e406adff161a193962c60ae4501632">_DEBUGGER_SEARCH_MEMORY::Length</a></div><div class="ttdeci">UINT64 Length</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:481</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y_html_a2286bb7292ad9a907133af3a8de82ac7"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a2286bb7292ad9a907133af3a8de82ac7">_DEBUGGER_SEARCH_MEMORY::ProcessId</a></div><div class="ttdeci">UINT32 ProcessId</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:482</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y_html_a93f60f8bba58373d242567705f2d147a"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a93f60f8bba58373d242567705f2d147a">_DEBUGGER_SEARCH_MEMORY::Address</a></div><div class="ttdeci">UINT64 Address</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:480</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae149f6dd099f7dc3f64584a3b27f7d56" name="ae149f6dd099f7dc3f64584a3b27f7d56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae149f6dd099f7dc3f64584a3b27f7d56">&#9670;&#160;</a></span>DebuggerCommandSendGeneralBufferToDebugger()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS DebuggerCommandSendGeneralBufferToDebugger </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#ad97915c6241a0c1642aa62839e661aa1">PDEBUGGEE_SEND_GENERAL_PACKET_FROM_DEBUGGEE_TO_DEBUGGER</a>&#160;</td>
          <td class="paramname"><em>DebuggeeBufferRequest</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send general buffers from the debuggee to the debugger. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">DebuggeeBufferRequest</td><td>Request to buffer that will be sent to the debugger </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1149</span>{</div>
<div class="line"><span class="lineno"> 1150</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1151</span>    <span class="comment">// It&#39;s better to send the signal from vmx-root mode to avoid deadlock</span></div>
<div class="line"><span class="lineno"> 1152</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1153</span>    <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#ab2e385f36ad04e1650c3855007a91b98">VmFuncVmxVmcall</a>(<a class="code hl_define" href="_debugger_vmcalls_8h.html#aea644d30f2ae0f1573f9ac0a7c729686">DEBUGGER_VMCALL_SEND_GENERAL_BUFFER_TO_DEBUGGER</a>,</div>
<div class="line"><span class="lineno"> 1154</span>                    DebuggeeBufferRequest,</div>
<div class="line"><span class="lineno"> 1155</span>                    0,</div>
<div class="line"><span class="lineno"> 1156</span>                    0);</div>
<div class="line"><span class="lineno"> 1157</span> </div>
<div class="line"><span class="lineno"> 1158</span>    DebuggeeBufferRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___s_e_n_d___g_e_n_e_r_a_l___p_a_c_k_e_t___f_r_o_m___d_e_b_u_g_g_e_e___t_o___d_e_b_u_g_g_e_r.html#ac871117cd61b8e2eab2e16c2fba63c22">KernelResult</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#aed656c58434eecb2d7e8c10e93aecff4">DEBUGGER_OPERATION_WAS_SUCCESSFUL</a>;</div>
<div class="line"><span class="lineno"> 1159</span> </div>
<div class="line"><span class="lineno"> 1160</span>    <span class="keywordflow">return</span> STATUS_SUCCESS;</div>
<div class="line"><span class="lineno"> 1161</span>}</div>
<div class="ttc" id="a_debugger_vmcalls_8h_html_aea644d30f2ae0f1573f9ac0a7c729686"><div class="ttname"><a href="_debugger_vmcalls_8h.html#aea644d30f2ae0f1573f9ac0a7c729686">DEBUGGER_VMCALL_SEND_GENERAL_BUFFER_TO_DEBUGGER</a></div><div class="ttdeci">#define DEBUGGER_VMCALL_SEND_GENERAL_BUFFER_TO_DEBUGGER</div><div class="ttdoc">VMCALL to send general buffers from debuggee user-mode to the debugger.</div><div class="ttdef"><b>Definition:</b> DebuggerVmcalls.h:49</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_ab2e385f36ad04e1650c3855007a91b98"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#ab2e385f36ad04e1650c3855007a91b98">VmFuncVmxVmcall</a></div><div class="ttdeci">IMPORT_EXPORT_VMM NTSTATUS VmFuncVmxVmcall(unsigned long long VmcallNumber, unsigned long long OptionalParam1, unsigned long long OptionalParam2, long long OptionalParam3)</div><div class="ttdoc">Export for running VMX VMCALLs.</div><div class="ttdef"><b>Definition:</b> Export.c:561</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___s_e_n_d___g_e_n_e_r_a_l___p_a_c_k_e_t___f_r_o_m___d_e_b_u_g_g_e_e___t_o___d_e_b_u_g_g_e_r_html_ac871117cd61b8e2eab2e16c2fba63c22"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___s_e_n_d___g_e_n_e_r_a_l___p_a_c_k_e_t___f_r_o_m___d_e_b_u_g_g_e_e___t_o___d_e_b_u_g_g_e_r.html#ac871117cd61b8e2eab2e16c2fba63c22">_DEBUGGEE_SEND_GENERAL_PACKET_FROM_DEBUGGEE_TO_DEBUGGER::KernelResult</a></div><div class="ttdeci">UINT32 KernelResult</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:339</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adea94a64fc961c2aa25be87907844586" name="adea94a64fc961c2aa25be87907844586"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adea94a64fc961c2aa25be87907844586">&#9670;&#160;</a></span>DebuggerCommandSendMessage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS DebuggerCommandSendMessage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a220681277ea06cfae1cec6d8cd06d3f9">PDEBUGGER_SEND_USERMODE_MESSAGES_TO_DEBUGGER</a>&#160;</td>
          <td class="paramname"><em>DebuggerSendUsermodeMessageRequest</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send the user-mode buffer to debugger. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">DebuggerSendUsermodeMessageRequest</td><td>Request to send message to debugger </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1127</span>{</div>
<div class="line"><span class="lineno"> 1128</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1129</span>    <span class="comment">// It&#39;s better to send the signal from vmx-root mode to avoid deadlock</span></div>
<div class="line"><span class="lineno"> 1130</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1131</span>    <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#ab2e385f36ad04e1650c3855007a91b98">VmFuncVmxVmcall</a>(<a class="code hl_define" href="_debugger_vmcalls_8h.html#a24e3d1ecb000261d557dd795f205d51e">DEBUGGER_VMCALL_SEND_MESSAGES_TO_DEBUGGER</a>,</div>
<div class="line"><span class="lineno"> 1132</span>                    (<a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)DebuggerSendUsermodeMessageRequest + (<a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a0437a8efeddd8a30372c9a44e41954e9">SIZEOF_DEBUGGER_SEND_USERMODE_MESSAGES_TO_DEBUGGER</a>),</div>
<div class="line"><span class="lineno"> 1133</span>                    DebuggerSendUsermodeMessageRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_n_d___u_s_e_r_m_o_d_e___m_e_s_s_a_g_e_s___t_o___d_e_b_u_g_g_e_r.html#acbaabdfeca27bad0082ba08c3aae349d">Length</a>,</div>
<div class="line"><span class="lineno"> 1134</span>                    0);</div>
<div class="line"><span class="lineno"> 1135</span> </div>
<div class="line"><span class="lineno"> 1136</span>    DebuggerSendUsermodeMessageRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_n_d___u_s_e_r_m_o_d_e___m_e_s_s_a_g_e_s___t_o___d_e_b_u_g_g_e_r.html#a045b45760aa92376f8ef1688c08cc175">KernelStatus</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#aed656c58434eecb2d7e8c10e93aecff4">DEBUGGER_OPERATION_WAS_SUCCESSFUL</a>;</div>
<div class="line"><span class="lineno"> 1137</span> </div>
<div class="line"><span class="lineno"> 1138</span>    <span class="keywordflow">return</span> STATUS_SUCCESS;</div>
<div class="line"><span class="lineno"> 1139</span>}</div>
<div class="ttc" id="a_debugger_vmcalls_8h_html_a24e3d1ecb000261d557dd795f205d51e"><div class="ttname"><a href="_debugger_vmcalls_8h.html#a24e3d1ecb000261d557dd795f205d51e">DEBUGGER_VMCALL_SEND_MESSAGES_TO_DEBUGGER</a></div><div class="ttdeci">#define DEBUGGER_VMCALL_SEND_MESSAGES_TO_DEBUGGER</div><div class="ttdoc">VMCALL to send messages to the debugger.</div><div class="ttdef"><b>Definition:</b> DebuggerVmcalls.h:42</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h_html_a0437a8efeddd8a30372c9a44e41954e9"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a0437a8efeddd8a30372c9a44e41954e9">SIZEOF_DEBUGGER_SEND_USERMODE_MESSAGES_TO_DEBUGGER</a></div><div class="ttdeci">#define SIZEOF_DEBUGGER_SEND_USERMODE_MESSAGES_TO_DEBUGGER</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:351</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___s_e_n_d___u_s_e_r_m_o_d_e___m_e_s_s_a_g_e_s___t_o___d_e_b_u_g_g_e_r_html_a045b45760aa92376f8ef1688c08cc175"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___s_e_n_d___u_s_e_r_m_o_d_e___m_e_s_s_a_g_e_s___t_o___d_e_b_u_g_g_e_r.html#a045b45760aa92376f8ef1688c08cc175">_DEBUGGER_SEND_USERMODE_MESSAGES_TO_DEBUGGER::KernelStatus</a></div><div class="ttdeci">UINT32 KernelStatus</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:360</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___s_e_n_d___u_s_e_r_m_o_d_e___m_e_s_s_a_g_e_s___t_o___d_e_b_u_g_g_e_r_html_acbaabdfeca27bad0082ba08c3aae349d"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___s_e_n_d___u_s_e_r_m_o_d_e___m_e_s_s_a_g_e_s___t_o___d_e_b_u_g_g_e_r.html#acbaabdfeca27bad0082ba08c3aae349d">_DEBUGGER_SEND_USERMODE_MESSAGES_TO_DEBUGGER::Length</a></div><div class="ttdeci">UINT32 Length</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:361</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7aa8aa71f33a1a7c56f77864afb4641e" name="a7aa8aa71f33a1a7c56f77864afb4641e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7aa8aa71f33a1a7c56f77864afb4641e">&#9670;&#160;</a></span>DebuggerCommandSignalExecutionState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS DebuggerCommandSignalExecutionState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a79b3c4ae30c99d53a4287aec1398db44">PDEBUGGER_SEND_COMMAND_EXECUTION_FINISHED_SIGNAL</a>&#160;</td>
          <td class="paramname"><em>DebuggerFinishedExecutionRequest</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform the command finished signal. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">DebuggerFinishedExecutionRequest</td><td>Request to signal debuggee about execution state </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1108</span>{</div>
<div class="line"><span class="lineno"> 1109</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1110</span>    <span class="comment">// It&#39;s better to send the signal from vmx-root mode</span></div>
<div class="line"><span class="lineno"> 1111</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1112</span>    <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#ab2e385f36ad04e1650c3855007a91b98">VmFuncVmxVmcall</a>(<a class="code hl_define" href="_debugger_vmcalls_8h.html#a043a8356fe9dcf434e61a92cbf30a237">DEBUGGER_VMCALL_SIGNAL_DEBUGGER_EXECUTION_FINISHED</a>, 0, 0, 0);</div>
<div class="line"><span class="lineno"> 1113</span> </div>
<div class="line"><span class="lineno"> 1114</span>    DebuggerFinishedExecutionRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_n_d___c_o_m_m_a_n_d___e_x_e_c_u_t_i_o_n___f_i_n_i_s_h_e_d___s_i_g_n_a_l.html#a7f6eb4942fa94da828b9425c3d49882c">KernelStatus</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#aed656c58434eecb2d7e8c10e93aecff4">DEBUGGER_OPERATION_WAS_SUCCESSFUL</a>;</div>
<div class="line"><span class="lineno"> 1115</span> </div>
<div class="line"><span class="lineno"> 1116</span>    <span class="keywordflow">return</span> STATUS_SUCCESS;</div>
<div class="line"><span class="lineno"> 1117</span>}</div>
<div class="ttc" id="a_debugger_vmcalls_8h_html_a043a8356fe9dcf434e61a92cbf30a237"><div class="ttname"><a href="_debugger_vmcalls_8h.html#a043a8356fe9dcf434e61a92cbf30a237">DEBUGGER_VMCALL_SIGNAL_DEBUGGER_EXECUTION_FINISHED</a></div><div class="ttdeci">#define DEBUGGER_VMCALL_SIGNAL_DEBUGGER_EXECUTION_FINISHED</div><div class="ttdoc">VMCALL to signal debugger that debuggee finished execution of the command.</div><div class="ttdef"><b>Definition:</b> DebuggerVmcalls.h:36</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___s_e_n_d___c_o_m_m_a_n_d___e_x_e_c_u_t_i_o_n___f_i_n_i_s_h_e_d___s_i_g_n_a_l_html_a7f6eb4942fa94da828b9425c3d49882c"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___s_e_n_d___c_o_m_m_a_n_d___e_x_e_c_u_t_i_o_n___f_i_n_i_s_h_e_d___s_i_g_n_a_l.html#a7f6eb4942fa94da828b9425c3d49882c">_DEBUGGER_SEND_COMMAND_EXECUTION_FINISHED_SIGNAL::KernelStatus</a></div><div class="ttdeci">UINT32 KernelStatus</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:301</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6cacf53abe149ebe3e2c43ad68d43e22" name="a6cacf53abe149ebe3e2c43ad68d43e22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cacf53abe149ebe3e2c43ad68d43e22">&#9670;&#160;</a></span>DebuggerReadOrWriteMsr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS DebuggerReadOrWriteMsr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a4d767d7cb2f35f41f4644da283ed779b">PDEBUGGER_READ_AND_WRITE_ON_MSR</a>&#160;</td>
          <td class="paramname"><em>ReadOrWriteMsrRequest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> *&#160;</td>
          <td class="paramname"><em>UserBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PSIZE_T&#160;</td>
          <td class="paramname"><em>ReturnSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform rdmsr, wrmsr commands. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ReadOrWriteMsrRequest</td><td>Msr read/write request </td></tr>
    <tr><td class="paramname">UserBuffer</td><td>user buffer to save the results </td></tr>
    <tr><td class="paramname">ReturnSize</td><td>return size to user-mode buffers </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  150</span>{</div>
<div class="line"><span class="lineno">  151</span>    NTSTATUS Status;</div>
<div class="line"><span class="lineno">  152</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>   ProcessorCount = KeQueryActiveProcessorCount(0);</div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  155</span>    <span class="comment">// We don&#39;t check whether the MSR is in valid range of hardware or not</span></div>
<div class="line"><span class="lineno">  156</span>    <span class="comment">// because the user might send a non-valid MSR which means sth to the</span></div>
<div class="line"><span class="lineno">  157</span>    <span class="comment">// Windows or VMM, e.g the range specified for VMMs in Hyper-v</span></div>
<div class="line"><span class="lineno">  158</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  159</span> </div>
<div class="line"><span class="lineno">  160</span>    <span class="keywordflow">if</span> (ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a38a6cf9e2ea5ef31a1f7e888db6dc649">ActionType</a> == <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a9e99d3b0c6a6357a5f021dc82422f789a8b4846619d6bec50232910290764fff3">DEBUGGER_MSR_WRITE</a>)</div>
<div class="line"><span class="lineno">  161</span>    {</div>
<div class="line"><span class="lineno">  162</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  163</span>        <span class="comment">// Set Msr to be applied on the target cores</span></div>
<div class="line"><span class="lineno">  164</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  165</span>        <span class="keywordflow">if</span> (ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a1bc8c0010501f9125b025ecb933380d5">CoreNumber</a> == <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_constants_8h.html#ad4f1d4dd952194fa7b47a2ed193ea0ed">DEBUGGER_READ_AND_WRITE_ON_MSR_APPLY_ALL_CORES</a>)</div>
<div class="line"><span class="lineno">  166</span>        {</div>
<div class="line"><span class="lineno">  167</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  168</span>            <span class="comment">// Means that we should apply it on all cores</span></div>
<div class="line"><span class="lineno">  169</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  170</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; ProcessorCount; i++)</div>
<div class="line"><span class="lineno">  171</span>            {</div>
<div class="line"><span class="lineno">  172</span>                <a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a>[i].<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a5d5c22183a428958358e19d6434db8a7">MsrState</a>.<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___m_s_r___r_e_a_d___o_r___w_r_i_t_e.html#a3ca94b81f31339286eaa6f27eea5804e">Msr</a>   = ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a3e43511772a5618a6bec9655e8a774d5">Msr</a>;</div>
<div class="line"><span class="lineno">  173</span>                <a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a>[i].<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a5d5c22183a428958358e19d6434db8a7">MsrState</a>.<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___m_s_r___r_e_a_d___o_r___w_r_i_t_e.html#af0a7d72554edcca419674fb5dbf3608d">Value</a> = ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#aec2dc73b7eb1f1d455f0399bcb49e929">Value</a>;</div>
<div class="line"><span class="lineno">  174</span>            }</div>
<div class="line"><span class="lineno">  175</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  176</span>            <span class="comment">// Broadcast to all cores to change their Msrs</span></div>
<div class="line"><span class="lineno">  177</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  178</span>            KeGenericCallDpc(<a class="code hl_function" href="hprdbgkd_2code_2debugger_2broadcast_2_dpc_routines_8c.html#ac9051976c97907c7b77703fd5b8d5a79">DpcRoutineWriteMsrToAllCores</a>, 0x0);</div>
<div class="line"><span class="lineno">  179</span>        }</div>
<div class="line"><span class="lineno">  180</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  181</span>        {</div>
<div class="line"><span class="lineno">  182</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  183</span>            <span class="comment">// We have to change a single core&#39;s msr</span></div>
<div class="line"><span class="lineno">  184</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  187</span>            <span class="comment">// Check if the core number is not invalid</span></div>
<div class="line"><span class="lineno">  188</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  189</span>            <span class="keywordflow">if</span> (ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a1bc8c0010501f9125b025ecb933380d5">CoreNumber</a> &gt;= ProcessorCount)</div>
<div class="line"><span class="lineno">  190</span>            {</div>
<div class="line"><span class="lineno">  191</span>                <span class="keywordflow">return</span> STATUS_INVALID_PARAMETER;</div>
<div class="line"><span class="lineno">  192</span>            }</div>
<div class="line"><span class="lineno">  193</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  194</span>            <span class="comment">// Otherwise it&#39;s valid</span></div>
<div class="line"><span class="lineno">  195</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  196</span>            <a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a>[ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a1bc8c0010501f9125b025ecb933380d5">CoreNumber</a>].<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a5d5c22183a428958358e19d6434db8a7">MsrState</a>.<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___m_s_r___r_e_a_d___o_r___w_r_i_t_e.html#a3ca94b81f31339286eaa6f27eea5804e">Msr</a>   = ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a3e43511772a5618a6bec9655e8a774d5">Msr</a>;</div>
<div class="line"><span class="lineno">  197</span>            <a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a>[ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a1bc8c0010501f9125b025ecb933380d5">CoreNumber</a>].<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a5d5c22183a428958358e19d6434db8a7">MsrState</a>.<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___m_s_r___r_e_a_d___o_r___w_r_i_t_e.html#af0a7d72554edcca419674fb5dbf3608d">Value</a> = ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#aec2dc73b7eb1f1d455f0399bcb49e929">Value</a>;</div>
<div class="line"><span class="lineno">  198</span> </div>
<div class="line"><span class="lineno">  199</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  200</span>            <span class="comment">// Execute it on a single core</span></div>
<div class="line"><span class="lineno">  201</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  202</span>            Status = <a class="code hl_function" href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#a860d1d5fbe8605d03eda7327935c799e">DpcRoutineRunTaskOnSingleCore</a>(ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a1bc8c0010501f9125b025ecb933380d5">CoreNumber</a>, <a class="code hl_function" href="hprdbgkd_2code_2debugger_2broadcast_2_dpc_routines_8c.html#a5db83f6e1cbc79c9147fabc0c3b97744">DpcRoutinePerformWriteMsr</a>, NULL);</div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>            *ReturnSize = 0;</div>
<div class="line"><span class="lineno">  205</span>            <span class="keywordflow">return</span> Status;</div>
<div class="line"><span class="lineno">  206</span>        }</div>
<div class="line"><span class="lineno">  207</span> </div>
<div class="line"><span class="lineno">  208</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  209</span>        <span class="comment">// It&#39;s an wrmsr, nothing to return</span></div>
<div class="line"><span class="lineno">  210</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  211</span>        *ReturnSize = 0;</div>
<div class="line"><span class="lineno">  212</span>        <span class="keywordflow">return</span> STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  213</span>    }</div>
<div class="line"><span class="lineno">  214</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a38a6cf9e2ea5ef31a1f7e888db6dc649">ActionType</a> == <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a9e99d3b0c6a6357a5f021dc82422f789a3ef6fa35171ecbbaa97f3a88e619be3e">DEBUGGER_MSR_READ</a>)</div>
<div class="line"><span class="lineno">  215</span>    {</div>
<div class="line"><span class="lineno">  216</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  217</span>        <span class="comment">// Set Msr to be applied on the target cores</span></div>
<div class="line"><span class="lineno">  218</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  219</span>        <span class="keywordflow">if</span> (ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a1bc8c0010501f9125b025ecb933380d5">CoreNumber</a> == <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_constants_8h.html#ad4f1d4dd952194fa7b47a2ed193ea0ed">DEBUGGER_READ_AND_WRITE_ON_MSR_APPLY_ALL_CORES</a>)</div>
<div class="line"><span class="lineno">  220</span>        {</div>
<div class="line"><span class="lineno">  221</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  222</span>            <span class="comment">// Means that we should apply it on all cores</span></div>
<div class="line"><span class="lineno">  223</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  224</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; ProcessorCount; i++)</div>
<div class="line"><span class="lineno">  225</span>            {</div>
<div class="line"><span class="lineno">  226</span>                <a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a>[i].<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a5d5c22183a428958358e19d6434db8a7">MsrState</a>.<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___m_s_r___r_e_a_d___o_r___w_r_i_t_e.html#a3ca94b81f31339286eaa6f27eea5804e">Msr</a> = ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a3e43511772a5618a6bec9655e8a774d5">Msr</a>;</div>
<div class="line"><span class="lineno">  227</span>            }</div>
<div class="line"><span class="lineno">  228</span> </div>
<div class="line"><span class="lineno">  229</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  230</span>            <span class="comment">// Broadcast to all cores to read their Msrs</span></div>
<div class="line"><span class="lineno">  231</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  232</span>            KeGenericCallDpc(<a class="code hl_function" href="hprdbgkd_2code_2debugger_2broadcast_2_dpc_routines_8c.html#aeac723279c4734876a27723d78950f0a">DpcRoutineReadMsrToAllCores</a>, 0x0);</div>
<div class="line"><span class="lineno">  233</span> </div>
<div class="line"><span class="lineno">  234</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  235</span>            <span class="comment">// When we reach here, all processors read their shits</span></div>
<div class="line"><span class="lineno">  236</span>            <span class="comment">// so we have to fill that fucking buffer for user mode</span></div>
<div class="line"><span class="lineno">  237</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  238</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; ProcessorCount; i++)</div>
<div class="line"><span class="lineno">  239</span>            {</div>
<div class="line"><span class="lineno">  240</span>                UserBuffer[i] = <a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a>[i].<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a5d5c22183a428958358e19d6434db8a7">MsrState</a>.<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___m_s_r___r_e_a_d___o_r___w_r_i_t_e.html#af0a7d72554edcca419674fb5dbf3608d">Value</a>;</div>
<div class="line"><span class="lineno">  241</span>            }</div>
<div class="line"><span class="lineno">  242</span> </div>
<div class="line"><span class="lineno">  243</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  244</span>            <span class="comment">// It&#39;s an rdmsr we have to return a value for all cores</span></div>
<div class="line"><span class="lineno">  245</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  246</span> </div>
<div class="line"><span class="lineno">  247</span>            *ReturnSize = <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>) * ProcessorCount;</div>
<div class="line"><span class="lineno">  248</span>            <span class="keywordflow">return</span> STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  249</span>        }</div>
<div class="line"><span class="lineno">  250</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  251</span>        {</div>
<div class="line"><span class="lineno">  252</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  253</span>            <span class="comment">// Apply to one core</span></div>
<div class="line"><span class="lineno">  254</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  257</span>            <span class="comment">// Check if the core number is not invalid</span></div>
<div class="line"><span class="lineno">  258</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  259</span>            <span class="keywordflow">if</span> (ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a1bc8c0010501f9125b025ecb933380d5">CoreNumber</a> &gt;= ProcessorCount)</div>
<div class="line"><span class="lineno">  260</span>            {</div>
<div class="line"><span class="lineno">  261</span>                *ReturnSize = 0;</div>
<div class="line"><span class="lineno">  262</span>                <span class="keywordflow">return</span> STATUS_INVALID_PARAMETER;</div>
<div class="line"><span class="lineno">  263</span>            }</div>
<div class="line"><span class="lineno">  264</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  265</span>            <span class="comment">// Otherwise it&#39;s valid</span></div>
<div class="line"><span class="lineno">  266</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  267</span>            <a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a>[ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a1bc8c0010501f9125b025ecb933380d5">CoreNumber</a>].<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a5d5c22183a428958358e19d6434db8a7">MsrState</a>.<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___m_s_r___r_e_a_d___o_r___w_r_i_t_e.html#a3ca94b81f31339286eaa6f27eea5804e">Msr</a> = ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a3e43511772a5618a6bec9655e8a774d5">Msr</a>;</div>
<div class="line"><span class="lineno">  268</span> </div>
<div class="line"><span class="lineno">  269</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  270</span>            <span class="comment">// Execute it on a single core</span></div>
<div class="line"><span class="lineno">  271</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  272</span>            Status = <a class="code hl_function" href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#a860d1d5fbe8605d03eda7327935c799e">DpcRoutineRunTaskOnSingleCore</a>(ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a1bc8c0010501f9125b025ecb933380d5">CoreNumber</a>, <a class="code hl_function" href="hprdbgkd_2code_2debugger_2broadcast_2_dpc_routines_8c.html#a6b602a352170d025aa12387207214382">DpcRoutinePerformReadMsr</a>, NULL);</div>
<div class="line"><span class="lineno">  273</span> </div>
<div class="line"><span class="lineno">  274</span>            <span class="keywordflow">if</span> (Status != STATUS_SUCCESS)</div>
<div class="line"><span class="lineno">  275</span>            {</div>
<div class="line"><span class="lineno">  276</span>                *ReturnSize = 0;</div>
<div class="line"><span class="lineno">  277</span>                <span class="keywordflow">return</span> Status;</div>
<div class="line"><span class="lineno">  278</span>            }</div>
<div class="line"><span class="lineno">  279</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  280</span>            <span class="comment">// Restore the result to the usermode</span></div>
<div class="line"><span class="lineno">  281</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  282</span>            UserBuffer[0] = <a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a>[ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a1bc8c0010501f9125b025ecb933380d5">CoreNumber</a>].<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a5d5c22183a428958358e19d6434db8a7">MsrState</a>.<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___m_s_r___r_e_a_d___o_r___w_r_i_t_e.html#af0a7d72554edcca419674fb5dbf3608d">Value</a>;</div>
<div class="line"><span class="lineno">  283</span> </div>
<div class="line"><span class="lineno">  284</span>            *ReturnSize = <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>);</div>
<div class="line"><span class="lineno">  285</span>            <span class="keywordflow">return</span> STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  286</span>        }</div>
<div class="line"><span class="lineno">  287</span>    }</div>
<div class="line"><span class="lineno">  288</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  289</span>    {</div>
<div class="line"><span class="lineno">  290</span>        *ReturnSize = 0;</div>
<div class="line"><span class="lineno">  291</span>        <span class="keywordflow">return</span> STATUS_UNSUCCESSFUL;</div>
<div class="line"><span class="lineno">  292</span>    }</div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>    <span class="keywordflow">return</span> STATUS_UNSUCCESSFUL;</div>
<div class="line"><span class="lineno">  295</span>}</div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_constants_8h_html_ad4f1d4dd952194fa7b47a2ed193ea0ed"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_constants_8h.html#ad4f1d4dd952194fa7b47a2ed193ea0ed">DEBUGGER_READ_AND_WRITE_ON_MSR_APPLY_ALL_CORES</a></div><div class="ttdeci">#define DEBUGGER_READ_AND_WRITE_ON_MSR_APPLY_ALL_CORES</div><div class="ttdoc">Read and write MSRs to all cores.</div><div class="ttdef"><b>Definition:</b> Constants.h:539</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h_html_a9e99d3b0c6a6357a5f021dc82422f789a3ef6fa35171ecbbaa97f3a88e619be3e"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a9e99d3b0c6a6357a5f021dc82422f789a3ef6fa35171ecbbaa97f3a88e619be3e">DEBUGGER_MSR_READ</a></div><div class="ttdeci">@ DEBUGGER_MSR_READ</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:382</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h_html_a9e99d3b0c6a6357a5f021dc82422f789a8b4846619d6bec50232910290764fff3"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a9e99d3b0c6a6357a5f021dc82422f789a8b4846619d6bec50232910290764fff3">DEBUGGER_MSR_WRITE</a></div><div class="ttdeci">@ DEBUGGER_MSR_WRITE</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:383</div></div>
<div class="ttc" id="ahprdbghv_2code_2broadcast_2_dpc_routines_8c_html_a860d1d5fbe8605d03eda7327935c799e"><div class="ttname"><a href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#a860d1d5fbe8605d03eda7327935c799e">DpcRoutineRunTaskOnSingleCore</a></div><div class="ttdeci">NTSTATUS DpcRoutineRunTaskOnSingleCore(UINT32 CoreNumber, PVOID Routine, PVOID DeferredContext)</div><div class="ttdoc">This function synchronize the function execution for a single core You should only used it for one co...</div><div class="ttdef"><b>Definition:</b> DpcRoutines.c:35</div></div>
<div class="ttc" id="ahprdbgkd_2code_2debugger_2broadcast_2_dpc_routines_8c_html_a5db83f6e1cbc79c9147fabc0c3b97744"><div class="ttname"><a href="hprdbgkd_2code_2debugger_2broadcast_2_dpc_routines_8c.html#a5db83f6e1cbc79c9147fabc0c3b97744">DpcRoutinePerformWriteMsr</a></div><div class="ttdeci">VOID DpcRoutinePerformWriteMsr(KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)</div><div class="ttdoc">Broadcast msr write.</div><div class="ttdef"><b>Definition:</b> DpcRoutines.c:128</div></div>
<div class="ttc" id="ahprdbgkd_2code_2debugger_2broadcast_2_dpc_routines_8c_html_a6b602a352170d025aa12387207214382"><div class="ttname"><a href="hprdbgkd_2code_2debugger_2broadcast_2_dpc_routines_8c.html#a6b602a352170d025aa12387207214382">DpcRoutinePerformReadMsr</a></div><div class="ttdeci">VOID DpcRoutinePerformReadMsr(KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)</div><div class="ttdoc">Broadcast msr read.</div><div class="ttdef"><b>Definition:</b> DpcRoutines.c:161</div></div>
<div class="ttc" id="ahprdbgkd_2code_2debugger_2broadcast_2_dpc_routines_8c_html_ac9051976c97907c7b77703fd5b8d5a79"><div class="ttname"><a href="hprdbgkd_2code_2debugger_2broadcast_2_dpc_routines_8c.html#ac9051976c97907c7b77703fd5b8d5a79">DpcRoutineWriteMsrToAllCores</a></div><div class="ttdeci">VOID DpcRoutineWriteMsrToAllCores(KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)</div><div class="ttdoc">Broadcast Msr Write.</div><div class="ttdef"><b>Definition:</b> DpcRoutines.c:193</div></div>
<div class="ttc" id="ahprdbgkd_2code_2debugger_2broadcast_2_dpc_routines_8c_html_aeac723279c4734876a27723d78950f0a"><div class="ttname"><a href="hprdbgkd_2code_2debugger_2broadcast_2_dpc_routines_8c.html#aeac723279c4734876a27723d78950f0a">DpcRoutineReadMsrToAllCores</a></div><div class="ttdeci">VOID DpcRoutineReadMsrToAllCores(KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)</div><div class="ttdoc">Broadcast Msr read.</div><div class="ttdef"><b>Definition:</b> DpcRoutines.c:227</div></div>
<div class="ttc" id="ahprdbgkd_2header_2globals_2_global_8h_html_a349ee1adc363d2e4323a35a68fae5646"><div class="ttname"><a href="hprdbgkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a></div><div class="ttdeci">PROCESSOR_DEBUGGING_STATE * g_DbgState</div><div class="ttdoc">Save the state and variables related to debugging on each to logical core.</div><div class="ttdef"><b>Definition:</b> Global.h:23</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r_html_a1bc8c0010501f9125b025ecb933380d5"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a1bc8c0010501f9125b025ecb933380d5">_DEBUGGER_READ_AND_WRITE_ON_MSR::CoreNumber</a></div><div class="ttdeci">UINT32 CoreNumber</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:393</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r_html_a38a6cf9e2ea5ef31a1f7e888db6dc649"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a38a6cf9e2ea5ef31a1f7e888db6dc649">_DEBUGGER_READ_AND_WRITE_ON_MSR::ActionType</a></div><div class="ttdeci">DEBUGGER_MSR_ACTION_TYPE ActionType</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:397</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r_html_a3e43511772a5618a6bec9655e8a774d5"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a3e43511772a5618a6bec9655e8a774d5">_DEBUGGER_READ_AND_WRITE_ON_MSR::Msr</a></div><div class="ttdeci">UINT64 Msr</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:392</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r_html_aec2dc73b7eb1f1d455f0399bcb49e929"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#aec2dc73b7eb1f1d455f0399bcb49e929">_DEBUGGER_READ_AND_WRITE_ON_MSR::Value</a></div><div class="ttdeci">UINT64 Value</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:398</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___m_s_r___r_e_a_d___o_r___w_r_i_t_e_html_a3ca94b81f31339286eaa6f27eea5804e"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___m_s_r___r_e_a_d___o_r___w_r_i_t_e.html#a3ca94b81f31339286eaa6f27eea5804e">_PROCESSOR_DEBUGGING_MSR_READ_OR_WRITE::Msr</a></div><div class="ttdeci">UINT64 Msr</div><div class="ttdef"><b>Definition:</b> State.h:24</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___m_s_r___r_e_a_d___o_r___w_r_i_t_e_html_af0a7d72554edcca419674fb5dbf3608d"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___m_s_r___r_e_a_d___o_r___w_r_i_t_e.html#af0a7d72554edcca419674fb5dbf3608d">_PROCESSOR_DEBUGGING_MSR_READ_OR_WRITE::Value</a></div><div class="ttdeci">UINT64 Value</div><div class="ttdef"><b>Definition:</b> State.h:25</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html_a5d5c22183a428958358e19d6434db8a7"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a5d5c22183a428958358e19d6434db8a7">_PROCESSOR_DEBUGGING_STATE::MsrState</a></div><div class="ttdeci">PROCESSOR_DEBUGGING_MSR_READ_OR_WRITE MsrState</div><div class="ttdef"><b>Definition:</b> State.h:113</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_53a6cdbae347618e9ee76d4be5c6ea96.html">hyperdbg</a></li><li class="navelem"><a class="el" href="dir_0f75a8685de99980df6b10136f072ea3.html">hprdbgkd</a></li><li class="navelem"><a class="el" href="dir_a49bef8785c3fd81042e69d2866eb23c.html">header</a></li><li class="navelem"><a class="el" href="dir_c5c32dbaf8d06eb5e35478b4712c2bd5.html">debugger</a></li><li class="navelem"><a class="el" href="dir_f353bd738039477edd8cc44a32311ebb.html">commands</a></li><li class="navelem"><a class="el" href="_debugger_commands_8h.html">DebuggerCommands.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
