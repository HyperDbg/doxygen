<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HyperDbg Debugger: hyperdbg/hprdbghv/code/debugger/user-level/Ud.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HyperDbg Debugger
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_ud_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Ud.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Routines related to user mode debugging.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;pch.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a86574ff4fedfd90b7552bf5d4f8d66a2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_script_engine_eval_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ud_8c.html#a86574ff4fedfd90b7552bf5d4f8d66a2">UdInitializeUserDebugger</a> ()</td></tr>
<tr class="memdesc:a86574ff4fedfd90b7552bf5d4f8d66a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">initialize user debugger  <a href="_ud_8c.html#a86574ff4fedfd90b7552bf5d4f8d66a2">More...</a><br /></td></tr>
<tr class="separator:a86574ff4fedfd90b7552bf5d4f8d66a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c8e27ff0bdd3e135b4e39c7cf7b5805"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_script_engine_eval_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ud_8c.html#a7c8e27ff0bdd3e135b4e39c7cf7b5805">UdUninitializeUserDebugger</a> ()</td></tr>
<tr class="memdesc:a7c8e27ff0bdd3e135b4e39c7cf7b5805"><td class="mdescLeft">&#160;</td><td class="mdescRight">uninitialize user debugger  <a href="_ud_8c.html#a7c8e27ff0bdd3e135b4e39c7cf7b5805">More...</a><br /></td></tr>
<tr class="separator:a7c8e27ff0bdd3e135b4e39c7cf7b5805"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a341566fede69a4d98bc71badd18a4973"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_script_engine_eval_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ud_8c.html#a341566fede69a4d98bc71badd18a4973">UdRestoreToOriginalDirection</a> (<a class="el" href="_thread_holder_8h.html#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a> ThreadDebuggingDetails)</td></tr>
<tr class="memdesc:a341566fede69a4d98bc71badd18a4973"><td class="mdescLeft">&#160;</td><td class="mdescRight">Restore the thread to the original direction.  <a href="_ud_8c.html#a341566fede69a4d98bc71badd18a4973">More...</a><br /></td></tr>
<tr class="separator:a341566fede69a4d98bc71badd18a4973"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85b049cfd213a9037a5d33810dcabb67"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_script_engine_eval_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ud_8c.html#a85b049cfd213a9037a5d33810dcabb67">UdContinueThread</a> (<a class="el" href="_thread_holder_8h.html#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a> ThreadDebuggingDetails)</td></tr>
<tr class="memdesc:a85b049cfd213a9037a5d33810dcabb67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Continue the thread.  <a href="_ud_8c.html#a85b049cfd213a9037a5d33810dcabb67">More...</a><br /></td></tr>
<tr class="separator:a85b049cfd213a9037a5d33810dcabb67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6511ae87f747db8b9448846c7bed8565"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_script_engine_eval_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ud_8c.html#a6511ae87f747db8b9448846c7bed8565">UdStepInstructions</a> (<a class="el" href="_thread_holder_8h.html#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a> ThreadDebuggingDetails, <a class="el" href="_definition_8h.html#a802b099f77f70d5fde80220454df2190">DEBUGGER_REMOTE_STEPPING_REQUEST</a> SteppingType)</td></tr>
<tr class="memdesc:a6511ae87f747db8b9448846c7bed8565"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform stepping though the instructions in target thread.  <a href="_ud_8c.html#a6511ae87f747db8b9448846c7bed8565">More...</a><br /></td></tr>
<tr class="separator:a6511ae87f747db8b9448846c7bed8565"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1952ae25243278fc748ce38a16183410"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_script_engine_eval_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ud_8c.html#a1952ae25243278fc748ce38a16183410">UdPerformCommand</a> (<a class="el" href="_thread_holder_8h.html#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a> ThreadDebuggingDetails, <a class="el" href="_definition_8h.html#a246fe957e8b56ed0c8607f0f4a706d0b">DEBUGGER_UD_COMMAND_ACTION_TYPE</a> UserAction, <a class="el" href="_script_engine_eval_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> OptionalParam1, <a class="el" href="_script_engine_eval_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> OptionalParam2, <a class="el" href="_script_engine_eval_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> OptionalParam3, <a class="el" href="_script_engine_eval_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> OptionalParam4)</td></tr>
<tr class="memdesc:a1952ae25243278fc748ce38a16183410"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform the user-mode commands.  <a href="_ud_8c.html#a1952ae25243278fc748ce38a16183410">More...</a><br /></td></tr>
<tr class="separator:a1952ae25243278fc748ce38a16183410"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe8e59191c78460477ae89d3e9daf751"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_script_engine_eval_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ud_8c.html#afe8e59191c78460477ae89d3e9daf751">UdCheckForCommand</a> ()</td></tr>
<tr class="memdesc:afe8e59191c78460477ae89d3e9daf751"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check for the user-mode commands.  <a href="_ud_8c.html#afe8e59191c78460477ae89d3e9daf751">More...</a><br /></td></tr>
<tr class="separator:afe8e59191c78460477ae89d3e9daf751"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56a511f72fa77e4eadf393c2e0d6dc8f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_script_engine_eval_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ud_8c.html#a56a511f72fa77e4eadf393c2e0d6dc8f">UdDispatchUsermodeCommands</a> (<a class="el" href="_definition_8h.html#a510b3c0106ca6b73316f747e1557baef">PDEBUGGER_UD_COMMAND_PACKET</a> ActionRequest)</td></tr>
<tr class="memdesc:a56a511f72fa77e4eadf393c2e0d6dc8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dispatch the user-mode commands.  <a href="_ud_8c.html#a56a511f72fa77e4eadf393c2e0d6dc8f">More...</a><br /></td></tr>
<tr class="separator:a56a511f72fa77e4eadf393c2e0d6dc8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a382dd16eb179d5548591aa4468ffbc05"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_script_engine_eval_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ud_8c.html#a382dd16eb179d5548591aa4468ffbc05">UdSpinThreadOnNop</a> (<a class="el" href="_thread_holder_8h.html#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a> ThreadDebuggingDetails, <a class="el" href="_attaching_8h.html#ac289d6b25a670c70d1f6a5105788fb04">PUSERMODE_DEBUGGING_PROCESS_DETAILS</a> ProcessDebuggingDetails)</td></tr>
<tr class="memdesc:a382dd16eb179d5548591aa4468ffbc05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Spin on nop sled in user-mode to halt the debuggee.  <a href="_ud_8c.html#a382dd16eb179d5548591aa4468ffbc05">More...</a><br /></td></tr>
<tr class="separator:a382dd16eb179d5548591aa4468ffbc05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a755c47dbcee726d5e92930be5fb0d43f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_script_engine_eval_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ud_8c.html#a755c47dbcee726d5e92930be5fb0d43f">UdHandleAfterSteppingReason</a> (<a class="el" href="_script_engine_eval_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> CurrentCore, <a class="el" href="_thread_holder_8h.html#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a> ThreadDebuggingDetails)</td></tr>
<tr class="memdesc:a755c47dbcee726d5e92930be5fb0d43f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle after we hit the stepping.  <a href="_ud_8c.html#a755c47dbcee726d5e92930be5fb0d43f">More...</a><br /></td></tr>
<tr class="separator:a755c47dbcee726d5e92930be5fb0d43f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae602bce09486942ba7aa76870b609a0b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_script_engine_eval_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ud_8c.html#ae602bce09486942ba7aa76870b609a0b">UdPrePausingReasons</a> (<a class="el" href="_script_engine_eval_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> CurrentCore, <a class="el" href="_thread_holder_8h.html#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a> ThreadDebuggingDetails, <a class="el" href="_definition_8h.html#a2bd4673df5e6e2fb371d770f3f2886d9">PGUEST_REGS</a> GuestRegs, <a class="el" href="_definition_8h.html#ac834b5b60f3a3213636632ea482a26a3">DEBUGGEE_PAUSING_REASON</a> Reason, <a class="el" href="_definition_8h.html#ad502772c412e6f5dd67d557fdc3a4322">PDEBUGGER_TRIGGERED_EVENT_DETAILS</a> EventDetails)</td></tr>
<tr class="memdesc:ae602bce09486942ba7aa76870b609a0b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle special reasons pre-pausings.  <a href="_ud_8c.html#ae602bce09486942ba7aa76870b609a0b">More...</a><br /></td></tr>
<tr class="separator:ae602bce09486942ba7aa76870b609a0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62081a4b5b5063edcc90904360f4d6b2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_script_engine_eval_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ud_8c.html#a62081a4b5b5063edcc90904360f4d6b2">UdCheckAndHandleBreakpointsAndDebugBreaks</a> (<a class="el" href="_script_engine_eval_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> CurrentCore, <a class="el" href="_definition_8h.html#a2bd4673df5e6e2fb371d770f3f2886d9">PGUEST_REGS</a> GuestRegs, <a class="el" href="_definition_8h.html#ac834b5b60f3a3213636632ea482a26a3">DEBUGGEE_PAUSING_REASON</a> Reason, <a class="el" href="_definition_8h.html#ad502772c412e6f5dd67d557fdc3a4322">PDEBUGGER_TRIGGERED_EVENT_DETAILS</a> EventDetails)</td></tr>
<tr class="memdesc:a62081a4b5b5063edcc90904360f4d6b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle #DBs and #BPs for kernel debugger.  <a href="_ud_8c.html#a62081a4b5b5063edcc90904360f4d6b2">More...</a><br /></td></tr>
<tr class="separator:a62081a4b5b5063edcc90904360f4d6b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Routines related to user mode debugging. </p>
<dl class="section author"><dt>Author</dt><dd>Sina Karvandi (<a href="#" onclick="location.href='mai'+'lto:'+'sin'+'a@'+'hyp'+'er'+'dbg'+'.o'+'rg'; return false;">sina@<span style="display: none;">.nosp@m.</span>hype<span style="display: none;">.nosp@m.</span>rdbg.<span style="display: none;">.nosp@m.</span>org</a>)</dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2022-01-06</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>This project is released under the GNU Public License v3. </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a62081a4b5b5063edcc90904360f4d6b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62081a4b5b5063edcc90904360f4d6b2">&#9670;&nbsp;</a></span>UdCheckAndHandleBreakpointsAndDebugBreaks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_script_engine_eval_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> UdCheckAndHandleBreakpointsAndDebugBreaks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_script_engine_eval_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td>
          <td class="paramname"><em>CurrentCore</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_definition_8h.html#a2bd4673df5e6e2fb371d770f3f2886d9">PGUEST_REGS</a>&#160;</td>
          <td class="paramname"><em>GuestRegs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_definition_8h.html#ac834b5b60f3a3213636632ea482a26a3">DEBUGGEE_PAUSING_REASON</a>&#160;</td>
          <td class="paramname"><em>Reason</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_definition_8h.html#ad502772c412e6f5dd67d557fdc3a4322">PDEBUGGER_TRIGGERED_EVENT_DETAILS</a>&#160;</td>
          <td class="paramname"><em>EventDetails</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle #DBs and #BPs for kernel debugger. </p>
<p>This function can be used in vmx-root</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CurrentCore</td><td></td></tr>
    <tr><td class="paramname">GuestRegs</td><td></td></tr>
    <tr><td class="paramname">Reason</td><td></td></tr>
    <tr><td class="paramname">EventDetails</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;{</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <a class="code" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html">DEBUGGEE_UD_PAUSED_PACKET</a>           PausePacket;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <a class="code" href="_script_engine_eval_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a>                               ExitInstructionLength   = 0;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <a class="code" href="_script_engine_eval_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>                              SizeOfSafeBufferToRead  = 0;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    RFLAGS                              Rflags                  = {0};</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <a class="code" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html">PUSERMODE_DEBUGGING_PROCESS_DETAILS</a> ProcessDebuggingDetails = NULL;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <a class="code" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html">PUSERMODE_DEBUGGING_THREAD_DETAILS</a>  ThreadDebuggingDetails  = NULL;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="comment">// Breaking only supported in vmx-root mode, and if user-debugger is</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="comment">// loaded</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="_global_variables_8h.html#ae304ded1a8cbb4e772d97aec7510c9d2">g_UserDebuggerState</a> &amp;&amp; !<a class="code" href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a>[CurrentCore].IsOnVmxRootMode)</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    {</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="_script_engine_eval_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    }</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="comment">// Check entry of paused thread</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    ProcessDebuggingDetails = <a class="code" href="_attaching_8c.html#a733d0f343ddcccaeec221bbbb20483c7">AttachingFindProcessDebuggingDetailsByProcessId</a>(PsGetCurrentProcessId());</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160; </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">if</span> (!ProcessDebuggingDetails)</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    {</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <span class="comment">// Token not found!</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="_script_engine_eval_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    }</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="comment">// Find the thread entry and if not found, create one for it</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    ThreadDebuggingDetails = <a class="code" href="_thread_holder_8c.html#ac752176641e6314d84738f2f323cec68">ThreadHolderFindOrCreateThreadDebuggingDetail</a>(PsGetCurrentThreadId(), ProcessDebuggingDetails);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160; </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="keywordflow">if</span> (!ThreadDebuggingDetails)</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="comment">// Sth went wrong!</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="_script_engine_eval_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="comment">// Set it as active thread debugging</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    ProcessDebuggingDetails-&gt;<a class="code" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#ac7497bb7cd3585fdc424075cae9ff98c">ActiveThreadId</a> = ThreadDebuggingDetails-&gt;<a class="code" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a726606b3498458de98f6cb19e6873df0">ThreadId</a>;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="comment">// Perform the pre-pausing tasks</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <a class="code" href="_ud_8c.html#ae602bce09486942ba7aa76870b609a0b">UdPrePausingReasons</a>(CurrentCore, ThreadDebuggingDetails, GuestRegs, Reason, EventDetails);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="comment">// *** Fill the pausing structure ***</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160; </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    RtlZeroMemory(&amp;PausePacket, <span class="keyword">sizeof</span>(<a class="code" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html">DEBUGGEE_UD_PAUSED_PACKET</a>));</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="comment">// Set the pausing reason</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    PausePacket.<a class="code" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a18f93b90e7be5065db4ca0acf4addfdf">PausingReason</a> = Reason;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="comment">// Set process debugging information</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    PausePacket.<a class="code" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#af634ca2741eb2f229798a1f0fb65511d">ProcessId</a>             = PsGetCurrentProcessId();</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    PausePacket.<a class="code" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#aeff5c8c0b5217e3f98b3d37e408f6283">ThreadId</a>              = PsGetCurrentThreadId();</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    PausePacket.<a class="code" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a8241688f61ab475b180e4686f3685723">ProcessDebuggingToken</a> = ProcessDebuggingDetails-&gt;<a class="code" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aac3f928359d06bdd7572a4bd67c86429">Token</a>;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="comment">// Set the RIP and mode of execution</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    PausePacket.<a class="code" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a3e56574a7c4011c34c087b31cbb75979">Rip</a>     = <a class="code" href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a>[CurrentCore].<a class="code" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#ae855827593a6f9ed1deb258ae3337e57">LastVmexitRip</a>;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    PausePacket.<a class="code" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a7ae9dfd624d3677a5aaf1c13cfb587d8">Is32Bit</a> = <a class="code" href="_kd_8c.html#a814437795a9e923d352b848630625a56">KdIsGuestOnUsermode32Bit</a>();</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160; </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="comment">// Set rflags for finding the results of conditional jumps</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    __vmx_vmread(VMCS_GUEST_RFLAGS, &amp;Rflags);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    PausePacket.<a class="code" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a8ca350c38725c48ba7c30d1e7745c6dc">Rflags</a>.Flags = Rflags.Flags;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="comment">// Set the event tag (if it&#39;s an event)</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keywordflow">if</span> (EventDetails != NULL)</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    {</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        PausePacket.<a class="code" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#abd4a87f9106cc80d3d2a35f418684b86">EventTag</a> = EventDetails-&gt;<a class="code" href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html#a4eed19d8d35fa2c8378db39e95dd9ef2">Tag</a>;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    }</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="comment">// Read the instruction len</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a>[CurrentCore].DebuggingState.InstructionLengthHint != 0)</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    {</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        ExitInstructionLength = <a class="code" href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a>[CurrentCore].<a class="code" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#abeaf053196e625ac00ab12a5dc38c8f1">DebuggingState</a>.<a class="code" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac0735b6e84ce3ae397f74cfd5b4eabb4">InstructionLengthHint</a>;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    }</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    {</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <span class="comment">// Reading instruction length proved to provide wrong results,</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="comment">// so we won&#39;t use it anymore</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <span class="comment">// __vmx_vmread(VMCS_VMEXIT_INSTRUCTION_LENGTH, &amp;ExitInstructionLength);</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        <span class="comment">// Compute the amount of buffer we can read without problem</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        SizeOfSafeBufferToRead = <a class="code" href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a>[CurrentCore].<a class="code" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#ae855827593a6f9ed1deb258ae3337e57">LastVmexitRip</a> &amp; 0xfff;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        SizeOfSafeBufferToRead += <a class="code" href="_definition_8h.html#abc19f528c1665033d9ac7f477a26c608">MAXIMUM_INSTR_SIZE</a>;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <span class="keywordflow">if</span> (SizeOfSafeBufferToRead &gt;= <a class="code" href="hprdbgctrl_2header_2common_8h.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a>)</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            SizeOfSafeBufferToRead = SizeOfSafeBufferToRead - <a class="code" href="hprdbgctrl_2header_2common_8h.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a>;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            SizeOfSafeBufferToRead = <a class="code" href="_definition_8h.html#abc19f528c1665033d9ac7f477a26c608">MAXIMUM_INSTR_SIZE</a> - SizeOfSafeBufferToRead;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        }</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        {</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            SizeOfSafeBufferToRead = <a class="code" href="_definition_8h.html#abc19f528c1665033d9ac7f477a26c608">MAXIMUM_INSTR_SIZE</a>;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        }</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="comment">// Set the length to notify debuggee</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        ExitInstructionLength = SizeOfSafeBufferToRead;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    }</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160; </div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="comment">// Set the reading length of bytes (for instruction disassembling)</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    PausePacket.<a class="code" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a2193543107e5c824870e3c027403db13">ReadInstructionLen</a> = ExitInstructionLength;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="comment">// Find the current instruction</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <a class="code" href="_memory_mapper_8c.html#a4b9c8387e09821a8668975ec6119782e">MemoryMapperReadMemorySafeOnTargetProcess</a>(<a class="code" href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a>[CurrentCore].LastVmexitRip,</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                                              &amp;PausePacket.<a class="code" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#af8522eb09dc5c1d44b3fbf0f2bceda07">InstructionBytesOnRip</a>,</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                                              ExitInstructionLength);</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="comment">// Copy registers to the pause packet</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    RtlCopyMemory(&amp;PausePacket.<a class="code" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a0145af02a2814d6a0272b961169d0356">GuestRegs</a>, GuestRegs, <span class="keyword">sizeof</span>(<a class="code" href="struct_g_u_e_s_t___r_e_g_s.html">GUEST_REGS</a>));</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="comment">// Send the pause packet, along with RIP and an indication</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="comment">// to pause to the user debugger</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <a class="code" href="_logging_8c.html#ad224b6cc6c3e32105f3d53e9eba3810b">LogSendBuffer</a>(<a class="code" href="_definition_8h.html#a7d47482024b99d93c486dabbdbfca6d2">OPERATION_NOTIFICATION_FROM_USER_DEBUGGER_PAUSE</a>,</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                  &amp;PausePacket,</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                  <span class="keyword">sizeof</span>(<a class="code" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html">DEBUGGEE_UD_PAUSED_PACKET</a>),</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                  <a class="code" href="_script_engine_eval_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="comment">// Halt the thread on nop sleds</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <a class="code" href="_ud_8c.html#a382dd16eb179d5548591aa4468ffbc05">UdSpinThreadOnNop</a>(ThreadDebuggingDetails, ProcessDebuggingDetails);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160; </div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="comment">// Everything was okay</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_script_engine_eval_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;}</div>
<div class="ttc" id="a_attaching_8c_html_a733d0f343ddcccaeec221bbbb20483c7"><div class="ttname"><a href="_attaching_8c.html#a733d0f343ddcccaeec221bbbb20483c7">AttachingFindProcessDebuggingDetailsByProcessId</a></div><div class="ttdeci">PUSERMODE_DEBUGGING_PROCESS_DETAILS AttachingFindProcessDebuggingDetailsByProcessId(UINT32 ProcessId)</div><div class="ttdoc">Find user-mode debugging details for threads by process Id.</div><div class="ttdef"><b>Definition:</b> Attaching.c:187</div></div>
<div class="ttc" id="a_definition_8h_html_a7d47482024b99d93c486dabbdbfca6d2"><div class="ttname"><a href="_definition_8h.html#a7d47482024b99d93c486dabbdbfca6d2">OPERATION_NOTIFICATION_FROM_USER_DEBUGGER_PAUSE</a></div><div class="ttdeci">#define OPERATION_NOTIFICATION_FROM_USER_DEBUGGER_PAUSE</div><div class="ttdef"><b>Definition:</b> Definition.h:403</div></div>
<div class="ttc" id="a_definition_8h_html_abc19f528c1665033d9ac7f477a26c608"><div class="ttname"><a href="_definition_8h.html#abc19f528c1665033d9ac7f477a26c608">MAXIMUM_INSTR_SIZE</a></div><div class="ttdeci">#define MAXIMUM_INSTR_SIZE</div><div class="ttdoc">maximum instruction size in intel</div><div class="ttdef"><b>Definition:</b> Definition.h:610</div></div>
<div class="ttc" id="a_global_variables_8h_html_a04bac1f4beef0dcf1ce1a4d9ce72ea76"><div class="ttname"><a href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a></div><div class="ttdeci">VIRTUAL_MACHINE_STATE * g_GuestState</div><div class="ttdoc">Save the state and variables related to each to logical core.</div><div class="ttdef"><b>Definition:</b> GlobalVariables.h:31</div></div>
<div class="ttc" id="a_global_variables_8h_html_ae304ded1a8cbb4e772d97aec7510c9d2"><div class="ttname"><a href="_global_variables_8h.html#ae304ded1a8cbb4e772d97aec7510c9d2">g_UserDebuggerState</a></div><div class="ttdeci">BOOLEAN g_UserDebuggerState</div><div class="ttdoc">shows whether the user debugger is enabled or disabled</div><div class="ttdef"><b>Definition:</b> GlobalVariables.h:124</div></div>
<div class="ttc" id="a_kd_8c_html_a814437795a9e923d352b848630625a56"><div class="ttname"><a href="_kd_8c.html#a814437795a9e923d352b848630625a56">KdIsGuestOnUsermode32Bit</a></div><div class="ttdeci">BOOLEAN KdIsGuestOnUsermode32Bit()</div><div class="ttdoc">determines if the guest was in 32-bit user-mode or 64-bit (long mode)</div><div class="ttdef"><b>Definition:</b> Kd.c:2368</div></div>
<div class="ttc" id="a_logging_8c_html_ad224b6cc6c3e32105f3d53e9eba3810b"><div class="ttname"><a href="_logging_8c.html#ad224b6cc6c3e32105f3d53e9eba3810b">LogSendBuffer</a></div><div class="ttdeci">_Use_decl_annotations_ BOOLEAN LogSendBuffer(UINT32 OperationCode, PVOID Buffer, UINT32 BufferLength, BOOLEAN Priority)</div><div class="ttdoc">Save buffer to the pool.</div><div class="ttdef"><b>Definition:</b> Logging.c:134</div></div>
<div class="ttc" id="a_memory_mapper_8c_html_a4b9c8387e09821a8668975ec6119782e"><div class="ttname"><a href="_memory_mapper_8c.html#a4b9c8387e09821a8668975ec6119782e">MemoryMapperReadMemorySafeOnTargetProcess</a></div><div class="ttdeci">_Use_decl_annotations_ BOOLEAN MemoryMapperReadMemorySafeOnTargetProcess(UINT64 VaAddressToRead, PVOID BufferToSaveMemory, SIZE_T SizeToRead)</div><div class="ttdoc">Read memory safely by mapping the buffer on the target process memory (It's a wrapper)</div><div class="ttdef"><b>Definition:</b> MemoryMapper.c:845</div></div>
<div class="ttc" id="a_script_engine_eval_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="_script_engine_eval_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> ScriptEngineEval.h:103</div></div>
<div class="ttc" id="a_script_engine_eval_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="_script_engine_eval_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> ScriptEngineEval.h:102</div></div>
<div class="ttc" id="a_script_engine_eval_8h_html_aae17ebb9ef7279d026817fb22f8aebe9"><div class="ttname"><a href="_script_engine_eval_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></div><div class="ttdeci">unsigned __int64 UINT64</div><div class="ttdef"><b>Definition:</b> ScriptEngineEval.h:72</div></div>
<div class="ttc" id="a_script_engine_eval_8h_html_af632da489ebc3708ec3ab6791ee53fa4"><div class="ttname"><a href="_script_engine_eval_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a></div><div class="ttdeci">unsigned long ULONG</div><div class="ttdef"><b>Definition:</b> ScriptEngineEval.h:88</div></div>
<div class="ttc" id="a_thread_holder_8c_html_ac752176641e6314d84738f2f323cec68"><div class="ttname"><a href="_thread_holder_8c.html#ac752176641e6314d84738f2f323cec68">ThreadHolderFindOrCreateThreadDebuggingDetail</a></div><div class="ttdeci">PUSERMODE_DEBUGGING_THREAD_DETAILS ThreadHolderFindOrCreateThreadDebuggingDetail(UINT32 ThreadId, PUSERMODE_DEBUGGING_PROCESS_DETAILS ProcessDebuggingDetail)</div><div class="ttdoc">Find or create user-mode debugging details for threads.</div><div class="ttdef"><b>Definition:</b> ThreadHolder.c:257</div></div>
<div class="ttc" id="a_ud_8c_html_a382dd16eb179d5548591aa4468ffbc05"><div class="ttname"><a href="_ud_8c.html#a382dd16eb179d5548591aa4468ffbc05">UdSpinThreadOnNop</a></div><div class="ttdeci">VOID UdSpinThreadOnNop(PUSERMODE_DEBUGGING_THREAD_DETAILS ThreadDebuggingDetails, PUSERMODE_DEBUGGING_PROCESS_DETAILS ProcessDebuggingDetails)</div><div class="ttdoc">Spin on nop sled in user-mode to halt the debuggee.</div><div class="ttdef"><b>Definition:</b> Ud.c:369</div></div>
<div class="ttc" id="a_ud_8c_html_ae602bce09486942ba7aa76870b609a0b"><div class="ttname"><a href="_ud_8c.html#ae602bce09486942ba7aa76870b609a0b">UdPrePausingReasons</a></div><div class="ttdeci">VOID UdPrePausingReasons(UINT32 CurrentCore, PUSERMODE_DEBUGGING_THREAD_DETAILS ThreadDebuggingDetails, PGUEST_REGS GuestRegs, DEBUGGEE_PAUSING_REASON Reason, PDEBUGGER_TRIGGERED_EVENT_DETAILS EventDetails)</div><div class="ttdoc">Handle special reasons pre-pausings.</div><div class="ttdef"><b>Definition:</b> Ud.c:429</div></div>
<div class="ttc" id="ahprdbgctrl_2header_2common_8h_html_a7d467c1d283fdfa1f2081ba1e0d01b6e"><div class="ttname"><a href="hprdbgctrl_2header_2common_8h.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a></div><div class="ttdeci">#define PAGE_SIZE</div><div class="ttdoc">Size of each page (4096 bytes)</div><div class="ttdef"><b>Definition:</b> common.h:59</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html">_DEBUGGEE_UD_PAUSED_PACKET</a></div><div class="ttdoc">The structure of pausing packet in uHyperDbg.</div><div class="ttdef"><b>Definition:</b> Definition.h:2019</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_a0145af02a2814d6a0272b961169d0356"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a0145af02a2814d6a0272b961169d0356">_DEBUGGEE_UD_PAUSED_PACKET::GuestRegs</a></div><div class="ttdeci">GUEST_REGS GuestRegs</div><div class="ttdef"><b>Definition:</b> Definition.h:2030</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_a18f93b90e7be5065db4ca0acf4addfdf"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a18f93b90e7be5065db4ca0acf4addfdf">_DEBUGGEE_UD_PAUSED_PACKET::PausingReason</a></div><div class="ttdeci">DEBUGGEE_PAUSING_REASON PausingReason</div><div class="ttdef"><b>Definition:</b> Definition.h:2023</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_a2193543107e5c824870e3c027403db13"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a2193543107e5c824870e3c027403db13">_DEBUGGEE_UD_PAUSED_PACKET::ReadInstructionLen</a></div><div class="ttdeci">UINT16 ReadInstructionLen</div><div class="ttdef"><b>Definition:</b> Definition.h:2029</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_a3e56574a7c4011c34c087b31cbb75979"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a3e56574a7c4011c34c087b31cbb75979">_DEBUGGEE_UD_PAUSED_PACKET::Rip</a></div><div class="ttdeci">UINT64 Rip</div><div class="ttdef"><b>Definition:</b> Definition.h:2020</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_a7ae9dfd624d3677a5aaf1c13cfb587d8"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a7ae9dfd624d3677a5aaf1c13cfb587d8">_DEBUGGEE_UD_PAUSED_PACKET::Is32Bit</a></div><div class="ttdeci">BOOLEAN Is32Bit</div><div class="ttdef"><b>Definition:</b> Definition.h:2022</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_a8241688f61ab475b180e4686f3685723"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a8241688f61ab475b180e4686f3685723">_DEBUGGEE_UD_PAUSED_PACKET::ProcessDebuggingToken</a></div><div class="ttdeci">UINT64 ProcessDebuggingToken</div><div class="ttdef"><b>Definition:</b> Definition.h:2021</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_a8ca350c38725c48ba7c30d1e7745c6dc"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a8ca350c38725c48ba7c30d1e7745c6dc">_DEBUGGEE_UD_PAUSED_PACKET::Rflags</a></div><div class="ttdeci">RFLAGS Rflags</div><div class="ttdef"><b>Definition:</b> Definition.h:2027</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_abd4a87f9106cc80d3d2a35f418684b86"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#abd4a87f9106cc80d3d2a35f418684b86">_DEBUGGEE_UD_PAUSED_PACKET::EventTag</a></div><div class="ttdeci">UINT64 EventTag</div><div class="ttdef"><b>Definition:</b> Definition.h:2026</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_aeff5c8c0b5217e3f98b3d37e408f6283"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#aeff5c8c0b5217e3f98b3d37e408f6283">_DEBUGGEE_UD_PAUSED_PACKET::ThreadId</a></div><div class="ttdeci">UINT32 ThreadId</div><div class="ttdef"><b>Definition:</b> Definition.h:2025</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_af634ca2741eb2f229798a1f0fb65511d"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#af634ca2741eb2f229798a1f0fb65511d">_DEBUGGEE_UD_PAUSED_PACKET::ProcessId</a></div><div class="ttdeci">UINT32 ProcessId</div><div class="ttdef"><b>Definition:</b> Definition.h:2024</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_af8522eb09dc5c1d44b3fbf0f2bceda07"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#af8522eb09dc5c1d44b3fbf0f2bceda07">_DEBUGGEE_UD_PAUSED_PACKET::InstructionBytesOnRip</a></div><div class="ttdeci">BYTE InstructionBytesOnRip[MAXIMUM_INSTR_SIZE]</div><div class="ttdef"><b>Definition:</b> Definition.h:2028</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s_html_a4eed19d8d35fa2c8378db39e95dd9ef2"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html#a4eed19d8d35fa2c8378db39e95dd9ef2">_DEBUGGER_TRIGGERED_EVENT_DETAILS::Tag</a></div><div class="ttdeci">UINT64 Tag</div><div class="ttdef"><b>Definition:</b> Definition.h:1992</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html_ac0735b6e84ce3ae397f74cfd5b4eabb4"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac0735b6e84ce3ae397f74cfd5b4eabb4">_PROCESSOR_DEBUGGING_STATE::InstructionLengthHint</a></div><div class="ttdeci">UINT16 InstructionLengthHint</div><div class="ttdef"><b>Definition:</b> Debugger.h:151</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s_html"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html">_USERMODE_DEBUGGING_PROCESS_DETAILS</a></div><div class="ttdoc">Description of each active thread in user-mode attaching mechanism.</div><div class="ttdef"><b>Definition:</b> Attaching.h:49</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s_html_aac3f928359d06bdd7572a4bd67c86429"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aac3f928359d06bdd7572a4bd67c86429">_USERMODE_DEBUGGING_PROCESS_DETAILS::Token</a></div><div class="ttdeci">UINT64 Token</div><div class="ttdef"><b>Definition:</b> Attaching.h:50</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s_html_ac7497bb7cd3585fdc424075cae9ff98c"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#ac7497bb7cd3585fdc424075cae9ff98c">_USERMODE_DEBUGGING_PROCESS_DETAILS::ActiveThreadId</a></div><div class="ttdeci">UINT32 ActiveThreadId</div><div class="ttdef"><b>Definition:</b> Attaching.h:53</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s_html"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html">_USERMODE_DEBUGGING_THREAD_DETAILS</a></div><div class="ttdoc">Details of each thread in process.</div><div class="ttdef"><b>Definition:</b> ThreadHolder.h:33</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s_html_a726606b3498458de98f6cb19e6873df0"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a726606b3498458de98f6cb19e6873df0">_USERMODE_DEBUGGING_THREAD_DETAILS::ThreadId</a></div><div class="ttdeci">UINT32 ThreadId</div><div class="ttdef"><b>Definition:</b> ThreadHolder.h:34</div></div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html_abeaf053196e625ac00ab12a5dc38c8f1"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#abeaf053196e625ac00ab12a5dc38c8f1">_VIRTUAL_MACHINE_STATE::DebuggingState</a></div><div class="ttdeci">PROCESSOR_DEBUGGING_STATE DebuggingState</div><div class="ttdef"><b>Definition:</b> Vmx.h:358</div></div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html_ae855827593a6f9ed1deb258ae3337e57"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#ae855827593a6f9ed1deb258ae3337e57">_VIRTUAL_MACHINE_STATE::LastVmexitRip</a></div><div class="ttdeci">UINT64 LastVmexitRip</div><div class="ttdef"><b>Definition:</b> Vmx.h:339</div></div>
<div class="ttc" id="astruct_g_u_e_s_t___r_e_g_s_html"><div class="ttname"><a href="struct_g_u_e_s_t___r_e_g_s.html">GUEST_REGS</a></div><div class="ttdef"><b>Definition:</b> Definition.h:651</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afe8e59191c78460477ae89d3e9daf751"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe8e59191c78460477ae89d3e9daf751">&#9670;&nbsp;</a></span>UdCheckForCommand()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_script_engine_eval_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> UdCheckForCommand </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check for the user-mode commands. </p>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;{</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <a class="code" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html">PUSERMODE_DEBUGGING_THREAD_DETAILS</a> ThreadDebuggingDetails;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    ThreadDebuggingDetails =</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <a class="code" href="_thread_holder_8c.html#aae54fde00233fd8e30b197ab1a64a555">ThreadHolderGetProcessThreadDetailsByProcessIdAndThreadId</a>(PsGetCurrentProcessId(),</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                                                                  PsGetCurrentThreadId());</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">if</span> (!ThreadDebuggingDetails)</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="_script_engine_eval_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">// If we reached here, the current thread is in debugger attached mechanism</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">// now we check whether it&#39;s a regular CPUID or a debugger paused thread CPUID</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">if</span> (!ThreadDebuggingDetails-&gt;<a class="code" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#afcd7f63e2118dbfefdac3e7c79fda7fc">IsPaused</a>)</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="_script_engine_eval_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="comment">// Here, we&#39;re sure that this thread is looking for command, let</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">// see if we find anything</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="_attaching_8h.html#a71a7b969b4769247f9e1c54276f6514f">MAX_USER_ACTIONS_FOR_THREADS</a>; i++)</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keywordflow">if</span> (ThreadDebuggingDetails-&gt;<a class="code" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a0342fbe7f03915834f74d7154874145f">ActionType</a> != <a class="code" href="_definition_8h.html#ad87c3f70d0c62885d9fa07518b5802a1a8d10bc5059f14f2b3d00d7d6edb4182a">DEBUGGER_UD_COMMAND_ACTION_TYPE_NONE</a>)</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            <span class="comment">// Perform the command</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            <a class="code" href="_ud_8c.html#a1952ae25243278fc748ce38a16183410">UdPerformCommand</a>(ThreadDebuggingDetails,</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                             ThreadDebuggingDetails-&gt;<a class="code" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a0342fbe7f03915834f74d7154874145f">ActionType</a>,</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                             ThreadDebuggingDetails-&gt;<a class="code" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a479258f824cfd17a0f610d9bcefce1a1">OptionalParam1</a>,</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                             ThreadDebuggingDetails-&gt;<a class="code" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#ad76de86942302644cd6c27e446bb9b4a">OptionalParam2</a>,</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                             ThreadDebuggingDetails-&gt;<a class="code" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a5bd4a1a8d6a407cf98eb4f84597fa233">OptionalParam3</a>,</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                             ThreadDebuggingDetails-&gt;<a class="code" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a5e2412025f8524952d364840ba658829">OptionalParam4</a>);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            <span class="comment">// Remove the command</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            ThreadDebuggingDetails-&gt;<a class="code" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a479258f824cfd17a0f610d9bcefce1a1">OptionalParam1</a> = NULL;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            ThreadDebuggingDetails-&gt;<a class="code" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#ad76de86942302644cd6c27e446bb9b4a">OptionalParam2</a> = NULL;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            ThreadDebuggingDetails-&gt;<a class="code" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a5bd4a1a8d6a407cf98eb4f84597fa233">OptionalParam3</a> = NULL;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            ThreadDebuggingDetails-&gt;<a class="code" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a5e2412025f8524952d364840ba658829">OptionalParam4</a> = NULL;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            <span class="comment">// At last disable it</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            ThreadDebuggingDetails-&gt;<a class="code" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a0342fbe7f03915834f74d7154874145f">ActionType</a> = <a class="code" href="_definition_8h.html#ad87c3f70d0c62885d9fa07518b5802a1a8d10bc5059f14f2b3d00d7d6edb4182a">DEBUGGER_UD_COMMAND_ACTION_TYPE_NONE</a>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            <span class="comment">// only one command at a time</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="comment">// Won&#39;t change the registers for cpuid</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_script_engine_eval_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;}</div>
<div class="ttc" id="a_attaching_8h_html_a71a7b969b4769247f9e1c54276f6514f"><div class="ttname"><a href="_attaching_8h.html#a71a7b969b4769247f9e1c54276f6514f">MAX_USER_ACTIONS_FOR_THREADS</a></div><div class="ttdeci">#define MAX_USER_ACTIONS_FOR_THREADS</div><div class="ttdoc">Maximum actions in paused threads storage.</div><div class="ttdef"><b>Definition:</b> Attaching.h:22</div></div>
<div class="ttc" id="a_definition_8h_html_ad87c3f70d0c62885d9fa07518b5802a1a8d10bc5059f14f2b3d00d7d6edb4182a"><div class="ttname"><a href="_definition_8h.html#ad87c3f70d0c62885d9fa07518b5802a1a8d10bc5059f14f2b3d00d7d6edb4182a">DEBUGGER_UD_COMMAND_ACTION_TYPE_NONE</a></div><div class="ttdeci">@ DEBUGGER_UD_COMMAND_ACTION_TYPE_NONE</div><div class="ttdef"><b>Definition:</b> Definition.h:2047</div></div>
<div class="ttc" id="a_thread_holder_8c_html_aae54fde00233fd8e30b197ab1a64a555"><div class="ttname"><a href="_thread_holder_8c.html#aae54fde00233fd8e30b197ab1a64a555">ThreadHolderGetProcessThreadDetailsByProcessIdAndThreadId</a></div><div class="ttdeci">PUSERMODE_DEBUGGING_THREAD_DETAILS ThreadHolderGetProcessThreadDetailsByProcessIdAndThreadId(UINT32 ProcessId, UINT32 ThreadId)</div><div class="ttdoc">Find the active threads of the process from process id.</div><div class="ttdef"><b>Definition:</b> ThreadHolder.c:109</div></div>
<div class="ttc" id="a_ud_8c_html_a1952ae25243278fc748ce38a16183410"><div class="ttname"><a href="_ud_8c.html#a1952ae25243278fc748ce38a16183410">UdPerformCommand</a></div><div class="ttdeci">BOOLEAN UdPerformCommand(PUSERMODE_DEBUGGING_THREAD_DETAILS ThreadDebuggingDetails, DEBUGGER_UD_COMMAND_ACTION_TYPE UserAction, UINT64 OptionalParam1, UINT64 OptionalParam2, UINT64 OptionalParam3, UINT64 OptionalParam4)</div><div class="ttdoc">Perform the user-mode commands.</div><div class="ttdef"><b>Definition:</b> Ud.c:206</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n_html_a0342fbe7f03915834f74d7154874145f"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a0342fbe7f03915834f74d7154874145f">_DEBUGGER_UD_COMMAND_ACTION::ActionType</a></div><div class="ttdeci">DEBUGGER_UD_COMMAND_ACTION_TYPE ActionType</div><div class="ttdef"><b>Definition:</b> Definition.h:2060</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n_html_a479258f824cfd17a0f610d9bcefce1a1"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a479258f824cfd17a0f610d9bcefce1a1">_DEBUGGER_UD_COMMAND_ACTION::OptionalParam1</a></div><div class="ttdeci">UINT64 OptionalParam1</div><div class="ttdef"><b>Definition:</b> Definition.h:2061</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n_html_a5bd4a1a8d6a407cf98eb4f84597fa233"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a5bd4a1a8d6a407cf98eb4f84597fa233">_DEBUGGER_UD_COMMAND_ACTION::OptionalParam3</a></div><div class="ttdeci">UINT64 OptionalParam3</div><div class="ttdef"><b>Definition:</b> Definition.h:2063</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n_html_a5e2412025f8524952d364840ba658829"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a5e2412025f8524952d364840ba658829">_DEBUGGER_UD_COMMAND_ACTION::OptionalParam4</a></div><div class="ttdeci">UINT64 OptionalParam4</div><div class="ttdef"><b>Definition:</b> Definition.h:2064</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n_html_ad76de86942302644cd6c27e446bb9b4a"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#ad76de86942302644cd6c27e446bb9b4a">_DEBUGGER_UD_COMMAND_ACTION::OptionalParam2</a></div><div class="ttdeci">UINT64 OptionalParam2</div><div class="ttdef"><b>Definition:</b> Definition.h:2062</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s_html_a9b52613ecdffc1e60ac1ca9e956d1416"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">_USERMODE_DEBUGGING_THREAD_DETAILS::UdAction</a></div><div class="ttdeci">DEBUGGER_UD_COMMAND_ACTION UdAction[MAX_USER_ACTIONS_FOR_THREADS]</div><div class="ttdef"><b>Definition:</b> ThreadHolder.h:38</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s_html_afcd7f63e2118dbfefdac3e7c79fda7fc"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#afcd7f63e2118dbfefdac3e7c79fda7fc">_USERMODE_DEBUGGING_THREAD_DETAILS::IsPaused</a></div><div class="ttdeci">BOOLEAN IsPaused</div><div class="ttdef"><b>Definition:</b> ThreadHolder.h:36</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a85b049cfd213a9037a5d33810dcabb67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85b049cfd213a9037a5d33810dcabb67">&#9670;&nbsp;</a></span>UdContinueThread()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_script_engine_eval_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> UdContinueThread </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_thread_holder_8h.html#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a>&#160;</td>
          <td class="paramname"><em>ThreadDebuggingDetails</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Continue the thread. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ThreadDebuggingDetails</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;{</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">// Configure the RIP and RSP again</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="_ud_8c.html#a341566fede69a4d98bc71badd18a4973">UdRestoreToOriginalDirection</a>(ThreadDebuggingDetails);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">// Continue the current instruction won&#39;t pass it</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a>[KeGetCurrentProcessorNumber()].<a class="code" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#a95be62d62b8c4a2e9bd6bf75a0ba4cd1">IncrementRip</a> = <a class="code" href="_script_engine_eval_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">// It&#39;s not paused anymore!</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    ThreadDebuggingDetails-&gt;<a class="code" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#afcd7f63e2118dbfefdac3e7c79fda7fc">IsPaused</a> = <a class="code" href="_script_engine_eval_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;}</div>
<div class="ttc" id="a_ud_8c_html_a341566fede69a4d98bc71badd18a4973"><div class="ttname"><a href="_ud_8c.html#a341566fede69a4d98bc71badd18a4973">UdRestoreToOriginalDirection</a></div><div class="ttdeci">VOID UdRestoreToOriginalDirection(PUSERMODE_DEBUGGING_THREAD_DETAILS ThreadDebuggingDetails)</div><div class="ttdoc">Restore the thread to the original direction.</div><div class="ttdef"><b>Definition:</b> Ud.c:102</div></div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html_a95be62d62b8c4a2e9bd6bf75a0ba4cd1"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#a95be62d62b8c4a2e9bd6bf75a0ba4cd1">_VIRTUAL_MACHINE_STATE::IncrementRip</a></div><div class="ttdeci">BOOLEAN IncrementRip</div><div class="ttdef"><b>Definition:</b> Vmx.h:334</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a56a511f72fa77e4eadf393c2e0d6dc8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56a511f72fa77e4eadf393c2e0d6dc8f">&#9670;&nbsp;</a></span>UdDispatchUsermodeCommands()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_script_engine_eval_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> UdDispatchUsermodeCommands </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_definition_8h.html#a510b3c0106ca6b73316f747e1557baef">PDEBUGGER_UD_COMMAND_PACKET</a>&#160;</td>
          <td class="paramname"><em>ActionRequest</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dispatch the user-mode commands. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ActionRequest</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;{</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <a class="code" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html">PUSERMODE_DEBUGGING_PROCESS_DETAILS</a> ProcessDebuggingDetails;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">// Find the thread debugging detail of the thread</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    ProcessDebuggingDetails = <a class="code" href="_attaching_8c.html#ab826f65586e0a294b97e505c6affe8b5">AttachingFindProcessDebuggingDetailsByToken</a>(ActionRequest-&gt;<a class="code" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___p_a_c_k_e_t.html#ae384ab33099a5fc4d9d5b3b597ae1b39">ProcessDebuggingDetailToken</a>);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordflow">if</span> (!ProcessDebuggingDetails)</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    {</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="comment">// Token not found!</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="_script_engine_eval_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    }</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">// Based on the documentation, HyperDbg stops intercepting threads</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">// when the debugger sent the first command, but if user presses</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="comment">// CTRL+C again, all the threads (or new threads) that will enter</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">// the user-mode will be intercepted</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">if</span> (ProcessDebuggingDetails-&gt;<a class="code" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#ad3d6574cef84c00d549493d88c62e68f">IsOnThreadInterceptingPhase</a>)</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <a class="code" href="_attaching_8c.html#a7f67611f7474cb9199c0b941fcf82a85">AttachingConfigureInterceptingThreads</a>(ProcessDebuggingDetails-&gt;<a class="code" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aac3f928359d06bdd7572a4bd67c86429">Token</a>, <a class="code" href="_script_engine_eval_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">// Apply the command to all threads or just one thread</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_thread_holder_8c.html#a090fda3da0d1eaee5abdaf2fe8d6079c">ThreadHolderApplyActionToPausedThreads</a>(ProcessDebuggingDetails, ActionRequest);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;}</div>
<div class="ttc" id="a_attaching_8c_html_a7f67611f7474cb9199c0b941fcf82a85"><div class="ttname"><a href="_attaching_8c.html#a7f67611f7474cb9199c0b941fcf82a85">AttachingConfigureInterceptingThreads</a></div><div class="ttdeci">BOOLEAN AttachingConfigureInterceptingThreads(UINT64 ProcessDebuggingToken, BOOLEAN Enable)</div><div class="ttdoc">Enable or disable the thread intercepting phase.</div><div class="ttdef"><b>Definition:</b> Attaching.c:666</div></div>
<div class="ttc" id="a_attaching_8c_html_ab826f65586e0a294b97e505c6affe8b5"><div class="ttname"><a href="_attaching_8c.html#ab826f65586e0a294b97e505c6affe8b5">AttachingFindProcessDebuggingDetailsByToken</a></div><div class="ttdeci">PUSERMODE_DEBUGGING_PROCESS_DETAILS AttachingFindProcessDebuggingDetailsByToken(UINT64 Token)</div><div class="ttdoc">Find user-mode debugging details for threads by token.</div><div class="ttdef"><b>Definition:</b> Attaching.c:164</div></div>
<div class="ttc" id="a_thread_holder_8c_html_a090fda3da0d1eaee5abdaf2fe8d6079c"><div class="ttname"><a href="_thread_holder_8c.html#a090fda3da0d1eaee5abdaf2fe8d6079c">ThreadHolderApplyActionToPausedThreads</a></div><div class="ttdeci">BOOLEAN ThreadHolderApplyActionToPausedThreads(PUSERMODE_DEBUGGING_PROCESS_DETAILS ProcessDebuggingDetails, PDEBUGGER_UD_COMMAND_PACKET ActionRequest)</div><div class="ttdoc">Apply the action of the user debugger to a specific thread or all threads.</div><div class="ttdef"><b>Definition:</b> ThreadHolder.c:364</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___p_a_c_k_e_t_html_ae384ab33099a5fc4d9d5b3b597ae1b39"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___p_a_c_k_e_t.html#ae384ab33099a5fc4d9d5b3b597ae1b39">_DEBUGGER_UD_COMMAND_PACKET::ProcessDebuggingDetailToken</a></div><div class="ttdeci">UINT64 ProcessDebuggingDetailToken</div><div class="ttdef"><b>Definition:</b> Definition.h:2075</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s_html_ad3d6574cef84c00d549493d88c62e68f"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#ad3d6574cef84c00d549493d88c62e68f">_USERMODE_DEBUGGING_PROCESS_DETAILS::IsOnThreadInterceptingPhase</a></div><div class="ttdeci">BOOLEAN IsOnThreadInterceptingPhase</div><div class="ttdef"><b>Definition:</b> Attaching.h:64</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a755c47dbcee726d5e92930be5fb0d43f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a755c47dbcee726d5e92930be5fb0d43f">&#9670;&nbsp;</a></span>UdHandleAfterSteppingReason()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_script_engine_eval_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> UdHandleAfterSteppingReason </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_script_engine_eval_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td>
          <td class="paramname"><em>CurrentCore</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_thread_holder_8h.html#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a>&#160;</td>
          <td class="paramname"><em>ThreadDebuggingDetails</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle after we hit the stepping. </p>
<p>This function can be used in vmx-root</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CurrentCore</td><td></td></tr>
    <tr><td class="paramname">ThreadDebuggingDetails</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;{</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    RFLAGS Rflags = {0};</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="comment">// Unset the trap-flag</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    __vmx_vmread(VMCS_GUEST_RFLAGS, &amp;Rflags);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    Rflags.TrapFlag = <a class="code" href="_script_engine_eval_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    __vmx_vmwrite(VMCS_GUEST_RFLAGS, Rflags.Flags);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="comment">// Rflags&#39; trap flag is not set anymore</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    ThreadDebuggingDetails-&gt;<a class="code" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a3e1d2b7c1b74b95ba2ad6611e0f1cf7d">IsRflagsTrapFlagsSet</a> = <a class="code" href="_script_engine_eval_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;}</div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s_html_a3e1d2b7c1b74b95ba2ad6611e0f1cf7d"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a3e1d2b7c1b74b95ba2ad6611e0f1cf7d">_USERMODE_DEBUGGING_THREAD_DETAILS::IsRflagsTrapFlagsSet</a></div><div class="ttdeci">BOOLEAN IsRflagsTrapFlagsSet</div><div class="ttdef"><b>Definition:</b> ThreadHolder.h:37</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a86574ff4fedfd90b7552bf5d4f8d66a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86574ff4fedfd90b7552bf5d4f8d66a2">&#9670;&nbsp;</a></span>UdInitializeUserDebugger()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_script_engine_eval_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> UdInitializeUserDebugger </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>initialize user debugger </p>
<p>Initialize the user debugger in user mode.</p>
<p>this function should be called on vmx non-root</p>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;{</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="comment">// Check if it&#39;s already initialized or not, we&#39;ll ignore it if it&#39;s</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="comment">// previously initialized</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_global_variables_8h.html#ae304ded1a8cbb4e772d97aec7510c9d2">g_UserDebuggerState</a>)</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="_script_engine_eval_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    }</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="comment">// Check if we have functions we need for attaching mechanism</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_user_access_8h.html#a2e58e91ee1d41c311736e026efcfe134">g_PsGetProcessPeb</a> == NULL || <a class="code" href="_user_access_8h.html#a7e5eee7c3615d4c3a4b2e080eebf3046">g_PsGetProcessWow64Process</a> == NULL || <a class="code" href="_user_access_8h.html#a114772f502575fa8e6ff36c9fab0bf3e">g_ZwQueryInformationProcess</a> == NULL)</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <a class="code" href="hprdbghv_2header_2common_2common_8h.html#a459b19922fecfbb9438dd56b66930d16">LogError</a>(<span class="stringliteral">&quot;Err, unable to find needed functions for user-debugger&quot;</span>);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <span class="comment">// return FALSE;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    }</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">// Start the seed of user-mode debugging thread</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="_global_variables_8h.html#a6cc09230cf7303d0513330bed82491b0">g_SeedOfUserDebuggingDetails</a> = <a class="code" href="_definition_8h.html#a4a9c35cd734dd9a54b542d173e53eeee">DebuggerThreadDebuggingTagStartSeed</a>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">// Initialize the thread debugging details list</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <a class="code" href="list_8h.html#a71fd97aa8bac50a2f3a1d98cf680b2f4">InitializeListHead</a>(&amp;<a class="code" href="_global_variables_8h.html#a3a003d2c59562062fe921cd2754440f7">g_ProcessDebuggingDetailsListHead</a>);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">// Enable vm-exit on Hardware debug exceptions and breakpoints</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="comment">// so, intercept #DBs and #BP by changing exception bitmap (one core)</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="_broadcast_8c.html#a74d9c313b40b008235ca3ca0e40628d3">BroadcastEnableDbAndBpExitingAllCores</a>();</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">// Request to allocate buffers for thread holder of threads</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="_thread_holder_8c.html#a437f8737b54482ae346eb1bcacd672d0">ThreadHolderAllocateThreadHoldingBuffers</a>();</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">// Indicate that the user debugger is active</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="_global_variables_8h.html#ae304ded1a8cbb4e772d97aec7510c9d2">g_UserDebuggerState</a> = <a class="code" href="_script_engine_eval_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_script_engine_eval_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;}</div>
<div class="ttc" id="a_broadcast_8c_html_a74d9c313b40b008235ca3ca0e40628d3"><div class="ttname"><a href="_broadcast_8c.html#a74d9c313b40b008235ca3ca0e40628d3">BroadcastEnableDbAndBpExitingAllCores</a></div><div class="ttdeci">VOID BroadcastEnableDbAndBpExitingAllCores()</div><div class="ttdoc">routines to set vm-exit on all #DBs and #BP on all cores</div><div class="ttdef"><b>Definition:</b> Broadcast.c:35</div></div>
<div class="ttc" id="a_definition_8h_html_a4a9c35cd734dd9a54b542d173e53eeee"><div class="ttname"><a href="_definition_8h.html#a4a9c35cd734dd9a54b542d173e53eeee">DebuggerThreadDebuggingTagStartSeed</a></div><div class="ttdeci">#define DebuggerThreadDebuggingTagStartSeed</div><div class="ttdoc">The seeds that user-mode thread detail token start with it.</div><div class="ttdef"><b>Definition:</b> Definition.h:286</div></div>
<div class="ttc" id="a_global_variables_8h_html_a3a003d2c59562062fe921cd2754440f7"><div class="ttname"><a href="_global_variables_8h.html#a3a003d2c59562062fe921cd2754440f7">g_ProcessDebuggingDetailsListHead</a></div><div class="ttdeci">LIST_ENTRY g_ProcessDebuggingDetailsListHead</div><div class="ttdoc">List header of thread debugging details.</div><div class="ttdef"><b>Definition:</b> GlobalVariables.h:269</div></div>
<div class="ttc" id="a_global_variables_8h_html_a6cc09230cf7303d0513330bed82491b0"><div class="ttname"><a href="_global_variables_8h.html#a6cc09230cf7303d0513330bed82491b0">g_SeedOfUserDebuggingDetails</a></div><div class="ttdeci">UINT64 g_SeedOfUserDebuggingDetails</div><div class="ttdoc">Seed for tokens of unique details buffer for threads.</div><div class="ttdef"><b>Definition:</b> GlobalVariables.h:250</div></div>
<div class="ttc" id="a_thread_holder_8c_html_a437f8737b54482ae346eb1bcacd672d0"><div class="ttname"><a href="_thread_holder_8c.html#a437f8737b54482ae346eb1bcacd672d0">ThreadHolderAllocateThreadHoldingBuffers</a></div><div class="ttdeci">VOID ThreadHolderAllocateThreadHoldingBuffers()</div><div class="ttdoc">Pre allocate buffer for thread holder.</div><div class="ttdef"><b>Definition:</b> ThreadHolder.c:21</div></div>
<div class="ttc" id="a_user_access_8h_html_a114772f502575fa8e6ff36c9fab0bf3e"><div class="ttname"><a href="_user_access_8h.html#a114772f502575fa8e6ff36c9fab0bf3e">g_ZwQueryInformationProcess</a></div><div class="ttdeci">ZwQueryInformationProcess g_ZwQueryInformationProcess</div><div class="ttdoc">Address of ZwQueryInformationProcess.</div><div class="ttdef"><b>Definition:</b> UserAccess.h:187</div></div>
<div class="ttc" id="a_user_access_8h_html_a2e58e91ee1d41c311736e026efcfe134"><div class="ttname"><a href="_user_access_8h.html#a2e58e91ee1d41c311736e026efcfe134">g_PsGetProcessPeb</a></div><div class="ttdeci">PsGetProcessPeb g_PsGetProcessPeb</div><div class="ttdoc">Address of PsGetProcessPeb.</div><div class="ttdef"><b>Definition:</b> UserAccess.h:193</div></div>
<div class="ttc" id="a_user_access_8h_html_a7e5eee7c3615d4c3a4b2e080eebf3046"><div class="ttname"><a href="_user_access_8h.html#a7e5eee7c3615d4c3a4b2e080eebf3046">g_PsGetProcessWow64Process</a></div><div class="ttdeci">PsGetProcessWow64Process g_PsGetProcessWow64Process</div><div class="ttdoc">Address of PsGetProcessWow64Process.</div><div class="ttdef"><b>Definition:</b> UserAccess.h:199</div></div>
<div class="ttc" id="ahprdbghv_2header_2common_2common_8h_html_a459b19922fecfbb9438dd56b66930d16"><div class="ttname"><a href="hprdbghv_2header_2common_2common_8h.html#a459b19922fecfbb9438dd56b66930d16">LogError</a></div><div class="ttdeci">#define LogError(format,...)</div><div class="ttdoc">Log in the case of error.</div><div class="ttdef"><b>Definition:</b> Common.h:442</div></div>
<div class="ttc" id="alist_8h_html_a71fd97aa8bac50a2f3a1d98cf680b2f4"><div class="ttname"><a href="list_8h.html#a71fd97aa8bac50a2f3a1d98cf680b2f4">InitializeListHead</a></div><div class="ttdeci">void InitializeListHead(PLIST_ENTRY ListHead)</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1952ae25243278fc748ce38a16183410"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1952ae25243278fc748ce38a16183410">&#9670;&nbsp;</a></span>UdPerformCommand()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_script_engine_eval_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> UdPerformCommand </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_thread_holder_8h.html#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a>&#160;</td>
          <td class="paramname"><em>ThreadDebuggingDetails</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_definition_8h.html#a246fe957e8b56ed0c8607f0f4a706d0b">DEBUGGER_UD_COMMAND_ACTION_TYPE</a>&#160;</td>
          <td class="paramname"><em>UserAction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_script_engine_eval_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>&#160;</td>
          <td class="paramname"><em>OptionalParam1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_script_engine_eval_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>&#160;</td>
          <td class="paramname"><em>OptionalParam2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_script_engine_eval_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>&#160;</td>
          <td class="paramname"><em>OptionalParam3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_script_engine_eval_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>&#160;</td>
          <td class="paramname"><em>OptionalParam4</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform the user-mode commands. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ThreadDebuggingDetails</td><td></td></tr>
    <tr><td class="paramname">UserAction</td><td></td></tr>
    <tr><td class="paramname">OptionalParam1</td><td></td></tr>
    <tr><td class="paramname">OptionalParam2</td><td></td></tr>
    <tr><td class="paramname">OptionalParam3</td><td></td></tr>
    <tr><td class="paramname">OptionalParam4</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;{</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">// Perform the command</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">switch</span> (UserAction)</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="_definition_8h.html#ad87c3f70d0c62885d9fa07518b5802a1afb4083783dd81d465b89aa4abfdd6b4d">DEBUGGER_UD_COMMAND_ACTION_TYPE_CONTINUE</a>:</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="comment">// Continue the thread normally</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <a class="code" href="_ud_8c.html#a85b049cfd213a9037a5d33810dcabb67">UdContinueThread</a>(ThreadDebuggingDetails);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="_definition_8h.html#ad87c3f70d0c62885d9fa07518b5802a1a9ef67974ab1682d82fbf4feebc05fcde">DEBUGGER_UD_COMMAND_ACTION_TYPE_REGULAR_STEP</a>:</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="comment">// Stepping through the instructions</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <a class="code" href="_ud_8c.html#a6511ae87f747db8b9448846c7bed8565">UdStepInstructions</a>(ThreadDebuggingDetails, (<a class="code" href="_definition_8h.html#a802b099f77f70d5fde80220454df2190">DEBUGGER_REMOTE_STEPPING_REQUEST</a>)OptionalParam1);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="comment">// Invalid user action</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="_script_engine_eval_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_script_engine_eval_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;}</div>
<div class="ttc" id="a_definition_8h_html_a802b099f77f70d5fde80220454df2190"><div class="ttname"><a href="_definition_8h.html#a802b099f77f70d5fde80220454df2190">DEBUGGER_REMOTE_STEPPING_REQUEST</a></div><div class="ttdeci">enum _DEBUGGER_REMOTE_STEPPING_REQUEST DEBUGGER_REMOTE_STEPPING_REQUEST</div><div class="ttdoc">stepping types</div></div>
<div class="ttc" id="a_definition_8h_html_ad87c3f70d0c62885d9fa07518b5802a1a9ef67974ab1682d82fbf4feebc05fcde"><div class="ttname"><a href="_definition_8h.html#ad87c3f70d0c62885d9fa07518b5802a1a9ef67974ab1682d82fbf4feebc05fcde">DEBUGGER_UD_COMMAND_ACTION_TYPE_REGULAR_STEP</a></div><div class="ttdeci">@ DEBUGGER_UD_COMMAND_ACTION_TYPE_REGULAR_STEP</div><div class="ttdef"><b>Definition:</b> Definition.h:2050</div></div>
<div class="ttc" id="a_definition_8h_html_ad87c3f70d0c62885d9fa07518b5802a1afb4083783dd81d465b89aa4abfdd6b4d"><div class="ttname"><a href="_definition_8h.html#ad87c3f70d0c62885d9fa07518b5802a1afb4083783dd81d465b89aa4abfdd6b4d">DEBUGGER_UD_COMMAND_ACTION_TYPE_CONTINUE</a></div><div class="ttdeci">@ DEBUGGER_UD_COMMAND_ACTION_TYPE_CONTINUE</div><div class="ttdef"><b>Definition:</b> Definition.h:2049</div></div>
<div class="ttc" id="a_ud_8c_html_a6511ae87f747db8b9448846c7bed8565"><div class="ttname"><a href="_ud_8c.html#a6511ae87f747db8b9448846c7bed8565">UdStepInstructions</a></div><div class="ttdeci">VOID UdStepInstructions(PUSERMODE_DEBUGGING_THREAD_DETAILS ThreadDebuggingDetails, DEBUGGER_REMOTE_STEPPING_REQUEST SteppingType)</div><div class="ttdoc">Perform stepping though the instructions in target thread.</div><div class="ttdef"><b>Definition:</b> Ud.c:144</div></div>
<div class="ttc" id="a_ud_8c_html_a85b049cfd213a9037a5d33810dcabb67"><div class="ttname"><a href="_ud_8c.html#a85b049cfd213a9037a5d33810dcabb67">UdContinueThread</a></div><div class="ttdeci">VOID UdContinueThread(PUSERMODE_DEBUGGING_THREAD_DETAILS ThreadDebuggingDetails)</div><div class="ttdoc">Continue the thread.</div><div class="ttdef"><b>Definition:</b> Ud.c:118</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae602bce09486942ba7aa76870b609a0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae602bce09486942ba7aa76870b609a0b">&#9670;&nbsp;</a></span>UdPrePausingReasons()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_script_engine_eval_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> UdPrePausingReasons </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_script_engine_eval_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td>
          <td class="paramname"><em>CurrentCore</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_thread_holder_8h.html#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a>&#160;</td>
          <td class="paramname"><em>ThreadDebuggingDetails</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_definition_8h.html#a2bd4673df5e6e2fb371d770f3f2886d9">PGUEST_REGS</a>&#160;</td>
          <td class="paramname"><em>GuestRegs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_definition_8h.html#ac834b5b60f3a3213636632ea482a26a3">DEBUGGEE_PAUSING_REASON</a>&#160;</td>
          <td class="paramname"><em>Reason</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_definition_8h.html#ad502772c412e6f5dd67d557fdc3a4322">PDEBUGGER_TRIGGERED_EVENT_DETAILS</a>&#160;</td>
          <td class="paramname"><em>EventDetails</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle special reasons pre-pausings. </p>
<p>This function can be used in vmx-root</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CurrentCore</td><td></td></tr>
    <tr><td class="paramname">ThreadDebuggingDetails</td><td></td></tr>
    <tr><td class="paramname">GuestRegs</td><td></td></tr>
    <tr><td class="paramname">Reason</td><td></td></tr>
    <tr><td class="paramname">EventDetails</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;{</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="comment">// *** Handle events before pausing ***</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordflow">switch</span> (Reason)</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="_definition_8h.html#a6e2be89205e735ebae644cf4850ac21ba369b24d73385054023d8aba1a5d3c8b5">DEBUGGEE_PAUSING_REASON_DEBUGGEE_GENERAL_DEBUG_BREAK</a>:</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <span class="keywordflow">if</span> (ThreadDebuggingDetails-&gt;<a class="code" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a3e1d2b7c1b74b95ba2ad6611e0f1cf7d">IsRflagsTrapFlagsSet</a>)</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            <a class="code" href="_ud_8c.html#a755c47dbcee726d5e92930be5fb0d43f">UdHandleAfterSteppingReason</a>(CurrentCore, ThreadDebuggingDetails);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    }</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;}</div>
<div class="ttc" id="a_definition_8h_html_a6e2be89205e735ebae644cf4850ac21ba369b24d73385054023d8aba1a5d3c8b5"><div class="ttname"><a href="_definition_8h.html#a6e2be89205e735ebae644cf4850ac21ba369b24d73385054023d8aba1a5d3c8b5">DEBUGGEE_PAUSING_REASON_DEBUGGEE_GENERAL_DEBUG_BREAK</a></div><div class="ttdeci">@ DEBUGGEE_PAUSING_REASON_DEBUGGEE_GENERAL_DEBUG_BREAK</div><div class="ttdef"><b>Definition:</b> Definition.h:925</div></div>
<div class="ttc" id="a_ud_8c_html_a755c47dbcee726d5e92930be5fb0d43f"><div class="ttname"><a href="_ud_8c.html#a755c47dbcee726d5e92930be5fb0d43f">UdHandleAfterSteppingReason</a></div><div class="ttdeci">VOID UdHandleAfterSteppingReason(UINT32 CurrentCore, PUSERMODE_DEBUGGING_THREAD_DETAILS ThreadDebuggingDetails)</div><div class="ttdoc">Handle after we hit the stepping.</div><div class="ttdef"><b>Definition:</b> Ud.c:397</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a341566fede69a4d98bc71badd18a4973"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a341566fede69a4d98bc71badd18a4973">&#9670;&nbsp;</a></span>UdRestoreToOriginalDirection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_script_engine_eval_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> UdRestoreToOriginalDirection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_thread_holder_8h.html#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a>&#160;</td>
          <td class="paramname"><em>ThreadDebuggingDetails</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Restore the thread to the original direction. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ThreadDebuggingDetails</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;{</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// Configure the RIP again</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    __vmx_vmwrite(VMCS_GUEST_RIP, ThreadDebuggingDetails-&gt;<a class="code" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a174db30b0f4e22cefa4a26c91c903e41">ThreadRip</a>);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;}</div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s_html_a174db30b0f4e22cefa4a26c91c903e41"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a174db30b0f4e22cefa4a26c91c903e41">_USERMODE_DEBUGGING_THREAD_DETAILS::ThreadRip</a></div><div class="ttdeci">UINT64 ThreadRip</div><div class="ttdef"><b>Definition:</b> ThreadHolder.h:35</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a382dd16eb179d5548591aa4468ffbc05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a382dd16eb179d5548591aa4468ffbc05">&#9670;&nbsp;</a></span>UdSpinThreadOnNop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_script_engine_eval_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> UdSpinThreadOnNop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_thread_holder_8h.html#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a>&#160;</td>
          <td class="paramname"><em>ThreadDebuggingDetails</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_attaching_8h.html#ac289d6b25a670c70d1f6a5105788fb04">PUSERMODE_DEBUGGING_PROCESS_DETAILS</a>&#160;</td>
          <td class="paramname"><em>ProcessDebuggingDetails</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Spin on nop sled in user-mode to halt the debuggee. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ThreadDebuggingDetails</td><td></td></tr>
    <tr><td class="paramname">ProcessDebuggingDetails</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;{</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment">// Save the RIP for future return</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    __vmx_vmread(VMCS_GUEST_RIP, &amp;ThreadDebuggingDetails-&gt;<a class="code" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a174db30b0f4e22cefa4a26c91c903e41">ThreadRip</a>);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="comment">// Set the rip to new spinning address</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    __vmx_vmwrite(VMCS_GUEST_RIP, ProcessDebuggingDetails-&gt;<a class="code" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#ac2d3522e9585dce69980ff651c53cb1d">UsermodeReservedBuffer</a>);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="comment">// Indicate that it&#39;s spinning</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    ThreadDebuggingDetails-&gt;<a class="code" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#afcd7f63e2118dbfefdac3e7c79fda7fc">IsPaused</a> = <a class="code" href="_script_engine_eval_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;}</div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s_html_ac2d3522e9585dce69980ff651c53cb1d"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#ac2d3522e9585dce69980ff651c53cb1d">_USERMODE_DEBUGGING_PROCESS_DETAILS::UsermodeReservedBuffer</a></div><div class="ttdeci">UINT64 UsermodeReservedBuffer</div><div class="ttdef"><b>Definition:</b> Attaching.h:57</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6511ae87f747db8b9448846c7bed8565"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6511ae87f747db8b9448846c7bed8565">&#9670;&nbsp;</a></span>UdStepInstructions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_script_engine_eval_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> UdStepInstructions </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_thread_holder_8h.html#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a>&#160;</td>
          <td class="paramname"><em>ThreadDebuggingDetails</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_definition_8h.html#a802b099f77f70d5fde80220454df2190">DEBUGGER_REMOTE_STEPPING_REQUEST</a>&#160;</td>
          <td class="paramname"><em>SteppingType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform stepping though the instructions in target thread. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ThreadDebuggingDetails</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;{</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    RFLAGS Rflags = {0};</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">// Configure the RIP</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <a class="code" href="_ud_8c.html#a341566fede69a4d98bc71badd18a4973">UdRestoreToOriginalDirection</a>(ThreadDebuggingDetails);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">switch</span> (SteppingType)</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="_definition_8h.html#a712ecf490a024ef4e89274a9075b3d5ba65fd7f83ac0cea94ffc166049c18fffe">DEBUGGER_REMOTE_STEPPING_REQUEST_STEP_IN</a>:</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="comment">// Set the trap-flag</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        __vmx_vmread(VMCS_GUEST_RFLAGS, &amp;Rflags);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        Rflags.TrapFlag = <a class="code" href="_script_engine_eval_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        __vmx_vmwrite(VMCS_GUEST_RFLAGS, Rflags.Flags);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="comment">// Rflags&#39; trap flag is set</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        ThreadDebuggingDetails-&gt;<a class="code" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a3e1d2b7c1b74b95ba2ad6611e0f1cf7d">IsRflagsTrapFlagsSet</a> = <a class="code" href="_script_engine_eval_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="_definition_8h.html#a712ecf490a024ef4e89274a9075b3d5ba981ecc65ffc870c95bc3c9ebb638f315">DEBUGGER_REMOTE_STEPPING_REQUEST_STEP_OVER</a>:</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">// Continue the current instruction won&#39;t pass it</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a>[KeGetCurrentProcessorNumber()].<a class="code" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#a95be62d62b8c4a2e9bd6bf75a0ba4cd1">IncrementRip</a> = <a class="code" href="_script_engine_eval_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">// It&#39;s not paused anymore!</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    ThreadDebuggingDetails-&gt;<a class="code" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#afcd7f63e2118dbfefdac3e7c79fda7fc">IsPaused</a> = <a class="code" href="_script_engine_eval_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;}</div>
<div class="ttc" id="a_definition_8h_html_a712ecf490a024ef4e89274a9075b3d5ba65fd7f83ac0cea94ffc166049c18fffe"><div class="ttname"><a href="_definition_8h.html#a712ecf490a024ef4e89274a9075b3d5ba65fd7f83ac0cea94ffc166049c18fffe">DEBUGGER_REMOTE_STEPPING_REQUEST_STEP_IN</a></div><div class="ttdeci">@ DEBUGGER_REMOTE_STEPPING_REQUEST_STEP_IN</div><div class="ttdef"><b>Definition:</b> Definition.h:2187</div></div>
<div class="ttc" id="a_definition_8h_html_a712ecf490a024ef4e89274a9075b3d5ba981ecc65ffc870c95bc3c9ebb638f315"><div class="ttname"><a href="_definition_8h.html#a712ecf490a024ef4e89274a9075b3d5ba981ecc65ffc870c95bc3c9ebb638f315">DEBUGGER_REMOTE_STEPPING_REQUEST_STEP_OVER</a></div><div class="ttdeci">@ DEBUGGER_REMOTE_STEPPING_REQUEST_STEP_OVER</div><div class="ttdef"><b>Definition:</b> Definition.h:2186</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c8e27ff0bdd3e135b4e39c7cf7b5805"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c8e27ff0bdd3e135b4e39c7cf7b5805">&#9670;&nbsp;</a></span>UdUninitializeUserDebugger()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_script_engine_eval_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> UdUninitializeUserDebugger </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>uninitialize user debugger </p>
<p>Uninitialize the user debugger in user mode.</p>
<p>this function should be called on vmx non-root</p>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;{</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_global_variables_8h.html#ae304ded1a8cbb4e772d97aec7510c9d2">g_UserDebuggerState</a>)</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="comment">// Indicate that the user debugger is not active</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <a class="code" href="_global_variables_8h.html#ae304ded1a8cbb4e772d97aec7510c9d2">g_UserDebuggerState</a> = <a class="code" href="_script_engine_eval_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="comment">// Free and deallocate all the buffers (pools) relating to</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="comment">// thread debugging details</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <a class="code" href="_attaching_8c.html#ad16b106f9f7b6a857bafc12252bcfadd">AttachingRemoveAndFreeAllProcessDebuggingDetails</a>();</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;}</div>
<div class="ttc" id="a_attaching_8c_html_ad16b106f9f7b6a857bafc12252bcfadd"><div class="ttname"><a href="_attaching_8c.html#ad16b106f9f7b6a857bafc12252bcfadd">AttachingRemoveAndFreeAllProcessDebuggingDetails</a></div><div class="ttdeci">VOID AttachingRemoveAndFreeAllProcessDebuggingDetails()</div><div class="ttdoc">Remove and deallocate all thread debuggig details.</div><div class="ttdef"><b>Definition:</b> Attaching.c:229</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_53a6cdbae347618e9ee76d4be5c6ea96.html">hyperdbg</a></li><li class="navelem"><a class="el" href="dir_19054a674c4bd5cb8fceb6542228579c.html">hprdbghv</a></li><li class="navelem"><a class="el" href="dir_aac0c9299474d8b4035e61d55763e72a.html">code</a></li><li class="navelem"><a class="el" href="dir_e2f4eefc971f71d3c579835f2ac940cc.html">debugger</a></li><li class="navelem"><a class="el" href="dir_fc6a8a5e117c1faa0c3a643d94870144.html">user-level</a></li><li class="navelem"><a class="el" href="_ud_8c.html">Ud.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
