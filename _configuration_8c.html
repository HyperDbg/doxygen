<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HyperDbg Debugger: hyperdbg/hprdbghv/code/interface/Configuration.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">HyperDbg Debugger
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('_configuration_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Configuration.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Configuration interface for hypervisor events.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;pch.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab3a6af0209221a2a25ae9201fc60f1cf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_configuration_8c.html#ab3a6af0209221a2a25ae9201fc60f1cf">ConfigureEnableMovToCr3ExitingOnAllProcessors</a> ()</td></tr>
<tr class="memdesc:ab3a6af0209221a2a25ae9201fc60f1cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">routines for debugging threads (enable mov-to-cr3 exiting)  <br /></td></tr>
<tr class="separator:ab3a6af0209221a2a25ae9201fc60f1cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e09280f251f18f09a751111968c2d7c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_configuration_8c.html#a2e09280f251f18f09a751111968c2d7c">ConfigureInitializeReversingMachineOnAllProcessors</a> (<a class="el" href="_request_structures_8h.html#a91c6221d89d110c3a9ebc2fac4ae3e2d">PREVERSING_MACHINE_RECONSTRUCT_MEMORY_REQUEST</a> RevServiceRequest)</td></tr>
<tr class="memdesc:a2e09280f251f18f09a751111968c2d7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">routines for initializing Mode-based execution hooks  <br /></td></tr>
<tr class="separator:a2e09280f251f18f09a751111968c2d7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0e72ac48176ecf52fe48443a9903593"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_configuration_8c.html#ac0e72ac48176ecf52fe48443a9903593">ConfigureModeBasedExecHookUninitializeOnAllProcessors</a> ()</td></tr>
<tr class="memdesc:ac0e72ac48176ecf52fe48443a9903593"><td class="mdescLeft">&#160;</td><td class="mdescRight">routines for initializing Mode-based execution hooks  <br /></td></tr>
<tr class="separator:ac0e72ac48176ecf52fe48443a9903593"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87af14fc672b4f22dd8bf9aa06133bfe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_configuration_8c.html#a87af14fc672b4f22dd8bf9aa06133bfe">ConfigureDirtyLoggingInitializeOnAllProcessors</a> ()</td></tr>
<tr class="memdesc:a87af14fc672b4f22dd8bf9aa06133bfe"><td class="mdescLeft">&#160;</td><td class="mdescRight">routines for initializing dirty logging mechanism  <br /></td></tr>
<tr class="separator:a87af14fc672b4f22dd8bf9aa06133bfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a4d4056b23b71fe99f68da92ec7a4ea"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_configuration_8c.html#a5a4d4056b23b71fe99f68da92ec7a4ea">ConfigureDirtyLoggingUninitializeOnAllProcessors</a> ()</td></tr>
<tr class="memdesc:a5a4d4056b23b71fe99f68da92ec7a4ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">routines for uninitializing dirty logging mechanism  <br /></td></tr>
<tr class="separator:a5a4d4056b23b71fe99f68da92ec7a4ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5c7fc6c4f8d88ccb2fe6308242bf56b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_configuration_8c.html#aa5c7fc6c4f8d88ccb2fe6308242bf56b">ConfigureDisableMovToCr3ExitingOnAllProcessors</a> ()</td></tr>
<tr class="memdesc:aa5c7fc6c4f8d88ccb2fe6308242bf56b"><td class="mdescLeft">&#160;</td><td class="mdescRight">routines for debugging threads (disable mov-to-cr3 exiting)  <br /></td></tr>
<tr class="separator:aa5c7fc6c4f8d88ccb2fe6308242bf56b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65911e5480e9bbf690530f95257ba177"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_configuration_8c.html#a65911e5480e9bbf690530f95257ba177">ConfigureEnableEferSyscallEventsOnAllProcessors</a> (<a class="el" href="include_2_s_d_k_2_headers_2_events_8h.html#ad59706f68fe9056c1b7f4c7ee5b809ab">DEBUGGER_EVENT_SYSCALL_SYSRET_TYPE</a> SyscallHookType)</td></tr>
<tr class="memdesc:a65911e5480e9bbf690530f95257ba177"><td class="mdescLeft">&#160;</td><td class="mdescRight">routines for enabling syscall hooks on all cores  <br /></td></tr>
<tr class="separator:a65911e5480e9bbf690530f95257ba177"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c34667ae652718d0b8a15a84e6ccc7f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_configuration_8c.html#a9c34667ae652718d0b8a15a84e6ccc7f">ConfigureDisableEferSyscallEventsOnAllProcessors</a> ()</td></tr>
<tr class="memdesc:a9c34667ae652718d0b8a15a84e6ccc7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">routines for disabling syscall hooks on all cores  <br /></td></tr>
<tr class="separator:a9c34667ae652718d0b8a15a84e6ccc7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6129e5f85312a405e0509e2c45351bf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_configuration_8c.html#ad6129e5f85312a405e0509e2c45351bf">ConfigureEptHookUnHookSingleAddress</a> (<a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> VirtualAddress, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> PhysAddress, <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> ProcessId)</td></tr>
<tr class="memdesc:ad6129e5f85312a405e0509e2c45351bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove single hook from the hooked pages list and invalidate TLB.  <br /></td></tr>
<tr class="separator:ad6129e5f85312a405e0509e2c45351bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa62d4e17a65f5e1024f37e3c2bf0b38"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_configuration_8c.html#aaa62d4e17a65f5e1024f37e3c2bf0b38">ConfigureEptHook</a> (PVOID TargetAddress, <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> ProcessId)</td></tr>
<tr class="memdesc:aaa62d4e17a65f5e1024f37e3c2bf0b38"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allocates a buffer in VMX Non Root Mode and then invokes a VMCALL to set the hook.  <br /></td></tr>
<tr class="separator:aaa62d4e17a65f5e1024f37e3c2bf0b38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3fe6525bba079418c58fec08c2add0f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_configuration_8c.html#af3fe6525bba079418c58fec08c2add0f">ConfigureEptHook2</a> (PVOID TargetAddress, PVOID HookFunction, <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> ProcessId, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> SetHookForRead, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> SetHookForWrite, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> SetHookForExec, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> EptHiddenHook2)</td></tr>
<tr class="memdesc:af3fe6525bba079418c58fec08c2add0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allocates a buffer in VMX Non Root Mode and then invokes a VMCALL to set the hook.  <br /></td></tr>
<tr class="separator:af3fe6525bba079418c58fec08c2add0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae487c6cde6eab0c8b5c934900e02f77"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_configuration_8c.html#aae487c6cde6eab0c8b5c934900e02f77">ConfigureEptHookModifyInstructionFetchState</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> CoreId, PVOID PhysicalAddress, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> IsUnset)</td></tr>
<tr class="memdesc:aae487c6cde6eab0c8b5c934900e02f77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Change PML EPT state for execution (execute) @detail should be called from VMX-root.  <br /></td></tr>
<tr class="separator:aae487c6cde6eab0c8b5c934900e02f77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3273428c5505c7af8a08a2319c8e688"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_configuration_8c.html#af3273428c5505c7af8a08a2319c8e688">ConfigureEptHookModifyPageReadState</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> CoreId, PVOID PhysicalAddress, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> IsUnset)</td></tr>
<tr class="memdesc:af3273428c5505c7af8a08a2319c8e688"><td class="mdescLeft">&#160;</td><td class="mdescRight">Change PML EPT state for read @detail should be called from VMX-root.  <br /></td></tr>
<tr class="separator:af3273428c5505c7af8a08a2319c8e688"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a701db01cdd2fb70134e209fe80d23236"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_configuration_8c.html#a701db01cdd2fb70134e209fe80d23236">ConfigureEptHookModifyPageWriteState</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> CoreId, PVOID PhysicalAddress, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> IsUnset)</td></tr>
<tr class="memdesc:a701db01cdd2fb70134e209fe80d23236"><td class="mdescLeft">&#160;</td><td class="mdescRight">Change PML EPT state for write @detail should be called from VMX-root.  <br /></td></tr>
<tr class="separator:a701db01cdd2fb70134e209fe80d23236"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53fec80da84381073b54556a6cabc098"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_configuration_8c.html#a53fec80da84381073b54556a6cabc098">ConfigureEnableEferSyscallHookOnSingleCore</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> TargetCoreId, <a class="el" href="include_2_s_d_k_2_headers_2_events_8h.html#ad59706f68fe9056c1b7f4c7ee5b809ab">DEBUGGER_EVENT_SYSCALL_SYSRET_TYPE</a> SyscallHookType)</td></tr>
<tr class="memdesc:a53fec80da84381073b54556a6cabc098"><td class="mdescLeft">&#160;</td><td class="mdescRight">routines for enabling EFER syscall hooks on a single core  <br /></td></tr>
<tr class="separator:a53fec80da84381073b54556a6cabc098"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8cefdf192b6214caca28a2d3472dabe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_configuration_8c.html#aa8cefdf192b6214caca28a2d3472dabe">ConfigureSetExternalInterruptExitingOnSingleCore</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> TargetCoreId)</td></tr>
<tr class="memdesc:aa8cefdf192b6214caca28a2d3472dabe"><td class="mdescLeft">&#160;</td><td class="mdescRight">set external interrupt exiting on a single core  <br /></td></tr>
<tr class="separator:aa8cefdf192b6214caca28a2d3472dabe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a736c9678fb16d3340e7b963ce779d85e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_configuration_8c.html#a736c9678fb16d3340e7b963ce779d85e">ConfigureEnableRdtscExitingOnSingleCore</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> TargetCoreId)</td></tr>
<tr class="memdesc:a736c9678fb16d3340e7b963ce779d85e"><td class="mdescLeft">&#160;</td><td class="mdescRight">enable RDTSC exiting on a single core  <br /></td></tr>
<tr class="separator:a736c9678fb16d3340e7b963ce779d85e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40d05c72969eddee7308d4fd44522c34"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_configuration_8c.html#a40d05c72969eddee7308d4fd44522c34">ConfigureEnableRdpmcExitingOnSingleCore</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> TargetCoreId)</td></tr>
<tr class="memdesc:a40d05c72969eddee7308d4fd44522c34"><td class="mdescLeft">&#160;</td><td class="mdescRight">enable RDPMC exiting on a single core  <br /></td></tr>
<tr class="separator:a40d05c72969eddee7308d4fd44522c34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a528c7a4faebda601e8f256629cd8c324"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_configuration_8c.html#a528c7a4faebda601e8f256629cd8c324">ConfigureEnableMovToDebugRegistersExitingOnSingleCore</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> TargetCoreId)</td></tr>
<tr class="memdesc:a528c7a4faebda601e8f256629cd8c324"><td class="mdescLeft">&#160;</td><td class="mdescRight">enable mov 2 debug register exiting on a single core  <br /></td></tr>
<tr class="separator:a528c7a4faebda601e8f256629cd8c324"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1440df6523c738461133801841828def"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_configuration_8c.html#a1440df6523c738461133801841828def">ConfigureSetExceptionBitmapOnSingleCore</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> TargetCoreId, <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> BitMask)</td></tr>
<tr class="memdesc:a1440df6523c738461133801841828def"><td class="mdescLeft">&#160;</td><td class="mdescRight">set exception bitmap on a single core  <br /></td></tr>
<tr class="separator:a1440df6523c738461133801841828def"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc3e70af1e14446938eaa3d81bb41c6b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_configuration_8c.html#afc3e70af1e14446938eaa3d81bb41c6b">ConfigureEnableMovToControlRegisterExitingOnSingleCore</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> TargetCoreId, <a class="el" href="include_2_s_d_k_2_headers_2_events_8h.html#a51fdcbd4a691fb1defc309f977dc4ad8">DEBUGGER_BROADCASTING_OPTIONS</a> *BroadcastingOption)</td></tr>
<tr class="memdesc:afc3e70af1e14446938eaa3d81bb41c6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">enable mov 2 control register on a single core  <br /></td></tr>
<tr class="separator:afc3e70af1e14446938eaa3d81bb41c6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85d8b0bc91e6f1a0013eb07af520504f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_configuration_8c.html#a85d8b0bc91e6f1a0013eb07af520504f">ConfigureChangeMsrBitmapWriteOnSingleCore</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> TargetCoreId, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> MsrMask)</td></tr>
<tr class="memdesc:a85d8b0bc91e6f1a0013eb07af520504f"><td class="mdescLeft">&#160;</td><td class="mdescRight">change the mask of msr bitmaps for write on a single core  <br /></td></tr>
<tr class="separator:a85d8b0bc91e6f1a0013eb07af520504f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae43ea56fe71188fc168438908e6f4d1e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_configuration_8c.html#ae43ea56fe71188fc168438908e6f4d1e">ConfigureChangeMsrBitmapReadOnSingleCore</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> TargetCoreId, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> MsrMask)</td></tr>
<tr class="memdesc:ae43ea56fe71188fc168438908e6f4d1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">change the mask of msr bitmaps for read on a single core  <br /></td></tr>
<tr class="separator:ae43ea56fe71188fc168438908e6f4d1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80befb4c3f298c82e7ff79d4a219fc11"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_configuration_8c.html#a80befb4c3f298c82e7ff79d4a219fc11">ConfigureChangeIoBitmapOnSingleCore</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> TargetCoreId, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> Port)</td></tr>
<tr class="memdesc:a80befb4c3f298c82e7ff79d4a219fc11"><td class="mdescLeft">&#160;</td><td class="mdescRight">change I/O port bitmap on a single core  <br /></td></tr>
<tr class="separator:a80befb4c3f298c82e7ff79d4a219fc11"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Configuration interface for hypervisor events. </p>
<dl class="section author"><dt>Author</dt><dd>Sina Karvandi (<a href="#" onclick="location.href='mai'+'lto:'+'sin'+'a@'+'hyp'+'er'+'dbg'+'.o'+'rg'; return false;">sina@<span class="obfuscator">.nosp@m.</span>hype<span class="obfuscator">.nosp@m.</span>rdbg.<span class="obfuscator">.nosp@m.</span>org</a>)</dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.2 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2023-01-26</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>This project is released under the GNU Public License v3. </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a80befb4c3f298c82e7ff79d4a219fc11" name="a80befb4c3f298c82e7ff79d4a219fc11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80befb4c3f298c82e7ff79d4a219fc11">&#9670;&#160;</a></span>ConfigureChangeIoBitmapOnSingleCore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureChangeIoBitmapOnSingleCore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td>
          <td class="paramname"><em>TargetCoreId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>&#160;</td>
          <td class="paramname"><em>Port</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>change I/O port bitmap on a single core </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TargetCoreId</td><td>The target core's ID (to just run on this core) </td></tr>
    <tr><td class="paramname">Port</td><td>Target port in I/O bitmap</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  383</span>{</div>
<div class="line"><span class="lineno">  384</span>    <a class="code hl_function" href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#a860d1d5fbe8605d03eda7327935c799e">DpcRoutineRunTaskOnSingleCore</a>(TargetCoreId, <a class="code hl_function" href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#a4ce952e8ebd61cde6d6dcc118fb77541">DpcRoutinePerformChangeIoBitmapOnSingleCore</a>, Port);</div>
<div class="line"><span class="lineno">  385</span>}</div>
<div class="ttc" id="ahprdbghv_2code_2broadcast_2_dpc_routines_8c_html_a4ce952e8ebd61cde6d6dcc118fb77541"><div class="ttname"><a href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#a4ce952e8ebd61cde6d6dcc118fb77541">DpcRoutinePerformChangeIoBitmapOnSingleCore</a></div><div class="ttdeci">VOID DpcRoutinePerformChangeIoBitmapOnSingleCore(KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)</div><div class="ttdoc">change I/O bitmap on a single core</div><div class="ttdef"><b>Definition</b> DpcRoutines.c:416</div></div>
<div class="ttc" id="ahprdbghv_2code_2broadcast_2_dpc_routines_8c_html_a860d1d5fbe8605d03eda7327935c799e"><div class="ttname"><a href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#a860d1d5fbe8605d03eda7327935c799e">DpcRoutineRunTaskOnSingleCore</a></div><div class="ttdeci">NTSTATUS DpcRoutineRunTaskOnSingleCore(UINT32 CoreNumber, PVOID Routine, PVOID DeferredContext)</div><div class="ttdoc">This function synchronize the function execution for a single core You should only used it for one co...</div><div class="ttdef"><b>Definition</b> DpcRoutines.c:35</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae43ea56fe71188fc168438908e6f4d1e" name="ae43ea56fe71188fc168438908e6f4d1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae43ea56fe71188fc168438908e6f4d1e">&#9670;&#160;</a></span>ConfigureChangeMsrBitmapReadOnSingleCore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureChangeMsrBitmapReadOnSingleCore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td>
          <td class="paramname"><em>TargetCoreId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>&#160;</td>
          <td class="paramname"><em>MsrMask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>change the mask of msr bitmaps for read on a single core </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TargetCoreId</td><td>The target core's ID (to just run on this core) </td></tr>
    <tr><td class="paramname">MsrMask</td><td>The ECX in MSR (mask)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  369</span>{</div>
<div class="line"><span class="lineno">  370</span>    <a class="code hl_function" href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#a860d1d5fbe8605d03eda7327935c799e">DpcRoutineRunTaskOnSingleCore</a>(TargetCoreId, <a class="code hl_function" href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#a64193ff039021b05cfee8e048af68c31">DpcRoutinePerformChangeMsrBitmapReadOnSingleCore</a>, MsrMask);</div>
<div class="line"><span class="lineno">  371</span>}</div>
<div class="ttc" id="ahprdbghv_2code_2broadcast_2_dpc_routines_8c_html_a64193ff039021b05cfee8e048af68c31"><div class="ttname"><a href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#a64193ff039021b05cfee8e048af68c31">DpcRoutinePerformChangeMsrBitmapReadOnSingleCore</a></div><div class="ttdeci">VOID DpcRoutinePerformChangeMsrBitmapReadOnSingleCore(KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)</div><div class="ttdoc">change msr bitmap read on a single core</div><div class="ttdef"><b>Definition</b> DpcRoutines.c:158</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a85d8b0bc91e6f1a0013eb07af520504f" name="a85d8b0bc91e6f1a0013eb07af520504f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85d8b0bc91e6f1a0013eb07af520504f">&#9670;&#160;</a></span>ConfigureChangeMsrBitmapWriteOnSingleCore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureChangeMsrBitmapWriteOnSingleCore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td>
          <td class="paramname"><em>TargetCoreId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>&#160;</td>
          <td class="paramname"><em>MsrMask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>change the mask of msr bitmaps for write on a single core </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TargetCoreId</td><td>The target core's ID (to just run on this core) </td></tr>
    <tr><td class="paramname">MsrMask</td><td>The ECX in MSR (mask)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  355</span>{</div>
<div class="line"><span class="lineno">  356</span>    <a class="code hl_function" href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#a860d1d5fbe8605d03eda7327935c799e">DpcRoutineRunTaskOnSingleCore</a>(TargetCoreId, <a class="code hl_function" href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#a7b111e2caa07e0259a61102db2ba61af">DpcRoutinePerformChangeMsrBitmapWriteOnSingleCore</a>, MsrMask);</div>
<div class="line"><span class="lineno">  357</span>}</div>
<div class="ttc" id="ahprdbghv_2code_2broadcast_2_dpc_routines_8c_html_a7b111e2caa07e0259a61102db2ba61af"><div class="ttname"><a href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#a7b111e2caa07e0259a61102db2ba61af">DpcRoutinePerformChangeMsrBitmapWriteOnSingleCore</a></div><div class="ttdeci">VOID DpcRoutinePerformChangeMsrBitmapWriteOnSingleCore(KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)</div><div class="ttdoc">change msr bitmap write on a single core</div><div class="ttdef"><b>Definition</b> DpcRoutines.c:186</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a87af14fc672b4f22dd8bf9aa06133bfe" name="a87af14fc672b4f22dd8bf9aa06133bfe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87af14fc672b4f22dd8bf9aa06133bfe">&#9670;&#160;</a></span>ConfigureDirtyLoggingInitializeOnAllProcessors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureDirtyLoggingInitializeOnAllProcessors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>routines for initializing dirty logging mechanism </p>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   61</span>{</div>
<div class="line"><span class="lineno">   62</span>    <a class="code hl_function" href="_dirty_logging_8c.html#a585fdbe53a7e659f5e2e01c6d6d492e8">DirtyLoggingInitialize</a>();</div>
<div class="line"><span class="lineno">   63</span>}</div>
<div class="ttc" id="a_dirty_logging_8c_html_a585fdbe53a7e659f5e2e01c6d6d492e8"><div class="ttname"><a href="_dirty_logging_8c.html#a585fdbe53a7e659f5e2e01c6d6d492e8">DirtyLoggingInitialize</a></div><div class="ttdeci">BOOLEAN DirtyLoggingInitialize()</div><div class="ttdoc">Initialize the dirty logging mechanism.</div><div class="ttdef"><b>Definition</b> DirtyLogging.c:21</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5a4d4056b23b71fe99f68da92ec7a4ea" name="a5a4d4056b23b71fe99f68da92ec7a4ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a4d4056b23b71fe99f68da92ec7a4ea">&#9670;&#160;</a></span>ConfigureDirtyLoggingUninitializeOnAllProcessors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureDirtyLoggingUninitializeOnAllProcessors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>routines for uninitializing dirty logging mechanism </p>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   72</span>{</div>
<div class="line"><span class="lineno">   73</span>    <a class="code hl_function" href="_dirty_logging_8c.html#aaf90fc3d8b6829ba9a11d32c02987020">DirtyLoggingUninitialize</a>();</div>
<div class="line"><span class="lineno">   74</span>}</div>
<div class="ttc" id="a_dirty_logging_8c_html_aaf90fc3d8b6829ba9a11d32c02987020"><div class="ttname"><a href="_dirty_logging_8c.html#aaf90fc3d8b6829ba9a11d32c02987020">DirtyLoggingUninitialize</a></div><div class="ttdeci">VOID DirtyLoggingUninitialize()</div><div class="ttdoc">Initialize the dirty logging mechanism.</div><div class="ttdef"><b>Definition</b> DirtyLogging.c:180</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9c34667ae652718d0b8a15a84e6ccc7f" name="a9c34667ae652718d0b8a15a84e6ccc7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c34667ae652718d0b8a15a84e6ccc7f">&#9670;&#160;</a></span>ConfigureDisableEferSyscallEventsOnAllProcessors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureDisableEferSyscallEventsOnAllProcessors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>routines for disabling syscall hooks on all cores </p>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  120</span>{</div>
<div class="line"><span class="lineno">  121</span>    <a class="code hl_function" href="_broadcast_8c.html#af9be4a566740f2a21d9d173dfc5b9768">BroadcastDisableEferSyscallEventsOnAllProcessors</a>();</div>
<div class="line"><span class="lineno">  122</span>}</div>
<div class="ttc" id="a_broadcast_8c_html_af9be4a566740f2a21d9d173dfc5b9768"><div class="ttname"><a href="_broadcast_8c.html#af9be4a566740f2a21d9d173dfc5b9768">BroadcastDisableEferSyscallEventsOnAllProcessors</a></div><div class="ttdeci">VOID BroadcastDisableEferSyscallEventsOnAllProcessors()</div><div class="ttdoc">routines for disabling syscall hooks on all cores</div><div class="ttdef"><b>Definition</b> Broadcast.c:491</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa5c7fc6c4f8d88ccb2fe6308242bf56b" name="aa5c7fc6c4f8d88ccb2fe6308242bf56b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5c7fc6c4f8d88ccb2fe6308242bf56b">&#9670;&#160;</a></span>ConfigureDisableMovToCr3ExitingOnAllProcessors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureDisableMovToCr3ExitingOnAllProcessors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>routines for debugging threads (disable mov-to-cr3 exiting) </p>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   83</span>{</div>
<div class="line"><span class="lineno">   84</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   85</span>    <span class="comment">// Indicate that the future #PFs should or should not be checked with user debugger</span></div>
<div class="line"><span class="lineno">   86</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   87</span>    <a class="code hl_variable" href="_global_variables_8h.html#a2945717b38be3209d407eb31dc9d5f4b">g_CheckPageFaultsAndMov2Cr3VmexitsWithUserDebugger</a> = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">   88</span> </div>
<div class="line"><span class="lineno">   89</span>    <a class="code hl_function" href="_broadcast_8c.html#afbdc3a135b42022a6041d1c69c1b18f3">BroadcastDisableMovToCr3ExitingOnAllProcessors</a>();</div>
<div class="line"><span class="lineno">   90</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition</b> BasicTypes.h:49</div></div>
<div class="ttc" id="a_broadcast_8c_html_afbdc3a135b42022a6041d1c69c1b18f3"><div class="ttname"><a href="_broadcast_8c.html#afbdc3a135b42022a6041d1c69c1b18f3">BroadcastDisableMovToCr3ExitingOnAllProcessors</a></div><div class="ttdeci">VOID BroadcastDisableMovToCr3ExitingOnAllProcessors()</div><div class="ttdoc">routines for debugging threads (disable mov-to-cr3 exiting)</div><div class="ttdef"><b>Definition</b> Broadcast.c:469</div></div>
<div class="ttc" id="a_global_variables_8h_html_a2945717b38be3209d407eb31dc9d5f4b"><div class="ttname"><a href="_global_variables_8h.html#a2945717b38be3209d407eb31dc9d5f4b">g_CheckPageFaultsAndMov2Cr3VmexitsWithUserDebugger</a></div><div class="ttdeci">BOOLEAN g_CheckPageFaultsAndMov2Cr3VmexitsWithUserDebugger</div><div class="ttdoc">Whether the page-fault and cr3 vm-exits in vmx-root should check the #PFs or the PML4....</div><div class="ttdef"><b>Definition</b> GlobalVariables.h:114</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a65911e5480e9bbf690530f95257ba177" name="a65911e5480e9bbf690530f95257ba177"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65911e5480e9bbf690530f95257ba177">&#9670;&#160;</a></span>ConfigureEnableEferSyscallEventsOnAllProcessors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureEnableEferSyscallEventsOnAllProcessors </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="include_2_s_d_k_2_headers_2_events_8h.html#ad59706f68fe9056c1b7f4c7ee5b809ab">DEBUGGER_EVENT_SYSCALL_SYSRET_TYPE</a>&#160;</td>
          <td class="paramname"><em>SyscallHookType</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>routines for enabling syscall hooks on all cores </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">SyscallHookType</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  100</span>{</div>
<div class="line"><span class="lineno">  101</span>    <span class="keywordflow">if</span> (SyscallHookType == <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a603add14bd7b96e83bdd990c53449b61af4d0ab42e46b060da271e41fe24fbc06">DEBUGGER_EVENT_SYSCALL_SYSRET_HANDLE_ALL_UD</a>)</div>
<div class="line"><span class="lineno">  102</span>    {</div>
<div class="line"><span class="lineno">  103</span>        <a class="code hl_variable" href="_global_variables_8h.html#a79454511c45c422bb27a2d4429b65a53">g_IsUnsafeSyscallOrSysretHandling</a> = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  104</span>    }</div>
<div class="line"><span class="lineno">  105</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SyscallHookType == <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a603add14bd7b96e83bdd990c53449b61ac2c2eb597f451618da795d66856123f4">DEBUGGER_EVENT_SYSCALL_SYSRET_SAFE_ACCESS_MEMORY</a>)</div>
<div class="line"><span class="lineno">  106</span>    {</div>
<div class="line"><span class="lineno">  107</span>        <a class="code hl_variable" href="_global_variables_8h.html#a79454511c45c422bb27a2d4429b65a53">g_IsUnsafeSyscallOrSysretHandling</a> = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  108</span>    }</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>    <a class="code hl_function" href="_broadcast_8c.html#a2b511aee80072559f2f867c8216fcc54">BroadcastEnableEferSyscallEventsOnAllProcessors</a>();</div>
<div class="line"><span class="lineno">  111</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition</b> BasicTypes.h:50</div></div>
<div class="ttc" id="a_broadcast_8c_html_a2b511aee80072559f2f867c8216fcc54"><div class="ttname"><a href="_broadcast_8c.html#a2b511aee80072559f2f867c8216fcc54">BroadcastEnableEferSyscallEventsOnAllProcessors</a></div><div class="ttdeci">VOID BroadcastEnableEferSyscallEventsOnAllProcessors()</div><div class="ttdoc">routines for enabling syscall hooks on all cores</div><div class="ttdef"><b>Definition</b> Broadcast.c:480</div></div>
<div class="ttc" id="a_global_variables_8h_html_a79454511c45c422bb27a2d4429b65a53"><div class="ttname"><a href="_global_variables_8h.html#a79454511c45c422bb27a2d4429b65a53">g_IsUnsafeSyscallOrSysretHandling</a></div><div class="ttdeci">BOOLEAN g_IsUnsafeSyscallOrSysretHandling</div><div class="ttdoc">Shows whether the debuggee is waiting for an trap step or not.</div><div class="ttdef"><b>Definition</b> GlobalVariables.h:101</div></div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a603add14bd7b96e83bdd990c53449b61ac2c2eb597f451618da795d66856123f4"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a603add14bd7b96e83bdd990c53449b61ac2c2eb597f451618da795d66856123f4">DEBUGGER_EVENT_SYSCALL_SYSRET_SAFE_ACCESS_MEMORY</a></div><div class="ttdeci">@ DEBUGGER_EVENT_SYSCALL_SYSRET_SAFE_ACCESS_MEMORY</div><div class="ttdef"><b>Definition</b> Events.h:163</div></div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a603add14bd7b96e83bdd990c53449b61af4d0ab42e46b060da271e41fe24fbc06"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a603add14bd7b96e83bdd990c53449b61af4d0ab42e46b060da271e41fe24fbc06">DEBUGGER_EVENT_SYSCALL_SYSRET_HANDLE_ALL_UD</a></div><div class="ttdeci">@ DEBUGGER_EVENT_SYSCALL_SYSRET_HANDLE_ALL_UD</div><div class="ttdef"><b>Definition</b> Events.h:164</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a53fec80da84381073b54556a6cabc098" name="a53fec80da84381073b54556a6cabc098"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53fec80da84381073b54556a6cabc098">&#9670;&#160;</a></span>ConfigureEnableEferSyscallHookOnSingleCore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureEnableEferSyscallHookOnSingleCore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td>
          <td class="paramname"><em>TargetCoreId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2_s_d_k_2_headers_2_events_8h.html#ad59706f68fe9056c1b7f4c7ee5b809ab">DEBUGGER_EVENT_SYSCALL_SYSRET_TYPE</a>&#160;</td>
          <td class="paramname"><em>SyscallHookType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>routines for enabling EFER syscall hooks on a single core </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TargetCoreId</td><td>The target core's ID (to just run on this core) </td></tr>
    <tr><td class="paramname">SyscallHookType</td><td>Type of hook</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  252</span>{</div>
<div class="line"><span class="lineno">  253</span>    <span class="keywordflow">if</span> (SyscallHookType == <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a603add14bd7b96e83bdd990c53449b61af4d0ab42e46b060da271e41fe24fbc06">DEBUGGER_EVENT_SYSCALL_SYSRET_HANDLE_ALL_UD</a>)</div>
<div class="line"><span class="lineno">  254</span>    {</div>
<div class="line"><span class="lineno">  255</span>        <a class="code hl_variable" href="_global_variables_8h.html#a79454511c45c422bb27a2d4429b65a53">g_IsUnsafeSyscallOrSysretHandling</a> = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  256</span>    }</div>
<div class="line"><span class="lineno">  257</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SyscallHookType == <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a603add14bd7b96e83bdd990c53449b61ac2c2eb597f451618da795d66856123f4">DEBUGGER_EVENT_SYSCALL_SYSRET_SAFE_ACCESS_MEMORY</a>)</div>
<div class="line"><span class="lineno">  258</span>    {</div>
<div class="line"><span class="lineno">  259</span>        <a class="code hl_variable" href="_global_variables_8h.html#a79454511c45c422bb27a2d4429b65a53">g_IsUnsafeSyscallOrSysretHandling</a> = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  260</span>    }</div>
<div class="line"><span class="lineno">  261</span> </div>
<div class="line"><span class="lineno">  262</span>    <a class="code hl_function" href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#a860d1d5fbe8605d03eda7327935c799e">DpcRoutineRunTaskOnSingleCore</a>(TargetCoreId, <a class="code hl_function" href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#a3aecac4c6c92d962339067855d42795a">DpcRoutinePerformEnableEferSyscallHookOnSingleCore</a>, NULL);</div>
<div class="line"><span class="lineno">  263</span>}</div>
<div class="ttc" id="ahprdbghv_2code_2broadcast_2_dpc_routines_8c_html_a3aecac4c6c92d962339067855d42795a"><div class="ttname"><a href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#a3aecac4c6c92d962339067855d42795a">DpcRoutinePerformEnableEferSyscallHookOnSingleCore</a></div><div class="ttdeci">VOID DpcRoutinePerformEnableEferSyscallHookOnSingleCore(KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)</div><div class="ttdoc">Enable syscall hook EFER on a single core.</div><div class="ttdef"><b>Definition</b> DpcRoutines.c:387</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afc3e70af1e14446938eaa3d81bb41c6b" name="afc3e70af1e14446938eaa3d81bb41c6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc3e70af1e14446938eaa3d81bb41c6b">&#9670;&#160;</a></span>ConfigureEnableMovToControlRegisterExitingOnSingleCore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureEnableMovToControlRegisterExitingOnSingleCore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td>
          <td class="paramname"><em>TargetCoreId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2_s_d_k_2_headers_2_events_8h.html#a51fdcbd4a691fb1defc309f977dc4ad8">DEBUGGER_BROADCASTING_OPTIONS</a> *&#160;</td>
          <td class="paramname"><em>BroadcastingOption</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>enable mov 2 control register on a single core </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TargetCoreId</td><td>The target core's ID (to just run on this core) </td></tr>
    <tr><td class="paramname">BroadcastingOption</td><td>The optional broadcasting fields</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  341</span>{</div>
<div class="line"><span class="lineno">  342</span>    <a class="code hl_function" href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#a860d1d5fbe8605d03eda7327935c799e">DpcRoutineRunTaskOnSingleCore</a>(TargetCoreId, <a class="code hl_function" href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#a4d574e0e84d8df37680ba7a300681d00">DpcRoutinePerformEnableMovToControlRegisterExiting</a>, &amp;BroadcastingOption);</div>
<div class="line"><span class="lineno">  343</span>}</div>
<div class="ttc" id="ahprdbghv_2code_2broadcast_2_dpc_routines_8c_html_a4d574e0e84d8df37680ba7a300681d00"><div class="ttname"><a href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#a4d574e0e84d8df37680ba7a300681d00">DpcRoutinePerformEnableMovToControlRegisterExiting</a></div><div class="ttdeci">VOID DpcRoutinePerformEnableMovToControlRegisterExiting(KDPC *Dpc, DEBUGGER_BROADCASTING_OPTIONS *Event, PVOID SystemArgument1, PVOID SystemArgument2)</div><div class="ttdoc">Set the Mov to Control Registers Exitings.</div><div class="ttdef"><b>Definition</b> DpcRoutines.c:330</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab3a6af0209221a2a25ae9201fc60f1cf" name="ab3a6af0209221a2a25ae9201fc60f1cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3a6af0209221a2a25ae9201fc60f1cf">&#9670;&#160;</a></span>ConfigureEnableMovToCr3ExitingOnAllProcessors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureEnableMovToCr3ExitingOnAllProcessors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>routines for debugging threads (enable mov-to-cr3 exiting) </p>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   22</span>{</div>
<div class="line"><span class="lineno">   23</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   24</span>    <span class="comment">// Indicate that the future #PFs should or should not be checked with user debugger</span></div>
<div class="line"><span class="lineno">   25</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   26</span>    <a class="code hl_variable" href="_global_variables_8h.html#a2945717b38be3209d407eb31dc9d5f4b">g_CheckPageFaultsAndMov2Cr3VmexitsWithUserDebugger</a> = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">   27</span> </div>
<div class="line"><span class="lineno">   28</span>    <a class="code hl_function" href="_broadcast_8c.html#ad399387aeaaae4be8180107318d1ed62">BroadcastEnableMovToCr3ExitingOnAllProcessors</a>();</div>
<div class="line"><span class="lineno">   29</span>}</div>
<div class="ttc" id="a_broadcast_8c_html_ad399387aeaaae4be8180107318d1ed62"><div class="ttname"><a href="_broadcast_8c.html#ad399387aeaaae4be8180107318d1ed62">BroadcastEnableMovToCr3ExitingOnAllProcessors</a></div><div class="ttdeci">VOID BroadcastEnableMovToCr3ExitingOnAllProcessors()</div><div class="ttdoc">routines for debugging threads (enable mov-to-cr3 exiting)</div><div class="ttdef"><b>Definition</b> Broadcast.c:436</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a528c7a4faebda601e8f256629cd8c324" name="a528c7a4faebda601e8f256629cd8c324"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a528c7a4faebda601e8f256629cd8c324">&#9670;&#160;</a></span>ConfigureEnableMovToDebugRegistersExitingOnSingleCore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureEnableMovToDebugRegistersExitingOnSingleCore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td>
          <td class="paramname"><em>TargetCoreId</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>enable mov 2 debug register exiting on a single core </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TargetCoreId</td><td>The target core's ID (to just run on this core)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  313</span>{</div>
<div class="line"><span class="lineno">  314</span>    <a class="code hl_function" href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#a860d1d5fbe8605d03eda7327935c799e">DpcRoutineRunTaskOnSingleCore</a>(TargetCoreId, <a class="code hl_function" href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#aef7db7dd1e1f564dd5db438db232c4ef">DpcRoutinePerformEnableMovToDebugRegistersExiting</a>, NULL);</div>
<div class="line"><span class="lineno">  315</span>}</div>
<div class="ttc" id="ahprdbghv_2code_2broadcast_2_dpc_routines_8c_html_aef7db7dd1e1f564dd5db438db232c4ef"><div class="ttname"><a href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#aef7db7dd1e1f564dd5db438db232c4ef">DpcRoutinePerformEnableMovToDebugRegistersExiting</a></div><div class="ttdeci">VOID DpcRoutinePerformEnableMovToDebugRegistersExiting(KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)</div><div class="ttdoc">Set the Mov to Debug Registers Exitings.</div><div class="ttdef"><b>Definition</b> DpcRoutines.c:301</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a40d05c72969eddee7308d4fd44522c34" name="a40d05c72969eddee7308d4fd44522c34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40d05c72969eddee7308d4fd44522c34">&#9670;&#160;</a></span>ConfigureEnableRdpmcExitingOnSingleCore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureEnableRdpmcExitingOnSingleCore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td>
          <td class="paramname"><em>TargetCoreId</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>enable RDPMC exiting on a single core </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TargetCoreId</td><td>The target core's ID (to just run on this core)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  300</span>{</div>
<div class="line"><span class="lineno">  301</span>    <a class="code hl_function" href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#a860d1d5fbe8605d03eda7327935c799e">DpcRoutineRunTaskOnSingleCore</a>(TargetCoreId, <a class="code hl_function" href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#a6fe8d23e3fd81eecba6f28a50f454222">DpcRoutinePerformEnableRdpmcExitingOnSingleCore</a>, NULL);</div>
<div class="line"><span class="lineno">  302</span>}</div>
<div class="ttc" id="ahprdbghv_2code_2broadcast_2_dpc_routines_8c_html_a6fe8d23e3fd81eecba6f28a50f454222"><div class="ttname"><a href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#a6fe8d23e3fd81eecba6f28a50f454222">DpcRoutinePerformEnableRdpmcExitingOnSingleCore</a></div><div class="ttdeci">VOID DpcRoutinePerformEnableRdpmcExitingOnSingleCore(KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)</div><div class="ttdoc">set rdpmc exiting</div><div class="ttdef"><b>Definition</b> DpcRoutines.c:243</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a736c9678fb16d3340e7b963ce779d85e" name="a736c9678fb16d3340e7b963ce779d85e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a736c9678fb16d3340e7b963ce779d85e">&#9670;&#160;</a></span>ConfigureEnableRdtscExitingOnSingleCore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureEnableRdtscExitingOnSingleCore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td>
          <td class="paramname"><em>TargetCoreId</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>enable RDTSC exiting on a single core </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TargetCoreId</td><td>The target core's ID (to just run on this core)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  287</span>{</div>
<div class="line"><span class="lineno">  288</span>    <a class="code hl_function" href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#a860d1d5fbe8605d03eda7327935c799e">DpcRoutineRunTaskOnSingleCore</a>(TargetCoreId, <a class="code hl_function" href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#a508772fcbdb9d34fd81501639eb996e1">DpcRoutinePerformEnableRdtscExitingOnSingleCore</a>, NULL);</div>
<div class="line"><span class="lineno">  289</span>}</div>
<div class="ttc" id="ahprdbghv_2code_2broadcast_2_dpc_routines_8c_html_a508772fcbdb9d34fd81501639eb996e1"><div class="ttname"><a href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#a508772fcbdb9d34fd81501639eb996e1">DpcRoutinePerformEnableRdtscExitingOnSingleCore</a></div><div class="ttdeci">VOID DpcRoutinePerformEnableRdtscExitingOnSingleCore(KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)</div><div class="ttdoc">set rdtsc/rdtscp exiting</div><div class="ttdef"><b>Definition</b> DpcRoutines.c:214</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaa62d4e17a65f5e1024f37e3c2bf0b38" name="aaa62d4e17a65f5e1024f37e3c2bf0b38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa62d4e17a65f5e1024f37e3c2bf0b38">&#9670;&#160;</a></span>ConfigureEptHook()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ConfigureEptHook </td>
          <td>(</td>
          <td class="paramtype">PVOID&#160;</td>
          <td class="paramname"><em>TargetAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td>
          <td class="paramname"><em>ProcessId</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allocates a buffer in VMX Non Root Mode and then invokes a VMCALL to set the hook. </p>
<p>this command uses hidden breakpoints (0xcc) to hook, THIS FUNCTION SHOULD BE CALLED WHEN THE VMLAUNCH ALREADY EXECUTED, it is because, broadcasting to enable exception bitmap for breakpoint is not clear here, if we want to broadcast to enable exception bitmaps on all cores when vmlaunch is not executed then that's ok but a user might call this function when we didn't configure the vmcs, it's a problem! we can solve it by giving a hint to vmcs configure function to make it ok for future configuration but that sounds stupid, I think it's better to not support this feature. Btw, debugger won't use this function in the above mentioned method, so we won't have any problem with this :)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TargetAddress</td><td>The address of function or memory address to be hooked </td></tr>
    <tr><td class="paramname">ProcessId</td><td>The process id to translate based on that process's cr3 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN Returns true if the hook was successful or false if there was an error </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  158</span>{</div>
<div class="line"><span class="lineno">  159</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="_ept_hook_8c.html#abcbdb9cd3dbdf238b8b5d484522855e3">EptHook</a>(TargetAddress, ProcessId);</div>
<div class="line"><span class="lineno">  160</span>}</div>
<div class="ttc" id="a_ept_hook_8c_html_abcbdb9cd3dbdf238b8b5d484522855e3"><div class="ttname"><a href="_ept_hook_8c.html#abcbdb9cd3dbdf238b8b5d484522855e3">EptHook</a></div><div class="ttdeci">BOOLEAN EptHook(PVOID TargetAddress, UINT32 ProcessId)</div><div class="ttdoc">This function allocates a buffer in VMX Non Root Mode and then invokes a VMCALL to set the hook.</div><div class="ttdef"><b>Definition</b> EptHook.c:439</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af3fe6525bba079418c58fec08c2add0f" name="af3fe6525bba079418c58fec08c2add0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3fe6525bba079418c58fec08c2add0f">&#9670;&#160;</a></span>ConfigureEptHook2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ConfigureEptHook2 </td>
          <td>(</td>
          <td class="paramtype">PVOID&#160;</td>
          <td class="paramname"><em>TargetAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID&#160;</td>
          <td class="paramname"><em>HookFunction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td>
          <td class="paramname"><em>ProcessId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td>
          <td class="paramname"><em>SetHookForRead</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td>
          <td class="paramname"><em>SetHookForWrite</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td>
          <td class="paramname"><em>SetHookForExec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td>
          <td class="paramname"><em>EptHiddenHook2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allocates a buffer in VMX Non Root Mode and then invokes a VMCALL to set the hook. </p>
<p>this command uses hidden detours, this NOT be called from vmx-root mode</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TargetAddress</td><td>The address of function or memory address to be hooked </td></tr>
    <tr><td class="paramname">HookFunction</td><td>The function that will be called when hook triggered </td></tr>
    <tr><td class="paramname">ProcessId</td><td>The process id to translate based on that process's cr3 </td></tr>
    <tr><td class="paramname">SetHookForRead</td><td>Hook READ Access </td></tr>
    <tr><td class="paramname">SetHookForWrite</td><td>Hook WRITE Access </td></tr>
    <tr><td class="paramname">SetHookForExec</td><td>Hook EXECUTE Access </td></tr>
    <tr><td class="paramname">EptHiddenHook2</td><td>epthook2 style hook </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN Returns true if the hook was successful or false if there was an error </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  184</span>{</div>
<div class="line"><span class="lineno">  185</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="_ept_hook_8c.html#acc42be0e755a425e09c017b36b8d17ac">EptHook2</a>(TargetAddress, HookFunction, ProcessId, SetHookForRead, SetHookForWrite, SetHookForExec, EptHiddenHook2);</div>
<div class="line"><span class="lineno">  186</span>}</div>
<div class="ttc" id="a_ept_hook_8c_html_acc42be0e755a425e09c017b36b8d17ac"><div class="ttname"><a href="_ept_hook_8c.html#acc42be0e755a425e09c017b36b8d17ac">EptHook2</a></div><div class="ttdeci">BOOLEAN EptHook2(PVOID TargetAddress, PVOID HookFunction, UINT32 ProcessId, BOOLEAN SetHookForRead, BOOLEAN SetHookForWrite, BOOLEAN SetHookForExec, BOOLEAN EptHiddenHook2)</div><div class="ttdoc">This function allocates a buffer in VMX Non Root Mode and then invokes a VMCALL to set the hook.</div><div class="ttdef"><b>Definition</b> EptHook.c:1061</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aae487c6cde6eab0c8b5c934900e02f77" name="aae487c6cde6eab0c8b5c934900e02f77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae487c6cde6eab0c8b5c934900e02f77">&#9670;&#160;</a></span>ConfigureEptHookModifyInstructionFetchState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ConfigureEptHookModifyInstructionFetchState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td>
          <td class="paramname"><em>CoreId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID&#160;</td>
          <td class="paramname"><em>PhysicalAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td>
          <td class="paramname"><em>IsUnset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Change PML EPT state for execution (execute) @detail should be called from VMX-root. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CoreId</td><td>Current Core ID </td></tr>
    <tr><td class="paramname">PhysicalAddress</td><td>Target physical address </td></tr>
    <tr><td class="paramname">IsUnset</td><td>Is unsetting bit or setting bit</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  202</span>{</div>
<div class="line"><span class="lineno">  203</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="_ept_hook_8c.html#a54499f05708f5cf69df924d7cf92ba89">EptHookModifyInstructionFetchState</a>(&amp;<a class="code hl_variable" href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a>[CoreId], PhysicalAddress, IsUnset);</div>
<div class="line"><span class="lineno">  204</span>}</div>
<div class="ttc" id="a_ept_hook_8c_html_a54499f05708f5cf69df924d7cf92ba89"><div class="ttname"><a href="_ept_hook_8c.html#a54499f05708f5cf69df924d7cf92ba89">EptHookModifyInstructionFetchState</a></div><div class="ttdeci">BOOLEAN EptHookModifyInstructionFetchState(VIRTUAL_MACHINE_STATE *VCpu, PVOID PhysicalAddress, BOOLEAN IsUnset)</div><div class="ttdoc">Change PML EPT state for execution (execute) @detail should be called from VMX-root.</div><div class="ttdef"><b>Definition</b> EptHook.c:1785</div></div>
<div class="ttc" id="a_global_variables_8h_html_a04bac1f4beef0dcf1ce1a4d9ce72ea76"><div class="ttname"><a href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a></div><div class="ttdeci">VIRTUAL_MACHINE_STATE * g_GuestState</div><div class="ttdoc">Save the state and variables related to virtualization on each to logical core.</div><div class="ttdef"><b>Definition</b> GlobalVariables.h:38</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af3273428c5505c7af8a08a2319c8e688" name="af3273428c5505c7af8a08a2319c8e688"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3273428c5505c7af8a08a2319c8e688">&#9670;&#160;</a></span>ConfigureEptHookModifyPageReadState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ConfigureEptHookModifyPageReadState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td>
          <td class="paramname"><em>CoreId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID&#160;</td>
          <td class="paramname"><em>PhysicalAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td>
          <td class="paramname"><em>IsUnset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Change PML EPT state for read @detail should be called from VMX-root. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
    <tr><td class="paramname">PhysicalAddress</td><td>Target physical address </td></tr>
    <tr><td class="paramname">IsUnset</td><td>Is unsetting bit or setting bit</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  220</span>{</div>
<div class="line"><span class="lineno">  221</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="_ept_hook_8c.html#a1dc01f084128845b23788d6f384df6ab">EptHookModifyPageReadState</a>(&amp;<a class="code hl_variable" href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a>[CoreId], PhysicalAddress, IsUnset);</div>
<div class="line"><span class="lineno">  222</span>}</div>
<div class="ttc" id="a_ept_hook_8c_html_a1dc01f084128845b23788d6f384df6ab"><div class="ttname"><a href="_ept_hook_8c.html#a1dc01f084128845b23788d6f384df6ab">EptHookModifyPageReadState</a></div><div class="ttdeci">BOOLEAN EptHookModifyPageReadState(VIRTUAL_MACHINE_STATE *VCpu, PVOID PhysicalAddress, BOOLEAN IsUnset)</div><div class="ttdoc">Change PML EPT state for read @detail should be called from VMX-root.</div><div class="ttdef"><b>Definition</b> EptHook.c:1849</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a701db01cdd2fb70134e209fe80d23236" name="a701db01cdd2fb70134e209fe80d23236"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a701db01cdd2fb70134e209fe80d23236">&#9670;&#160;</a></span>ConfigureEptHookModifyPageWriteState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ConfigureEptHookModifyPageWriteState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td>
          <td class="paramname"><em>CoreId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID&#160;</td>
          <td class="paramname"><em>PhysicalAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td>
          <td class="paramname"><em>IsUnset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Change PML EPT state for write @detail should be called from VMX-root. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
    <tr><td class="paramname">PhysicalAddress</td><td>Target physical address </td></tr>
    <tr><td class="paramname">IsUnset</td><td>Is unsetting bit or setting bit</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  238</span>{</div>
<div class="line"><span class="lineno">  239</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="_ept_hook_8c.html#a04587a27698f5cc43cd9c2c13a6736c5">EptHookModifyPageWriteState</a>(&amp;<a class="code hl_variable" href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a>[CoreId], PhysicalAddress, IsUnset);</div>
<div class="line"><span class="lineno">  240</span>}</div>
<div class="ttc" id="a_ept_hook_8c_html_a04587a27698f5cc43cd9c2c13a6736c5"><div class="ttname"><a href="_ept_hook_8c.html#a04587a27698f5cc43cd9c2c13a6736c5">EptHookModifyPageWriteState</a></div><div class="ttdeci">BOOLEAN EptHookModifyPageWriteState(VIRTUAL_MACHINE_STATE *VCpu, PVOID PhysicalAddress, BOOLEAN IsUnset)</div><div class="ttdoc">Change PML EPT state for write @detail should be called from VMX-root.</div><div class="ttdef"><b>Definition</b> EptHook.c:1913</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad6129e5f85312a405e0509e2c45351bf" name="ad6129e5f85312a405e0509e2c45351bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6129e5f85312a405e0509e2c45351bf">&#9670;&#160;</a></span>ConfigureEptHookUnHookSingleAddress()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ConfigureEptHookUnHookSingleAddress </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>&#160;</td>
          <td class="paramname"><em>VirtualAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>&#160;</td>
          <td class="paramname"><em>PhysAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td>
          <td class="paramname"><em>ProcessId</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove single hook from the hooked pages list and invalidate TLB. </p>
<p>Should be called from vmx non-root</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VirtualAddress</td><td>Virtual address to unhook </td></tr>
    <tr><td class="paramname">PhysAddress</td><td>Physical address to unhook (optional) </td></tr>
    <tr><td class="paramname">ProcessId</td><td>The process id of target process</td></tr>
  </table>
  </dd>
</dl>
<p>in unhooking for some hooks only physical address is availables</p>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN If unhook was successful it returns true or if it was not successful returns false </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  137</span>{</div>
<div class="line"><span class="lineno">  138</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="_ept_hook_8c.html#a24ce2115ab4514ec8eed08d0911b64d6">EptHookUnHookSingleAddress</a>(VirtualAddress, PhysAddress, ProcessId);</div>
<div class="line"><span class="lineno">  139</span>}</div>
<div class="ttc" id="a_ept_hook_8c_html_a24ce2115ab4514ec8eed08d0911b64d6"><div class="ttname"><a href="_ept_hook_8c.html#a24ce2115ab4514ec8eed08d0911b64d6">EptHookUnHookSingleAddress</a></div><div class="ttdeci">BOOLEAN EptHookUnHookSingleAddress(UINT64 VirtualAddress, UINT64 PhysAddress, UINT32 ProcessId)</div><div class="ttdoc">Remove single hook from the hooked pages list and invalidate TLB.</div><div class="ttdef"><b>Definition</b> EptHook.c:1559</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2e09280f251f18f09a751111968c2d7c" name="a2e09280f251f18f09a751111968c2d7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e09280f251f18f09a751111968c2d7c">&#9670;&#160;</a></span>ConfigureInitializeReversingMachineOnAllProcessors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureInitializeReversingMachineOnAllProcessors </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_request_structures_8h.html#a91c6221d89d110c3a9ebc2fac4ae3e2d">PREVERSING_MACHINE_RECONSTRUCT_MEMORY_REQUEST</a>&#160;</td>
          <td class="paramname"><em>RevServiceRequest</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>routines for initializing Mode-based execution hooks </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">RevServiceRequest</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   39</span>{</div>
<div class="line"><span class="lineno">   40</span>    <a class="code hl_function" href="_reversing_machine_8c.html#ab1ddfa4bb94c4fb4760d047dcd7ffc5b">ReversingMachineInitialize</a>(RevServiceRequest);</div>
<div class="line"><span class="lineno">   41</span>}</div>
<div class="ttc" id="a_reversing_machine_8c_html_ab1ddfa4bb94c4fb4760d047dcd7ffc5b"><div class="ttname"><a href="_reversing_machine_8c.html#ab1ddfa4bb94c4fb4760d047dcd7ffc5b">ReversingMachineInitialize</a></div><div class="ttdeci">BOOLEAN ReversingMachineInitialize(PREVERSING_MACHINE_RECONSTRUCT_MEMORY_REQUEST RevServiceRequest)</div><div class="ttdoc">Initialize the reversing machine based on service request.</div><div class="ttdef"><b>Definition</b> ReversingMachine.c:499</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0e72ac48176ecf52fe48443a9903593" name="ac0e72ac48176ecf52fe48443a9903593"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0e72ac48176ecf52fe48443a9903593">&#9670;&#160;</a></span>ConfigureModeBasedExecHookUninitializeOnAllProcessors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureModeBasedExecHookUninitializeOnAllProcessors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>routines for initializing Mode-based execution hooks </p>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   50</span>{</div>
<div class="line"><span class="lineno">   51</span>    <a class="code hl_function" href="_mode_based_exec_hook_8c.html#a17a8e377b4679423f8c80f9dab0f113a">ModeBasedExecHookUninitialize</a>();</div>
<div class="line"><span class="lineno">   52</span>}</div>
<div class="ttc" id="a_mode_based_exec_hook_8c_html_a17a8e377b4679423f8c80f9dab0f113a"><div class="ttname"><a href="_mode_based_exec_hook_8c.html#a17a8e377b4679423f8c80f9dab0f113a">ModeBasedExecHookUninitialize</a></div><div class="ttdeci">VOID ModeBasedExecHookUninitialize()</div><div class="ttdoc">Uinitialize the needed structure for hooking mode execution.</div><div class="ttdef"><b>Definition</b> ModeBasedExecHook.c:155</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1440df6523c738461133801841828def" name="a1440df6523c738461133801841828def"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1440df6523c738461133801841828def">&#9670;&#160;</a></span>ConfigureSetExceptionBitmapOnSingleCore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureSetExceptionBitmapOnSingleCore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td>
          <td class="paramname"><em>TargetCoreId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td>
          <td class="paramname"><em>BitMask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>set exception bitmap on a single core </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TargetCoreId</td><td>The target core's ID (to just run on this core) </td></tr>
    <tr><td class="paramname">BitMask</td><td>The bit mask of exception bitmap</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  327</span>{</div>
<div class="line"><span class="lineno">  328</span>    <a class="code hl_function" href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#a860d1d5fbe8605d03eda7327935c799e">DpcRoutineRunTaskOnSingleCore</a>(TargetCoreId, <a class="code hl_function" href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#ae81da9f18268df6f043f0f715099bdce">DpcRoutinePerformSetExceptionBitmapOnSingleCore</a>, BitMask);</div>
<div class="line"><span class="lineno">  329</span>}</div>
<div class="ttc" id="ahprdbghv_2code_2broadcast_2_dpc_routines_8c_html_ae81da9f18268df6f043f0f715099bdce"><div class="ttname"><a href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#ae81da9f18268df6f043f0f715099bdce">DpcRoutinePerformSetExceptionBitmapOnSingleCore</a></div><div class="ttdeci">VOID DpcRoutinePerformSetExceptionBitmapOnSingleCore(KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)</div><div class="ttdoc">change exception bitmap on a single core</div><div class="ttdef"><b>Definition</b> DpcRoutines.c:272</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa8cefdf192b6214caca28a2d3472dabe" name="aa8cefdf192b6214caca28a2d3472dabe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8cefdf192b6214caca28a2d3472dabe">&#9670;&#160;</a></span>ConfigureSetExternalInterruptExitingOnSingleCore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureSetExternalInterruptExitingOnSingleCore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td>
          <td class="paramname"><em>TargetCoreId</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>set external interrupt exiting on a single core </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TargetCoreId</td><td>The target core's ID (to just run on this core)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  274</span>{</div>
<div class="line"><span class="lineno">  275</span>    <a class="code hl_function" href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#a860d1d5fbe8605d03eda7327935c799e">DpcRoutineRunTaskOnSingleCore</a>(TargetCoreId, <a class="code hl_function" href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#acb4f0c4f4fc5c02f54f30cff5f4c8192">DpcRoutinePerformSetExternalInterruptExitingOnSingleCore</a>, NULL);</div>
<div class="line"><span class="lineno">  276</span>}</div>
<div class="ttc" id="ahprdbghv_2code_2broadcast_2_dpc_routines_8c_html_acb4f0c4f4fc5c02f54f30cff5f4c8192"><div class="ttname"><a href="hprdbghv_2code_2broadcast_2_dpc_routines_8c.html#acb4f0c4f4fc5c02f54f30cff5f4c8192">DpcRoutinePerformSetExternalInterruptExitingOnSingleCore</a></div><div class="ttdeci">VOID DpcRoutinePerformSetExternalInterruptExitingOnSingleCore(KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)</div><div class="ttdoc">Enable external interrupt exiting on a single core.</div><div class="ttdef"><b>Definition</b> DpcRoutines.c:358</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_53a6cdbae347618e9ee76d4be5c6ea96.html">hyperdbg</a></li><li class="navelem"><a class="el" href="dir_19054a674c4bd5cb8fceb6542228579c.html">hprdbghv</a></li><li class="navelem"><a class="el" href="dir_aac0c9299474d8b4035e61d55763e72a.html">code</a></li><li class="navelem"><a class="el" href="dir_324a3f57123903071951c4f82b1a8c9d.html">interface</a></li><li class="navelem"><a class="el" href="_configuration_8c.html">Configuration.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
