<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HyperDbg: hyperdbg/hprdbgkd/header/debugger/commands/BreakpointCommands.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">HyperDbg
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('_breakpoint_commands_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">BreakpointCommands.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Commands for setting breakpoints.  
<a href="#details">More...</a></p>

<p><a href="_breakpoint_commands_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af5a28890d7cdeb6e697ba8c41d2bbbe7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_breakpoint_commands_8h.html#af5a28890d7cdeb6e697ba8c41d2bbbe7">BreakpointRemoveAllBreakpoints</a> ()</td></tr>
<tr class="memdesc:af5a28890d7cdeb6e697ba8c41d2bbbe7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove all the breakpoints if possible.  <br /></td></tr>
<tr class="separator:af5a28890d7cdeb6e697ba8c41d2bbbe7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a295701da4a28b591937893cfbb3dcd75"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_breakpoint_commands_8h.html#a295701da4a28b591937893cfbb3dcd75">BreakpointAddNew</a> (<a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a58c97daf5894ba79ab884e8b85515ad3">PDEBUGGEE_BP_PACKET</a> BpDescriptorArg)</td></tr>
<tr class="memdesc:a295701da4a28b591937893cfbb3dcd75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add new breakpoints.  <br /></td></tr>
<tr class="separator:a295701da4a28b591937893cfbb3dcd75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfb2587c2b1380011576fb0f243c4148"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_breakpoint_commands_8h.html#acfb2587c2b1380011576fb0f243c4148">BreakpointListOrModify</a> (<a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#ae0b77106e76131900a06635311dd3c2e">PDEBUGGEE_BP_LIST_OR_MODIFY_PACKET</a> ListOrModifyBreakpoints)</td></tr>
<tr class="memdesc:acfb2587c2b1380011576fb0f243c4148"><td class="mdescLeft">&#160;</td><td class="mdescRight">List of modify breakpoints.  <br /></td></tr>
<tr class="separator:acfb2587c2b1380011576fb0f243c4148"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a0aeca428b3ffc888248391356079ac"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_breakpoint_commands_8h.html#a3a0aeca428b3ffc888248391356079ac">BreakpointHandleBpTraps</a> (<a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> CoreId)</td></tr>
<tr class="memdesc:a3a0aeca428b3ffc888248391356079ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle breakpoint vm-exits (#BP)  <br /></td></tr>
<tr class="separator:a3a0aeca428b3ffc888248391356079ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af249a8d277f3fe6fdeeb1796e537572b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_breakpoint_commands_8h.html#af249a8d277f3fe6fdeeb1796e537572b">BreakpointCheckAndHandleDebuggerDefinedBreakpoints</a> (<a class="el" href="hprdbgkd_2header_2debugger_2core_2_state_8h.html#aa35afece6adc9a29a7bf7a2e76476037">PROCESSOR_DEBUGGING_STATE</a> *DbgState, <a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> GuestRip, <a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_connection_8h.html#ac834b5b60f3a3213636632ea482a26a3">DEBUGGEE_PAUSING_REASON</a> Reason, <a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ChangeMtfState)</td></tr>
<tr class="memdesc:af249a8d277f3fe6fdeeb1796e537572b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the breakpoint vm-exit relates to 'bp' command or not.  <br /></td></tr>
<tr class="separator:af249a8d277f3fe6fdeeb1796e537572b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2d64f1a4448078440fa5e05a511e3bb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_breakpoint_commands_8h.html#ac2d64f1a4448078440fa5e05a511e3bb">BreakpointCheckAndHandleReApplyingBreakpoint</a> (<a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> CoreId)</td></tr>
<tr class="memdesc:ac2d64f1a4448078440fa5e05a511e3bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check and reapply breakpoint.  <br /></td></tr>
<tr class="separator:ac2d64f1a4448078440fa5e05a511e3bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6de84d2bb5c24bf8c4edcbad8e9dc055"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_breakpoint_commands_8h.html#a6de84d2bb5c24bf8c4edcbad8e9dc055">BreakpointCheckAndHandleDebugBreakpoint</a> (<a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> CoreId)</td></tr>
<tr class="memdesc:a6de84d2bb5c24bf8c4edcbad8e9dc055"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check and handle debug breakpoint exceptions.  <br /></td></tr>
<tr class="separator:a6de84d2bb5c24bf8c4edcbad8e9dc055"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2b3b7d14e79251d6e4b20dff257500a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_breakpoint_commands_8h.html#aa2b3b7d14e79251d6e4b20dff257500a">SearchAddressWrapper</a> (<a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ad413c7f23e00f0764dfa0ab21b6442a0">PUINT64</a> AddressToSaveResults, <a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a259329cf5d90fa23392810c8705398cf">PDEBUGGER_SEARCH_MEMORY</a> SearchMemRequest, <a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> StartAddress, <a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> EndAddress, <a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> IsDebuggeePaused, <a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a8e3d0f172defb4e820ad5df4ec48960c">PUINT32</a> CountOfMatchedCases)</td></tr>
<tr class="memdesc:aa2b3b7d14e79251d6e4b20dff257500a"><td class="mdescLeft">&#160;</td><td class="mdescRight">The wrapper to check for validity of addresses and call the search routines for both physical and virtual memory.  <br /></td></tr>
<tr class="separator:aa2b3b7d14e79251d6e4b20dff257500a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Commands for setting breakpoints. </p>
<dl class="section author"><dt>Author</dt><dd>Sina Karvandi (<a href="#" onclick="location.href='mai'+'lto:'+'sin'+'a@'+'hyp'+'er'+'dbg'+'.o'+'rg'; return false;">sina@<span class="obfuscator">.nosp@m.</span>hype<span class="obfuscator">.nosp@m.</span>rdbg.<span class="obfuscator">.nosp@m.</span>org</a>) </dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2021-03-12</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>This project is released under the GNU Public License v3. </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a295701da4a28b591937893cfbb3dcd75" name="a295701da4a28b591937893cfbb3dcd75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a295701da4a28b591937893cfbb3dcd75">&#9670;&#160;</a></span>BreakpointAddNew()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> BreakpointAddNew </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a58c97daf5894ba79ab884e8b85515ad3">PDEBUGGEE_BP_PACKET</a>&#160;</td>
          <td class="paramname"><em>BpDescriptorArg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add new breakpoints. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">BpDescriptor</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  555</span>{</div>
<div class="line"><span class="lineno">  556</span>    <a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html">PDEBUGGEE_BP_DESCRIPTOR</a> BreakpointDescriptor = NULL;</div>
<div class="line"><span class="lineno">  557</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>                  ProcessorCount;</div>
<div class="line"><span class="lineno">  558</span>    <a class="code hl_struct" href="struct___c_r3___t_y_p_e.html">CR3_TYPE</a>                GuestCr3;</div>
<div class="line"><span class="lineno">  559</span> </div>
<div class="line"><span class="lineno">  560</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  561</span>    <span class="comment">// Find the current process cr3</span></div>
<div class="line"><span class="lineno">  562</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  563</span>    GuestCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a> = <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#ade88a95bca6e425e8c81c358d041d76c">LayoutGetCurrentProcessCr3</a>().<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>;</div>
<div class="line"><span class="lineno">  564</span> </div>
<div class="line"><span class="lineno">  565</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  566</span>    <span class="comment">// *** Validate arguments ***</span></div>
<div class="line"><span class="lineno">  567</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  568</span> </div>
<div class="line"><span class="lineno">  569</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  570</span>    <span class="comment">// Check if address is safe (only one byte for 0xcc)</span></div>
<div class="line"><span class="lineno">  571</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  572</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a240789bd1c3cf023cd1403d4ea32bb19">CheckAccessValidityAndSafety</a>(BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#aa58a4dcb7c01e3412eac7dd3b428f309">Address</a>, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>)))</div>
<div class="line"><span class="lineno">  573</span>    {</div>
<div class="line"><span class="lineno">  574</span>        BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#a31f51c86477913031d2e01f69341620f">Result</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#a68e4d375f85d62fc6169b228d0cb346a">DEBUGGER_ERROR_EDIT_MEMORY_STATUS_INVALID_ADDRESS_BASED_ON_CURRENT_PROCESS</a>;</div>
<div class="line"><span class="lineno">  575</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  576</span>    }</div>
<div class="line"><span class="lineno">  577</span> </div>
<div class="line"><span class="lineno">  578</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  579</span>    <span class="comment">// Check if the core number is not invalid</span></div>
<div class="line"><span class="lineno">  580</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  581</span>    ProcessorCount = KeQueryActiveProcessorCount(0);</div>
<div class="line"><span class="lineno">  582</span> </div>
<div class="line"><span class="lineno">  583</span>    <span class="keywordflow">if</span> (BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#a7285098a69927e556cbc61864a1d7e62">Core</a> != <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_constants_8h.html#aa145d6235b4996c241ae08d13de243a0">DEBUGGEE_BP_APPLY_TO_ALL_CORES</a> &amp;&amp;</div>
<div class="line"><span class="lineno">  584</span>        BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#a7285098a69927e556cbc61864a1d7e62">Core</a> &gt;= ProcessorCount)</div>
<div class="line"><span class="lineno">  585</span>    {</div>
<div class="line"><span class="lineno">  586</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  587</span>        <span class="comment">// Core is invalid (Set the error)</span></div>
<div class="line"><span class="lineno">  588</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  589</span>        BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#a31f51c86477913031d2e01f69341620f">Result</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#a5a5ccba7c7cceb94d66f297978047611">DEBUGGER_ERROR_INVALID_CORE_ID</a>;</div>
<div class="line"><span class="lineno">  590</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  591</span>    }</div>
<div class="line"><span class="lineno">  592</span> </div>
<div class="line"><span class="lineno">  593</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  594</span>    <span class="comment">// Check if breakpoint already exists on list or not</span></div>
<div class="line"><span class="lineno">  595</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  596</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="_breakpoint_commands_8c.html#ae7d28c7c329ec9621af580e43f13b412">BreakpointGetEntryByAddress</a>(BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#aa58a4dcb7c01e3412eac7dd3b428f309">Address</a>) != NULL)</div>
<div class="line"><span class="lineno">  597</span>    {</div>
<div class="line"><span class="lineno">  598</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  599</span>        <span class="comment">// Address is already on the list (Set the error)</span></div>
<div class="line"><span class="lineno">  600</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  601</span>        BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#a31f51c86477913031d2e01f69341620f">Result</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#a3b5b126406066bc4844a91c1d07de9ac">DEBUGGER_ERROR_BREAKPOINT_ALREADY_EXISTS_ON_THE_ADDRESS</a>;</div>
<div class="line"><span class="lineno">  602</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  603</span>    }</div>
<div class="line"><span class="lineno">  604</span> </div>
<div class="line"><span class="lineno">  605</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  606</span>    <span class="comment">// We won&#39;t check for process id and thread id, if these arguments are invalid</span></div>
<div class="line"><span class="lineno">  607</span>    <span class="comment">// then the HyperDbg simply ignores the breakpoints but it makes the computer slow</span></div>
<div class="line"><span class="lineno">  608</span>    <span class="comment">// it just won&#39;t be triggered</span></div>
<div class="line"><span class="lineno">  609</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  610</span> </div>
<div class="line"><span class="lineno">  611</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  612</span>    <span class="comment">// When we reach here means that the arguments are valid and address is</span></div>
<div class="line"><span class="lineno">  613</span>    <span class="comment">// safe to access (put 0xcc)</span></div>
<div class="line"><span class="lineno">  614</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  615</span> </div>
<div class="line"><span class="lineno">  616</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  617</span>    <span class="comment">// Get the pre-allocated buffer</span></div>
<div class="line"><span class="lineno">  618</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  619</span>    BreakpointDescriptor = <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a7f3b17763776a06c42601f8da4cad5ec">PoolManagerRequestPool</a>(<a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63ab8948b7a3ee40226d0f76b7fccf90b9a">BREAKPOINT_DEFINITION_STRUCTURE</a>, <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html">DEBUGGEE_BP_DESCRIPTOR</a>));</div>
<div class="line"><span class="lineno">  620</span> </div>
<div class="line"><span class="lineno">  621</span>    <span class="keywordflow">if</span> (BreakpointDescriptor == NULL)</div>
<div class="line"><span class="lineno">  622</span>    {</div>
<div class="line"><span class="lineno">  623</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  624</span>        <span class="comment">// No pool ! Probably the user set more than MAXIMUM_BREAKPOINTS_WITHOUT_CONTINUE</span></div>
<div class="line"><span class="lineno">  625</span>        <span class="comment">// pools without IOCTL (continue)</span></div>
<div class="line"><span class="lineno">  626</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  627</span>        BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#a31f51c86477913031d2e01f69341620f">Result</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#a29e9c99a3400fc71880be5e623e7baaf">DEBUGGER_ERROR_MAXIMUM_BREAKPOINT_WITHOUT_CONTINUE</a>;</div>
<div class="line"><span class="lineno">  628</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  629</span>    }</div>
<div class="line"><span class="lineno">  630</span> </div>
<div class="line"><span class="lineno">  631</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  632</span>    <span class="comment">// Copy details of breakpoint to the descriptor structure</span></div>
<div class="line"><span class="lineno">  633</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  634</span>    <a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#ad09616266c993d19a27d9f414073c0a7">g_MaximumBreakpointId</a>++;</div>
<div class="line"><span class="lineno">  635</span>    BreakpointDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a0600a3a7a748f669bef44b0eb920fd4f">BreakpointId</a> = <a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#ad09616266c993d19a27d9f414073c0a7">g_MaximumBreakpointId</a>;</div>
<div class="line"><span class="lineno">  636</span>    BreakpointDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a6ee164edb59fd20f9e69048564dd435a">Address</a>      = BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#aa58a4dcb7c01e3412eac7dd3b428f309">Address</a>;</div>
<div class="line"><span class="lineno">  637</span>    BreakpointDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#ab5f824b8c4d255545d038d3e57231e76">PhysAddress</a>  = <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#aa4c6128ae9e5d96a297990bf5d3e7c5d">VirtualAddressToPhysicalAddressByProcessCr3</a>(BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#aa58a4dcb7c01e3412eac7dd3b428f309">Address</a>,</div>
<div class="line"><span class="lineno">  638</span>                                                                                    GuestCr3);</div>
<div class="line"><span class="lineno">  639</span>    BreakpointDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#aff66a054304ff0b558bd5e5688cb8e04">Core</a>         = BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#a7285098a69927e556cbc61864a1d7e62">Core</a>;</div>
<div class="line"><span class="lineno">  640</span>    BreakpointDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#ad46a87a0665b8d99405fec5650ae1eb1">Pid</a>          = BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#aae09270daf430ca348d56079a35ed1b8">Pid</a>;</div>
<div class="line"><span class="lineno">  641</span>    BreakpointDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#ad787a3220aa8e2b76f31c570f33fd071">Tid</a>          = BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#a13aeaf024d8bea5bd40692b08a8ed3ee">Tid</a>;</div>
<div class="line"><span class="lineno">  642</span> </div>
<div class="line"><span class="lineno">  643</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  644</span>    <span class="comment">// Use length disassembler engine to get the instruction length</span></div>
<div class="line"><span class="lineno">  645</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  646</span>    BreakpointDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a603517c66479592e240eeacb29379803">InstructionLength</a> = <a class="code hl_function" href="_length_disassembler_engine_8h.html#a54247063c60b345c5935afee417bbc1a">ldisasm</a>(BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#aa58a4dcb7c01e3412eac7dd3b428f309">Address</a>, <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><span class="lineno">  647</span> </div>
<div class="line"><span class="lineno">  648</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  649</span>    <span class="comment">// Breakpoints are enabled by default</span></div>
<div class="line"><span class="lineno">  650</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  651</span>    BreakpointDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#aac7e43f351a7b2c5d45e6b058be77036">Enabled</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  652</span> </div>
<div class="line"><span class="lineno">  653</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  654</span>    <span class="comment">// Now we should add the breakpoint to the list of breakpoints (LIST_ENTRY)</span></div>
<div class="line"><span class="lineno">  655</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  656</span>    <a class="code hl_function" href="list_8h.html#a77df31a5e6a1be59d08b93e9cb028f22">InsertHeadList</a>(&amp;<a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#abca944290c6a683f0821a9096472f7d4">g_BreakpointsListHead</a>, &amp;(BreakpointDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a963ede4fbe9776b1b18b53b4e2dff062">BreakpointsList</a>));</div>
<div class="line"><span class="lineno">  657</span> </div>
<div class="line"><span class="lineno">  658</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  659</span>    <span class="comment">// Apply the breakpoint</span></div>
<div class="line"><span class="lineno">  660</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  661</span>    <a class="code hl_function" href="_breakpoint_commands_8c.html#adbfa823a7d6541668573fc9467ee4355">BreakpointWrite</a>(BreakpointDescriptor);</div>
<div class="line"><span class="lineno">  662</span> </div>
<div class="line"><span class="lineno">  663</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  664</span>    <span class="comment">// Show that operation was successful</span></div>
<div class="line"><span class="lineno">  665</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  666</span>    BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#a31f51c86477913031d2e01f69341620f">Result</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#aed656c58434eecb2d7e8c10e93aecff4">DEBUGGER_OPERATION_WAS_SUCCESSFUL</a>;</div>
<div class="line"><span class="lineno">  667</span> </div>
<div class="line"><span class="lineno">  668</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  669</span>}</div>
<div class="ttc" id="a_breakpoint_commands_8c_html_adbfa823a7d6541668573fc9467ee4355"><div class="ttname"><a href="_breakpoint_commands_8c.html#adbfa823a7d6541668573fc9467ee4355">BreakpointWrite</a></div><div class="ttdeci">BOOLEAN BreakpointWrite(PDEBUGGEE_BP_DESCRIPTOR BreakpointDescriptor)</div><div class="ttdoc">writes the 0xcc and applies the breakpoint @detail this function won't remove the descriptor from the...</div><div class="ttdef"><b>Definition:</b> BreakpointCommands.c:369</div></div>
<div class="ttc" id="a_breakpoint_commands_8c_html_ae7d28c7c329ec9621af580e43f13b412"><div class="ttname"><a href="_breakpoint_commands_8c.html#ae7d28c7c329ec9621af580e43f13b412">BreakpointGetEntryByAddress</a></div><div class="ttdeci">PDEBUGGEE_BP_DESCRIPTOR BreakpointGetEntryByAddress(UINT64 Address)</div><div class="ttdoc">Find entry of breakpoint descriptor from list of breakpoints by address.</div><div class="ttdef"><b>Definition:</b> BreakpointCommands.c:524</div></div>
<div class="ttc" id="a_length_disassembler_engine_8h_html_a54247063c60b345c5935afee417bbc1a"><div class="ttname"><a href="_length_disassembler_engine_8h.html#a54247063c60b345c5935afee417bbc1a">ldisasm</a></div><div class="ttdeci">size_t ldisasm(const void *const address, const BOOLEAN x86_64_mode)</div><div class="ttdef"><b>Definition:</b> LengthDisassemblerEngine.h:64</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h_html_a4ae1dab0fb4b072a66584546209e7d58"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a></div><div class="ttdeci">unsigned char BYTE</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:22</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:50</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:49</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h_html_ae1e6edbbc26d6fbc71a90190d0266018"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></div><div class="ttdeci">unsigned int UINT32</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:46</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_constants_8h_html_aa145d6235b4996c241ae08d13de243a0"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_constants_8h.html#aa145d6235b4996c241ae08d13de243a0">DEBUGGEE_BP_APPLY_TO_ALL_CORES</a></div><div class="ttdeci">#define DEBUGGEE_BP_APPLY_TO_ALL_CORES</div><div class="ttdoc">The constant to apply to all cores for bp command.</div><div class="ttdef"><b>Definition:</b> Constants.h:587</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_data_types_8h_html_ad130f0bae4db97169873223d0aad9a63ab8948b7a3ee40226d0f76b7fccf90b9a"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63ab8948b7a3ee40226d0f76b7fccf90b9a">BREAKPOINT_DEFINITION_STRUCTURE</a></div><div class="ttdeci">@ BREAKPOINT_DEFINITION_STRUCTURE</div><div class="ttdef"><b>Definition:</b> DataTypes.h:45</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h_html_a29e9c99a3400fc71880be5e623e7baaf"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#a29e9c99a3400fc71880be5e623e7baaf">DEBUGGER_ERROR_MAXIMUM_BREAKPOINT_WITHOUT_CONTINUE</a></div><div class="ttdeci">#define DEBUGGER_ERROR_MAXIMUM_BREAKPOINT_WITHOUT_CONTINUE</div><div class="ttdoc">error, maximum pools were used without continueing debuggee</div><div class="ttdef"><b>Definition:</b> ErrorCodes.h:184</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h_html_a3b5b126406066bc4844a91c1d07de9ac"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#a3b5b126406066bc4844a91c1d07de9ac">DEBUGGER_ERROR_BREAKPOINT_ALREADY_EXISTS_ON_THE_ADDRESS</a></div><div class="ttdeci">#define DEBUGGER_ERROR_BREAKPOINT_ALREADY_EXISTS_ON_THE_ADDRESS</div><div class="ttdoc">error, breakpoint already exists on the target address</div><div class="ttdef"><b>Definition:</b> ErrorCodes.h:190</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h_html_a5a5ccba7c7cceb94d66f297978047611"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#a5a5ccba7c7cceb94d66f297978047611">DEBUGGER_ERROR_INVALID_CORE_ID</a></div><div class="ttdeci">#define DEBUGGER_ERROR_INVALID_CORE_ID</div><div class="ttdoc">error, the core id is invalid</div><div class="ttdef"><b>Definition:</b> ErrorCodes.h:69</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h_html_a68e4d375f85d62fc6169b228d0cb346a"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#a68e4d375f85d62fc6169b228d0cb346a">DEBUGGER_ERROR_EDIT_MEMORY_STATUS_INVALID_ADDRESS_BASED_ON_CURRENT_PROCESS</a></div><div class="ttdeci">#define DEBUGGER_ERROR_EDIT_MEMORY_STATUS_INVALID_ADDRESS_BASED_ON_CURRENT_PROCESS</div><div class="ttdoc">error, an invalid address is specified based on current cr3 in !e* or e* commands</div><div class="ttdef"><b>Definition:</b> ErrorCodes.h:106</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h_html_aed656c58434eecb2d7e8c10e93aecff4"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#aed656c58434eecb2d7e8c10e93aecff4">DEBUGGER_OPERATION_WAS_SUCCESSFUL</a></div><div class="ttdeci">#define DEBUGGER_OPERATION_WAS_SUCCESSFUL</div><div class="ttdoc">General value to indicate that the operation or request was successful.</div><div class="ttdef"><b>Definition:</b> ErrorCodes.h:23</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_a240789bd1c3cf023cd1403d4ea32bb19"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a240789bd1c3cf023cd1403d4ea32bb19">CheckAccessValidityAndSafety</a></div><div class="ttdeci">IMPORT_EXPORT_VMM BOOLEAN CheckAccessValidityAndSafety(UINT64 TargetAddress, UINT32 Size)</div><div class="ttdoc">Check the safety to access the memory.</div><div class="ttdef"><b>Definition:</b> common.cpp:1038</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_a7f3b17763776a06c42601f8da4cad5ec"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a7f3b17763776a06c42601f8da4cad5ec">PoolManagerRequestPool</a></div><div class="ttdeci">IMPORT_EXPORT_VMM UINT64 PoolManagerRequestPool(POOL_ALLOCATION_INTENTION Intention, BOOLEAN RequestNewPool, UINT32 Size)</div><div class="ttdoc">This function should be called from vmx-root in order to get a pool from the list.</div><div class="ttdef"><b>Definition:</b> PoolManager.c:234</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_aa4c6128ae9e5d96a297990bf5d3e7c5d"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#aa4c6128ae9e5d96a297990bf5d3e7c5d">VirtualAddressToPhysicalAddressByProcessCr3</a></div><div class="ttdeci">IMPORT_EXPORT_VMM UINT64 VirtualAddressToPhysicalAddressByProcessCr3(_In_ PVOID VirtualAddress, _In_ CR3_TYPE TargetCr3)</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_ade88a95bca6e425e8c81c358d041d76c"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#ade88a95bca6e425e8c81c358d041d76c">LayoutGetCurrentProcessCr3</a></div><div class="ttdeci">IMPORT_EXPORT_VMM CR3_TYPE LayoutGetCurrentProcessCr3()</div><div class="ttdoc">Get cr3 of the target running process.</div><div class="ttdef"><b>Definition:</b> Layout.c:55</div></div>
<div class="ttc" id="ahprdbgkd_2header_2globals_2_global_8h_html_abca944290c6a683f0821a9096472f7d4"><div class="ttname"><a href="hprdbgkd_2header_2globals_2_global_8h.html#abca944290c6a683f0821a9096472f7d4">g_BreakpointsListHead</a></div><div class="ttdeci">LIST_ENTRY g_BreakpointsListHead</div><div class="ttdoc">List header of breakpoints for debugger-mode.</div><div class="ttdef"><b>Definition:</b> Global.h:85</div></div>
<div class="ttc" id="ahprdbgkd_2header_2globals_2_global_8h_html_ad09616266c993d19a27d9f414073c0a7"><div class="ttname"><a href="hprdbgkd_2header_2globals_2_global_8h.html#ad09616266c993d19a27d9f414073c0a7">g_MaximumBreakpointId</a></div><div class="ttdeci">UINT64 g_MaximumBreakpointId</div><div class="ttdoc">Seed for setting id of breakpoints.</div><div class="ttdef"><b>Definition:</b> Global.h:91</div></div>
<div class="ttc" id="alist_8h_html_a77df31a5e6a1be59d08b93e9cb028f22"><div class="ttname"><a href="list_8h.html#a77df31a5e6a1be59d08b93e9cb028f22">InsertHeadList</a></div><div class="ttdeci">void InsertHeadList(PLIST_ENTRY ListHead, PLIST_ENTRY Entry)</div></div>
<div class="ttc" id="astruct___c_r3___t_y_p_e_html"><div class="ttname"><a href="struct___c_r3___t_y_p_e.html">_CR3_TYPE</a></div><div class="ttdoc">CR3 Structure.</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:136</div></div>
<div class="ttc" id="astruct___c_r3___t_y_p_e_html_a04eb96cc99b0458be739bcc9c640e08b"><div class="ttname"><a href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">_CR3_TYPE::Flags</a></div><div class="ttdeci">UINT64 Flags</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:139</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html">_DEBUGGEE_BP_DESCRIPTOR</a></div><div class="ttdoc">The structure of storing breakpoints.</div><div class="ttdef"><b>Definition:</b> State.h:72</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html_a0600a3a7a748f669bef44b0eb920fd4f"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a0600a3a7a748f669bef44b0eb920fd4f">_DEBUGGEE_BP_DESCRIPTOR::BreakpointId</a></div><div class="ttdeci">UINT64 BreakpointId</div><div class="ttdef"><b>Definition:</b> State.h:73</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html_a603517c66479592e240eeacb29379803"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a603517c66479592e240eeacb29379803">_DEBUGGEE_BP_DESCRIPTOR::InstructionLength</a></div><div class="ttdeci">UINT16 InstructionLength</div><div class="ttdef"><b>Definition:</b> State.h:81</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html_a6ee164edb59fd20f9e69048564dd435a"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a6ee164edb59fd20f9e69048564dd435a">_DEBUGGEE_BP_DESCRIPTOR::Address</a></div><div class="ttdeci">UINT64 Address</div><div class="ttdef"><b>Definition:</b> State.h:76</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html_a963ede4fbe9776b1b18b53b4e2dff062"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a963ede4fbe9776b1b18b53b4e2dff062">_DEBUGGEE_BP_DESCRIPTOR::BreakpointsList</a></div><div class="ttdeci">LIST_ENTRY BreakpointsList</div><div class="ttdef"><b>Definition:</b> State.h:74</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html_aac7e43f351a7b2c5d45e6b058be77036"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#aac7e43f351a7b2c5d45e6b058be77036">_DEBUGGEE_BP_DESCRIPTOR::Enabled</a></div><div class="ttdeci">BOOLEAN Enabled</div><div class="ttdef"><b>Definition:</b> State.h:75</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html_ab5f824b8c4d255545d038d3e57231e76"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#ab5f824b8c4d255545d038d3e57231e76">_DEBUGGEE_BP_DESCRIPTOR::PhysAddress</a></div><div class="ttdeci">UINT64 PhysAddress</div><div class="ttdef"><b>Definition:</b> State.h:77</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html_ad46a87a0665b8d99405fec5650ae1eb1"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#ad46a87a0665b8d99405fec5650ae1eb1">_DEBUGGEE_BP_DESCRIPTOR::Pid</a></div><div class="ttdeci">UINT32 Pid</div><div class="ttdef"><b>Definition:</b> State.h:78</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html_ad787a3220aa8e2b76f31c570f33fd071"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#ad787a3220aa8e2b76f31c570f33fd071">_DEBUGGEE_BP_DESCRIPTOR::Tid</a></div><div class="ttdeci">UINT32 Tid</div><div class="ttdef"><b>Definition:</b> State.h:79</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html_aff66a054304ff0b558bd5e5688cb8e04"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#aff66a054304ff0b558bd5e5688cb8e04">_DEBUGGEE_BP_DESCRIPTOR::Core</a></div><div class="ttdeci">UINT32 Core</div><div class="ttdef"><b>Definition:</b> State.h:80</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t_html_a13aeaf024d8bea5bd40692b08a8ed3ee"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#a13aeaf024d8bea5bd40692b08a8ed3ee">_DEBUGGEE_BP_PACKET::Tid</a></div><div class="ttdeci">UINT32 Tid</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:1005</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t_html_a31f51c86477913031d2e01f69341620f"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#a31f51c86477913031d2e01f69341620f">_DEBUGGEE_BP_PACKET::Result</a></div><div class="ttdeci">UINT32 Result</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:1007</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t_html_a7285098a69927e556cbc61864a1d7e62"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#a7285098a69927e556cbc61864a1d7e62">_DEBUGGEE_BP_PACKET::Core</a></div><div class="ttdeci">UINT32 Core</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:1006</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t_html_aa58a4dcb7c01e3412eac7dd3b428f309"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#aa58a4dcb7c01e3412eac7dd3b428f309">_DEBUGGEE_BP_PACKET::Address</a></div><div class="ttdeci">UINT64 Address</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:1003</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t_html_aae09270daf430ca348d56079a35ed1b8"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#aae09270daf430ca348d56079a35ed1b8">_DEBUGGEE_BP_PACKET::Pid</a></div><div class="ttdeci">UINT32 Pid</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:1004</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6de84d2bb5c24bf8c4edcbad8e9dc055" name="a6de84d2bb5c24bf8c4edcbad8e9dc055"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6de84d2bb5c24bf8c4edcbad8e9dc055">&#9670;&#160;</a></span>BreakpointCheckAndHandleDebugBreakpoint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> BreakpointCheckAndHandleDebugBreakpoint </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td>
          <td class="paramname"><em>CoreId</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check and handle debug breakpoint exceptions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CoreId</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   23</span>{</div>
<div class="line"><span class="lineno">   24</span>    <a class="code hl_struct" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html">PROCESSOR_DEBUGGING_STATE</a> * DbgState = &amp;<a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a>[CoreId];</div>
<div class="line"><span class="lineno">   25</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                     Result   = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">   26</span> </div>
<div class="line"><span class="lineno">   27</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   28</span>    <span class="comment">// Check whether it is because of thread change detection or not</span></div>
<div class="line"><span class="lineno">   29</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   30</span>    <span class="keywordflow">if</span> (DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a8f17ce3238c1b7fcd0e8a53040cba548">ThreadOrProcessTracingDetails</a>.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___p_r_o_c_e_s_s___o_r___t_h_r_e_a_d___t_r_a_c_i_n_g___d_e_t_a_i_l_s.html#a828cb9812e870d901c9397930c02a451">DebugRegisterInterceptionState</a>)</div>
<div class="line"><span class="lineno">   31</span>    {</div>
<div class="line"><span class="lineno">   32</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   33</span>        <span class="comment">// This way of handling has a problem, if the user set to change</span></div>
<div class="line"><span class="lineno">   34</span>        <span class="comment">// the thread and instead of using &#39;g&#39;, it pressed the &#39;p&#39; to</span></div>
<div class="line"><span class="lineno">   35</span>        <span class="comment">// set or a trap happens somewhere then will be ignored</span></div>
<div class="line"><span class="lineno">   36</span>        <span class="comment">// it because we don&#39;t know the origin of this debug breakpoint</span></div>
<div class="line"><span class="lineno">   37</span>        <span class="comment">// and it only happens on &#39;.thread2&#39; command, the correct way</span></div>
<div class="line"><span class="lineno">   38</span>        <span class="comment">// to handle it is to find the exact hw debug register that caused</span></div>
<div class="line"><span class="lineno">   39</span>        <span class="comment">// this vm-exit, but it&#39;s a really rare case, so we left it without</span></div>
<div class="line"><span class="lineno">   40</span>        <span class="comment">// handling this case</span></div>
<div class="line"><span class="lineno">   41</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   42</span>        <a class="code hl_function" href="_thread_8c.html#a2d1b8ef9edfc052394e1b64cf6daf3d3">ThreadHandleThreadChange</a>(DbgState);</div>
<div class="line"><span class="lineno">   43</span>    }</div>
<div class="line"><span class="lineno">   44</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#ae304ded1a8cbb4e772d97aec7510c9d2">g_UserDebuggerState</a> == <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a> &amp;&amp;</div>
<div class="line"><span class="lineno">   45</span>             (<a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#af09520fe178a6499a1727ed73b228add">g_IsWaitingForUserModeModuleEntrypointToBeCalled</a> || <a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#a0b03446aa090036e1c29277857de9596">g_IsWaitingForReturnAndRunFromPageFault</a>))</div>
<div class="line"><span class="lineno">   46</span>    {</div>
<div class="line"><span class="lineno">   47</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   48</span>        <span class="comment">// Handle for user-mode attaching mechanism</span></div>
<div class="line"><span class="lineno">   49</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   50</span>        <a class="code hl_function" href="_attaching_8c.html#a29f7e27bd80ff2354ac96b8d87335897">AttachingHandleEntrypointDebugBreak</a>(DbgState);</div>
<div class="line"><span class="lineno">   51</span>    }</div>
<div class="line"><span class="lineno">   52</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#ae4b5afa957e3e26377135b91b60eda4e">g_KernelDebuggerState</a> == <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)</div>
<div class="line"><span class="lineno">   53</span>    {</div>
<div class="line"><span class="lineno">   54</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   55</span>        <span class="comment">// Handle debug events (breakpoint, traps, hardware debug register when kernel</span></div>
<div class="line"><span class="lineno">   56</span>        <span class="comment">// debugger is attached.)</span></div>
<div class="line"><span class="lineno">   57</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   58</span>        <a class="code hl_function" href="_kd_8c.html#a471c63b8db9a487f132923dcaf13b0cc">KdHandleDebugEventsWhenKernelDebuggerIsAttached</a>(DbgState);</div>
<div class="line"><span class="lineno">   59</span>    }</div>
<div class="line"><span class="lineno">   60</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="_ud_8c.html#a5ebe34618715108270c71344983e4af3">UdCheckAndHandleBreakpointsAndDebugBreaks</a>(DbgState,</div>
<div class="line"><span class="lineno">   61</span>                                                       <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_connection_8h.html#a6e2be89205e735ebae644cf4850ac21ba369b24d73385054023d8aba1a5d3c8b5">DEBUGGEE_PAUSING_REASON_DEBUGGEE_GENERAL_DEBUG_BREAK</a>,</div>
<div class="line"><span class="lineno">   62</span>                                                       NULL))</div>
<div class="line"><span class="lineno">   63</span>    {</div>
<div class="line"><span class="lineno">   64</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   65</span>        <span class="comment">// if the above function returns true, no need for further action</span></div>
<div class="line"><span class="lineno">   66</span>        <span class="comment">// it&#39;s handled in the user debugger</span></div>
<div class="line"><span class="lineno">   67</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   68</span>    }</div>
<div class="line"><span class="lineno">   69</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   70</span>    {</div>
<div class="line"><span class="lineno">   71</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   72</span>        <span class="comment">// Not handled by debugger</span></div>
<div class="line"><span class="lineno">   73</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   74</span>        Result = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">   75</span>    }</div>
<div class="line"><span class="lineno">   76</span> </div>
<div class="line"><span class="lineno">   77</span>    <span class="keywordflow">return</span> Result;</div>
<div class="line"><span class="lineno">   78</span>}</div>
<div class="ttc" id="a_attaching_8c_html_a29f7e27bd80ff2354ac96b8d87335897"><div class="ttname"><a href="_attaching_8c.html#a29f7e27bd80ff2354ac96b8d87335897">AttachingHandleEntrypointDebugBreak</a></div><div class="ttdeci">VOID AttachingHandleEntrypointDebugBreak(PROCESSOR_DEBUGGING_STATE *DbgState)</div><div class="ttdoc">Handle debug register event (#DB) for attaching to user-mode process.</div><div class="ttdef"><b>Definition:</b> Attaching.c:385</div></div>
<div class="ttc" id="a_kd_8c_html_a471c63b8db9a487f132923dcaf13b0cc"><div class="ttname"><a href="_kd_8c.html#a471c63b8db9a487f132923dcaf13b0cc">KdHandleDebugEventsWhenKernelDebuggerIsAttached</a></div><div class="ttdeci">VOID KdHandleDebugEventsWhenKernelDebuggerIsAttached(PROCESSOR_DEBUGGING_STATE *DbgState)</div><div class="ttdoc">Handles debug events when kernel-debugger is attached.</div><div class="ttdef"><b>Definition:</b> Kd.c:373</div></div>
<div class="ttc" id="a_thread_8c_html_a2d1b8ef9edfc052394e1b64cf6daf3d3"><div class="ttname"><a href="_thread_8c.html#a2d1b8ef9edfc052394e1b64cf6daf3d3">ThreadHandleThreadChange</a></div><div class="ttdeci">BOOLEAN ThreadHandleThreadChange(PROCESSOR_DEBUGGING_STATE *DbgState)</div><div class="ttdoc">handle thread changes</div><div class="ttdef"><b>Definition:</b> Thread.c:22</div></div>
<div class="ttc" id="a_ud_8c_html_a5ebe34618715108270c71344983e4af3"><div class="ttname"><a href="_ud_8c.html#a5ebe34618715108270c71344983e4af3">UdCheckAndHandleBreakpointsAndDebugBreaks</a></div><div class="ttdeci">BOOLEAN UdCheckAndHandleBreakpointsAndDebugBreaks(PROCESSOR_DEBUGGING_STATE *DbgState, DEBUGGEE_PAUSING_REASON Reason, PDEBUGGER_TRIGGERED_EVENT_DETAILS EventDetails)</div><div class="ttdoc">Handle #DBs and #BPs for kernel debugger.</div><div class="ttdef"><b>Definition:</b> Ud.c:470</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h_html_a1cb18096b299d23458d3c7b85fd86555"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></div><div class="ttdeci">UCHAR BOOLEAN</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:37</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_connection_8h_html_a6e2be89205e735ebae644cf4850ac21ba369b24d73385054023d8aba1a5d3c8b5"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_connection_8h.html#a6e2be89205e735ebae644cf4850ac21ba369b24d73385054023d8aba1a5d3c8b5">DEBUGGEE_PAUSING_REASON_DEBUGGEE_GENERAL_DEBUG_BREAK</a></div><div class="ttdeci">@ DEBUGGEE_PAUSING_REASON_DEBUGGEE_GENERAL_DEBUG_BREAK</div><div class="ttdef"><b>Definition:</b> Connection.h:40</div></div>
<div class="ttc" id="ahprdbgkd_2header_2globals_2_global_8h_html_a0b03446aa090036e1c29277857de9596"><div class="ttname"><a href="hprdbgkd_2header_2globals_2_global_8h.html#a0b03446aa090036e1c29277857de9596">g_IsWaitingForReturnAndRunFromPageFault</a></div><div class="ttdeci">BOOLEAN g_IsWaitingForReturnAndRunFromPageFault</div><div class="ttdoc">Whether the thread attaching mechanism is waiting for a page-fault finish or not.</div><div class="ttdef"><b>Definition:</b> Global.h:134</div></div>
<div class="ttc" id="ahprdbgkd_2header_2globals_2_global_8h_html_a349ee1adc363d2e4323a35a68fae5646"><div class="ttname"><a href="hprdbgkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a></div><div class="ttdeci">PROCESSOR_DEBUGGING_STATE * g_DbgState</div><div class="ttdoc">Save the state and variables related to debugging on each to logical core.</div><div class="ttdef"><b>Definition:</b> Global.h:23</div></div>
<div class="ttc" id="ahprdbgkd_2header_2globals_2_global_8h_html_ae304ded1a8cbb4e772d97aec7510c9d2"><div class="ttname"><a href="hprdbgkd_2header_2globals_2_global_8h.html#ae304ded1a8cbb4e772d97aec7510c9d2">g_UserDebuggerState</a></div><div class="ttdeci">BOOLEAN g_UserDebuggerState</div><div class="ttdoc">shows whether the user debugger is enabled or disabled</div><div class="ttdef"><b>Definition:</b> Global.h:103</div></div>
<div class="ttc" id="ahprdbgkd_2header_2globals_2_global_8h_html_ae4b5afa957e3e26377135b91b60eda4e"><div class="ttname"><a href="hprdbgkd_2header_2globals_2_global_8h.html#ae4b5afa957e3e26377135b91b60eda4e">g_KernelDebuggerState</a></div><div class="ttdeci">BOOLEAN g_KernelDebuggerState</div><div class="ttdoc">shows whether the kernel debugger is enabled or disabled</div><div class="ttdef"><b>Definition:</b> Global.h:97</div></div>
<div class="ttc" id="ahprdbgkd_2header_2globals_2_global_8h_html_af09520fe178a6499a1727ed73b228add"><div class="ttname"><a href="hprdbgkd_2header_2globals_2_global_8h.html#af09520fe178a6499a1727ed73b228add">g_IsWaitingForUserModeModuleEntrypointToBeCalled</a></div><div class="ttdeci">BOOLEAN g_IsWaitingForUserModeModuleEntrypointToBeCalled</div><div class="ttdoc">Whether the thread attaching mechanism is waiting for #DB or not.</div><div class="ttdef"><b>Definition:</b> Global.h:173</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___p_r_o_c_e_s_s___o_r___t_h_r_e_a_d___t_r_a_c_i_n_g___d_e_t_a_i_l_s_html_a828cb9812e870d901c9397930c02a451"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___p_r_o_c_e_s_s___o_r___t_h_r_e_a_d___t_r_a_c_i_n_g___d_e_t_a_i_l_s.html#a828cb9812e870d901c9397930c02a451">_DEBUGGEE_PROCESS_OR_THREAD_TRACING_DETAILS::DebugRegisterInterceptionState</a></div><div class="ttdeci">BOOLEAN DebugRegisterInterceptionState</div><div class="ttdef"><b>Definition:</b> State.h:56</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html">_PROCESSOR_DEBUGGING_STATE</a></div><div class="ttdoc">Saves the debugger state.</div><div class="ttdef"><b>Definition:</b> State.h:106</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html_a8f17ce3238c1b7fcd0e8a53040cba548"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a8f17ce3238c1b7fcd0e8a53040cba548">_PROCESSOR_DEBUGGING_STATE::ThreadOrProcessTracingDetails</a></div><div class="ttdeci">DEBUGGEE_PROCESS_OR_THREAD_TRACING_DETAILS ThreadOrProcessTracingDetails</div><div class="ttdef"><b>Definition:</b> State.h:118</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af249a8d277f3fe6fdeeb1796e537572b" name="af249a8d277f3fe6fdeeb1796e537572b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af249a8d277f3fe6fdeeb1796e537572b">&#9670;&#160;</a></span>BreakpointCheckAndHandleDebuggerDefinedBreakpoints()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> BreakpointCheckAndHandleDebuggerDefinedBreakpoints </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hprdbgkd_2header_2debugger_2core_2_state_8h.html#aa35afece6adc9a29a7bf7a2e76476037">PROCESSOR_DEBUGGING_STATE</a> *&#160;</td>
          <td class="paramname"><em>DbgState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>&#160;</td>
          <td class="paramname"><em>GuestRip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_connection_8h.html#ac834b5b60f3a3213636632ea482a26a3">DEBUGGEE_PAUSING_REASON</a>&#160;</td>
          <td class="paramname"><em>Reason</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td>
          <td class="paramname"><em>ChangeMtfState</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if the breakpoint vm-exit relates to 'bp' command or not. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">DbgState</td><td>The state of the debugger on the current core </td></tr>
    <tr><td class="paramname">GuestRip</td><td></td></tr>
    <tr><td class="paramname">Reason</td><td></td></tr>
    <tr><td class="paramname">ChangeMtfState</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  147</span>{</div>
<div class="line"><span class="lineno">  148</span>    <a class="code hl_struct" href="struct___c_r3___t_y_p_e.html">CR3_TYPE</a>                         GuestCr3;</div>
<div class="line"><span class="lineno">  149</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                          IsHandledByBpRoutines = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  150</span>    PLIST_ENTRY                      TempList              = 0;</div>
<div class="line"><span class="lineno">  151</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>                           GuestRipPhysical      = NULL;</div>
<div class="line"><span class="lineno">  152</span>    <a class="code hl_struct" href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html">DEBUGGER_TRIGGERED_EVENT_DETAILS</a> ContextAndTag         = {0};</div>
<div class="line"><span class="lineno">  153</span>    RFLAGS                           Rflags                = {0};</div>
<div class="line"><span class="lineno">  154</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a>                            LengthOfExitInstr     = 0;</div>
<div class="line"><span class="lineno">  155</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>                             InstrByte             = NULL;</div>
<div class="line"><span class="lineno">  156</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                          AvoidUnsetMtf         = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  159</span>    <span class="comment">// ***** Check breakpoint for &#39;bp&#39; command *****</span></div>
<div class="line"><span class="lineno">  160</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  163</span>    <span class="comment">// Find the current process cr3</span></div>
<div class="line"><span class="lineno">  164</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  165</span>    GuestCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a> = <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#ade88a95bca6e425e8c81c358d041d76c">LayoutGetCurrentProcessCr3</a>().<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>;</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  168</span>    <span class="comment">// Convert breakpoint to physical address</span></div>
<div class="line"><span class="lineno">  169</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  170</span>    GuestRipPhysical = <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#aa4c6128ae9e5d96a297990bf5d3e7c5d">VirtualAddressToPhysicalAddressByProcessCr3</a>(GuestRip, GuestCr3);</div>
<div class="line"><span class="lineno">  171</span> </div>
<div class="line"><span class="lineno">  172</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  173</span>    <span class="comment">// Iterate through the list of breakpoints</span></div>
<div class="line"><span class="lineno">  174</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  175</span>    TempList = &amp;<a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#abca944290c6a683f0821a9096472f7d4">g_BreakpointsListHead</a>;</div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>    <span class="keywordflow">while</span> (&amp;<a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#abca944290c6a683f0821a9096472f7d4">g_BreakpointsListHead</a> != TempList-&gt;Flink)</div>
<div class="line"><span class="lineno">  178</span>    {</div>
<div class="line"><span class="lineno">  179</span>        TempList                                      = TempList-&gt;Flink;</div>
<div class="line"><span class="lineno">  180</span>        <a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html">PDEBUGGEE_BP_DESCRIPTOR</a> CurrentBreakpointDesc = <a class="code hl_define" href="list_8h.html#adec42d53dc3b3e16ab7a1cd98af1c5fc">CONTAINING_RECORD</a>(TempList, <a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html">DEBUGGEE_BP_DESCRIPTOR</a>, BreakpointsList);</div>
<div class="line"><span class="lineno">  181</span> </div>
<div class="line"><span class="lineno">  182</span>        <span class="keywordflow">if</span> (CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#ab5f824b8c4d255545d038d3e57231e76">PhysAddress</a> == GuestRipPhysical)</div>
<div class="line"><span class="lineno">  183</span>        {</div>
<div class="line"><span class="lineno">  184</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  185</span>            <span class="comment">// It&#39;s a breakpoint by &#39;bp&#39; command</span></div>
<div class="line"><span class="lineno">  186</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  187</span>            IsHandledByBpRoutines = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  188</span> </div>
<div class="line"><span class="lineno">  189</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  190</span>            <span class="comment">// First, we remove the breakpoint</span></div>
<div class="line"><span class="lineno">  191</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  192</span>            <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#aa59828a1cda23251be1cd6c1d10f1b94">MemoryMapperWriteMemorySafeByPhysicalAddress</a>(GuestRipPhysical,</div>
<div class="line"><span class="lineno">  193</span>                                                         &amp;CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a5a31f78cc97ef4c9fdb0ab7a9a3d9bad">PreviousByte</a>,</div>
<div class="line"><span class="lineno">  194</span>                                                         <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>));</div>
<div class="line"><span class="lineno">  195</span> </div>
<div class="line"><span class="lineno">  196</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  197</span>            <span class="comment">// Now, halt the debuggee</span></div>
<div class="line"><span class="lineno">  198</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  199</span>            ContextAndTag.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html#aed232a35a0d0d95aa4ca77dc50fc6fae">Context</a> = <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#ad3bf3809af7905836fde46ee81e86cc7">VmFuncGetLastVmexitRip</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>);</div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  202</span>            <span class="comment">// In breakpoints tag is breakpoint id, not event tag</span></div>
<div class="line"><span class="lineno">  203</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  204</span>            <span class="keywordflow">if</span> (Reason == <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_connection_8h.html#a6e2be89205e735ebae644cf4850ac21ba04b2c9d4250379b584ec3d3d2af3355c">DEBUGGEE_PAUSING_REASON_DEBUGGEE_SOFTWARE_BREAKPOINT_HIT</a>)</div>
<div class="line"><span class="lineno">  205</span>            {</div>
<div class="line"><span class="lineno">  206</span>                ContextAndTag.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html#a4eed19d8d35fa2c8378db39e95dd9ef2">Tag</a> = CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a0600a3a7a748f669bef44b0eb920fd4f">BreakpointId</a>;</div>
<div class="line"><span class="lineno">  207</span>            }</div>
<div class="line"><span class="lineno">  208</span> </div>
<div class="line"><span class="lineno">  209</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  210</span>            <span class="comment">// Hint the debuggee about the length</span></div>
<div class="line"><span class="lineno">  211</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  212</span>            DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac0735b6e84ce3ae397f74cfd5b4eabb4">InstructionLengthHint</a> = CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a603517c66479592e240eeacb29379803">InstructionLength</a>;</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  215</span>            <span class="comment">// Check constraints</span></div>
<div class="line"><span class="lineno">  216</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  217</span>            <span class="keywordflow">if</span> ((CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#ad46a87a0665b8d99405fec5650ae1eb1">Pid</a> == <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_constants_8h.html#a772442c9aa9acb6567a6d79ddc8c171b">DEBUGGEE_BP_APPLY_TO_ALL_PROCESSES</a> || CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#ad46a87a0665b8d99405fec5650ae1eb1">Pid</a> == PsGetCurrentProcessId()) &amp;&amp;</div>
<div class="line"><span class="lineno">  218</span>                (CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#ad787a3220aa8e2b76f31c570f33fd071">Tid</a> == <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_constants_8h.html#a83c229c2fbc9b06f560b3b78ae873f50">DEBUGGEE_BP_APPLY_TO_ALL_THREADS</a> || CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#ad787a3220aa8e2b76f31c570f33fd071">Tid</a> == PsGetCurrentThreadId()) &amp;&amp;</div>
<div class="line"><span class="lineno">  219</span>                (CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#aff66a054304ff0b558bd5e5688cb8e04">Core</a> == <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_constants_8h.html#aa145d6235b4996c241ae08d13de243a0">DEBUGGEE_BP_APPLY_TO_ALL_CORES</a> || CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#aff66a054304ff0b558bd5e5688cb8e04">Core</a> == DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>))</div>
<div class="line"><span class="lineno">  220</span>            {</div>
<div class="line"><span class="lineno">  221</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  222</span>                <span class="comment">// *** It&#39;s not safe to access CurrentBreakpointDesc anymore as the</span></div>
<div class="line"><span class="lineno">  223</span>                <span class="comment">// breakpoint might be removed ***</span></div>
<div class="line"><span class="lineno">  224</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span>                <a class="code hl_function" href="_kd_8c.html#a732bca2051e444c16d2d9a5080978981">KdHandleBreakpointAndDebugBreakpoints</a>(DbgState,</div>
<div class="line"><span class="lineno">  227</span>                                                      Reason,</div>
<div class="line"><span class="lineno">  228</span>                                                      &amp;ContextAndTag);</div>
<div class="line"><span class="lineno">  229</span>            }</div>
<div class="line"><span class="lineno">  230</span> </div>
<div class="line"><span class="lineno">  231</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  232</span>            <span class="comment">// Reset hint to instruction length</span></div>
<div class="line"><span class="lineno">  233</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  234</span>            DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac0735b6e84ce3ae397f74cfd5b4eabb4">InstructionLengthHint</a> = 0;</div>
<div class="line"><span class="lineno">  235</span> </div>
<div class="line"><span class="lineno">  236</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  237</span>            <span class="comment">// Check if we should re-apply the breakpoint after this instruction</span></div>
<div class="line"><span class="lineno">  238</span>            <span class="comment">// or not (in other words, is breakpoint still valid)</span></div>
<div class="line"><span class="lineno">  239</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  240</span>            <span class="keywordflow">if</span> (!CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a92b8d8e3dfe78ced438c04c2fc9c8b08">AvoidReApplyBreakpoint</a>)</div>
<div class="line"><span class="lineno">  241</span>            {</div>
<div class="line"><span class="lineno">  242</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  243</span>                <span class="comment">// We should re-apply the breakpoint on next mtf</span></div>
<div class="line"><span class="lineno">  244</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  245</span>                DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac48a6f48fd26c69f2d2ad49f09acbdd4">SoftwareBreakpointState</a> = CurrentBreakpointDesc;</div>
<div class="line"><span class="lineno">  246</span> </div>
<div class="line"><span class="lineno">  247</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  248</span>                <span class="comment">// Fire and MTF</span></div>
<div class="line"><span class="lineno">  249</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  250</span>                <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a2ad80a7ced0e72665e1c626797ef089a">VmFuncSetMonitorTrapFlag</a>(<a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><span class="lineno">  251</span>                AvoidUnsetMtf = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  252</span> </div>
<div class="line"><span class="lineno">  253</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  254</span>                <span class="comment">// As we want to continue debuggee, the MTF might arrive when the</span></div>
<div class="line"><span class="lineno">  255</span>                <span class="comment">// host finish executing it&#39;s time slice; thus, a clock interrupt</span></div>
<div class="line"><span class="lineno">  256</span>                <span class="comment">// or an IPI might be arrived and the next instruction is not what</span></div>
<div class="line"><span class="lineno">  257</span>                <span class="comment">// we expect, because of that we check if the IF (Interrupt enable)</span></div>
<div class="line"><span class="lineno">  258</span>                <span class="comment">// flag of RFLAGS is enabled or not, if enabled then we remove it</span></div>
<div class="line"><span class="lineno">  259</span>                <span class="comment">// to avoid any clock-interrupt or IPI to arrive and the next</span></div>
<div class="line"><span class="lineno">  260</span>                <span class="comment">// instruction is our next instruction in the current execution</span></div>
<div class="line"><span class="lineno">  261</span>                <span class="comment">// context</span></div>
<div class="line"><span class="lineno">  262</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  263</span>                Rflags.AsUInt = <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a4b045128fd323df34d999096f06d23d1">VmFuncGetRflags</a>();</div>
<div class="line"><span class="lineno">  264</span> </div>
<div class="line"><span class="lineno">  265</span>                <span class="keywordflow">if</span> (Rflags.InterruptEnableFlag)</div>
<div class="line"><span class="lineno">  266</span>                {</div>
<div class="line"><span class="lineno">  267</span>                    Rflags.InterruptEnableFlag = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  268</span>                    <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a289d7772b90af91d3f6c91610ab6c9af">VmFuncSetRflags</a>(Rflags.AsUInt);</div>
<div class="line"><span class="lineno">  269</span> </div>
<div class="line"><span class="lineno">  270</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  271</span>                    <span class="comment">// An indicator to restore RFLAGS if to enabled state</span></div>
<div class="line"><span class="lineno">  272</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  273</span>                    DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac48a6f48fd26c69f2d2ad49f09acbdd4">SoftwareBreakpointState</a>-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a7c55438ab180ae0b5c47fe3b4266fce7">SetRflagsIFBitOnMtf</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  274</span>                }</div>
<div class="line"><span class="lineno">  275</span>            }</div>
<div class="line"><span class="lineno">  276</span> </div>
<div class="line"><span class="lineno">  277</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  278</span>            <span class="comment">// Do not increment rip</span></div>
<div class="line"><span class="lineno">  279</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  280</span>            <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a36649162b2af7c487288260bf689ba61">VmFuncSuppressRipIncrement</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>);</div>
<div class="line"><span class="lineno">  281</span> </div>
<div class="line"><span class="lineno">  282</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  283</span>            <span class="comment">// No need to iterate anymore</span></div>
<div class="line"><span class="lineno">  284</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  285</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  286</span>        }</div>
<div class="line"><span class="lineno">  287</span>    }</div>
<div class="line"><span class="lineno">  288</span> </div>
<div class="line"><span class="lineno">  289</span>    <span class="keywordflow">if</span> (IsHandledByBpRoutines &amp;&amp; ChangeMtfState)</div>
<div class="line"><span class="lineno">  290</span>    {</div>
<div class="line"><span class="lineno">  291</span>        <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a50b66f92afe0201e3561264ee61240e4">VmFuncChangeMtfUnsettingState</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>, AvoidUnsetMtf);</div>
<div class="line"><span class="lineno">  292</span>    }</div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>    <span class="keywordflow">return</span> IsHandledByBpRoutines;</div>
<div class="line"><span class="lineno">  295</span>}</div>
<div class="ttc" id="a_kd_8c_html_a732bca2051e444c16d2d9a5080978981"><div class="ttname"><a href="_kd_8c.html#a732bca2051e444c16d2d9a5080978981">KdHandleBreakpointAndDebugBreakpoints</a></div><div class="ttdeci">_Use_decl_annotations_ VOID KdHandleBreakpointAndDebugBreakpoints(PROCESSOR_DEBUGGING_STATE *DbgState, DEBUGGEE_PAUSING_REASON Reason, PDEBUGGER_TRIGGERED_EVENT_DETAILS EventDetails)</div><div class="ttdoc">Handle #DBs and #BPs for kernel debugger.</div><div class="ttdef"><b>Definition:</b> Kd.c:1141</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h_html_aae17ebb9ef7279d026817fb22f8aebe9"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></div><div class="ttdeci">unsigned __int64 UINT64</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:19</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h_html_af632da489ebc3708ec3ab6791ee53fa4"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a></div><div class="ttdeci">unsigned long ULONG</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:35</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_connection_8h_html_a6e2be89205e735ebae644cf4850ac21ba04b2c9d4250379b584ec3d3d2af3355c"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_connection_8h.html#a6e2be89205e735ebae644cf4850ac21ba04b2c9d4250379b584ec3d3d2af3355c">DEBUGGEE_PAUSING_REASON_DEBUGGEE_SOFTWARE_BREAKPOINT_HIT</a></div><div class="ttdeci">@ DEBUGGEE_PAUSING_REASON_DEBUGGEE_SOFTWARE_BREAKPOINT_HIT</div><div class="ttdef"><b>Definition:</b> Connection.h:28</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_constants_8h_html_a772442c9aa9acb6567a6d79ddc8c171b"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_constants_8h.html#a772442c9aa9acb6567a6d79ddc8c171b">DEBUGGEE_BP_APPLY_TO_ALL_PROCESSES</a></div><div class="ttdeci">#define DEBUGGEE_BP_APPLY_TO_ALL_PROCESSES</div><div class="ttdoc">The constant to apply to all processes for bp command.</div><div class="ttdef"><b>Definition:</b> Constants.h:593</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_constants_8h_html_a83c229c2fbc9b06f560b3b78ae873f50"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_constants_8h.html#a83c229c2fbc9b06f560b3b78ae873f50">DEBUGGEE_BP_APPLY_TO_ALL_THREADS</a></div><div class="ttdeci">#define DEBUGGEE_BP_APPLY_TO_ALL_THREADS</div><div class="ttdoc">The constant to apply to all threads for bp command.</div><div class="ttdef"><b>Definition:</b> Constants.h:599</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_a289d7772b90af91d3f6c91610ab6c9af"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a289d7772b90af91d3f6c91610ab6c9af">VmFuncSetRflags</a></div><div class="ttdeci">IMPORT_EXPORT_VMM VOID VmFuncSetRflags(UINT64 Rflags)</div><div class="ttdoc">Set guest's RFLAGS.</div><div class="ttdef"><b>Definition:</b> Export.c:352</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_a2ad80a7ced0e72665e1c626797ef089a"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a2ad80a7ced0e72665e1c626797ef089a">VmFuncSetMonitorTrapFlag</a></div><div class="ttdeci">IMPORT_EXPORT_VMM VOID VmFuncSetMonitorTrapFlag(BOOLEAN Set)</div><div class="ttdoc">Set the monitor trap flag.</div><div class="ttdef"><b>Definition:</b> Export.c:98</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_a36649162b2af7c487288260bf689ba61"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a36649162b2af7c487288260bf689ba61">VmFuncSuppressRipIncrement</a></div><div class="ttdeci">IMPORT_EXPORT_VMM VOID VmFuncSuppressRipIncrement(UINT32 CoreId)</div><div class="ttdoc">Supress the incrementation of RIP.</div><div class="ttdef"><b>Definition:</b> Export.c:34</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_a4b045128fd323df34d999096f06d23d1"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a4b045128fd323df34d999096f06d23d1">VmFuncGetRflags</a></div><div class="ttdeci">IMPORT_EXPORT_VMM UINT64 VmFuncGetRflags()</div><div class="ttdoc">Read guest's RFLAGS.</div><div class="ttdef"><b>Definition:</b> Export.c:340</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_a50b66f92afe0201e3561264ee61240e4"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a50b66f92afe0201e3561264ee61240e4">VmFuncChangeMtfUnsettingState</a></div><div class="ttdeci">IMPORT_EXPORT_VMM VOID VmFuncChangeMtfUnsettingState(UINT32 CoreId, BOOLEAN Set)</div><div class="ttdoc">Supress unsetting MTF.</div><div class="ttdef"><b>Definition:</b> Export.c:47</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_aa59828a1cda23251be1cd6c1d10f1b94"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#aa59828a1cda23251be1cd6c1d10f1b94">MemoryMapperWriteMemorySafeByPhysicalAddress</a></div><div class="ttdeci">IMPORT_EXPORT_VMM BOOLEAN MemoryMapperWriteMemorySafeByPhysicalAddress(_Inout_ UINT64 DestinationPa, _In_ UINT64 Source, _In_ SIZE_T SizeToWrite)</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_ad3bf3809af7905836fde46ee81e86cc7"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#ad3bf3809af7905836fde46ee81e86cc7">VmFuncGetLastVmexitRip</a></div><div class="ttdeci">IMPORT_EXPORT_VMM UINT64 VmFuncGetLastVmexitRip(UINT32 CoreId)</div><div class="ttdoc">get the last vm-exit RIP</div><div class="ttdef"><b>Definition:</b> Export.c:306</div></div>
<div class="ttc" id="alist_8h_html_adec42d53dc3b3e16ab7a1cd98af1c5fc"><div class="ttname"><a href="list_8h.html#adec42d53dc3b3e16ab7a1cd98af1c5fc">CONTAINING_RECORD</a></div><div class="ttdeci">#define CONTAINING_RECORD(address, type, field)</div><div class="ttdef"><b>Definition:</b> list.h:14</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html_a5a31f78cc97ef4c9fdb0ab7a9a3d9bad"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a5a31f78cc97ef4c9fdb0ab7a9a3d9bad">_DEBUGGEE_BP_DESCRIPTOR::PreviousByte</a></div><div class="ttdeci">BYTE PreviousByte</div><div class="ttdef"><b>Definition:</b> State.h:82</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html_a7c55438ab180ae0b5c47fe3b4266fce7"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a7c55438ab180ae0b5c47fe3b4266fce7">_DEBUGGEE_BP_DESCRIPTOR::SetRflagsIFBitOnMtf</a></div><div class="ttdeci">BOOLEAN SetRflagsIFBitOnMtf</div><div class="ttdef"><b>Definition:</b> State.h:83</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html_a92b8d8e3dfe78ced438c04c2fc9c8b08"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a92b8d8e3dfe78ced438c04c2fc9c8b08">_DEBUGGEE_BP_DESCRIPTOR::AvoidReApplyBreakpoint</a></div><div class="ttdeci">BOOLEAN AvoidReApplyBreakpoint</div><div class="ttdef"><b>Definition:</b> State.h:84</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s_html"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html">_DEBUGGER_TRIGGERED_EVENT_DETAILS</a></div><div class="ttdoc">The structure of detail of a triggered event in HyperDbg.</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:114</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s_html_a4eed19d8d35fa2c8378db39e95dd9ef2"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html#a4eed19d8d35fa2c8378db39e95dd9ef2">_DEBUGGER_TRIGGERED_EVENT_DETAILS::Tag</a></div><div class="ttdeci">UINT64 Tag</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:115</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s_html_aed232a35a0d0d95aa4ca77dc50fc6fae"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html#aed232a35a0d0d95aa4ca77dc50fc6fae">_DEBUGGER_TRIGGERED_EVENT_DETAILS::Context</a></div><div class="ttdeci">PVOID Context</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:116</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html_a090832a74d330cde891a17bdd5b236e3"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">_PROCESSOR_DEBUGGING_STATE::CoreId</a></div><div class="ttdeci">UINT32 CoreId</div><div class="ttdef"><b>Definition:</b> State.h:110</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html_ac0735b6e84ce3ae397f74cfd5b4eabb4"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac0735b6e84ce3ae397f74cfd5b4eabb4">_PROCESSOR_DEBUGGING_STATE::InstructionLengthHint</a></div><div class="ttdeci">UINT16 InstructionLengthHint</div><div class="ttdef"><b>Definition:</b> State.h:121</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html_ac48a6f48fd26c69f2d2ad49f09acbdd4"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac48a6f48fd26c69f2d2ad49f09acbdd4">_PROCESSOR_DEBUGGING_STATE::SoftwareBreakpointState</a></div><div class="ttdeci">PDEBUGGEE_BP_DESCRIPTOR SoftwareBreakpointState</div><div class="ttdef"><b>Definition:</b> State.h:114</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac2d64f1a4448078440fa5e05a511e3bb" name="ac2d64f1a4448078440fa5e05a511e3bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2d64f1a4448078440fa5e05a511e3bb">&#9670;&#160;</a></span>BreakpointCheckAndHandleReApplyingBreakpoint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> BreakpointCheckAndHandleReApplyingBreakpoint </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td>
          <td class="paramname"><em>CoreId</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check and reapply breakpoint. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CoreId</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   89</span>{</div>
<div class="line"><span class="lineno">   90</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                     Result   = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">   91</span>    <a class="code hl_struct" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html">PROCESSOR_DEBUGGING_STATE</a> * DbgState = &amp;<a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a>[CoreId];</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>    <span class="keywordflow">if</span> (DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac48a6f48fd26c69f2d2ad49f09acbdd4">SoftwareBreakpointState</a> != NULL)</div>
<div class="line"><span class="lineno">   94</span>    {</div>
<div class="line"><span class="lineno">   95</span>        <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> BreakpointByte = 0xcc;</div>
<div class="line"><span class="lineno">   96</span> </div>
<div class="line"><span class="lineno">   97</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   98</span>        <span class="comment">// MTF is handled</span></div>
<div class="line"><span class="lineno">   99</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  100</span>        Result = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  103</span>        <span class="comment">// Restore previous breakpoint byte</span></div>
<div class="line"><span class="lineno">  104</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  105</span>        <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#aa59828a1cda23251be1cd6c1d10f1b94">MemoryMapperWriteMemorySafeByPhysicalAddress</a>(</div>
<div class="line"><span class="lineno">  106</span>            DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac48a6f48fd26c69f2d2ad49f09acbdd4">SoftwareBreakpointState</a>-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#ab5f824b8c4d255545d038d3e57231e76">PhysAddress</a>,</div>
<div class="line"><span class="lineno">  107</span>            &amp;BreakpointByte,</div>
<div class="line"><span class="lineno">  108</span>            <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>));</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  111</span>        <span class="comment">// Check if we should re-enabled IF bit of RFLAGS or not</span></div>
<div class="line"><span class="lineno">  112</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  113</span>        <span class="keywordflow">if</span> (DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac48a6f48fd26c69f2d2ad49f09acbdd4">SoftwareBreakpointState</a>-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a7c55438ab180ae0b5c47fe3b4266fce7">SetRflagsIFBitOnMtf</a>)</div>
<div class="line"><span class="lineno">  114</span>        {</div>
<div class="line"><span class="lineno">  115</span>            RFLAGS Rflags = {0};</div>
<div class="line"><span class="lineno">  116</span> </div>
<div class="line"><span class="lineno">  117</span>            Rflags.AsUInt = <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a4b045128fd323df34d999096f06d23d1">VmFuncGetRflags</a>();</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span>            Rflags.InterruptEnableFlag = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>            <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a289d7772b90af91d3f6c91610ab6c9af">VmFuncSetRflags</a>(Rflags.AsUInt);</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span>            DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac48a6f48fd26c69f2d2ad49f09acbdd4">SoftwareBreakpointState</a>-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a7c55438ab180ae0b5c47fe3b4266fce7">SetRflagsIFBitOnMtf</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  124</span>        }</div>
<div class="line"><span class="lineno">  125</span> </div>
<div class="line"><span class="lineno">  126</span>        DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac48a6f48fd26c69f2d2ad49f09acbdd4">SoftwareBreakpointState</a> = NULL;</div>
<div class="line"><span class="lineno">  127</span>    }</div>
<div class="line"><span class="lineno">  128</span> </div>
<div class="line"><span class="lineno">  129</span>    <span class="keywordflow">return</span> Result;</div>
<div class="line"><span class="lineno">  130</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3a0aeca428b3ffc888248391356079ac" name="a3a0aeca428b3ffc888248391356079ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a0aeca428b3ffc888248391356079ac">&#9670;&#160;</a></span>BreakpointHandleBpTraps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> BreakpointHandleBpTraps </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td>
          <td class="paramname"><em>CoreId</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle breakpoint vm-exits (#BP) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CoreId</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  306</span>{</div>
<div class="line"><span class="lineno">  307</span>    <a class="code hl_struct" href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html">DEBUGGER_TRIGGERED_EVENT_DETAILS</a> ContextAndTag = {0};</div>
<div class="line"><span class="lineno">  308</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>                           GuestRip      = 0;</div>
<div class="line"><span class="lineno">  309</span>    <a class="code hl_struct" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html">PROCESSOR_DEBUGGING_STATE</a> *      DbgState      = &amp;<a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a>[CoreId];</div>
<div class="line"><span class="lineno">  310</span> </div>
<div class="line"><span class="lineno">  311</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  312</span>    <span class="comment">// re-inject #BP back to the guest if not handled by the hidden breakpoint</span></div>
<div class="line"><span class="lineno">  313</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  314</span> </div>
<div class="line"><span class="lineno">  315</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#ae4b5afa957e3e26377135b91b60eda4e">g_KernelDebuggerState</a>)</div>
<div class="line"><span class="lineno">  316</span>    {</div>
<div class="line"><span class="lineno">  317</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  318</span>        <span class="comment">// Kernel debugger is attached, let&#39;s halt everything</span></div>
<div class="line"><span class="lineno">  319</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  320</span>        GuestRip = <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#ae0a87ccbb970698341ed757a4f79c16a">VmFuncGetRip</a>();</div>
<div class="line"><span class="lineno">  321</span> </div>
<div class="line"><span class="lineno">  322</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  323</span>        <span class="comment">// A breakpoint triggered and two things might be happened,</span></div>
<div class="line"><span class="lineno">  324</span>        <span class="comment">// first, a breakpoint is triggered randomly in the computer and</span></div>
<div class="line"><span class="lineno">  325</span>        <span class="comment">// we shouldn&#39;t do anything on it (won&#39;t change the instruction)</span></div>
<div class="line"><span class="lineno">  326</span>        <span class="comment">// second, the breakpoint is because of &#39;bp&#39; command, we should</span></div>
<div class="line"><span class="lineno">  327</span>        <span class="comment">// replace it with exact byte</span></div>
<div class="line"><span class="lineno">  328</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  329</span> </div>
<div class="line"><span class="lineno">  330</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="_breakpoint_commands_8c.html#af249a8d277f3fe6fdeeb1796e537572b">BreakpointCheckAndHandleDebuggerDefinedBreakpoints</a>(DbgState,</div>
<div class="line"><span class="lineno">  331</span>                                                                GuestRip,</div>
<div class="line"><span class="lineno">  332</span>                                                                <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_connection_8h.html#a6e2be89205e735ebae644cf4850ac21ba04b2c9d4250379b584ec3d3d2af3355c">DEBUGGEE_PAUSING_REASON_DEBUGGEE_SOFTWARE_BREAKPOINT_HIT</a>,</div>
<div class="line"><span class="lineno">  333</span>                                                                <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>))</div>
<div class="line"><span class="lineno">  334</span>        {</div>
<div class="line"><span class="lineno">  335</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  336</span>            <span class="comment">// It&#39;s a random breakpoint byte</span></div>
<div class="line"><span class="lineno">  337</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  338</span>            ContextAndTag.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html#aed232a35a0d0d95aa4ca77dc50fc6fae">Context</a> = GuestRip;</div>
<div class="line"><span class="lineno">  339</span>            <a class="code hl_function" href="_kd_8c.html#a732bca2051e444c16d2d9a5080978981">KdHandleBreakpointAndDebugBreakpoints</a>(DbgState,</div>
<div class="line"><span class="lineno">  340</span>                                                  <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_connection_8h.html#a6e2be89205e735ebae644cf4850ac21ba04b2c9d4250379b584ec3d3d2af3355c">DEBUGGEE_PAUSING_REASON_DEBUGGEE_SOFTWARE_BREAKPOINT_HIT</a>,</div>
<div class="line"><span class="lineno">  341</span>                                                  &amp;ContextAndTag);</div>
<div class="line"><span class="lineno">  342</span> </div>
<div class="line"><span class="lineno">  343</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  344</span>            <span class="comment">// Increment rip</span></div>
<div class="line"><span class="lineno">  345</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  346</span>            <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#af01bf897036f63c8ccd75ba404b96a76">VmFuncPerformRipIncrement</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>);</div>
<div class="line"><span class="lineno">  347</span>        }</div>
<div class="line"><span class="lineno">  348</span>    }</div>
<div class="line"><span class="lineno">  349</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  350</span>    {</div>
<div class="line"><span class="lineno">  351</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  352</span>        <span class="comment">// re-inject back to the guest as not handled here</span></div>
<div class="line"><span class="lineno">  353</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  354</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  355</span>    }</div>
<div class="line"><span class="lineno">  356</span> </div>
<div class="line"><span class="lineno">  357</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  358</span>}</div>
<div class="ttc" id="a_breakpoint_commands_8c_html_af249a8d277f3fe6fdeeb1796e537572b"><div class="ttname"><a href="_breakpoint_commands_8c.html#af249a8d277f3fe6fdeeb1796e537572b">BreakpointCheckAndHandleDebuggerDefinedBreakpoints</a></div><div class="ttdeci">BOOLEAN BreakpointCheckAndHandleDebuggerDefinedBreakpoints(PROCESSOR_DEBUGGING_STATE *DbgState, UINT64 GuestRip, DEBUGGEE_PAUSING_REASON Reason, BOOLEAN ChangeMtfState)</div><div class="ttdoc">Check if the breakpoint vm-exit relates to 'bp' command or not.</div><div class="ttdef"><b>Definition:</b> BreakpointCommands.c:143</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_ae0a87ccbb970698341ed757a4f79c16a"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#ae0a87ccbb970698341ed757a4f79c16a">VmFuncGetRip</a></div><div class="ttdeci">IMPORT_EXPORT_VMM UINT64 VmFuncGetRip()</div><div class="ttdoc">Read guest's RIP.</div><div class="ttdef"><b>Definition:</b> Export.c:363</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_af01bf897036f63c8ccd75ba404b96a76"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#af01bf897036f63c8ccd75ba404b96a76">VmFuncPerformRipIncrement</a></div><div class="ttdeci">IMPORT_EXPORT_VMM VOID VmFuncPerformRipIncrement(UINT32 CoreId)</div><div class="ttdoc">Perform the incrementation of RIP.</div><div class="ttdef"><b>Definition:</b> Export.c:22</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acfb2587c2b1380011576fb0f243c4148" name="acfb2587c2b1380011576fb0f243c4148"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfb2587c2b1380011576fb0f243c4148">&#9670;&#160;</a></span>BreakpointListOrModify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> BreakpointListOrModify </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#ae0b77106e76131900a06635311dd3c2e">PDEBUGGEE_BP_LIST_OR_MODIFY_PACKET</a>&#160;</td>
          <td class="paramname"><em>ListOrModifyBreakpoints</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>List of modify breakpoints. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ListOrModifyBreakpoints</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  730</span>{</div>
<div class="line"><span class="lineno">  731</span>    <a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html">PDEBUGGEE_BP_DESCRIPTOR</a> BreakpointDescriptor = NULL;</div>
<div class="line"><span class="lineno">  732</span> </div>
<div class="line"><span class="lineno">  733</span>    <span class="keywordflow">if</span> (ListOrModifyBreakpoints-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#aebd996d558ebf1098a392d19289254f7">Request</a> == <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#ad78b7fd71adbd22c68a264ac22df3847a9f9631d6daadb45dfce91baa33e5eb4e">DEBUGGEE_BREAKPOINT_MODIFICATION_REQUEST_LIST_BREAKPOINTS</a>)</div>
<div class="line"><span class="lineno">  734</span>    {</div>
<div class="line"><span class="lineno">  735</span>        <a class="code hl_function" href="_breakpoint_commands_8c.html#a5dc92791e7148a75a6bf701966797b9d">BreakpointListAllBreakpoint</a>();</div>
<div class="line"><span class="lineno">  736</span>    }</div>
<div class="line"><span class="lineno">  737</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ListOrModifyBreakpoints-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#aebd996d558ebf1098a392d19289254f7">Request</a> == <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#ad78b7fd71adbd22c68a264ac22df3847abaf5cd591c9f6ba6bb3f00cb3db2688f">DEBUGGEE_BREAKPOINT_MODIFICATION_REQUEST_ENABLE</a>)</div>
<div class="line"><span class="lineno">  738</span>    {</div>
<div class="line"><span class="lineno">  739</span>        BreakpointDescriptor = <a class="code hl_function" href="_breakpoint_commands_8c.html#a5901425c05d238beb8eef3b70bfb65b5">BreakpointGetEntryByBreakpointId</a>(ListOrModifyBreakpoints-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#a25fc09d01ee64cca03420fd72f7e1d1c">BreakpointId</a>);</div>
<div class="line"><span class="lineno">  740</span> </div>
<div class="line"><span class="lineno">  741</span>        <span class="keywordflow">if</span> (BreakpointDescriptor == NULL)</div>
<div class="line"><span class="lineno">  742</span>        {</div>
<div class="line"><span class="lineno">  743</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  744</span>            <span class="comment">// Breakpoint id is invalid</span></div>
<div class="line"><span class="lineno">  745</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  746</span>            ListOrModifyBreakpoints-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#acac6a7db2a769df61a984f3f1da846e2">Result</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#a59ac3bd31f6604b05a16629d02d5480d">DEBUGGER_ERROR_BREAKPOINT_ID_NOT_FOUND</a>;</div>
<div class="line"><span class="lineno">  747</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  748</span>        }</div>
<div class="line"><span class="lineno">  749</span> </div>
<div class="line"><span class="lineno">  750</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  751</span>        <span class="comment">// Check to make sure that breakpoint is not already enabled</span></div>
<div class="line"><span class="lineno">  752</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  753</span>        <span class="keywordflow">if</span> (BreakpointDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#aac7e43f351a7b2c5d45e6b058be77036">Enabled</a>)</div>
<div class="line"><span class="lineno">  754</span>        {</div>
<div class="line"><span class="lineno">  755</span>            ListOrModifyBreakpoints-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#acac6a7db2a769df61a984f3f1da846e2">Result</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#aeba4471a71b03e65b21c42b9e077f508">DEBUGGER_ERROR_BREAKPOINT_ALREADY_ENABLED</a>;</div>
<div class="line"><span class="lineno">  756</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  757</span>        }</div>
<div class="line"><span class="lineno">  758</span> </div>
<div class="line"><span class="lineno">  759</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  760</span>        <span class="comment">// Set the breakpoint (without removing from list)</span></div>
<div class="line"><span class="lineno">  761</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  762</span>        <a class="code hl_function" href="_breakpoint_commands_8c.html#adbfa823a7d6541668573fc9467ee4355">BreakpointWrite</a>(BreakpointDescriptor);</div>
<div class="line"><span class="lineno">  763</span>    }</div>
<div class="line"><span class="lineno">  764</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ListOrModifyBreakpoints-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#aebd996d558ebf1098a392d19289254f7">Request</a> == <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#ad78b7fd71adbd22c68a264ac22df3847a2cccbcabca6974690342dd42a008743c">DEBUGGEE_BREAKPOINT_MODIFICATION_REQUEST_DISABLE</a>)</div>
<div class="line"><span class="lineno">  765</span>    {</div>
<div class="line"><span class="lineno">  766</span>        BreakpointDescriptor = <a class="code hl_function" href="_breakpoint_commands_8c.html#a5901425c05d238beb8eef3b70bfb65b5">BreakpointGetEntryByBreakpointId</a>(ListOrModifyBreakpoints-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#a25fc09d01ee64cca03420fd72f7e1d1c">BreakpointId</a>);</div>
<div class="line"><span class="lineno">  767</span> </div>
<div class="line"><span class="lineno">  768</span>        <span class="keywordflow">if</span> (BreakpointDescriptor == NULL)</div>
<div class="line"><span class="lineno">  769</span>        {</div>
<div class="line"><span class="lineno">  770</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  771</span>            <span class="comment">// Breakpoint id is invalid</span></div>
<div class="line"><span class="lineno">  772</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  773</span>            ListOrModifyBreakpoints-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#acac6a7db2a769df61a984f3f1da846e2">Result</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#a59ac3bd31f6604b05a16629d02d5480d">DEBUGGER_ERROR_BREAKPOINT_ID_NOT_FOUND</a>;</div>
<div class="line"><span class="lineno">  774</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  775</span>        }</div>
<div class="line"><span class="lineno">  776</span> </div>
<div class="line"><span class="lineno">  777</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  778</span>        <span class="comment">// Check to make sure that breakpoint is not already disabled</span></div>
<div class="line"><span class="lineno">  779</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  780</span>        <span class="keywordflow">if</span> (!BreakpointDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#aac7e43f351a7b2c5d45e6b058be77036">Enabled</a>)</div>
<div class="line"><span class="lineno">  781</span>        {</div>
<div class="line"><span class="lineno">  782</span>            ListOrModifyBreakpoints-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#acac6a7db2a769df61a984f3f1da846e2">Result</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#aa6630c7fa9379e6ddc14b0c5207855e9">DEBUGGER_ERROR_BREAKPOINT_ALREADY_DISABLED</a>;</div>
<div class="line"><span class="lineno">  783</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  784</span>        }</div>
<div class="line"><span class="lineno">  785</span> </div>
<div class="line"><span class="lineno">  786</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  787</span>        <span class="comment">// Unset the breakpoint (without removing from list)</span></div>
<div class="line"><span class="lineno">  788</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  789</span>        <a class="code hl_function" href="_breakpoint_commands_8c.html#af932a37c8259ad673a40b551f12f58c8">BreakpointClear</a>(BreakpointDescriptor);</div>
<div class="line"><span class="lineno">  790</span>    }</div>
<div class="line"><span class="lineno">  791</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ListOrModifyBreakpoints-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#aebd996d558ebf1098a392d19289254f7">Request</a> == <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#ad78b7fd71adbd22c68a264ac22df3847af7991c7bc2f097898dfaa6de3f57aba2">DEBUGGEE_BREAKPOINT_MODIFICATION_REQUEST_CLEAR</a>)</div>
<div class="line"><span class="lineno">  792</span>    {</div>
<div class="line"><span class="lineno">  793</span>        BreakpointDescriptor = <a class="code hl_function" href="_breakpoint_commands_8c.html#a5901425c05d238beb8eef3b70bfb65b5">BreakpointGetEntryByBreakpointId</a>(ListOrModifyBreakpoints-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#a25fc09d01ee64cca03420fd72f7e1d1c">BreakpointId</a>);</div>
<div class="line"><span class="lineno">  794</span> </div>
<div class="line"><span class="lineno">  795</span>        <span class="keywordflow">if</span> (BreakpointDescriptor == NULL)</div>
<div class="line"><span class="lineno">  796</span>        {</div>
<div class="line"><span class="lineno">  797</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  798</span>            <span class="comment">// Breakpoint id is invalid</span></div>
<div class="line"><span class="lineno">  799</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  800</span>            ListOrModifyBreakpoints-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#acac6a7db2a769df61a984f3f1da846e2">Result</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#a59ac3bd31f6604b05a16629d02d5480d">DEBUGGER_ERROR_BREAKPOINT_ID_NOT_FOUND</a>;</div>
<div class="line"><span class="lineno">  801</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  802</span>        }</div>
<div class="line"><span class="lineno">  803</span> </div>
<div class="line"><span class="lineno">  804</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  805</span>        <span class="comment">// Unset the breakpoint</span></div>
<div class="line"><span class="lineno">  806</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  807</span>        <a class="code hl_function" href="_breakpoint_commands_8c.html#af932a37c8259ad673a40b551f12f58c8">BreakpointClear</a>(BreakpointDescriptor);</div>
<div class="line"><span class="lineno">  808</span> </div>
<div class="line"><span class="lineno">  809</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  810</span>        <span class="comment">// Remove breakpoint from the list of breakpoints</span></div>
<div class="line"><span class="lineno">  811</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  812</span>        <a class="code hl_function" href="list_8h.html#a1384c9ab335080c2fdc01fc7eca7673c">RemoveEntryList</a>(&amp;BreakpointDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a963ede4fbe9776b1b18b53b4e2dff062">BreakpointsList</a>);</div>
<div class="line"><span class="lineno">  813</span> </div>
<div class="line"><span class="lineno">  814</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  815</span>        <span class="comment">// Uninitialize the breakpoint descriptor (safely)</span></div>
<div class="line"><span class="lineno">  816</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  817</span>        <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a959d3b71e4d867f6a1499abc90cb6023">PoolManagerFreePool</a>(BreakpointDescriptor);</div>
<div class="line"><span class="lineno">  818</span>    }</div>
<div class="line"><span class="lineno">  819</span> </div>
<div class="line"><span class="lineno">  820</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  821</span>    <span class="comment">// Operation was successful</span></div>
<div class="line"><span class="lineno">  822</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  823</span>    ListOrModifyBreakpoints-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#acac6a7db2a769df61a984f3f1da846e2">Result</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#aed656c58434eecb2d7e8c10e93aecff4">DEBUGGER_OPERATION_WAS_SUCCESSFUL</a>;</div>
<div class="line"><span class="lineno">  824</span> </div>
<div class="line"><span class="lineno">  825</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  826</span>}</div>
<div class="ttc" id="a_breakpoint_commands_8c_html_a5901425c05d238beb8eef3b70bfb65b5"><div class="ttname"><a href="_breakpoint_commands_8c.html#a5901425c05d238beb8eef3b70bfb65b5">BreakpointGetEntryByBreakpointId</a></div><div class="ttdeci">PDEBUGGEE_BP_DESCRIPTOR BreakpointGetEntryByBreakpointId(UINT64 BreakpointId)</div><div class="ttdoc">Find entry of breakpoint descriptor from list of breakpoints by breakpoint id.</div><div class="ttdef"><b>Definition:</b> BreakpointCommands.c:493</div></div>
<div class="ttc" id="a_breakpoint_commands_8c_html_a5dc92791e7148a75a6bf701966797b9d"><div class="ttname"><a href="_breakpoint_commands_8c.html#a5dc92791e7148a75a6bf701966797b9d">BreakpointListAllBreakpoint</a></div><div class="ttdeci">VOID BreakpointListAllBreakpoint()</div><div class="ttdoc">List all breakpoints.</div><div class="ttdef"><b>Definition:</b> BreakpointCommands.c:677</div></div>
<div class="ttc" id="a_breakpoint_commands_8c_html_af932a37c8259ad673a40b551f12f58c8"><div class="ttname"><a href="_breakpoint_commands_8c.html#af932a37c8259ad673a40b551f12f58c8">BreakpointClear</a></div><div class="ttdeci">BOOLEAN BreakpointClear(PDEBUGGEE_BP_DESCRIPTOR BreakpointDescriptor)</div><div class="ttdoc">clears the 0xcc and removes the breakpoint @detail this function won't remove the descriptor from the...</div><div class="ttdef"><b>Definition:</b> BreakpointCommands.c:412</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h_html_a59ac3bd31f6604b05a16629d02d5480d"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#a59ac3bd31f6604b05a16629d02d5480d">DEBUGGER_ERROR_BREAKPOINT_ID_NOT_FOUND</a></div><div class="ttdeci">#define DEBUGGER_ERROR_BREAKPOINT_ID_NOT_FOUND</div><div class="ttdoc">error, breakpoint id not found</div><div class="ttdef"><b>Definition:</b> ErrorCodes.h:196</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h_html_aa6630c7fa9379e6ddc14b0c5207855e9"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#aa6630c7fa9379e6ddc14b0c5207855e9">DEBUGGER_ERROR_BREAKPOINT_ALREADY_DISABLED</a></div><div class="ttdeci">#define DEBUGGER_ERROR_BREAKPOINT_ALREADY_DISABLED</div><div class="ttdoc">error, breakpoint already disabled</div><div class="ttdef"><b>Definition:</b> ErrorCodes.h:202</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h_html_aeba4471a71b03e65b21c42b9e077f508"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_error_codes_8h.html#aeba4471a71b03e65b21c42b9e077f508">DEBUGGER_ERROR_BREAKPOINT_ALREADY_ENABLED</a></div><div class="ttdeci">#define DEBUGGER_ERROR_BREAKPOINT_ALREADY_ENABLED</div><div class="ttdoc">error, breakpoint already enabled</div><div class="ttdef"><b>Definition:</b> ErrorCodes.h:208</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h_html_ad78b7fd71adbd22c68a264ac22df3847a2cccbcabca6974690342dd42a008743c"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#ad78b7fd71adbd22c68a264ac22df3847a2cccbcabca6974690342dd42a008743c">DEBUGGEE_BREAKPOINT_MODIFICATION_REQUEST_DISABLE</a></div><div class="ttdeci">@ DEBUGGEE_BREAKPOINT_MODIFICATION_REQUEST_DISABLE</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:1020</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h_html_ad78b7fd71adbd22c68a264ac22df3847a9f9631d6daadb45dfce91baa33e5eb4e"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#ad78b7fd71adbd22c68a264ac22df3847a9f9631d6daadb45dfce91baa33e5eb4e">DEBUGGEE_BREAKPOINT_MODIFICATION_REQUEST_LIST_BREAKPOINTS</a></div><div class="ttdeci">@ DEBUGGEE_BREAKPOINT_MODIFICATION_REQUEST_LIST_BREAKPOINTS</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:1018</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h_html_ad78b7fd71adbd22c68a264ac22df3847abaf5cd591c9f6ba6bb3f00cb3db2688f"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#ad78b7fd71adbd22c68a264ac22df3847abaf5cd591c9f6ba6bb3f00cb3db2688f">DEBUGGEE_BREAKPOINT_MODIFICATION_REQUEST_ENABLE</a></div><div class="ttdeci">@ DEBUGGEE_BREAKPOINT_MODIFICATION_REQUEST_ENABLE</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:1019</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h_html_ad78b7fd71adbd22c68a264ac22df3847af7991c7bc2f097898dfaa6de3f57aba2"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#ad78b7fd71adbd22c68a264ac22df3847af7991c7bc2f097898dfaa6de3f57aba2">DEBUGGEE_BREAKPOINT_MODIFICATION_REQUEST_CLEAR</a></div><div class="ttdeci">@ DEBUGGEE_BREAKPOINT_MODIFICATION_REQUEST_CLEAR</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:1021</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_a959d3b71e4d867f6a1499abc90cb6023"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a959d3b71e4d867f6a1499abc90cb6023">PoolManagerFreePool</a></div><div class="ttdeci">IMPORT_EXPORT_VMM BOOLEAN PoolManagerFreePool(UINT64 AddressToFree)</div><div class="ttdoc">This function set a pool flag to be freed, and it will be freed on the next IOCTL when it's safe to r...</div><div class="ttdef"><b>Definition:</b> PoolManager.c:157</div></div>
<div class="ttc" id="alist_8h_html_a1384c9ab335080c2fdc01fc7eca7673c"><div class="ttname"><a href="list_8h.html#a1384c9ab335080c2fdc01fc7eca7673c">RemoveEntryList</a></div><div class="ttdeci">BOOLEAN RemoveEntryList(PLIST_ENTRY Entry)</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t_html_a25fc09d01ee64cca03420fd72f7e1d1c"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#a25fc09d01ee64cca03420fd72f7e1d1c">_DEBUGGEE_BP_LIST_OR_MODIFY_PACKET::BreakpointId</a></div><div class="ttdeci">UINT64 BreakpointId</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:1031</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t_html_acac6a7db2a769df61a984f3f1da846e2"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#acac6a7db2a769df61a984f3f1da846e2">_DEBUGGEE_BP_LIST_OR_MODIFY_PACKET::Result</a></div><div class="ttdeci">UINT32 Result</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:1033</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t_html_aebd996d558ebf1098a392d19289254f7"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#aebd996d558ebf1098a392d19289254f7">_DEBUGGEE_BP_LIST_OR_MODIFY_PACKET::Request</a></div><div class="ttdeci">DEBUGGEE_BREAKPOINT_MODIFICATION_REQUEST Request</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:1032</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af5a28890d7cdeb6e697ba8c41d2bbbe7" name="af5a28890d7cdeb6e697ba8c41d2bbbe7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5a28890d7cdeb6e697ba8c41d2bbbe7">&#9670;&#160;</a></span>BreakpointRemoveAllBreakpoints()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> BreakpointRemoveAllBreakpoints </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove all the breakpoints if possible. </p>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  455</span>{</div>
<div class="line"><span class="lineno">  456</span>    PLIST_ENTRY TempList = 0;</div>
<div class="line"><span class="lineno">  457</span> </div>
<div class="line"><span class="lineno">  458</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  459</span>    <span class="comment">// Iterate through the list of breakpoints</span></div>
<div class="line"><span class="lineno">  460</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  461</span>    TempList = &amp;<a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#abca944290c6a683f0821a9096472f7d4">g_BreakpointsListHead</a>;</div>
<div class="line"><span class="lineno">  462</span> </div>
<div class="line"><span class="lineno">  463</span>    <span class="keywordflow">while</span> (&amp;<a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#abca944290c6a683f0821a9096472f7d4">g_BreakpointsListHead</a> != TempList-&gt;Flink)</div>
<div class="line"><span class="lineno">  464</span>    {</div>
<div class="line"><span class="lineno">  465</span>        TempList                                      = TempList-&gt;Flink;</div>
<div class="line"><span class="lineno">  466</span>        <a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html">PDEBUGGEE_BP_DESCRIPTOR</a> CurrentBreakpointDesc = <a class="code hl_define" href="list_8h.html#adec42d53dc3b3e16ab7a1cd98af1c5fc">CONTAINING_RECORD</a>(TempList, <a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html">DEBUGGEE_BP_DESCRIPTOR</a>, BreakpointsList);</div>
<div class="line"><span class="lineno">  467</span> </div>
<div class="line"><span class="lineno">  468</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  469</span>        <span class="comment">// Clear the breakpoint</span></div>
<div class="line"><span class="lineno">  470</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  471</span>        <a class="code hl_function" href="_breakpoint_commands_8c.html#af932a37c8259ad673a40b551f12f58c8">BreakpointClear</a>(CurrentBreakpointDesc);</div>
<div class="line"><span class="lineno">  472</span> </div>
<div class="line"><span class="lineno">  473</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  474</span>        <span class="comment">// Remove breakpoint from the list of breakpoints</span></div>
<div class="line"><span class="lineno">  475</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  476</span>        <a class="code hl_function" href="list_8h.html#a1384c9ab335080c2fdc01fc7eca7673c">RemoveEntryList</a>(&amp;CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a963ede4fbe9776b1b18b53b4e2dff062">BreakpointsList</a>);</div>
<div class="line"><span class="lineno">  477</span> </div>
<div class="line"><span class="lineno">  478</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  479</span>        <span class="comment">// Uninitialize the breakpoint descriptor (safely)</span></div>
<div class="line"><span class="lineno">  480</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  481</span>        <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a959d3b71e4d867f6a1499abc90cb6023">PoolManagerFreePool</a>(CurrentBreakpointDesc);</div>
<div class="line"><span class="lineno">  482</span>    }</div>
<div class="line"><span class="lineno">  483</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa2b3b7d14e79251d6e4b20dff257500a" name="aa2b3b7d14e79251d6e4b20dff257500a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2b3b7d14e79251d6e4b20dff257500a">&#9670;&#160;</a></span>SearchAddressWrapper()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> SearchAddressWrapper </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ad413c7f23e00f0764dfa0ab21b6442a0">PUINT64</a>&#160;</td>
          <td class="paramname"><em>AddressToSaveResults</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a259329cf5d90fa23392810c8705398cf">PDEBUGGER_SEARCH_MEMORY</a>&#160;</td>
          <td class="paramname"><em>SearchMemRequest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>&#160;</td>
          <td class="paramname"><em>StartAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>&#160;</td>
          <td class="paramname"><em>EndAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td>
          <td class="paramname"><em>IsDebuggeePaused</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a8e3d0f172defb4e820ad5df4ec48960c">PUINT32</a>&#160;</td>
          <td class="paramname"><em>CountOfMatchedCases</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The wrapper to check for validity of addresses and call the search routines for both physical and virtual memory. </p>
<p>This function can be called from vmx-root mode The address between start address and end address will be checked to make a contiguous address</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">AddressToSaveResults</td><td>Address to save the search results </td></tr>
    <tr><td class="paramname">SearchMemRequest</td><td>request structure of searching memory </td></tr>
    <tr><td class="paramname">StartAddress</td><td>start address of searching based on target process </td></tr>
    <tr><td class="paramname">EndAddress</td><td>start address of searching based on target process </td></tr>
    <tr><td class="paramname">IsDebuggeePaused</td><td>Set to true when the search is performed in the debugger mode </td></tr>
    <tr><td class="paramname">CountOfMatchedCases</td><td>Number of matched cases </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN Whether there was any error or not </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  816</span>{</div>
<div class="line"><span class="lineno">  817</span>    <a class="code hl_struct" href="struct___c_r3___t_y_p_e.html">CR3_TYPE</a> CurrentProcessCr3;</div>
<div class="line"><span class="lineno">  818</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>   BaseAddress         = 0;</div>
<div class="line"><span class="lineno">  819</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>   CurrentValue        = 0;</div>
<div class="line"><span class="lineno">  820</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>   RealPhysicalAddress = 0;</div>
<div class="line"><span class="lineno">  821</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>   TempValue           = NULL;</div>
<div class="line"><span class="lineno">  822</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>   TempStartAddress    = NULL;</div>
<div class="line"><span class="lineno">  823</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>  DoesBaseAddrSaved   = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  824</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>  SearchResult        = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  825</span> </div>
<div class="line"><span class="lineno">  826</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  827</span>    <span class="comment">// Reset the count of matched cases</span></div>
<div class="line"><span class="lineno">  828</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  829</span>    *CountOfMatchedCases = 0;</div>
<div class="line"><span class="lineno">  830</span> </div>
<div class="line"><span class="lineno">  831</span>    <span class="keywordflow">if</span> (SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#afd5dfd7402859985dd21a6cd8cf9e52d">MemoryType</a> == <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a84380c5425f8362a9e7ebc8ae0d7a504ae14e659c808936a0652a52719478054f">SEARCH_VIRTUAL_MEMORY</a>)</div>
<div class="line"><span class="lineno">  832</span>    {</div>
<div class="line"><span class="lineno">  833</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  834</span>        <span class="comment">// It&#39;s a virtual address search</span></div>
<div class="line"><span class="lineno">  835</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  836</span> </div>
<div class="line"><span class="lineno">  837</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  838</span>        <span class="comment">// Align the page and search with alignement</span></div>
<div class="line"><span class="lineno">  839</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  840</span>        TempStartAddress = StartAddress;</div>
<div class="line"><span class="lineno">  841</span>        StartAddress     = <a class="code hl_define" href="hprdbgctrl_2header_2common_8h.html#aa02188de52b66a3aa5e1aecc6bd963ae">PAGE_ALIGN</a>(StartAddress);</div>
<div class="line"><span class="lineno">  842</span> </div>
<div class="line"><span class="lineno">  843</span>        <span class="keywordflow">if</span> (IsDebuggeePaused)</div>
<div class="line"><span class="lineno">  844</span>        {</div>
<div class="line"><span class="lineno">  845</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  846</span>            <span class="comment">// Switch to new process&#39;s memory layout</span></div>
<div class="line"><span class="lineno">  847</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  848</span>            CurrentProcessCr3 = <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#ad711f252793324cdb878442d74d9098f">SwitchToProcessMemoryLayoutByCr3</a>(<a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#ade88a95bca6e425e8c81c358d041d76c">LayoutGetCurrentProcessCr3</a>());</div>
<div class="line"><span class="lineno">  849</span>        }</div>
<div class="line"><span class="lineno">  850</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  851</span>        {</div>
<div class="line"><span class="lineno">  852</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  853</span>            <span class="comment">// Switch to new process&#39;s memory layout</span></div>
<div class="line"><span class="lineno">  854</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  855</span>            CurrentProcessCr3 = <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a7ccc656f5aafff881fa12ff3eb2a324d">SwitchToProcessMemoryLayout</a>(SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a2286bb7292ad9a907133af3a8de82ac7">ProcessId</a>);</div>
<div class="line"><span class="lineno">  856</span>        }</div>
<div class="line"><span class="lineno">  857</span> </div>
<div class="line"><span class="lineno">  858</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  859</span>        <span class="comment">// We will try to find a contigues address</span></div>
<div class="line"><span class="lineno">  860</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  861</span>        <span class="keywordflow">while</span> (StartAddress &lt; EndAddress)</div>
<div class="line"><span class="lineno">  862</span>        {</div>
<div class="line"><span class="lineno">  863</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  864</span>            <span class="comment">// Check if address is valid or not</span></div>
<div class="line"><span class="lineno">  865</span>            <span class="comment">// Generally, we can use VirtualAddressToPhysicalAddressByProcessId</span></div>
<div class="line"><span class="lineno">  866</span>            <span class="comment">// but let&#39;s not change the cr3 multiple times</span></div>
<div class="line"><span class="lineno">  867</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  868</span>            TempValue = <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a9c177c471eaf6be292a94d8112fa3f36">VirtualAddressToPhysicalAddress</a>(StartAddress);</div>
<div class="line"><span class="lineno">  869</span> </div>
<div class="line"><span class="lineno">  870</span>            <span class="keywordflow">if</span> (TempValue != 0)</div>
<div class="line"><span class="lineno">  871</span>            {</div>
<div class="line"><span class="lineno">  872</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  873</span>                <span class="comment">// Address is valid, let&#39;s add a page size to it</span></div>
<div class="line"><span class="lineno">  874</span>                <span class="comment">// nothing to do</span></div>
<div class="line"><span class="lineno">  875</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  876</span>                <span class="keywordflow">if</span> (!DoesBaseAddrSaved)</div>
<div class="line"><span class="lineno">  877</span>                {</div>
<div class="line"><span class="lineno">  878</span>                    BaseAddress       = TempStartAddress;</div>
<div class="line"><span class="lineno">  879</span>                    DoesBaseAddrSaved = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  880</span>                }</div>
<div class="line"><span class="lineno">  881</span>            }</div>
<div class="line"><span class="lineno">  882</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  883</span>            {</div>
<div class="line"><span class="lineno">  884</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  885</span>                <span class="comment">// Address is not valid anymore</span></div>
<div class="line"><span class="lineno">  886</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  887</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  888</span>            }</div>
<div class="line"><span class="lineno">  889</span> </div>
<div class="line"><span class="lineno">  890</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  891</span>            <span class="comment">// Make the start address ready for next address</span></div>
<div class="line"><span class="lineno">  892</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  893</span>            StartAddress += <a class="code hl_define" href="hprdbgctrl_2header_2common_8h.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a>;</div>
<div class="line"><span class="lineno">  894</span>        }</div>
<div class="line"><span class="lineno">  895</span> </div>
<div class="line"><span class="lineno">  896</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  897</span>        <span class="comment">// Restore the original process</span></div>
<div class="line"><span class="lineno">  898</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  899</span>        <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a271e5e657ab23c69e078979359903d94">SwitchToPreviousProcess</a>(CurrentProcessCr3);</div>
<div class="line"><span class="lineno">  900</span> </div>
<div class="line"><span class="lineno">  901</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  902</span>        <span class="comment">// All of the address chunk was valid</span></div>
<div class="line"><span class="lineno">  903</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  904</span>        <span class="keywordflow">if</span> (DoesBaseAddrSaved &amp;&amp; StartAddress &gt; BaseAddress)</div>
<div class="line"><span class="lineno">  905</span>        {</div>
<div class="line"><span class="lineno">  906</span>            SearchResult = <a class="code hl_function" href="_debugger_commands_8c.html#a552399e58dff411c2c11f789f687f6d1">PerformSearchAddress</a>(AddressToSaveResults,</div>
<div class="line"><span class="lineno">  907</span>                                                SearchMemRequest,</div>
<div class="line"><span class="lineno">  908</span>                                                BaseAddress,</div>
<div class="line"><span class="lineno">  909</span>                                                EndAddress,</div>
<div class="line"><span class="lineno">  910</span>                                                IsDebuggeePaused,</div>
<div class="line"><span class="lineno">  911</span>                                                CountOfMatchedCases);</div>
<div class="line"><span class="lineno">  912</span>        }</div>
<div class="line"><span class="lineno">  913</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  914</span>        {</div>
<div class="line"><span class="lineno">  915</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  916</span>            <span class="comment">// There was an error, address was probably not contiguous</span></div>
<div class="line"><span class="lineno">  917</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  918</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  919</span>        }</div>
<div class="line"><span class="lineno">  920</span>    }</div>
<div class="line"><span class="lineno">  921</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#afd5dfd7402859985dd21a6cd8cf9e52d">MemoryType</a> == <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a84380c5425f8362a9e7ebc8ae0d7a504abc233c6bd13bd067efef1cb07135b413">SEARCH_PHYSICAL_MEMORY</a>)</div>
<div class="line"><span class="lineno">  922</span>    {</div>
<div class="line"><span class="lineno">  923</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  924</span>        <span class="comment">// when we reached here, we know that it&#39;s a valid physical memory,</span></div>
<div class="line"><span class="lineno">  925</span>        <span class="comment">// so we change the structure and pass it as a virtual address to</span></div>
<div class="line"><span class="lineno">  926</span>        <span class="comment">// the search function</span></div>
<div class="line"><span class="lineno">  927</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  928</span>        RealPhysicalAddress = SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a93f60f8bba58373d242567705f2d147a">Address</a>;</div>
<div class="line"><span class="lineno">  929</span> </div>
<div class="line"><span class="lineno">  930</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  931</span>        <span class="comment">// Change the start address</span></div>
<div class="line"><span class="lineno">  932</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  933</span>        <span class="keywordflow">if</span> (IsDebuggeePaused)</div>
<div class="line"><span class="lineno">  934</span>        {</div>
<div class="line"><span class="lineno">  935</span>            SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a93f60f8bba58373d242567705f2d147a">Address</a> = <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a2b092b5fa6c7a8fe7843d510c5614a20">PhysicalAddressToVirtualAddressOnTargetProcess</a>(StartAddress);</div>
<div class="line"><span class="lineno">  936</span>            EndAddress                = <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a2b092b5fa6c7a8fe7843d510c5614a20">PhysicalAddressToVirtualAddressOnTargetProcess</a>(EndAddress);</div>
<div class="line"><span class="lineno">  937</span>        }</div>
<div class="line"><span class="lineno">  938</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a2286bb7292ad9a907133af3a8de82ac7">ProcessId</a> == PsGetCurrentProcessId())</div>
<div class="line"><span class="lineno">  939</span>        {</div>
<div class="line"><span class="lineno">  940</span>            SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a93f60f8bba58373d242567705f2d147a">Address</a> = <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a7e40a1378887014695c04ddd6a644fbf">PhysicalAddressToVirtualAddress</a>(StartAddress);</div>
<div class="line"><span class="lineno">  941</span>            EndAddress                = <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a7e40a1378887014695c04ddd6a644fbf">PhysicalAddressToVirtualAddress</a>(EndAddress);</div>
<div class="line"><span class="lineno">  942</span>        }</div>
<div class="line"><span class="lineno">  943</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  944</span>        {</div>
<div class="line"><span class="lineno">  945</span>            SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a93f60f8bba58373d242567705f2d147a">Address</a> = <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#ae84ec23a76951b05dbc10c45076a5595">PhysicalAddressToVirtualAddressByProcessId</a>(StartAddress, SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a2286bb7292ad9a907133af3a8de82ac7">ProcessId</a>);</div>
<div class="line"><span class="lineno">  946</span>            EndAddress                = <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#ae84ec23a76951b05dbc10c45076a5595">PhysicalAddressToVirtualAddressByProcessId</a>(EndAddress, SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a2286bb7292ad9a907133af3a8de82ac7">ProcessId</a>);</div>
<div class="line"><span class="lineno">  947</span>        }</div>
<div class="line"><span class="lineno">  948</span> </div>
<div class="line"><span class="lineno">  949</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  950</span>        <span class="comment">// Change the type of memory</span></div>
<div class="line"><span class="lineno">  951</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  952</span>        SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#afd5dfd7402859985dd21a6cd8cf9e52d">MemoryType</a> = <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a84380c5425f8362a9e7ebc8ae0d7a504a7f8d2eefc188e4c88e6b759f7784800c">SEARCH_PHYSICAL_FROM_VIRTUAL_MEMORY</a>;</div>
<div class="line"><span class="lineno">  953</span> </div>
<div class="line"><span class="lineno">  954</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  955</span>        <span class="comment">// Call the wrapper</span></div>
<div class="line"><span class="lineno">  956</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  957</span>        SearchResult = <a class="code hl_function" href="_debugger_commands_8c.html#a552399e58dff411c2c11f789f687f6d1">PerformSearchAddress</a>(AddressToSaveResults,</div>
<div class="line"><span class="lineno">  958</span>                                            SearchMemRequest,</div>
<div class="line"><span class="lineno">  959</span>                                            SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a93f60f8bba58373d242567705f2d147a">Address</a>,</div>
<div class="line"><span class="lineno">  960</span>                                            EndAddress,</div>
<div class="line"><span class="lineno">  961</span>                                            IsDebuggeePaused,</div>
<div class="line"><span class="lineno">  962</span>                                            CountOfMatchedCases);</div>
<div class="line"><span class="lineno">  963</span> </div>
<div class="line"><span class="lineno">  964</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  965</span>        <span class="comment">// Restore the previous state</span></div>
<div class="line"><span class="lineno">  966</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  967</span>        SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#afd5dfd7402859985dd21a6cd8cf9e52d">MemoryType</a> = <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a84380c5425f8362a9e7ebc8ae0d7a504abc233c6bd13bd067efef1cb07135b413">SEARCH_PHYSICAL_MEMORY</a>;</div>
<div class="line"><span class="lineno">  968</span>        SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a93f60f8bba58373d242567705f2d147a">Address</a>    = RealPhysicalAddress;</div>
<div class="line"><span class="lineno">  969</span>    }</div>
<div class="line"><span class="lineno">  970</span> </div>
<div class="line"><span class="lineno">  971</span>    <span class="keywordflow">return</span> SearchResult;</div>
<div class="line"><span class="lineno">  972</span>}</div>
<div class="ttc" id="a_debugger_commands_8c_html_a552399e58dff411c2c11f789f687f6d1"><div class="ttname"><a href="_debugger_commands_8c.html#a552399e58dff411c2c11f789f687f6d1">PerformSearchAddress</a></div><div class="ttdeci">BOOLEAN PerformSearchAddress(UINT64 *AddressToSaveResults, PDEBUGGER_SEARCH_MEMORY SearchMemRequest, UINT64 StartAddress, UINT64 EndAddress, BOOLEAN IsDebuggeePaused, PUINT32 CountOfMatchedCases)</div><div class="ttdoc">Search on virtual memory (not work on physical memory)</div><div class="ttdef"><b>Definition:</b> DebuggerCommands.c:523</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h_html_a84380c5425f8362a9e7ebc8ae0d7a504a7f8d2eefc188e4c88e6b759f7784800c"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a84380c5425f8362a9e7ebc8ae0d7a504a7f8d2eefc188e4c88e6b759f7784800c">SEARCH_PHYSICAL_FROM_VIRTUAL_MEMORY</a></div><div class="ttdeci">@ SEARCH_PHYSICAL_FROM_VIRTUAL_MEMORY</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:458</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h_html_a84380c5425f8362a9e7ebc8ae0d7a504abc233c6bd13bd067efef1cb07135b413"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a84380c5425f8362a9e7ebc8ae0d7a504abc233c6bd13bd067efef1cb07135b413">SEARCH_PHYSICAL_MEMORY</a></div><div class="ttdeci">@ SEARCH_PHYSICAL_MEMORY</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:456</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h_html_a84380c5425f8362a9e7ebc8ae0d7a504ae14e659c808936a0652a52719478054f"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a84380c5425f8362a9e7ebc8ae0d7a504ae14e659c808936a0652a52719478054f">SEARCH_VIRTUAL_MEMORY</a></div><div class="ttdeci">@ SEARCH_VIRTUAL_MEMORY</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:457</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_a271e5e657ab23c69e078979359903d94"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a271e5e657ab23c69e078979359903d94">SwitchToPreviousProcess</a></div><div class="ttdeci">IMPORT_EXPORT_VMM VOID SwitchToPreviousProcess(_In_ CR3_TYPE PreviousProcess)</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_a2b092b5fa6c7a8fe7843d510c5614a20"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a2b092b5fa6c7a8fe7843d510c5614a20">PhysicalAddressToVirtualAddressOnTargetProcess</a></div><div class="ttdeci">IMPORT_EXPORT_VMM UINT64 PhysicalAddressToVirtualAddressOnTargetProcess(_In_ PVOID PhysicalAddress)</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_a7ccc656f5aafff881fa12ff3eb2a324d"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a7ccc656f5aafff881fa12ff3eb2a324d">SwitchToProcessMemoryLayout</a></div><div class="ttdeci">IMPORT_EXPORT_VMM CR3_TYPE SwitchToProcessMemoryLayout(_In_ UINT32 ProcessId)</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_a7e40a1378887014695c04ddd6a644fbf"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a7e40a1378887014695c04ddd6a644fbf">PhysicalAddressToVirtualAddress</a></div><div class="ttdeci">IMPORT_EXPORT_VMM UINT64 PhysicalAddressToVirtualAddress(_In_ UINT64 PhysicalAddress)</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_a9c177c471eaf6be292a94d8112fa3f36"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a9c177c471eaf6be292a94d8112fa3f36">VirtualAddressToPhysicalAddress</a></div><div class="ttdeci">IMPORT_EXPORT_VMM UINT64 VirtualAddressToPhysicalAddress(_In_ PVOID VirtualAddress)</div><div class="ttdoc">Converts Virtual Address to Physical Address.</div><div class="ttdef"><b>Definition:</b> Conversion.c:156</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_ad711f252793324cdb878442d74d9098f"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#ad711f252793324cdb878442d74d9098f">SwitchToProcessMemoryLayoutByCr3</a></div><div class="ttdeci">IMPORT_EXPORT_VMM CR3_TYPE SwitchToProcessMemoryLayoutByCr3(_In_ CR3_TYPE TargetCr3)</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_ae84ec23a76951b05dbc10c45076a5595"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#ae84ec23a76951b05dbc10c45076a5595">PhysicalAddressToVirtualAddressByProcessId</a></div><div class="ttdeci">IMPORT_EXPORT_VMM UINT64 PhysicalAddressToVirtualAddressByProcessId(_In_ PVOID PhysicalAddress, _In_ UINT32 ProcessId)</div></div>
<div class="ttc" id="ahprdbgctrl_2header_2common_8h_html_a7d467c1d283fdfa1f2081ba1e0d01b6e"><div class="ttname"><a href="hprdbgctrl_2header_2common_8h.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a></div><div class="ttdeci">#define PAGE_SIZE</div><div class="ttdoc">Size of each page (4096 bytes)</div><div class="ttdef"><b>Definition:</b> common.h:59</div></div>
<div class="ttc" id="ahprdbgctrl_2header_2common_8h_html_aa02188de52b66a3aa5e1aecc6bd963ae"><div class="ttname"><a href="hprdbgctrl_2header_2common_8h.html#aa02188de52b66a3aa5e1aecc6bd963ae">PAGE_ALIGN</a></div><div class="ttdeci">#define PAGE_ALIGN(Va)</div><div class="ttdoc">Aligning a page.</div><div class="ttdef"><b>Definition:</b> common.h:65</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y_html_a2286bb7292ad9a907133af3a8de82ac7"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a2286bb7292ad9a907133af3a8de82ac7">_DEBUGGER_SEARCH_MEMORY::ProcessId</a></div><div class="ttdeci">UINT32 ProcessId</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:482</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y_html_a93f60f8bba58373d242567705f2d147a"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a93f60f8bba58373d242567705f2d147a">_DEBUGGER_SEARCH_MEMORY::Address</a></div><div class="ttdeci">UINT64 Address</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:480</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y_html_afd5dfd7402859985dd21a6cd8cf9e52d"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#afd5dfd7402859985dd21a6cd8cf9e52d">_DEBUGGER_SEARCH_MEMORY::MemoryType</a></div><div class="ttdeci">DEBUGGER_SEARCH_MEMORY_TYPE MemoryType</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:483</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_53a6cdbae347618e9ee76d4be5c6ea96.html">hyperdbg</a></li><li class="navelem"><a class="el" href="dir_0f75a8685de99980df6b10136f072ea3.html">hprdbgkd</a></li><li class="navelem"><a class="el" href="dir_a49bef8785c3fd81042e69d2866eb23c.html">header</a></li><li class="navelem"><a class="el" href="dir_c5c32dbaf8d06eb5e35478b4712c2bd5.html">debugger</a></li><li class="navelem"><a class="el" href="dir_f353bd738039477edd8cc44a32311ebb.html">commands</a></li><li class="navelem"><a class="el" href="_breakpoint_commands_8h.html">BreakpointCommands.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
