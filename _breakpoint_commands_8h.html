<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HyperDbg Debugger: hyperdbg/hprdbgkd/header/debugger/commands/BreakpointCommands.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">HyperDbg Debugger
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('_breakpoint_commands_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">BreakpointCommands.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Commands for setting breakpoints.  
<a href="#details">More...</a></p>

<p><a href="_breakpoint_commands_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af5a28890d7cdeb6e697ba8c41d2bbbe7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_breakpoint_commands_8h.html#af5a28890d7cdeb6e697ba8c41d2bbbe7">BreakpointRemoveAllBreakpoints</a> ()</td></tr>
<tr class="memdesc:af5a28890d7cdeb6e697ba8c41d2bbbe7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove all the breakpoints if possible.  <br /></td></tr>
<tr class="separator:af5a28890d7cdeb6e697ba8c41d2bbbe7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a295701da4a28b591937893cfbb3dcd75"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_breakpoint_commands_8h.html#a295701da4a28b591937893cfbb3dcd75">BreakpointAddNew</a> (<a class="el" href="_request_structures_8h.html#a58c97daf5894ba79ab884e8b85515ad3">PDEBUGGEE_BP_PACKET</a> BpDescriptorArg)</td></tr>
<tr class="memdesc:a295701da4a28b591937893cfbb3dcd75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add new breakpoints.  <br /></td></tr>
<tr class="separator:a295701da4a28b591937893cfbb3dcd75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfb2587c2b1380011576fb0f243c4148"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_breakpoint_commands_8h.html#acfb2587c2b1380011576fb0f243c4148">BreakpointListOrModify</a> (<a class="el" href="_request_structures_8h.html#ae0b77106e76131900a06635311dd3c2e">PDEBUGGEE_BP_LIST_OR_MODIFY_PACKET</a> ListOrModifyBreakpoints)</td></tr>
<tr class="memdesc:acfb2587c2b1380011576fb0f243c4148"><td class="mdescLeft">&#160;</td><td class="mdescRight">List of modify breakpoints.  <br /></td></tr>
<tr class="separator:acfb2587c2b1380011576fb0f243c4148"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a0aeca428b3ffc888248391356079ac"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_breakpoint_commands_8h.html#a3a0aeca428b3ffc888248391356079ac">BreakpointHandleBpTraps</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> CoreId)</td></tr>
<tr class="memdesc:a3a0aeca428b3ffc888248391356079ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle breakpoint vm-exits (#BP)  <br /></td></tr>
<tr class="separator:a3a0aeca428b3ffc888248391356079ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af249a8d277f3fe6fdeeb1796e537572b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_breakpoint_commands_8h.html#af249a8d277f3fe6fdeeb1796e537572b">BreakpointCheckAndHandleDebuggerDefinedBreakpoints</a> (<a class="el" href="hprdbgkd_2header_2debugger_2core_2_state_8h.html#aa35afece6adc9a29a7bf7a2e76476037">PROCESSOR_DEBUGGING_STATE</a> *DbgState, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> GuestRip, <a class="el" href="_connection_8h.html#ac834b5b60f3a3213636632ea482a26a3">DEBUGGEE_PAUSING_REASON</a> Reason, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ChangeMtfState)</td></tr>
<tr class="memdesc:af249a8d277f3fe6fdeeb1796e537572b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the breakpoint vm-exit relates to 'bp' command or not.  <br /></td></tr>
<tr class="separator:af249a8d277f3fe6fdeeb1796e537572b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2d64f1a4448078440fa5e05a511e3bb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_breakpoint_commands_8h.html#ac2d64f1a4448078440fa5e05a511e3bb">BreakpointCheckAndHandleReApplyingBreakpoint</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> CoreId)</td></tr>
<tr class="memdesc:ac2d64f1a4448078440fa5e05a511e3bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check and reapply breakpoint.  <br /></td></tr>
<tr class="separator:ac2d64f1a4448078440fa5e05a511e3bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6de84d2bb5c24bf8c4edcbad8e9dc055"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_breakpoint_commands_8h.html#a6de84d2bb5c24bf8c4edcbad8e9dc055">BreakpointCheckAndHandleDebugBreakpoint</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> CoreId)</td></tr>
<tr class="memdesc:a6de84d2bb5c24bf8c4edcbad8e9dc055"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check and handle debug breakpoint exceptions.  <br /></td></tr>
<tr class="separator:a6de84d2bb5c24bf8c4edcbad8e9dc055"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a462860a027e1e81083a6df87f8e4a32a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_breakpoint_commands_8h.html#a462860a027e1e81083a6df87f8e4a32a">BreakpointAdjustUnsetTrapFlagsOnCurrentThread</a> (<a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> SetTo)</td></tr>
<tr class="memdesc:a462860a027e1e81083a6df87f8e4a32a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function makes sure to unset the RFLAGS.TF on next trigger of #DB.  <br /></td></tr>
<tr class="separator:a462860a027e1e81083a6df87f8e4a32a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Commands for setting breakpoints. </p>
<dl class="section author"><dt>Author</dt><dd>Sina Karvandi (<a href="#" onclick="location.href='mai'+'lto:'+'sin'+'a@'+'hyp'+'er'+'dbg'+'.o'+'rg'; return false;">sina@<span class="obfuscator">.nosp@m.</span>hype<span class="obfuscator">.nosp@m.</span>rdbg.<span class="obfuscator">.nosp@m.</span>org</a>) </dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2021-03-12</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>This project is released under the GNU Public License v3. </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a295701da4a28b591937893cfbb3dcd75" name="a295701da4a28b591937893cfbb3dcd75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a295701da4a28b591937893cfbb3dcd75">&#9670;&#160;</a></span>BreakpointAddNew()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> BreakpointAddNew </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_request_structures_8h.html#a58c97daf5894ba79ab884e8b85515ad3">PDEBUGGEE_BP_PACKET</a>&#160;</td>
          <td class="paramname"><em>BpDescriptorArg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add new breakpoints. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">BpDescriptor</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  640</span>{</div>
<div class="line"><span class="lineno">  641</span>    <a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html">PDEBUGGEE_BP_DESCRIPTOR</a> BreakpointDescriptor = NULL;</div>
<div class="line"><span class="lineno">  642</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>                  ProcessorCount;</div>
<div class="line"><span class="lineno">  643</span>    <a class="code hl_struct" href="struct___c_r3___t_y_p_e.html">CR3_TYPE</a>                GuestCr3;</div>
<div class="line"><span class="lineno">  644</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                 IsAddress32Bit = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  645</span> </div>
<div class="line"><span class="lineno">  646</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  647</span>    <span class="comment">// Find the current process cr3</span></div>
<div class="line"><span class="lineno">  648</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  649</span>    GuestCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a> = <a class="code hl_function" href="_layout_8c.html#af74e610cf3ad5dd8c972f536f2809429">LayoutGetCurrentProcessCr3</a>().<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>;</div>
<div class="line"><span class="lineno">  650</span> </div>
<div class="line"><span class="lineno">  651</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  652</span>    <span class="comment">// *** Validate arguments ***</span></div>
<div class="line"><span class="lineno">  653</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  654</span> </div>
<div class="line"><span class="lineno">  655</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  656</span>    <span class="comment">// Check if address is safe (only one byte for 0xcc)</span></div>
<div class="line"><span class="lineno">  657</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  658</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="common_8cpp.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>(BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#aa58a4dcb7c01e3412eac7dd3b428f309">Address</a>, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>)))</div>
<div class="line"><span class="lineno">  659</span>    {</div>
<div class="line"><span class="lineno">  660</span>        BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#a31f51c86477913031d2e01f69341620f">Result</a> = <a class="code hl_define" href="_error_codes_8h.html#a68e4d375f85d62fc6169b228d0cb346a">DEBUGGER_ERROR_EDIT_MEMORY_STATUS_INVALID_ADDRESS_BASED_ON_CURRENT_PROCESS</a>;</div>
<div class="line"><span class="lineno">  661</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  662</span>    }</div>
<div class="line"><span class="lineno">  663</span> </div>
<div class="line"><span class="lineno">  664</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  665</span>    <span class="comment">// Check if the core number is not invalid</span></div>
<div class="line"><span class="lineno">  666</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  667</span>    ProcessorCount = KeQueryActiveProcessorCount(0);</div>
<div class="line"><span class="lineno">  668</span> </div>
<div class="line"><span class="lineno">  669</span>    <span class="keywordflow">if</span> (BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#a7285098a69927e556cbc61864a1d7e62">Core</a> != <a class="code hl_define" href="_constants_8h.html#aa145d6235b4996c241ae08d13de243a0">DEBUGGEE_BP_APPLY_TO_ALL_CORES</a> &amp;&amp;</div>
<div class="line"><span class="lineno">  670</span>        BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#a7285098a69927e556cbc61864a1d7e62">Core</a> &gt;= ProcessorCount)</div>
<div class="line"><span class="lineno">  671</span>    {</div>
<div class="line"><span class="lineno">  672</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  673</span>        <span class="comment">// Core is invalid (Set the error)</span></div>
<div class="line"><span class="lineno">  674</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  675</span>        BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#a31f51c86477913031d2e01f69341620f">Result</a> = <a class="code hl_define" href="_error_codes_8h.html#a5a5ccba7c7cceb94d66f297978047611">DEBUGGER_ERROR_INVALID_CORE_ID</a>;</div>
<div class="line"><span class="lineno">  676</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  677</span>    }</div>
<div class="line"><span class="lineno">  678</span> </div>
<div class="line"><span class="lineno">  679</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  680</span>    <span class="comment">// Check if breakpoint already exists on list or not</span></div>
<div class="line"><span class="lineno">  681</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  682</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="_breakpoint_commands_8c.html#ae7d28c7c329ec9621af580e43f13b412">BreakpointGetEntryByAddress</a>(BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#aa58a4dcb7c01e3412eac7dd3b428f309">Address</a>) != NULL)</div>
<div class="line"><span class="lineno">  683</span>    {</div>
<div class="line"><span class="lineno">  684</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  685</span>        <span class="comment">// Address is already on the list (Set the error)</span></div>
<div class="line"><span class="lineno">  686</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  687</span>        BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#a31f51c86477913031d2e01f69341620f">Result</a> = <a class="code hl_define" href="_error_codes_8h.html#a3b5b126406066bc4844a91c1d07de9ac">DEBUGGER_ERROR_BREAKPOINT_ALREADY_EXISTS_ON_THE_ADDRESS</a>;</div>
<div class="line"><span class="lineno">  688</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  689</span>    }</div>
<div class="line"><span class="lineno">  690</span> </div>
<div class="line"><span class="lineno">  691</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  692</span>    <span class="comment">// We won&#39;t check for process id and thread id, if these arguments are invalid</span></div>
<div class="line"><span class="lineno">  693</span>    <span class="comment">// then the HyperDbg simply ignores the breakpoints but it makes the computer slow</span></div>
<div class="line"><span class="lineno">  694</span>    <span class="comment">// it just won&#39;t be triggered</span></div>
<div class="line"><span class="lineno">  695</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  696</span> </div>
<div class="line"><span class="lineno">  697</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  698</span>    <span class="comment">// When we reach here means that the arguments are valid and address is</span></div>
<div class="line"><span class="lineno">  699</span>    <span class="comment">// safe to access (put 0xcc)</span></div>
<div class="line"><span class="lineno">  700</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  701</span> </div>
<div class="line"><span class="lineno">  702</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  703</span>    <span class="comment">// Get the pre-allocated buffer</span></div>
<div class="line"><span class="lineno">  704</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  705</span>    BreakpointDescriptor = <a class="code hl_function" href="_pool_manager_8c.html#a065841edb44331344b1a71a2ea397923">PoolManagerRequestPool</a>(<a class="code hl_enumvalue" href="_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63ab8948b7a3ee40226d0f76b7fccf90b9a">BREAKPOINT_DEFINITION_STRUCTURE</a>, <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html">DEBUGGEE_BP_DESCRIPTOR</a>));</div>
<div class="line"><span class="lineno">  706</span> </div>
<div class="line"><span class="lineno">  707</span>    <span class="keywordflow">if</span> (BreakpointDescriptor == NULL)</div>
<div class="line"><span class="lineno">  708</span>    {</div>
<div class="line"><span class="lineno">  709</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  710</span>        <span class="comment">// No pool ! Probably the user set more than MAXIMUM_BREAKPOINTS_WITHOUT_CONTINUE</span></div>
<div class="line"><span class="lineno">  711</span>        <span class="comment">// pools without IOCTL (continue)</span></div>
<div class="line"><span class="lineno">  712</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  713</span>        BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#a31f51c86477913031d2e01f69341620f">Result</a> = <a class="code hl_define" href="_error_codes_8h.html#a29e9c99a3400fc71880be5e623e7baaf">DEBUGGER_ERROR_MAXIMUM_BREAKPOINT_WITHOUT_CONTINUE</a>;</div>
<div class="line"><span class="lineno">  714</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  715</span>    }</div>
<div class="line"><span class="lineno">  716</span> </div>
<div class="line"><span class="lineno">  717</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  718</span>    <span class="comment">// Copy details of breakpoint to the descriptor structure</span></div>
<div class="line"><span class="lineno">  719</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  720</span>    <a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#ad09616266c993d19a27d9f414073c0a7">g_MaximumBreakpointId</a>++;</div>
<div class="line"><span class="lineno">  721</span>    BreakpointDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a0600a3a7a748f669bef44b0eb920fd4f">BreakpointId</a>   = <a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#ad09616266c993d19a27d9f414073c0a7">g_MaximumBreakpointId</a>;</div>
<div class="line"><span class="lineno">  722</span>    BreakpointDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a6ee164edb59fd20f9e69048564dd435a">Address</a>        = BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#aa58a4dcb7c01e3412eac7dd3b428f309">Address</a>;</div>
<div class="line"><span class="lineno">  723</span>    BreakpointDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#ab5f824b8c4d255545d038d3e57231e76">PhysAddress</a>    = <a class="code hl_function" href="_conversion_8c.html#ace32f507228d4b1b3b8e53f82ac09402">VirtualAddressToPhysicalAddressByProcessCr3</a>(BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#aa58a4dcb7c01e3412eac7dd3b428f309">Address</a>,</div>
<div class="line"><span class="lineno">  724</span>                                                                                    GuestCr3);</div>
<div class="line"><span class="lineno">  725</span>    BreakpointDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#aff66a054304ff0b558bd5e5688cb8e04">Core</a>           = BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#a7285098a69927e556cbc61864a1d7e62">Core</a>;</div>
<div class="line"><span class="lineno">  726</span>    BreakpointDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#ad46a87a0665b8d99405fec5650ae1eb1">Pid</a>            = BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#aae09270daf430ca348d56079a35ed1b8">Pid</a>;</div>
<div class="line"><span class="lineno">  727</span>    BreakpointDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#ad787a3220aa8e2b76f31c570f33fd071">Tid</a>            = BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#a13aeaf024d8bea5bd40692b08a8ed3ee">Tid</a>;</div>
<div class="line"><span class="lineno">  728</span>    BreakpointDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a1e808c059fbd554f0899ae6b5f2d350e">RemoveAfterHit</a> = BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#a69d6b93ae09e735b05232e69700e0e2f">RemoveAfterHit</a>;</div>
<div class="line"><span class="lineno">  729</span> </div>
<div class="line"><span class="lineno">  730</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  731</span>    <span class="comment">// Check whether address is 32-bit or 64-bit</span></div>
<div class="line"><span class="lineno">  732</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  733</span>    <span class="keywordflow">if</span> (BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#aa58a4dcb7c01e3412eac7dd3b428f309">Address</a> &amp; 0xff00000000000000)</div>
<div class="line"><span class="lineno">  734</span>    {</div>
<div class="line"><span class="lineno">  735</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  736</span>        <span class="comment">// This is a kernel-base address and as the kernel is 64-bit, we assume it&#39;s a 64-bit address</span></div>
<div class="line"><span class="lineno">  737</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  738</span>        IsAddress32Bit = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  739</span>    }</div>
<div class="line"><span class="lineno">  740</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  741</span>    {</div>
<div class="line"><span class="lineno">  742</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  743</span>        <span class="comment">// The address is not a kernel address, thus, we check whether the debuggee is running on user-mode</span></div>
<div class="line"><span class="lineno">  744</span>        <span class="comment">// or not</span></div>
<div class="line"><span class="lineno">  745</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  746</span>        IsAddress32Bit = <a class="code hl_function" href="_kd_8c.html#a814437795a9e923d352b848630625a56">KdIsGuestOnUsermode32Bit</a>();</div>
<div class="line"><span class="lineno">  747</span>    }</div>
<div class="line"><span class="lineno">  748</span> </div>
<div class="line"><span class="lineno">  749</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  750</span>    <span class="comment">// Use length disassembler engine to get the instruction length</span></div>
<div class="line"><span class="lineno">  751</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  752</span>    BreakpointDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a603517c66479592e240eeacb29379803">InstructionLength</a> = <a class="code hl_function" href="_disassembler_8c.html#a387718dcee35d796938ad5f9b9fb1820">DisassemblerLengthDisassembleEngineInVmxRootOnTargetProcess</a>(BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#aa58a4dcb7c01e3412eac7dd3b428f309">Address</a>, IsAddress32Bit);</div>
<div class="line"><span class="lineno">  753</span> </div>
<div class="line"><span class="lineno">  754</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  755</span>    <span class="comment">// Breakpoints are enabled by default</span></div>
<div class="line"><span class="lineno">  756</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  757</span>    BreakpointDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#aac7e43f351a7b2c5d45e6b058be77036">Enabled</a> = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  758</span> </div>
<div class="line"><span class="lineno">  759</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  760</span>    <span class="comment">// Now we should add the breakpoint to the list of breakpoints (LIST_ENTRY)</span></div>
<div class="line"><span class="lineno">  761</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  762</span>    <a class="code hl_function" href="list_8h.html#a77df31a5e6a1be59d08b93e9cb028f22">InsertHeadList</a>(&amp;<a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#abca944290c6a683f0821a9096472f7d4">g_BreakpointsListHead</a>, &amp;(BreakpointDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a963ede4fbe9776b1b18b53b4e2dff062">BreakpointsList</a>));</div>
<div class="line"><span class="lineno">  763</span> </div>
<div class="line"><span class="lineno">  764</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  765</span>    <span class="comment">// Apply the breakpoint</span></div>
<div class="line"><span class="lineno">  766</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  767</span>    <a class="code hl_function" href="_breakpoint_commands_8c.html#adbfa823a7d6541668573fc9467ee4355">BreakpointWrite</a>(BreakpointDescriptor);</div>
<div class="line"><span class="lineno">  768</span> </div>
<div class="line"><span class="lineno">  769</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  770</span>    <span class="comment">// Show that operation was successful</span></div>
<div class="line"><span class="lineno">  771</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  772</span>    BpDescriptorArg-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#a31f51c86477913031d2e01f69341620f">Result</a> = <a class="code hl_define" href="_error_codes_8h.html#aed656c58434eecb2d7e8c10e93aecff4">DEBUGGER_OPERATION_WAS_SUCCESSFUL</a>;</div>
<div class="line"><span class="lineno">  773</span> </div>
<div class="line"><span class="lineno">  774</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  775</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_a1cb18096b299d23458d3c7b85fd86555"><div class="ttname"><a href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></div><div class="ttdeci">UCHAR BOOLEAN</div><div class="ttdef"><b>Definition</b> BasicTypes.h:37</div></div>
<div class="ttc" id="a_basic_types_8h_html_a4ae1dab0fb4b072a66584546209e7d58"><div class="ttname"><a href="_basic_types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a></div><div class="ttdeci">unsigned char BYTE</div><div class="ttdef"><b>Definition</b> BasicTypes.h:22</div></div>
<div class="ttc" id="a_basic_types_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition</b> BasicTypes.h:50</div></div>
<div class="ttc" id="a_basic_types_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition</b> BasicTypes.h:49</div></div>
<div class="ttc" id="a_basic_types_8h_html_ae1e6edbbc26d6fbc71a90190d0266018"><div class="ttname"><a href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></div><div class="ttdeci">unsigned int UINT32</div><div class="ttdef"><b>Definition</b> BasicTypes.h:46</div></div>
<div class="ttc" id="a_breakpoint_commands_8c_html_adbfa823a7d6541668573fc9467ee4355"><div class="ttname"><a href="_breakpoint_commands_8c.html#adbfa823a7d6541668573fc9467ee4355">BreakpointWrite</a></div><div class="ttdeci">BOOLEAN BreakpointWrite(PDEBUGGEE_BP_DESCRIPTOR BreakpointDescriptor)</div><div class="ttdoc">writes the 0xcc and applies the breakpoint @detail this function won't remove the descriptor from the...</div><div class="ttdef"><b>Definition</b> BreakpointCommands.c:508</div></div>
<div class="ttc" id="a_breakpoint_commands_8c_html_ae7d28c7c329ec9621af580e43f13b412"><div class="ttname"><a href="_breakpoint_commands_8c.html#ae7d28c7c329ec9621af580e43f13b412">BreakpointGetEntryByAddress</a></div><div class="ttdeci">PDEBUGGEE_BP_DESCRIPTOR BreakpointGetEntryByAddress(UINT64 Address)</div><div class="ttdoc">Find entry of breakpoint descriptor from list of breakpoints by address.</div><div class="ttdef"><b>Definition</b> BreakpointCommands.c:609</div></div>
<div class="ttc" id="a_constants_8h_html_aa145d6235b4996c241ae08d13de243a0"><div class="ttname"><a href="_constants_8h.html#aa145d6235b4996c241ae08d13de243a0">DEBUGGEE_BP_APPLY_TO_ALL_CORES</a></div><div class="ttdeci">#define DEBUGGEE_BP_APPLY_TO_ALL_CORES</div><div class="ttdoc">The constant to apply to all cores for bp command.</div><div class="ttdef"><b>Definition</b> Constants.h:587</div></div>
<div class="ttc" id="a_conversion_8c_html_ace32f507228d4b1b3b8e53f82ac09402"><div class="ttname"><a href="_conversion_8c.html#ace32f507228d4b1b3b8e53f82ac09402">VirtualAddressToPhysicalAddressByProcessCr3</a></div><div class="ttdeci">_Use_decl_annotations_ UINT64 VirtualAddressToPhysicalAddressByProcessCr3(PVOID VirtualAddress, CR3_TYPE TargetCr3)</div><div class="ttdoc">Converts Virtual Address to Physical Address based on a specific process's kernel cr3.</div><div class="ttdef"><b>Definition</b> Conversion.c:217</div></div>
<div class="ttc" id="a_data_types_8h_html_ad130f0bae4db97169873223d0aad9a63ab8948b7a3ee40226d0f76b7fccf90b9a"><div class="ttname"><a href="_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63ab8948b7a3ee40226d0f76b7fccf90b9a">BREAKPOINT_DEFINITION_STRUCTURE</a></div><div class="ttdeci">@ BREAKPOINT_DEFINITION_STRUCTURE</div><div class="ttdef"><b>Definition</b> DataTypes.h:45</div></div>
<div class="ttc" id="a_disassembler_8c_html_a387718dcee35d796938ad5f9b9fb1820"><div class="ttname"><a href="_disassembler_8c.html#a387718dcee35d796938ad5f9b9fb1820">DisassemblerLengthDisassembleEngineInVmxRootOnTargetProcess</a></div><div class="ttdeci">UINT32 DisassemblerLengthDisassembleEngineInVmxRootOnTargetProcess(PVOID Address, BOOLEAN Is32Bit)</div><div class="ttdoc">Disassembler length disassembler engine.</div><div class="ttdef"><b>Definition</b> Disassembler.c:292</div></div>
<div class="ttc" id="a_error_codes_8h_html_a29e9c99a3400fc71880be5e623e7baaf"><div class="ttname"><a href="_error_codes_8h.html#a29e9c99a3400fc71880be5e623e7baaf">DEBUGGER_ERROR_MAXIMUM_BREAKPOINT_WITHOUT_CONTINUE</a></div><div class="ttdeci">#define DEBUGGER_ERROR_MAXIMUM_BREAKPOINT_WITHOUT_CONTINUE</div><div class="ttdoc">error, maximum pools were used without continueing debuggee</div><div class="ttdef"><b>Definition</b> ErrorCodes.h:184</div></div>
<div class="ttc" id="a_error_codes_8h_html_a3b5b126406066bc4844a91c1d07de9ac"><div class="ttname"><a href="_error_codes_8h.html#a3b5b126406066bc4844a91c1d07de9ac">DEBUGGER_ERROR_BREAKPOINT_ALREADY_EXISTS_ON_THE_ADDRESS</a></div><div class="ttdeci">#define DEBUGGER_ERROR_BREAKPOINT_ALREADY_EXISTS_ON_THE_ADDRESS</div><div class="ttdoc">error, breakpoint already exists on the target address</div><div class="ttdef"><b>Definition</b> ErrorCodes.h:190</div></div>
<div class="ttc" id="a_error_codes_8h_html_a5a5ccba7c7cceb94d66f297978047611"><div class="ttname"><a href="_error_codes_8h.html#a5a5ccba7c7cceb94d66f297978047611">DEBUGGER_ERROR_INVALID_CORE_ID</a></div><div class="ttdeci">#define DEBUGGER_ERROR_INVALID_CORE_ID</div><div class="ttdoc">error, the core id is invalid</div><div class="ttdef"><b>Definition</b> ErrorCodes.h:69</div></div>
<div class="ttc" id="a_error_codes_8h_html_a68e4d375f85d62fc6169b228d0cb346a"><div class="ttname"><a href="_error_codes_8h.html#a68e4d375f85d62fc6169b228d0cb346a">DEBUGGER_ERROR_EDIT_MEMORY_STATUS_INVALID_ADDRESS_BASED_ON_CURRENT_PROCESS</a></div><div class="ttdeci">#define DEBUGGER_ERROR_EDIT_MEMORY_STATUS_INVALID_ADDRESS_BASED_ON_CURRENT_PROCESS</div><div class="ttdoc">error, an invalid address is specified based on current cr3 in !e* or e* commands</div><div class="ttdef"><b>Definition</b> ErrorCodes.h:106</div></div>
<div class="ttc" id="a_error_codes_8h_html_aed656c58434eecb2d7e8c10e93aecff4"><div class="ttname"><a href="_error_codes_8h.html#aed656c58434eecb2d7e8c10e93aecff4">DEBUGGER_OPERATION_WAS_SUCCESSFUL</a></div><div class="ttdeci">#define DEBUGGER_OPERATION_WAS_SUCCESSFUL</div><div class="ttdoc">General value to indicate that the operation or request was successful.</div><div class="ttdef"><b>Definition</b> ErrorCodes.h:23</div></div>
<div class="ttc" id="a_kd_8c_html_a814437795a9e923d352b848630625a56"><div class="ttname"><a href="_kd_8c.html#a814437795a9e923d352b848630625a56">KdIsGuestOnUsermode32Bit</a></div><div class="ttdeci">BOOLEAN KdIsGuestOnUsermode32Bit()</div><div class="ttdoc">determines if the guest was in 32-bit user-mode or 64-bit (long mode)</div><div class="ttdef"><b>Definition</b> Kd.c:2664</div></div>
<div class="ttc" id="a_layout_8c_html_af74e610cf3ad5dd8c972f536f2809429"><div class="ttname"><a href="_layout_8c.html#af74e610cf3ad5dd8c972f536f2809429">LayoutGetCurrentProcessCr3</a></div><div class="ttdeci">CR3_TYPE LayoutGetCurrentProcessCr3()</div><div class="ttdoc">Get cr3 of the target running process.</div><div class="ttdef"><b>Definition</b> Layout.c:55</div></div>
<div class="ttc" id="a_pool_manager_8c_html_a065841edb44331344b1a71a2ea397923"><div class="ttname"><a href="_pool_manager_8c.html#a065841edb44331344b1a71a2ea397923">PoolManagerRequestPool</a></div><div class="ttdeci">UINT64 PoolManagerRequestPool(POOL_ALLOCATION_INTENTION Intention, BOOLEAN RequestNewPool, UINT32 Size)</div><div class="ttdoc">This function should be called from vmx-root in order to get a pool from the list.</div><div class="ttdef"><b>Definition</b> PoolManager.c:235</div></div>
<div class="ttc" id="acommon_8cpp_html_aec71cec56c29db61a23b2997ee8e2059"><div class="ttname"><a href="common_8cpp.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a></div><div class="ttdeci">BOOLEAN CheckAccessValidityAndSafety(UINT64 TargetAddress, UINT32 Size)</div><div class="ttdoc">Check the safety to access the memory.</div><div class="ttdef"><b>Definition</b> common.cpp:1038</div></div>
<div class="ttc" id="ahprdbgkd_2header_2globals_2_global_8h_html_abca944290c6a683f0821a9096472f7d4"><div class="ttname"><a href="hprdbgkd_2header_2globals_2_global_8h.html#abca944290c6a683f0821a9096472f7d4">g_BreakpointsListHead</a></div><div class="ttdeci">LIST_ENTRY g_BreakpointsListHead</div><div class="ttdoc">List header of breakpoints for debugger-mode.</div><div class="ttdef"><b>Definition</b> Global.h:91</div></div>
<div class="ttc" id="ahprdbgkd_2header_2globals_2_global_8h_html_ad09616266c993d19a27d9f414073c0a7"><div class="ttname"><a href="hprdbgkd_2header_2globals_2_global_8h.html#ad09616266c993d19a27d9f414073c0a7">g_MaximumBreakpointId</a></div><div class="ttdeci">UINT64 g_MaximumBreakpointId</div><div class="ttdoc">Seed for setting id of breakpoints.</div><div class="ttdef"><b>Definition</b> Global.h:97</div></div>
<div class="ttc" id="alist_8h_html_a77df31a5e6a1be59d08b93e9cb028f22"><div class="ttname"><a href="list_8h.html#a77df31a5e6a1be59d08b93e9cb028f22">InsertHeadList</a></div><div class="ttdeci">void InsertHeadList(PLIST_ENTRY ListHead, PLIST_ENTRY Entry)</div></div>
<div class="ttc" id="astruct___c_r3___t_y_p_e_html"><div class="ttname"><a href="struct___c_r3___t_y_p_e.html">_CR3_TYPE</a></div><div class="ttdoc">CR3 Structure.</div><div class="ttdef"><b>Definition</b> BasicTypes.h:136</div></div>
<div class="ttc" id="astruct___c_r3___t_y_p_e_html_a04eb96cc99b0458be739bcc9c640e08b"><div class="ttname"><a href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">_CR3_TYPE::Flags</a></div><div class="ttdeci">UINT64 Flags</div><div class="ttdef"><b>Definition</b> BasicTypes.h:139</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html">_DEBUGGEE_BP_DESCRIPTOR</a></div><div class="ttdoc">The structure of storing breakpoints.</div><div class="ttdef"><b>Definition</b> State.h:72</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html_a0600a3a7a748f669bef44b0eb920fd4f"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a0600a3a7a748f669bef44b0eb920fd4f">_DEBUGGEE_BP_DESCRIPTOR::BreakpointId</a></div><div class="ttdeci">UINT64 BreakpointId</div><div class="ttdef"><b>Definition</b> State.h:73</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html_a1e808c059fbd554f0899ae6b5f2d350e"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a1e808c059fbd554f0899ae6b5f2d350e">_DEBUGGEE_BP_DESCRIPTOR::RemoveAfterHit</a></div><div class="ttdeci">BOOLEAN RemoveAfterHit</div><div class="ttdef"><b>Definition</b> State.h:85</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html_a603517c66479592e240eeacb29379803"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a603517c66479592e240eeacb29379803">_DEBUGGEE_BP_DESCRIPTOR::InstructionLength</a></div><div class="ttdeci">UINT16 InstructionLength</div><div class="ttdef"><b>Definition</b> State.h:81</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html_a6ee164edb59fd20f9e69048564dd435a"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a6ee164edb59fd20f9e69048564dd435a">_DEBUGGEE_BP_DESCRIPTOR::Address</a></div><div class="ttdeci">UINT64 Address</div><div class="ttdef"><b>Definition</b> State.h:76</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html_a963ede4fbe9776b1b18b53b4e2dff062"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a963ede4fbe9776b1b18b53b4e2dff062">_DEBUGGEE_BP_DESCRIPTOR::BreakpointsList</a></div><div class="ttdeci">LIST_ENTRY BreakpointsList</div><div class="ttdef"><b>Definition</b> State.h:74</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html_aac7e43f351a7b2c5d45e6b058be77036"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#aac7e43f351a7b2c5d45e6b058be77036">_DEBUGGEE_BP_DESCRIPTOR::Enabled</a></div><div class="ttdeci">BOOLEAN Enabled</div><div class="ttdef"><b>Definition</b> State.h:75</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html_ab5f824b8c4d255545d038d3e57231e76"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#ab5f824b8c4d255545d038d3e57231e76">_DEBUGGEE_BP_DESCRIPTOR::PhysAddress</a></div><div class="ttdeci">UINT64 PhysAddress</div><div class="ttdef"><b>Definition</b> State.h:77</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html_ad46a87a0665b8d99405fec5650ae1eb1"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#ad46a87a0665b8d99405fec5650ae1eb1">_DEBUGGEE_BP_DESCRIPTOR::Pid</a></div><div class="ttdeci">UINT32 Pid</div><div class="ttdef"><b>Definition</b> State.h:78</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html_ad787a3220aa8e2b76f31c570f33fd071"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#ad787a3220aa8e2b76f31c570f33fd071">_DEBUGGEE_BP_DESCRIPTOR::Tid</a></div><div class="ttdeci">UINT32 Tid</div><div class="ttdef"><b>Definition</b> State.h:79</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html_aff66a054304ff0b558bd5e5688cb8e04"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#aff66a054304ff0b558bd5e5688cb8e04">_DEBUGGEE_BP_DESCRIPTOR::Core</a></div><div class="ttdeci">UINT32 Core</div><div class="ttdef"><b>Definition</b> State.h:80</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t_html_a13aeaf024d8bea5bd40692b08a8ed3ee"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#a13aeaf024d8bea5bd40692b08a8ed3ee">_DEBUGGEE_BP_PACKET::Tid</a></div><div class="ttdeci">UINT32 Tid</div><div class="ttdef"><b>Definition</b> RequestStructures.h:1032</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t_html_a31f51c86477913031d2e01f69341620f"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#a31f51c86477913031d2e01f69341620f">_DEBUGGEE_BP_PACKET::Result</a></div><div class="ttdeci">UINT32 Result</div><div class="ttdef"><b>Definition</b> RequestStructures.h:1035</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t_html_a69d6b93ae09e735b05232e69700e0e2f"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#a69d6b93ae09e735b05232e69700e0e2f">_DEBUGGEE_BP_PACKET::RemoveAfterHit</a></div><div class="ttdeci">BOOLEAN RemoveAfterHit</div><div class="ttdef"><b>Definition</b> RequestStructures.h:1034</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t_html_a7285098a69927e556cbc61864a1d7e62"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#a7285098a69927e556cbc61864a1d7e62">_DEBUGGEE_BP_PACKET::Core</a></div><div class="ttdeci">UINT32 Core</div><div class="ttdef"><b>Definition</b> RequestStructures.h:1033</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t_html_aa58a4dcb7c01e3412eac7dd3b428f309"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#aa58a4dcb7c01e3412eac7dd3b428f309">_DEBUGGEE_BP_PACKET::Address</a></div><div class="ttdeci">UINT64 Address</div><div class="ttdef"><b>Definition</b> RequestStructures.h:1030</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t_html_aae09270daf430ca348d56079a35ed1b8"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___p_a_c_k_e_t.html#aae09270daf430ca348d56079a35ed1b8">_DEBUGGEE_BP_PACKET::Pid</a></div><div class="ttdeci">UINT32 Pid</div><div class="ttdef"><b>Definition</b> RequestStructures.h:1031</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a462860a027e1e81083a6df87f8e4a32a" name="a462860a027e1e81083a6df87f8e4a32a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a462860a027e1e81083a6df87f8e4a32a">&#9670;&#160;</a></span>BreakpointAdjustUnsetTrapFlagsOnCurrentThread()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> BreakpointAdjustUnsetTrapFlagsOnCurrentThread </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td>
          <td class="paramname"><em>SetTo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function makes sure to unset the RFLAGS.TF on next trigger of #DB. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">SetTo</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   62</span>{</div>
<div class="line"><span class="lineno">   63</span>    <a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#aaed877531015b85c25bca58d5bb60918">g_TrapFlagState</a>.<a class="code hl_variable" href="struct___k_d___t_r_a_p___f_l_a_g___s_t_a_t_e___s_t_a_t_e.html#a06267aa19b18af5e5535bcb886c54f6a">TargetProcessId</a>    = PsGetCurrentProcessId();</div>
<div class="line"><span class="lineno">   64</span>    <a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#aaed877531015b85c25bca58d5bb60918">g_TrapFlagState</a>.<a class="code hl_variable" href="struct___k_d___t_r_a_p___f_l_a_g___s_t_a_t_e___s_t_a_t_e.html#a1ea6946bfa8eecdbb7b4be08b5b98e9b">TargetThreadId</a>     = PsGetCurrentThreadId();</div>
<div class="line"><span class="lineno">   65</span>    <a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#aaed877531015b85c25bca58d5bb60918">g_TrapFlagState</a>.<a class="code hl_variable" href="struct___k_d___t_r_a_p___f_l_a_g___s_t_a_t_e___s_t_a_t_e.html#ab3192a51c55a8dd1358f39799f0e9dae">SetTo</a>              = SetTo;</div>
<div class="line"><span class="lineno">   66</span>    <a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#aaed877531015b85c25bca58d5bb60918">g_TrapFlagState</a>.<a class="code hl_variable" href="struct___k_d___t_r_a_p___f_l_a_g___s_t_a_t_e___s_t_a_t_e.html#aea5fe086db42f9e973ec68fee72ecff4">CheckTrapFlagState</a> = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">   67</span>}</div>
<div class="ttc" id="ahprdbgkd_2header_2globals_2_global_8h_html_aaed877531015b85c25bca58d5bb60918"><div class="ttname"><a href="hprdbgkd_2header_2globals_2_global_8h.html#aaed877531015b85c25bca58d5bb60918">g_TrapFlagState</a></div><div class="ttdeci">KD_TRAP_FLAG_STATE_STATE g_TrapFlagState</div><div class="ttdoc">State of the trap-flag.</div><div class="ttdef"><b>Definition</b> Global.h:29</div></div>
<div class="ttc" id="astruct___k_d___t_r_a_p___f_l_a_g___s_t_a_t_e___s_t_a_t_e_html_a06267aa19b18af5e5535bcb886c54f6a"><div class="ttname"><a href="struct___k_d___t_r_a_p___f_l_a_g___s_t_a_t_e___s_t_a_t_e.html#a06267aa19b18af5e5535bcb886c54f6a">_KD_TRAP_FLAG_STATE_STATE::TargetProcessId</a></div><div class="ttdeci">UINT32 TargetProcessId</div><div class="ttdef"><b>Definition</b> State.h:107</div></div>
<div class="ttc" id="astruct___k_d___t_r_a_p___f_l_a_g___s_t_a_t_e___s_t_a_t_e_html_a1ea6946bfa8eecdbb7b4be08b5b98e9b"><div class="ttname"><a href="struct___k_d___t_r_a_p___f_l_a_g___s_t_a_t_e___s_t_a_t_e.html#a1ea6946bfa8eecdbb7b4be08b5b98e9b">_KD_TRAP_FLAG_STATE_STATE::TargetThreadId</a></div><div class="ttdeci">UINT32 TargetThreadId</div><div class="ttdef"><b>Definition</b> State.h:108</div></div>
<div class="ttc" id="astruct___k_d___t_r_a_p___f_l_a_g___s_t_a_t_e___s_t_a_t_e_html_ab3192a51c55a8dd1358f39799f0e9dae"><div class="ttname"><a href="struct___k_d___t_r_a_p___f_l_a_g___s_t_a_t_e___s_t_a_t_e.html#ab3192a51c55a8dd1358f39799f0e9dae">_KD_TRAP_FLAG_STATE_STATE::SetTo</a></div><div class="ttdeci">UINT32 SetTo</div><div class="ttdef"><b>Definition</b> State.h:109</div></div>
<div class="ttc" id="astruct___k_d___t_r_a_p___f_l_a_g___s_t_a_t_e___s_t_a_t_e_html_aea5fe086db42f9e973ec68fee72ecff4"><div class="ttname"><a href="struct___k_d___t_r_a_p___f_l_a_g___s_t_a_t_e___s_t_a_t_e.html#aea5fe086db42f9e973ec68fee72ecff4">_KD_TRAP_FLAG_STATE_STATE::CheckTrapFlagState</a></div><div class="ttdeci">BOOLEAN CheckTrapFlagState</div><div class="ttdef"><b>Definition</b> State.h:106</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6de84d2bb5c24bf8c4edcbad8e9dc055" name="a6de84d2bb5c24bf8c4edcbad8e9dc055"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6de84d2bb5c24bf8c4edcbad8e9dc055">&#9670;&#160;</a></span>BreakpointCheckAndHandleDebugBreakpoint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> BreakpointCheckAndHandleDebugBreakpoint </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td>
          <td class="paramname"><em>CoreId</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check and handle debug breakpoint exceptions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CoreId</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   78</span>{</div>
<div class="line"><span class="lineno">   79</span>    <a class="code hl_struct" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html">PROCESSOR_DEBUGGING_STATE</a> * DbgState = &amp;<a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a>[CoreId];</div>
<div class="line"><span class="lineno">   80</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                     Result   = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">   81</span> </div>
<div class="line"><span class="lineno">   82</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   83</span>    <span class="comment">// Check whether anything should be changed with trap-flags</span></div>
<div class="line"><span class="lineno">   84</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   85</span>    <a class="code hl_function" href="_breakpoint_commands_8c.html#acc41a2fb2fa9c6cbd6e145286fc71231">BreakpointCheckAndPerformActionsOnTrapFlags</a>(DbgState);</div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   88</span>    <span class="comment">// Check whether it is because of thread change detection or not</span></div>
<div class="line"><span class="lineno">   89</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   90</span>    <span class="keywordflow">if</span> (DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a8f17ce3238c1b7fcd0e8a53040cba548">ThreadOrProcessTracingDetails</a>.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___p_r_o_c_e_s_s___o_r___t_h_r_e_a_d___t_r_a_c_i_n_g___d_e_t_a_i_l_s.html#a828cb9812e870d901c9397930c02a451">DebugRegisterInterceptionState</a>)</div>
<div class="line"><span class="lineno">   91</span>    {</div>
<div class="line"><span class="lineno">   92</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   93</span>        <span class="comment">// This way of handling has a problem, if the user set to change</span></div>
<div class="line"><span class="lineno">   94</span>        <span class="comment">// the thread and instead of using &#39;g&#39;, it pressed the &#39;p&#39; to</span></div>
<div class="line"><span class="lineno">   95</span>        <span class="comment">// set or a trap happens somewhere then will be ignored</span></div>
<div class="line"><span class="lineno">   96</span>        <span class="comment">// it because we don&#39;t know the origin of this debug breakpoint</span></div>
<div class="line"><span class="lineno">   97</span>        <span class="comment">// and it only happens on &#39;.thread2&#39; command, the correct way</span></div>
<div class="line"><span class="lineno">   98</span>        <span class="comment">// to handle it is to find the exact hw debug register that caused</span></div>
<div class="line"><span class="lineno">   99</span>        <span class="comment">// this vm-exit, but it&#39;s a really rare case, so we left it without</span></div>
<div class="line"><span class="lineno">  100</span>        <span class="comment">// handling this case</span></div>
<div class="line"><span class="lineno">  101</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  102</span>        <a class="code hl_function" href="_thread_8c.html#a2d1b8ef9edfc052394e1b64cf6daf3d3">ThreadHandleThreadChange</a>(DbgState);</div>
<div class="line"><span class="lineno">  103</span>    }</div>
<div class="line"><span class="lineno">  104</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#ae304ded1a8cbb4e772d97aec7510c9d2">g_UserDebuggerState</a> == <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a> &amp;&amp;</div>
<div class="line"><span class="lineno">  105</span>             (<a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#ae4b7e6d3d73fbc5e36dab0e432cfda0e">g_IsWaitingForUserModeProcessEntryToBeCalled</a> || <a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#a0b03446aa090036e1c29277857de9596">g_IsWaitingForReturnAndRunFromPageFault</a>))</div>
<div class="line"><span class="lineno">  106</span>    {</div>
<div class="line"><span class="lineno">  107</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  108</span>        <span class="comment">// Handle for user-mode attaching mechanism</span></div>
<div class="line"><span class="lineno">  109</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  110</span>        <a class="code hl_function" href="_attaching_8c.html#adadde19c6465b57b781fff52e7f8db85">AttachingHandleEntrypointInterception</a>(DbgState);</div>
<div class="line"><span class="lineno">  111</span>    }</div>
<div class="line"><span class="lineno">  112</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#ae4b5afa957e3e26377135b91b60eda4e">g_KernelDebuggerState</a> == <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)</div>
<div class="line"><span class="lineno">  113</span>    {</div>
<div class="line"><span class="lineno">  114</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  115</span>        <span class="comment">// Handle debug events (breakpoint, traps, hardware debug register when kernel</span></div>
<div class="line"><span class="lineno">  116</span>        <span class="comment">// debugger is attached.)</span></div>
<div class="line"><span class="lineno">  117</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  118</span>        <a class="code hl_function" href="_kd_8c.html#a471c63b8db9a487f132923dcaf13b0cc">KdHandleDebugEventsWhenKernelDebuggerIsAttached</a>(DbgState);</div>
<div class="line"><span class="lineno">  119</span>    }</div>
<div class="line"><span class="lineno">  120</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="_ud_8c.html#a5ebe34618715108270c71344983e4af3">UdCheckAndHandleBreakpointsAndDebugBreaks</a>(DbgState,</div>
<div class="line"><span class="lineno">  121</span>                                                       <a class="code hl_enumvalue" href="_connection_8h.html#a6e2be89205e735ebae644cf4850ac21ba369b24d73385054023d8aba1a5d3c8b5">DEBUGGEE_PAUSING_REASON_DEBUGGEE_GENERAL_DEBUG_BREAK</a>,</div>
<div class="line"><span class="lineno">  122</span>                                                       NULL))</div>
<div class="line"><span class="lineno">  123</span>    {</div>
<div class="line"><span class="lineno">  124</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  125</span>        <span class="comment">// if the above function returns true, no need for further action</span></div>
<div class="line"><span class="lineno">  126</span>        <span class="comment">// it&#39;s handled in the user debugger</span></div>
<div class="line"><span class="lineno">  127</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  128</span>    }</div>
<div class="line"><span class="lineno">  129</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  130</span>    {</div>
<div class="line"><span class="lineno">  131</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  132</span>        <span class="comment">// Not handled by debugger</span></div>
<div class="line"><span class="lineno">  133</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  134</span>        Result = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  135</span>    }</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>    <span class="keywordflow">return</span> Result;</div>
<div class="line"><span class="lineno">  138</span>}</div>
<div class="ttc" id="a_attaching_8c_html_adadde19c6465b57b781fff52e7f8db85"><div class="ttname"><a href="_attaching_8c.html#adadde19c6465b57b781fff52e7f8db85">AttachingHandleEntrypointInterception</a></div><div class="ttdeci">VOID AttachingHandleEntrypointInterception(PROCESSOR_DEBUGGING_STATE *DbgState)</div><div class="ttdoc">Handle the interception of finding the entrypoint on attaching to user-mode process.</div><div class="ttdef"><b>Definition</b> Attaching.c:425</div></div>
<div class="ttc" id="a_breakpoint_commands_8c_html_acc41a2fb2fa9c6cbd6e145286fc71231"><div class="ttname"><a href="_breakpoint_commands_8c.html#acc41a2fb2fa9c6cbd6e145286fc71231">BreakpointCheckAndPerformActionsOnTrapFlags</a></div><div class="ttdeci">BOOLEAN BreakpointCheckAndPerformActionsOnTrapFlags()</div><div class="ttdoc">Check and perform actions on RFLAGS.TF.</div><div class="ttdef"><b>Definition</b> BreakpointCommands.c:20</div></div>
<div class="ttc" id="a_connection_8h_html_a6e2be89205e735ebae644cf4850ac21ba369b24d73385054023d8aba1a5d3c8b5"><div class="ttname"><a href="_connection_8h.html#a6e2be89205e735ebae644cf4850ac21ba369b24d73385054023d8aba1a5d3c8b5">DEBUGGEE_PAUSING_REASON_DEBUGGEE_GENERAL_DEBUG_BREAK</a></div><div class="ttdeci">@ DEBUGGEE_PAUSING_REASON_DEBUGGEE_GENERAL_DEBUG_BREAK</div><div class="ttdef"><b>Definition</b> Connection.h:41</div></div>
<div class="ttc" id="a_kd_8c_html_a471c63b8db9a487f132923dcaf13b0cc"><div class="ttname"><a href="_kd_8c.html#a471c63b8db9a487f132923dcaf13b0cc">KdHandleDebugEventsWhenKernelDebuggerIsAttached</a></div><div class="ttdeci">VOID KdHandleDebugEventsWhenKernelDebuggerIsAttached(PROCESSOR_DEBUGGING_STATE *DbgState)</div><div class="ttdoc">Handles debug events when kernel-debugger is attached.</div><div class="ttdef"><b>Definition</b> Kd.c:373</div></div>
<div class="ttc" id="a_thread_8c_html_a2d1b8ef9edfc052394e1b64cf6daf3d3"><div class="ttname"><a href="_thread_8c.html#a2d1b8ef9edfc052394e1b64cf6daf3d3">ThreadHandleThreadChange</a></div><div class="ttdeci">BOOLEAN ThreadHandleThreadChange(PROCESSOR_DEBUGGING_STATE *DbgState)</div><div class="ttdoc">handle thread changes</div><div class="ttdef"><b>Definition</b> Thread.c:22</div></div>
<div class="ttc" id="a_ud_8c_html_a5ebe34618715108270c71344983e4af3"><div class="ttname"><a href="_ud_8c.html#a5ebe34618715108270c71344983e4af3">UdCheckAndHandleBreakpointsAndDebugBreaks</a></div><div class="ttdeci">BOOLEAN UdCheckAndHandleBreakpointsAndDebugBreaks(PROCESSOR_DEBUGGING_STATE *DbgState, DEBUGGEE_PAUSING_REASON Reason, PDEBUGGER_TRIGGERED_EVENT_DETAILS EventDetails)</div><div class="ttdoc">Handle #DBs and #BPs for kernel debugger.</div><div class="ttdef"><b>Definition</b> Ud.c:458</div></div>
<div class="ttc" id="ahprdbgkd_2header_2globals_2_global_8h_html_a0b03446aa090036e1c29277857de9596"><div class="ttname"><a href="hprdbgkd_2header_2globals_2_global_8h.html#a0b03446aa090036e1c29277857de9596">g_IsWaitingForReturnAndRunFromPageFault</a></div><div class="ttdeci">BOOLEAN g_IsWaitingForReturnAndRunFromPageFault</div><div class="ttdoc">Whether the thread attaching mechanism is waiting for a page-fault finish or not.</div><div class="ttdef"><b>Definition</b> Global.h:146</div></div>
<div class="ttc" id="ahprdbgkd_2header_2globals_2_global_8h_html_a349ee1adc363d2e4323a35a68fae5646"><div class="ttname"><a href="hprdbgkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a></div><div class="ttdeci">PROCESSOR_DEBUGGING_STATE * g_DbgState</div><div class="ttdoc">Save the state and variables related to debugging on each to logical core.</div><div class="ttdef"><b>Definition</b> Global.h:23</div></div>
<div class="ttc" id="ahprdbgkd_2header_2globals_2_global_8h_html_ae304ded1a8cbb4e772d97aec7510c9d2"><div class="ttname"><a href="hprdbgkd_2header_2globals_2_global_8h.html#ae304ded1a8cbb4e772d97aec7510c9d2">g_UserDebuggerState</a></div><div class="ttdeci">BOOLEAN g_UserDebuggerState</div><div class="ttdoc">shows whether the user debugger is enabled or disabled</div><div class="ttdef"><b>Definition</b> Global.h:109</div></div>
<div class="ttc" id="ahprdbgkd_2header_2globals_2_global_8h_html_ae4b5afa957e3e26377135b91b60eda4e"><div class="ttname"><a href="hprdbgkd_2header_2globals_2_global_8h.html#ae4b5afa957e3e26377135b91b60eda4e">g_KernelDebuggerState</a></div><div class="ttdeci">BOOLEAN g_KernelDebuggerState</div><div class="ttdoc">shows whether the kernel debugger is enabled or disabled</div><div class="ttdef"><b>Definition</b> Global.h:103</div></div>
<div class="ttc" id="ahprdbgkd_2header_2globals_2_global_8h_html_ae4b7e6d3d73fbc5e36dab0e432cfda0e"><div class="ttname"><a href="hprdbgkd_2header_2globals_2_global_8h.html#ae4b7e6d3d73fbc5e36dab0e432cfda0e">g_IsWaitingForUserModeProcessEntryToBeCalled</a></div><div class="ttdeci">BOOLEAN g_IsWaitingForUserModeProcessEntryToBeCalled</div><div class="ttdoc">Whether the thread attaching mechanism is waiting for #DB or not.</div><div class="ttdef"><b>Definition</b> Global.h:185</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___p_r_o_c_e_s_s___o_r___t_h_r_e_a_d___t_r_a_c_i_n_g___d_e_t_a_i_l_s_html_a828cb9812e870d901c9397930c02a451"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___p_r_o_c_e_s_s___o_r___t_h_r_e_a_d___t_r_a_c_i_n_g___d_e_t_a_i_l_s.html#a828cb9812e870d901c9397930c02a451">_DEBUGGEE_PROCESS_OR_THREAD_TRACING_DETAILS::DebugRegisterInterceptionState</a></div><div class="ttdeci">BOOLEAN DebugRegisterInterceptionState</div><div class="ttdef"><b>Definition</b> State.h:56</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html">_PROCESSOR_DEBUGGING_STATE</a></div><div class="ttdoc">Saves the debugger state.</div><div class="ttdef"><b>Definition</b> State.h:120</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html_a8f17ce3238c1b7fcd0e8a53040cba548"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a8f17ce3238c1b7fcd0e8a53040cba548">_PROCESSOR_DEBUGGING_STATE::ThreadOrProcessTracingDetails</a></div><div class="ttdeci">DEBUGGEE_PROCESS_OR_THREAD_TRACING_DETAILS ThreadOrProcessTracingDetails</div><div class="ttdef"><b>Definition</b> State.h:133</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af249a8d277f3fe6fdeeb1796e537572b" name="af249a8d277f3fe6fdeeb1796e537572b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af249a8d277f3fe6fdeeb1796e537572b">&#9670;&#160;</a></span>BreakpointCheckAndHandleDebuggerDefinedBreakpoints()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> BreakpointCheckAndHandleDebuggerDefinedBreakpoints </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hprdbgkd_2header_2debugger_2core_2_state_8h.html#aa35afece6adc9a29a7bf7a2e76476037">PROCESSOR_DEBUGGING_STATE</a> *&#160;</td>
          <td class="paramname"><em>DbgState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>&#160;</td>
          <td class="paramname"><em>GuestRip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_connection_8h.html#ac834b5b60f3a3213636632ea482a26a3">DEBUGGEE_PAUSING_REASON</a>&#160;</td>
          <td class="paramname"><em>Reason</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td>
          <td class="paramname"><em>ChangeMtfState</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if the breakpoint vm-exit relates to 'bp' command or not. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">DbgState</td><td>The state of the debugger on the current core </td></tr>
    <tr><td class="paramname">GuestRip</td><td></td></tr>
    <tr><td class="paramname">Reason</td><td></td></tr>
    <tr><td class="paramname">ChangeMtfState</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  276</span>{</div>
<div class="line"><span class="lineno">  277</span>    <a class="code hl_struct" href="struct___c_r3___t_y_p_e.html">CR3_TYPE</a>                         GuestCr3;</div>
<div class="line"><span class="lineno">  278</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                          IsHandledByBpRoutines = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  279</span>    PLIST_ENTRY                      TempList              = 0;</div>
<div class="line"><span class="lineno">  280</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>                           GuestRipPhysical      = NULL;</div>
<div class="line"><span class="lineno">  281</span>    <a class="code hl_struct" href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html">DEBUGGER_TRIGGERED_EVENT_DETAILS</a> ContextAndTag         = {0};</div>
<div class="line"><span class="lineno">  282</span>    RFLAGS                           Rflags                = {0};</div>
<div class="line"><span class="lineno">  283</span>    <a class="code hl_typedef" href="_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a>                            LengthOfExitInstr     = 0;</div>
<div class="line"><span class="lineno">  284</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>                             InstrByte             = NULL;</div>
<div class="line"><span class="lineno">  285</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                          AvoidUnsetMtf         = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  286</span> </div>
<div class="line"><span class="lineno">  287</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  288</span>    <span class="comment">// ***** Check breakpoint for &#39;bp&#39; command *****</span></div>
<div class="line"><span class="lineno">  289</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  290</span> </div>
<div class="line"><span class="lineno">  291</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  292</span>    <span class="comment">// Find the current process cr3</span></div>
<div class="line"><span class="lineno">  293</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  294</span>    GuestCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a> = <a class="code hl_function" href="_layout_8c.html#af74e610cf3ad5dd8c972f536f2809429">LayoutGetCurrentProcessCr3</a>().<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>;</div>
<div class="line"><span class="lineno">  295</span> </div>
<div class="line"><span class="lineno">  296</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  297</span>    <span class="comment">// Convert breakpoint to physical address</span></div>
<div class="line"><span class="lineno">  298</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  299</span>    GuestRipPhysical = <a class="code hl_function" href="_conversion_8c.html#ace32f507228d4b1b3b8e53f82ac09402">VirtualAddressToPhysicalAddressByProcessCr3</a>(GuestRip, GuestCr3);</div>
<div class="line"><span class="lineno">  300</span> </div>
<div class="line"><span class="lineno">  301</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  302</span>    <span class="comment">// Iterate through the list of breakpoints</span></div>
<div class="line"><span class="lineno">  303</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  304</span>    TempList = &amp;<a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#abca944290c6a683f0821a9096472f7d4">g_BreakpointsListHead</a>;</div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span>    <span class="keywordflow">while</span> (&amp;<a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#abca944290c6a683f0821a9096472f7d4">g_BreakpointsListHead</a> != TempList-&gt;Flink)</div>
<div class="line"><span class="lineno">  307</span>    {</div>
<div class="line"><span class="lineno">  308</span>        TempList                                      = TempList-&gt;Flink;</div>
<div class="line"><span class="lineno">  309</span>        <a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html">PDEBUGGEE_BP_DESCRIPTOR</a> CurrentBreakpointDesc = <a class="code hl_define" href="list_8h.html#adec42d53dc3b3e16ab7a1cd98af1c5fc">CONTAINING_RECORD</a>(TempList, <a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html">DEBUGGEE_BP_DESCRIPTOR</a>, BreakpointsList);</div>
<div class="line"><span class="lineno">  310</span> </div>
<div class="line"><span class="lineno">  311</span>        <span class="keywordflow">if</span> (CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#ab5f824b8c4d255545d038d3e57231e76">PhysAddress</a> == GuestRipPhysical)</div>
<div class="line"><span class="lineno">  312</span>        {</div>
<div class="line"><span class="lineno">  313</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  314</span>            <span class="comment">// It&#39;s a breakpoint by &#39;bp&#39; command</span></div>
<div class="line"><span class="lineno">  315</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  316</span>            IsHandledByBpRoutines = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  317</span> </div>
<div class="line"><span class="lineno">  318</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  319</span>            <span class="comment">// First, we remove the breakpoint</span></div>
<div class="line"><span class="lineno">  320</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  321</span>            <a class="code hl_function" href="_memory_mapper_8c.html#a1ddcc27debd88fc732fe9b046a6b0038">MemoryMapperWriteMemorySafeByPhysicalAddress</a>(GuestRipPhysical,</div>
<div class="line"><span class="lineno">  322</span>                                                         &amp;CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a5a31f78cc97ef4c9fdb0ab7a9a3d9bad">PreviousByte</a>,</div>
<div class="line"><span class="lineno">  323</span>                                                         <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>));</div>
<div class="line"><span class="lineno">  324</span> </div>
<div class="line"><span class="lineno">  325</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  326</span>            <span class="comment">// Now, halt the debuggee</span></div>
<div class="line"><span class="lineno">  327</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  328</span>            ContextAndTag.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html#aed232a35a0d0d95aa4ca77dc50fc6fae">Context</a> = <a class="code hl_function" href="_export_8c.html#ab49740d6ce5d1c5f90828b66496dcb4c">VmFuncGetLastVmexitRip</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>);</div>
<div class="line"><span class="lineno">  329</span> </div>
<div class="line"><span class="lineno">  330</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  331</span>            <span class="comment">// In breakpoints tag is breakpoint id, not event tag</span></div>
<div class="line"><span class="lineno">  332</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  333</span>            <span class="keywordflow">if</span> (Reason == <a class="code hl_enumvalue" href="_connection_8h.html#a6e2be89205e735ebae644cf4850ac21ba04b2c9d4250379b584ec3d3d2af3355c">DEBUGGEE_PAUSING_REASON_DEBUGGEE_SOFTWARE_BREAKPOINT_HIT</a>)</div>
<div class="line"><span class="lineno">  334</span>            {</div>
<div class="line"><span class="lineno">  335</span>                ContextAndTag.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html#a4eed19d8d35fa2c8378db39e95dd9ef2">Tag</a> = CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a0600a3a7a748f669bef44b0eb920fd4f">BreakpointId</a>;</div>
<div class="line"><span class="lineno">  336</span>            }</div>
<div class="line"><span class="lineno">  337</span> </div>
<div class="line"><span class="lineno">  338</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  339</span>            <span class="comment">// Hint the debuggee about the length</span></div>
<div class="line"><span class="lineno">  340</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  341</span>            DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac0735b6e84ce3ae397f74cfd5b4eabb4">InstructionLengthHint</a> = CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a603517c66479592e240eeacb29379803">InstructionLength</a>;</div>
<div class="line"><span class="lineno">  342</span> </div>
<div class="line"><span class="lineno">  343</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  344</span>            <span class="comment">// Check constraints</span></div>
<div class="line"><span class="lineno">  345</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  346</span>            <span class="keywordflow">if</span> ((CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#ad46a87a0665b8d99405fec5650ae1eb1">Pid</a> == <a class="code hl_define" href="_constants_8h.html#a772442c9aa9acb6567a6d79ddc8c171b">DEBUGGEE_BP_APPLY_TO_ALL_PROCESSES</a> || CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#ad46a87a0665b8d99405fec5650ae1eb1">Pid</a> == PsGetCurrentProcessId()) &amp;&amp;</div>
<div class="line"><span class="lineno">  347</span>                (CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#ad787a3220aa8e2b76f31c570f33fd071">Tid</a> == <a class="code hl_define" href="_constants_8h.html#a83c229c2fbc9b06f560b3b78ae873f50">DEBUGGEE_BP_APPLY_TO_ALL_THREADS</a> || CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#ad787a3220aa8e2b76f31c570f33fd071">Tid</a> == PsGetCurrentThreadId()) &amp;&amp;</div>
<div class="line"><span class="lineno">  348</span>                (CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#aff66a054304ff0b558bd5e5688cb8e04">Core</a> == <a class="code hl_define" href="_constants_8h.html#aa145d6235b4996c241ae08d13de243a0">DEBUGGEE_BP_APPLY_TO_ALL_CORES</a> || CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#aff66a054304ff0b558bd5e5688cb8e04">Core</a> == DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>))</div>
<div class="line"><span class="lineno">  349</span>            {</div>
<div class="line"><span class="lineno">  350</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  351</span>                <span class="comment">// Check if breakpoint should be removed after this hit or not</span></div>
<div class="line"><span class="lineno">  352</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  353</span>                <span class="keywordflow">if</span> (CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a1e808c059fbd554f0899ae6b5f2d350e">RemoveAfterHit</a>)</div>
<div class="line"><span class="lineno">  354</span>                {</div>
<div class="line"><span class="lineno">  355</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  356</span>                    <span class="comment">// One hit, we have to remove it</span></div>
<div class="line"><span class="lineno">  357</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  358</span>                    <a class="code hl_function" href="_breakpoint_commands_8c.html#a15e8a59a7b3e9d6c7fd68539075564c8">BreakpointClearAndDeallocateMemory</a>(CurrentBreakpointDesc);</div>
<div class="line"><span class="lineno">  359</span>                }</div>
<div class="line"><span class="lineno">  360</span> </div>
<div class="line"><span class="lineno">  361</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  362</span>                <span class="comment">// *** It&#39;s not safe to access CurrentBreakpointDesc anymore as the</span></div>
<div class="line"><span class="lineno">  363</span>                <span class="comment">// breakpoint might be removed ***</span></div>
<div class="line"><span class="lineno">  364</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  365</span>                <a class="code hl_function" href="_kd_8c.html#a732bca2051e444c16d2d9a5080978981">KdHandleBreakpointAndDebugBreakpoints</a>(DbgState,</div>
<div class="line"><span class="lineno">  366</span>                                                      Reason,</div>
<div class="line"><span class="lineno">  367</span>                                                      &amp;ContextAndTag);</div>
<div class="line"><span class="lineno">  368</span>            }</div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  371</span>            <span class="comment">// Reset hint to instruction length</span></div>
<div class="line"><span class="lineno">  372</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  373</span>            DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac0735b6e84ce3ae397f74cfd5b4eabb4">InstructionLengthHint</a> = 0;</div>
<div class="line"><span class="lineno">  374</span> </div>
<div class="line"><span class="lineno">  375</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  376</span>            <span class="comment">// Check if we should re-apply the breakpoint after this instruction</span></div>
<div class="line"><span class="lineno">  377</span>            <span class="comment">// or not (in other words, is breakpoint still valid)</span></div>
<div class="line"><span class="lineno">  378</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  379</span>            <span class="keywordflow">if</span> (!CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a92b8d8e3dfe78ced438c04c2fc9c8b08">AvoidReApplyBreakpoint</a>)</div>
<div class="line"><span class="lineno">  380</span>            {</div>
<div class="line"><span class="lineno">  381</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  382</span>                <span class="comment">// We should re-apply the breakpoint on next mtf</span></div>
<div class="line"><span class="lineno">  383</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  384</span>                DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac48a6f48fd26c69f2d2ad49f09acbdd4">SoftwareBreakpointState</a> = CurrentBreakpointDesc;</div>
<div class="line"><span class="lineno">  385</span> </div>
<div class="line"><span class="lineno">  386</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  387</span>                <span class="comment">// Fire and MTF</span></div>
<div class="line"><span class="lineno">  388</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  389</span>                <a class="code hl_function" href="_export_8c.html#a85480760316ec7682996e98898d3a611">VmFuncSetMonitorTrapFlag</a>(<a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><span class="lineno">  390</span>                AvoidUnsetMtf = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  391</span> </div>
<div class="line"><span class="lineno">  392</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  393</span>                <span class="comment">// As we want to continue debuggee, the MTF might arrive when the</span></div>
<div class="line"><span class="lineno">  394</span>                <span class="comment">// host finish executing it&#39;s time slice; thus, a clock interrupt</span></div>
<div class="line"><span class="lineno">  395</span>                <span class="comment">// or an IPI might be arrived and the next instruction is not what</span></div>
<div class="line"><span class="lineno">  396</span>                <span class="comment">// we expect, because of that we check if the IF (Interrupt enable)</span></div>
<div class="line"><span class="lineno">  397</span>                <span class="comment">// flag of RFLAGS is enabled or not, if enabled then we remove it</span></div>
<div class="line"><span class="lineno">  398</span>                <span class="comment">// to avoid any clock-interrupt or IPI to arrive and the next</span></div>
<div class="line"><span class="lineno">  399</span>                <span class="comment">// instruction is our next instruction in the current execution</span></div>
<div class="line"><span class="lineno">  400</span>                <span class="comment">// context</span></div>
<div class="line"><span class="lineno">  401</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  402</span>                Rflags.AsUInt = <a class="code hl_function" href="_export_8c.html#a65a0cf94fa34ebb1f4150ed97fa7abc0">VmFuncGetRflags</a>();</div>
<div class="line"><span class="lineno">  403</span> </div>
<div class="line"><span class="lineno">  404</span>                <span class="keywordflow">if</span> (Rflags.InterruptEnableFlag)</div>
<div class="line"><span class="lineno">  405</span>                {</div>
<div class="line"><span class="lineno">  406</span>                    Rflags.InterruptEnableFlag = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  407</span>                    <a class="code hl_function" href="_export_8c.html#a1951855b2f1d299485b5d7e9d5dfa6f7">VmFuncSetRflags</a>(Rflags.AsUInt);</div>
<div class="line"><span class="lineno">  408</span> </div>
<div class="line"><span class="lineno">  409</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  410</span>                    <span class="comment">// An indicator to restore RFLAGS if to enabled state</span></div>
<div class="line"><span class="lineno">  411</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  412</span>                    DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac48a6f48fd26c69f2d2ad49f09acbdd4">SoftwareBreakpointState</a>-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a7c55438ab180ae0b5c47fe3b4266fce7">SetRflagsIFBitOnMtf</a> = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  413</span>                }</div>
<div class="line"><span class="lineno">  414</span>            }</div>
<div class="line"><span class="lineno">  415</span> </div>
<div class="line"><span class="lineno">  416</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  417</span>            <span class="comment">// Do not increment rip</span></div>
<div class="line"><span class="lineno">  418</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  419</span>            <a class="code hl_function" href="_export_8c.html#ad357512be8732352fac0e4a03676e458">VmFuncSuppressRipIncrement</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>);</div>
<div class="line"><span class="lineno">  420</span> </div>
<div class="line"><span class="lineno">  421</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  422</span>            <span class="comment">// No need to iterate anymore</span></div>
<div class="line"><span class="lineno">  423</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  424</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  425</span>        }</div>
<div class="line"><span class="lineno">  426</span>    }</div>
<div class="line"><span class="lineno">  427</span> </div>
<div class="line"><span class="lineno">  428</span>    <span class="keywordflow">if</span> (IsHandledByBpRoutines &amp;&amp; ChangeMtfState)</div>
<div class="line"><span class="lineno">  429</span>    {</div>
<div class="line"><span class="lineno">  430</span>        <a class="code hl_function" href="_export_8c.html#a00a52e5c83db1524b3877e7b24c235bf">VmFuncChangeMtfUnsettingState</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>, AvoidUnsetMtf);</div>
<div class="line"><span class="lineno">  431</span>    }</div>
<div class="line"><span class="lineno">  432</span> </div>
<div class="line"><span class="lineno">  433</span>    <span class="keywordflow">return</span> IsHandledByBpRoutines;</div>
<div class="line"><span class="lineno">  434</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_aae17ebb9ef7279d026817fb22f8aebe9"><div class="ttname"><a href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></div><div class="ttdeci">unsigned __int64 UINT64</div><div class="ttdef"><b>Definition</b> BasicTypes.h:19</div></div>
<div class="ttc" id="a_basic_types_8h_html_af632da489ebc3708ec3ab6791ee53fa4"><div class="ttname"><a href="_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a></div><div class="ttdeci">unsigned long ULONG</div><div class="ttdef"><b>Definition</b> BasicTypes.h:35</div></div>
<div class="ttc" id="a_breakpoint_commands_8c_html_a15e8a59a7b3e9d6c7fd68539075564c8"><div class="ttname"><a href="_breakpoint_commands_8c.html#a15e8a59a7b3e9d6c7fd68539075564c8">BreakpointClearAndDeallocateMemory</a></div><div class="ttdeci">VOID BreakpointClearAndDeallocateMemory(PDEBUGGEE_BP_DESCRIPTOR BreakpointDesc)</div><div class="ttdoc">Clears the breakpoint and remove the entry from the breakpoint list.</div><div class="ttdef"><b>Definition</b> BreakpointCommands.c:191</div></div>
<div class="ttc" id="a_connection_8h_html_a6e2be89205e735ebae644cf4850ac21ba04b2c9d4250379b584ec3d3d2af3355c"><div class="ttname"><a href="_connection_8h.html#a6e2be89205e735ebae644cf4850ac21ba04b2c9d4250379b584ec3d3d2af3355c">DEBUGGEE_PAUSING_REASON_DEBUGGEE_SOFTWARE_BREAKPOINT_HIT</a></div><div class="ttdeci">@ DEBUGGEE_PAUSING_REASON_DEBUGGEE_SOFTWARE_BREAKPOINT_HIT</div><div class="ttdef"><b>Definition</b> Connection.h:29</div></div>
<div class="ttc" id="a_constants_8h_html_a772442c9aa9acb6567a6d79ddc8c171b"><div class="ttname"><a href="_constants_8h.html#a772442c9aa9acb6567a6d79ddc8c171b">DEBUGGEE_BP_APPLY_TO_ALL_PROCESSES</a></div><div class="ttdeci">#define DEBUGGEE_BP_APPLY_TO_ALL_PROCESSES</div><div class="ttdoc">The constant to apply to all processes for bp command.</div><div class="ttdef"><b>Definition</b> Constants.h:593</div></div>
<div class="ttc" id="a_constants_8h_html_a83c229c2fbc9b06f560b3b78ae873f50"><div class="ttname"><a href="_constants_8h.html#a83c229c2fbc9b06f560b3b78ae873f50">DEBUGGEE_BP_APPLY_TO_ALL_THREADS</a></div><div class="ttdeci">#define DEBUGGEE_BP_APPLY_TO_ALL_THREADS</div><div class="ttdoc">The constant to apply to all threads for bp command.</div><div class="ttdef"><b>Definition</b> Constants.h:599</div></div>
<div class="ttc" id="a_export_8c_html_a00a52e5c83db1524b3877e7b24c235bf"><div class="ttname"><a href="_export_8c.html#a00a52e5c83db1524b3877e7b24c235bf">VmFuncChangeMtfUnsettingState</a></div><div class="ttdeci">VOID VmFuncChangeMtfUnsettingState(UINT32 CoreId, BOOLEAN Set)</div><div class="ttdoc">Supress unsetting MTF.</div><div class="ttdef"><b>Definition</b> Export.c:47</div></div>
<div class="ttc" id="a_export_8c_html_a1951855b2f1d299485b5d7e9d5dfa6f7"><div class="ttname"><a href="_export_8c.html#a1951855b2f1d299485b5d7e9d5dfa6f7">VmFuncSetRflags</a></div><div class="ttdeci">VOID VmFuncSetRflags(UINT64 Rflags)</div><div class="ttdoc">Set guest's RFLAGS.</div><div class="ttdef"><b>Definition</b> Export.c:364</div></div>
<div class="ttc" id="a_export_8c_html_a65a0cf94fa34ebb1f4150ed97fa7abc0"><div class="ttname"><a href="_export_8c.html#a65a0cf94fa34ebb1f4150ed97fa7abc0">VmFuncGetRflags</a></div><div class="ttdeci">UINT64 VmFuncGetRflags()</div><div class="ttdoc">Read guest's RFLAGS.</div><div class="ttdef"><b>Definition</b> Export.c:352</div></div>
<div class="ttc" id="a_export_8c_html_a85480760316ec7682996e98898d3a611"><div class="ttname"><a href="_export_8c.html#a85480760316ec7682996e98898d3a611">VmFuncSetMonitorTrapFlag</a></div><div class="ttdeci">VOID VmFuncSetMonitorTrapFlag(BOOLEAN Set)</div><div class="ttdoc">Set the monitor trap flag.</div><div class="ttdef"><b>Definition</b> Export.c:98</div></div>
<div class="ttc" id="a_export_8c_html_ab49740d6ce5d1c5f90828b66496dcb4c"><div class="ttname"><a href="_export_8c.html#ab49740d6ce5d1c5f90828b66496dcb4c">VmFuncGetLastVmexitRip</a></div><div class="ttdeci">UINT64 VmFuncGetLastVmexitRip(UINT32 CoreId)</div><div class="ttdoc">get the last vm-exit RIP</div><div class="ttdef"><b>Definition</b> Export.c:318</div></div>
<div class="ttc" id="a_export_8c_html_ad357512be8732352fac0e4a03676e458"><div class="ttname"><a href="_export_8c.html#ad357512be8732352fac0e4a03676e458">VmFuncSuppressRipIncrement</a></div><div class="ttdeci">VOID VmFuncSuppressRipIncrement(UINT32 CoreId)</div><div class="ttdoc">Supress the incrementation of RIP.</div><div class="ttdef"><b>Definition</b> Export.c:34</div></div>
<div class="ttc" id="a_kd_8c_html_a732bca2051e444c16d2d9a5080978981"><div class="ttname"><a href="_kd_8c.html#a732bca2051e444c16d2d9a5080978981">KdHandleBreakpointAndDebugBreakpoints</a></div><div class="ttdeci">_Use_decl_annotations_ VOID KdHandleBreakpointAndDebugBreakpoints(PROCESSOR_DEBUGGING_STATE *DbgState, DEBUGGEE_PAUSING_REASON Reason, PDEBUGGER_TRIGGERED_EVENT_DETAILS EventDetails)</div><div class="ttdoc">Handle #DBs and #BPs for kernel debugger.</div><div class="ttdef"><b>Definition</b> Kd.c:1137</div></div>
<div class="ttc" id="a_memory_mapper_8c_html_a1ddcc27debd88fc732fe9b046a6b0038"><div class="ttname"><a href="_memory_mapper_8c.html#a1ddcc27debd88fc732fe9b046a6b0038">MemoryMapperWriteMemorySafeByPhysicalAddress</a></div><div class="ttdeci">_Use_decl_annotations_ BOOLEAN MemoryMapperWriteMemorySafeByPhysicalAddress(UINT64 DestinationPa, UINT64 Source, SIZE_T SizeToWrite)</div><div class="ttdoc">Write memory safely by mapping the buffer.</div><div class="ttdef"><b>Definition</b> MemoryMapper.c:1388</div></div>
<div class="ttc" id="alist_8h_html_adec42d53dc3b3e16ab7a1cd98af1c5fc"><div class="ttname"><a href="list_8h.html#adec42d53dc3b3e16ab7a1cd98af1c5fc">CONTAINING_RECORD</a></div><div class="ttdeci">#define CONTAINING_RECORD(address, type, field)</div><div class="ttdef"><b>Definition</b> list.h:14</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html_a5a31f78cc97ef4c9fdb0ab7a9a3d9bad"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a5a31f78cc97ef4c9fdb0ab7a9a3d9bad">_DEBUGGEE_BP_DESCRIPTOR::PreviousByte</a></div><div class="ttdeci">BYTE PreviousByte</div><div class="ttdef"><b>Definition</b> State.h:82</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html_a7c55438ab180ae0b5c47fe3b4266fce7"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a7c55438ab180ae0b5c47fe3b4266fce7">_DEBUGGEE_BP_DESCRIPTOR::SetRflagsIFBitOnMtf</a></div><div class="ttdeci">BOOLEAN SetRflagsIFBitOnMtf</div><div class="ttdef"><b>Definition</b> State.h:83</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html_a92b8d8e3dfe78ced438c04c2fc9c8b08"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a92b8d8e3dfe78ced438c04c2fc9c8b08">_DEBUGGEE_BP_DESCRIPTOR::AvoidReApplyBreakpoint</a></div><div class="ttdeci">BOOLEAN AvoidReApplyBreakpoint</div><div class="ttdef"><b>Definition</b> State.h:84</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s_html"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html">_DEBUGGER_TRIGGERED_EVENT_DETAILS</a></div><div class="ttdoc">The structure of detail of a triggered event in HyperDbg.</div><div class="ttdef"><b>Definition</b> BasicTypes.h:114</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s_html_a4eed19d8d35fa2c8378db39e95dd9ef2"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html#a4eed19d8d35fa2c8378db39e95dd9ef2">_DEBUGGER_TRIGGERED_EVENT_DETAILS::Tag</a></div><div class="ttdeci">UINT64 Tag</div><div class="ttdef"><b>Definition</b> BasicTypes.h:115</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s_html_aed232a35a0d0d95aa4ca77dc50fc6fae"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html#aed232a35a0d0d95aa4ca77dc50fc6fae">_DEBUGGER_TRIGGERED_EVENT_DETAILS::Context</a></div><div class="ttdeci">PVOID Context</div><div class="ttdef"><b>Definition</b> BasicTypes.h:116</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html_a090832a74d330cde891a17bdd5b236e3"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">_PROCESSOR_DEBUGGING_STATE::CoreId</a></div><div class="ttdeci">UINT32 CoreId</div><div class="ttdef"><b>Definition</b> State.h:124</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html_ac0735b6e84ce3ae397f74cfd5b4eabb4"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac0735b6e84ce3ae397f74cfd5b4eabb4">_PROCESSOR_DEBUGGING_STATE::InstructionLengthHint</a></div><div class="ttdeci">UINT16 InstructionLengthHint</div><div class="ttdef"><b>Definition</b> State.h:136</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html_ac48a6f48fd26c69f2d2ad49f09acbdd4"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac48a6f48fd26c69f2d2ad49f09acbdd4">_PROCESSOR_DEBUGGING_STATE::SoftwareBreakpointState</a></div><div class="ttdeci">PDEBUGGEE_BP_DESCRIPTOR SoftwareBreakpointState</div><div class="ttdef"><b>Definition</b> State.h:129</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac2d64f1a4448078440fa5e05a511e3bb" name="ac2d64f1a4448078440fa5e05a511e3bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2d64f1a4448078440fa5e05a511e3bb">&#9670;&#160;</a></span>BreakpointCheckAndHandleReApplyingBreakpoint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> BreakpointCheckAndHandleReApplyingBreakpoint </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td>
          <td class="paramname"><em>CoreId</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check and reapply breakpoint. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CoreId</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  218</span>{</div>
<div class="line"><span class="lineno">  219</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                     Result   = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  220</span>    <a class="code hl_struct" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html">PROCESSOR_DEBUGGING_STATE</a> * DbgState = &amp;<a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a>[CoreId];</div>
<div class="line"><span class="lineno">  221</span> </div>
<div class="line"><span class="lineno">  222</span>    <span class="keywordflow">if</span> (DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac48a6f48fd26c69f2d2ad49f09acbdd4">SoftwareBreakpointState</a> != NULL)</div>
<div class="line"><span class="lineno">  223</span>    {</div>
<div class="line"><span class="lineno">  224</span>        <a class="code hl_typedef" href="_basic_types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> BreakpointByte = 0xcc;</div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  227</span>        <span class="comment">// MTF is handled</span></div>
<div class="line"><span class="lineno">  228</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  229</span>        Result = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  230</span> </div>
<div class="line"><span class="lineno">  231</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  232</span>        <span class="comment">// Restore previous breakpoint byte</span></div>
<div class="line"><span class="lineno">  233</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  234</span>        <a class="code hl_function" href="_memory_mapper_8c.html#a1ddcc27debd88fc732fe9b046a6b0038">MemoryMapperWriteMemorySafeByPhysicalAddress</a>(</div>
<div class="line"><span class="lineno">  235</span>            DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac48a6f48fd26c69f2d2ad49f09acbdd4">SoftwareBreakpointState</a>-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#ab5f824b8c4d255545d038d3e57231e76">PhysAddress</a>,</div>
<div class="line"><span class="lineno">  236</span>            &amp;BreakpointByte,</div>
<div class="line"><span class="lineno">  237</span>            <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>));</div>
<div class="line"><span class="lineno">  238</span> </div>
<div class="line"><span class="lineno">  239</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  240</span>        <span class="comment">// Check if we should re-enabled IF bit of RFLAGS or not</span></div>
<div class="line"><span class="lineno">  241</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  242</span>        <span class="keywordflow">if</span> (DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac48a6f48fd26c69f2d2ad49f09acbdd4">SoftwareBreakpointState</a>-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a7c55438ab180ae0b5c47fe3b4266fce7">SetRflagsIFBitOnMtf</a>)</div>
<div class="line"><span class="lineno">  243</span>        {</div>
<div class="line"><span class="lineno">  244</span>            RFLAGS Rflags = {0};</div>
<div class="line"><span class="lineno">  245</span> </div>
<div class="line"><span class="lineno">  246</span>            Rflags.AsUInt = <a class="code hl_function" href="_export_8c.html#a65a0cf94fa34ebb1f4150ed97fa7abc0">VmFuncGetRflags</a>();</div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span>            Rflags.InterruptEnableFlag = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  249</span> </div>
<div class="line"><span class="lineno">  250</span>            <a class="code hl_function" href="_export_8c.html#a1951855b2f1d299485b5d7e9d5dfa6f7">VmFuncSetRflags</a>(Rflags.AsUInt);</div>
<div class="line"><span class="lineno">  251</span> </div>
<div class="line"><span class="lineno">  252</span>            DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac48a6f48fd26c69f2d2ad49f09acbdd4">SoftwareBreakpointState</a>-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a7c55438ab180ae0b5c47fe3b4266fce7">SetRflagsIFBitOnMtf</a> = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  253</span>        }</div>
<div class="line"><span class="lineno">  254</span> </div>
<div class="line"><span class="lineno">  255</span>        DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac48a6f48fd26c69f2d2ad49f09acbdd4">SoftwareBreakpointState</a> = NULL;</div>
<div class="line"><span class="lineno">  256</span>    }</div>
<div class="line"><span class="lineno">  257</span> </div>
<div class="line"><span class="lineno">  258</span>    <span class="keywordflow">return</span> Result;</div>
<div class="line"><span class="lineno">  259</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3a0aeca428b3ffc888248391356079ac" name="a3a0aeca428b3ffc888248391356079ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a0aeca428b3ffc888248391356079ac">&#9670;&#160;</a></span>BreakpointHandleBpTraps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> BreakpointHandleBpTraps </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td>
          <td class="paramname"><em>CoreId</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle breakpoint vm-exits (#BP) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CoreId</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  445</span>{</div>
<div class="line"><span class="lineno">  446</span>    <a class="code hl_struct" href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html">DEBUGGER_TRIGGERED_EVENT_DETAILS</a> ContextAndTag = {0};</div>
<div class="line"><span class="lineno">  447</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>                           GuestRip      = 0;</div>
<div class="line"><span class="lineno">  448</span>    <a class="code hl_struct" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html">PROCESSOR_DEBUGGING_STATE</a> *      DbgState      = &amp;<a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a>[CoreId];</div>
<div class="line"><span class="lineno">  449</span> </div>
<div class="line"><span class="lineno">  450</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  451</span>    <span class="comment">// re-inject #BP back to the guest if not handled by the hidden breakpoint</span></div>
<div class="line"><span class="lineno">  452</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  453</span> </div>
<div class="line"><span class="lineno">  454</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#ae4b5afa957e3e26377135b91b60eda4e">g_KernelDebuggerState</a> &amp;&amp; !<a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#a4d0018c727503706f39f9ad28f8ad373">g_InterceptBreakpoints</a>)</div>
<div class="line"><span class="lineno">  455</span>    {</div>
<div class="line"><span class="lineno">  456</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  457</span>        <span class="comment">// Kernel debugger is attached, let&#39;s halt everything</span></div>
<div class="line"><span class="lineno">  458</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  459</span>        GuestRip = <a class="code hl_function" href="_export_8c.html#adcc46211db99d7ad7e48e04fda4cf416">VmFuncGetRip</a>();</div>
<div class="line"><span class="lineno">  460</span> </div>
<div class="line"><span class="lineno">  461</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  462</span>        <span class="comment">// A breakpoint triggered and two things might be happened,</span></div>
<div class="line"><span class="lineno">  463</span>        <span class="comment">// first, a breakpoint is triggered randomly in the computer and</span></div>
<div class="line"><span class="lineno">  464</span>        <span class="comment">// we shouldn&#39;t do anything on it (won&#39;t change the instruction)</span></div>
<div class="line"><span class="lineno">  465</span>        <span class="comment">// second, the breakpoint is because of the &#39;bp&#39; command, we should</span></div>
<div class="line"><span class="lineno">  466</span>        <span class="comment">// replace it with exact byte</span></div>
<div class="line"><span class="lineno">  467</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  468</span> </div>
<div class="line"><span class="lineno">  469</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="_breakpoint_commands_8c.html#af249a8d277f3fe6fdeeb1796e537572b">BreakpointCheckAndHandleDebuggerDefinedBreakpoints</a>(DbgState,</div>
<div class="line"><span class="lineno">  470</span>                                                                GuestRip,</div>
<div class="line"><span class="lineno">  471</span>                                                                <a class="code hl_enumvalue" href="_connection_8h.html#a6e2be89205e735ebae644cf4850ac21ba04b2c9d4250379b584ec3d3d2af3355c">DEBUGGEE_PAUSING_REASON_DEBUGGEE_SOFTWARE_BREAKPOINT_HIT</a>,</div>
<div class="line"><span class="lineno">  472</span>                                                                <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>))</div>
<div class="line"><span class="lineno">  473</span>        {</div>
<div class="line"><span class="lineno">  474</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  475</span>            <span class="comment">// It&#39;s a random breakpoint byte</span></div>
<div class="line"><span class="lineno">  476</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  477</span>            ContextAndTag.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html#aed232a35a0d0d95aa4ca77dc50fc6fae">Context</a> = GuestRip;</div>
<div class="line"><span class="lineno">  478</span>            <a class="code hl_function" href="_kd_8c.html#a732bca2051e444c16d2d9a5080978981">KdHandleBreakpointAndDebugBreakpoints</a>(DbgState,</div>
<div class="line"><span class="lineno">  479</span>                                                  <a class="code hl_enumvalue" href="_connection_8h.html#a6e2be89205e735ebae644cf4850ac21ba04b2c9d4250379b584ec3d3d2af3355c">DEBUGGEE_PAUSING_REASON_DEBUGGEE_SOFTWARE_BREAKPOINT_HIT</a>,</div>
<div class="line"><span class="lineno">  480</span>                                                  &amp;ContextAndTag);</div>
<div class="line"><span class="lineno">  481</span> </div>
<div class="line"><span class="lineno">  482</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  483</span>            <span class="comment">// Increment rip</span></div>
<div class="line"><span class="lineno">  484</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  485</span>            <a class="code hl_function" href="_export_8c.html#adc8c7ffd1d587dd25b734f2f24217393">VmFuncPerformRipIncrement</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>);</div>
<div class="line"><span class="lineno">  486</span>        }</div>
<div class="line"><span class="lineno">  487</span>    }</div>
<div class="line"><span class="lineno">  488</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  489</span>    {</div>
<div class="line"><span class="lineno">  490</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  491</span>        <span class="comment">// re-inject back to the guest as not handled here</span></div>
<div class="line"><span class="lineno">  492</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  493</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  494</span>    }</div>
<div class="line"><span class="lineno">  495</span> </div>
<div class="line"><span class="lineno">  496</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  497</span>}</div>
<div class="ttc" id="a_breakpoint_commands_8c_html_af249a8d277f3fe6fdeeb1796e537572b"><div class="ttname"><a href="_breakpoint_commands_8c.html#af249a8d277f3fe6fdeeb1796e537572b">BreakpointCheckAndHandleDebuggerDefinedBreakpoints</a></div><div class="ttdeci">BOOLEAN BreakpointCheckAndHandleDebuggerDefinedBreakpoints(PROCESSOR_DEBUGGING_STATE *DbgState, UINT64 GuestRip, DEBUGGEE_PAUSING_REASON Reason, BOOLEAN ChangeMtfState)</div><div class="ttdoc">Check if the breakpoint vm-exit relates to 'bp' command or not.</div><div class="ttdef"><b>Definition</b> BreakpointCommands.c:272</div></div>
<div class="ttc" id="a_export_8c_html_adc8c7ffd1d587dd25b734f2f24217393"><div class="ttname"><a href="_export_8c.html#adc8c7ffd1d587dd25b734f2f24217393">VmFuncPerformRipIncrement</a></div><div class="ttdeci">VOID VmFuncPerformRipIncrement(UINT32 CoreId)</div><div class="ttdoc">Perform the incrementation of RIP.</div><div class="ttdef"><b>Definition</b> Export.c:22</div></div>
<div class="ttc" id="a_export_8c_html_adcc46211db99d7ad7e48e04fda4cf416"><div class="ttname"><a href="_export_8c.html#adcc46211db99d7ad7e48e04fda4cf416">VmFuncGetRip</a></div><div class="ttdeci">UINT64 VmFuncGetRip()</div><div class="ttdoc">Read guest's RIP.</div><div class="ttdef"><b>Definition</b> Export.c:375</div></div>
<div class="ttc" id="ahprdbgkd_2header_2globals_2_global_8h_html_a4d0018c727503706f39f9ad28f8ad373"><div class="ttname"><a href="hprdbgkd_2header_2globals_2_global_8h.html#a4d0018c727503706f39f9ad28f8ad373">g_InterceptBreakpoints</a></div><div class="ttdeci">BOOLEAN g_InterceptBreakpoints</div><div class="ttdoc">shows whether the debugger should intercept breakpoints (int3) or not</div><div class="ttdef"><b>Definition</b> Global.h:115</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acfb2587c2b1380011576fb0f243c4148" name="acfb2587c2b1380011576fb0f243c4148"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfb2587c2b1380011576fb0f243c4148">&#9670;&#160;</a></span>BreakpointListOrModify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> BreakpointListOrModify </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_request_structures_8h.html#ae0b77106e76131900a06635311dd3c2e">PDEBUGGEE_BP_LIST_OR_MODIFY_PACKET</a>&#160;</td>
          <td class="paramname"><em>ListOrModifyBreakpoints</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>List of modify breakpoints. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ListOrModifyBreakpoints</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  836</span>{</div>
<div class="line"><span class="lineno">  837</span>    <a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html">PDEBUGGEE_BP_DESCRIPTOR</a> BreakpointDescriptor = NULL;</div>
<div class="line"><span class="lineno">  838</span> </div>
<div class="line"><span class="lineno">  839</span>    <span class="keywordflow">if</span> (ListOrModifyBreakpoints-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#aebd996d558ebf1098a392d19289254f7">Request</a> == <a class="code hl_enumvalue" href="_request_structures_8h.html#ad78b7fd71adbd22c68a264ac22df3847a9f9631d6daadb45dfce91baa33e5eb4e">DEBUGGEE_BREAKPOINT_MODIFICATION_REQUEST_LIST_BREAKPOINTS</a>)</div>
<div class="line"><span class="lineno">  840</span>    {</div>
<div class="line"><span class="lineno">  841</span>        <a class="code hl_function" href="_breakpoint_commands_8c.html#a5dc92791e7148a75a6bf701966797b9d">BreakpointListAllBreakpoint</a>();</div>
<div class="line"><span class="lineno">  842</span>    }</div>
<div class="line"><span class="lineno">  843</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ListOrModifyBreakpoints-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#aebd996d558ebf1098a392d19289254f7">Request</a> == <a class="code hl_enumvalue" href="_request_structures_8h.html#ad78b7fd71adbd22c68a264ac22df3847abaf5cd591c9f6ba6bb3f00cb3db2688f">DEBUGGEE_BREAKPOINT_MODIFICATION_REQUEST_ENABLE</a>)</div>
<div class="line"><span class="lineno">  844</span>    {</div>
<div class="line"><span class="lineno">  845</span>        BreakpointDescriptor = <a class="code hl_function" href="_breakpoint_commands_8c.html#a5901425c05d238beb8eef3b70bfb65b5">BreakpointGetEntryByBreakpointId</a>(ListOrModifyBreakpoints-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#a25fc09d01ee64cca03420fd72f7e1d1c">BreakpointId</a>);</div>
<div class="line"><span class="lineno">  846</span> </div>
<div class="line"><span class="lineno">  847</span>        <span class="keywordflow">if</span> (BreakpointDescriptor == NULL)</div>
<div class="line"><span class="lineno">  848</span>        {</div>
<div class="line"><span class="lineno">  849</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  850</span>            <span class="comment">// Breakpoint id is invalid</span></div>
<div class="line"><span class="lineno">  851</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  852</span>            ListOrModifyBreakpoints-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#acac6a7db2a769df61a984f3f1da846e2">Result</a> = <a class="code hl_define" href="_error_codes_8h.html#a59ac3bd31f6604b05a16629d02d5480d">DEBUGGER_ERROR_BREAKPOINT_ID_NOT_FOUND</a>;</div>
<div class="line"><span class="lineno">  853</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  854</span>        }</div>
<div class="line"><span class="lineno">  855</span> </div>
<div class="line"><span class="lineno">  856</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  857</span>        <span class="comment">// Check to make sure that breakpoint is not already enabled</span></div>
<div class="line"><span class="lineno">  858</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  859</span>        <span class="keywordflow">if</span> (BreakpointDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#aac7e43f351a7b2c5d45e6b058be77036">Enabled</a>)</div>
<div class="line"><span class="lineno">  860</span>        {</div>
<div class="line"><span class="lineno">  861</span>            ListOrModifyBreakpoints-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#acac6a7db2a769df61a984f3f1da846e2">Result</a> = <a class="code hl_define" href="_error_codes_8h.html#aeba4471a71b03e65b21c42b9e077f508">DEBUGGER_ERROR_BREAKPOINT_ALREADY_ENABLED</a>;</div>
<div class="line"><span class="lineno">  862</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  863</span>        }</div>
<div class="line"><span class="lineno">  864</span> </div>
<div class="line"><span class="lineno">  865</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  866</span>        <span class="comment">// Set the breakpoint (without removing from list)</span></div>
<div class="line"><span class="lineno">  867</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  868</span>        <a class="code hl_function" href="_breakpoint_commands_8c.html#adbfa823a7d6541668573fc9467ee4355">BreakpointWrite</a>(BreakpointDescriptor);</div>
<div class="line"><span class="lineno">  869</span>    }</div>
<div class="line"><span class="lineno">  870</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ListOrModifyBreakpoints-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#aebd996d558ebf1098a392d19289254f7">Request</a> == <a class="code hl_enumvalue" href="_request_structures_8h.html#ad78b7fd71adbd22c68a264ac22df3847a2cccbcabca6974690342dd42a008743c">DEBUGGEE_BREAKPOINT_MODIFICATION_REQUEST_DISABLE</a>)</div>
<div class="line"><span class="lineno">  871</span>    {</div>
<div class="line"><span class="lineno">  872</span>        BreakpointDescriptor = <a class="code hl_function" href="_breakpoint_commands_8c.html#a5901425c05d238beb8eef3b70bfb65b5">BreakpointGetEntryByBreakpointId</a>(ListOrModifyBreakpoints-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#a25fc09d01ee64cca03420fd72f7e1d1c">BreakpointId</a>);</div>
<div class="line"><span class="lineno">  873</span> </div>
<div class="line"><span class="lineno">  874</span>        <span class="keywordflow">if</span> (BreakpointDescriptor == NULL)</div>
<div class="line"><span class="lineno">  875</span>        {</div>
<div class="line"><span class="lineno">  876</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  877</span>            <span class="comment">// Breakpoint id is invalid</span></div>
<div class="line"><span class="lineno">  878</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  879</span>            ListOrModifyBreakpoints-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#acac6a7db2a769df61a984f3f1da846e2">Result</a> = <a class="code hl_define" href="_error_codes_8h.html#a59ac3bd31f6604b05a16629d02d5480d">DEBUGGER_ERROR_BREAKPOINT_ID_NOT_FOUND</a>;</div>
<div class="line"><span class="lineno">  880</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  881</span>        }</div>
<div class="line"><span class="lineno">  882</span> </div>
<div class="line"><span class="lineno">  883</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  884</span>        <span class="comment">// Check to make sure that breakpoint is not already disabled</span></div>
<div class="line"><span class="lineno">  885</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  886</span>        <span class="keywordflow">if</span> (!BreakpointDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#aac7e43f351a7b2c5d45e6b058be77036">Enabled</a>)</div>
<div class="line"><span class="lineno">  887</span>        {</div>
<div class="line"><span class="lineno">  888</span>            ListOrModifyBreakpoints-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#acac6a7db2a769df61a984f3f1da846e2">Result</a> = <a class="code hl_define" href="_error_codes_8h.html#aa6630c7fa9379e6ddc14b0c5207855e9">DEBUGGER_ERROR_BREAKPOINT_ALREADY_DISABLED</a>;</div>
<div class="line"><span class="lineno">  889</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  890</span>        }</div>
<div class="line"><span class="lineno">  891</span> </div>
<div class="line"><span class="lineno">  892</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  893</span>        <span class="comment">// Unset the breakpoint (without removing from list)</span></div>
<div class="line"><span class="lineno">  894</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  895</span>        <a class="code hl_function" href="_breakpoint_commands_8c.html#af932a37c8259ad673a40b551f12f58c8">BreakpointClear</a>(BreakpointDescriptor);</div>
<div class="line"><span class="lineno">  896</span>    }</div>
<div class="line"><span class="lineno">  897</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ListOrModifyBreakpoints-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#aebd996d558ebf1098a392d19289254f7">Request</a> == <a class="code hl_enumvalue" href="_request_structures_8h.html#ad78b7fd71adbd22c68a264ac22df3847af7991c7bc2f097898dfaa6de3f57aba2">DEBUGGEE_BREAKPOINT_MODIFICATION_REQUEST_CLEAR</a>)</div>
<div class="line"><span class="lineno">  898</span>    {</div>
<div class="line"><span class="lineno">  899</span>        BreakpointDescriptor = <a class="code hl_function" href="_breakpoint_commands_8c.html#a5901425c05d238beb8eef3b70bfb65b5">BreakpointGetEntryByBreakpointId</a>(ListOrModifyBreakpoints-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#a25fc09d01ee64cca03420fd72f7e1d1c">BreakpointId</a>);</div>
<div class="line"><span class="lineno">  900</span> </div>
<div class="line"><span class="lineno">  901</span>        <span class="keywordflow">if</span> (BreakpointDescriptor == NULL)</div>
<div class="line"><span class="lineno">  902</span>        {</div>
<div class="line"><span class="lineno">  903</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  904</span>            <span class="comment">// Breakpoint id is invalid</span></div>
<div class="line"><span class="lineno">  905</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  906</span>            ListOrModifyBreakpoints-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#acac6a7db2a769df61a984f3f1da846e2">Result</a> = <a class="code hl_define" href="_error_codes_8h.html#a59ac3bd31f6604b05a16629d02d5480d">DEBUGGER_ERROR_BREAKPOINT_ID_NOT_FOUND</a>;</div>
<div class="line"><span class="lineno">  907</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  908</span>        }</div>
<div class="line"><span class="lineno">  909</span> </div>
<div class="line"><span class="lineno">  910</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  911</span>        <span class="comment">// Clear and deallocate the breakpoint</span></div>
<div class="line"><span class="lineno">  912</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  913</span>        <a class="code hl_function" href="_breakpoint_commands_8c.html#a15e8a59a7b3e9d6c7fd68539075564c8">BreakpointClearAndDeallocateMemory</a>(BreakpointDescriptor);</div>
<div class="line"><span class="lineno">  914</span>    }</div>
<div class="line"><span class="lineno">  915</span> </div>
<div class="line"><span class="lineno">  916</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  917</span>    <span class="comment">// Operation was successful</span></div>
<div class="line"><span class="lineno">  918</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  919</span>    ListOrModifyBreakpoints-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#acac6a7db2a769df61a984f3f1da846e2">Result</a> = <a class="code hl_define" href="_error_codes_8h.html#aed656c58434eecb2d7e8c10e93aecff4">DEBUGGER_OPERATION_WAS_SUCCESSFUL</a>;</div>
<div class="line"><span class="lineno">  920</span> </div>
<div class="line"><span class="lineno">  921</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  922</span>}</div>
<div class="ttc" id="a_breakpoint_commands_8c_html_a5901425c05d238beb8eef3b70bfb65b5"><div class="ttname"><a href="_breakpoint_commands_8c.html#a5901425c05d238beb8eef3b70bfb65b5">BreakpointGetEntryByBreakpointId</a></div><div class="ttdeci">PDEBUGGEE_BP_DESCRIPTOR BreakpointGetEntryByBreakpointId(UINT64 BreakpointId)</div><div class="ttdoc">Find entry of breakpoint descriptor from list of breakpoints by breakpoint id.</div><div class="ttdef"><b>Definition</b> BreakpointCommands.c:578</div></div>
<div class="ttc" id="a_breakpoint_commands_8c_html_a5dc92791e7148a75a6bf701966797b9d"><div class="ttname"><a href="_breakpoint_commands_8c.html#a5dc92791e7148a75a6bf701966797b9d">BreakpointListAllBreakpoint</a></div><div class="ttdeci">VOID BreakpointListAllBreakpoint()</div><div class="ttdoc">List all breakpoints.</div><div class="ttdef"><b>Definition</b> BreakpointCommands.c:783</div></div>
<div class="ttc" id="a_breakpoint_commands_8c_html_af932a37c8259ad673a40b551f12f58c8"><div class="ttname"><a href="_breakpoint_commands_8c.html#af932a37c8259ad673a40b551f12f58c8">BreakpointClear</a></div><div class="ttdeci">BOOLEAN BreakpointClear(PDEBUGGEE_BP_DESCRIPTOR BreakpointDescriptor)</div><div class="ttdoc">clears the 0xcc and removes the breakpoint @detail this function won't remove the descriptor from the...</div><div class="ttdef"><b>Definition</b> BreakpointCommands.c:148</div></div>
<div class="ttc" id="a_error_codes_8h_html_a59ac3bd31f6604b05a16629d02d5480d"><div class="ttname"><a href="_error_codes_8h.html#a59ac3bd31f6604b05a16629d02d5480d">DEBUGGER_ERROR_BREAKPOINT_ID_NOT_FOUND</a></div><div class="ttdeci">#define DEBUGGER_ERROR_BREAKPOINT_ID_NOT_FOUND</div><div class="ttdoc">error, breakpoint id not found</div><div class="ttdef"><b>Definition</b> ErrorCodes.h:196</div></div>
<div class="ttc" id="a_error_codes_8h_html_aa6630c7fa9379e6ddc14b0c5207855e9"><div class="ttname"><a href="_error_codes_8h.html#aa6630c7fa9379e6ddc14b0c5207855e9">DEBUGGER_ERROR_BREAKPOINT_ALREADY_DISABLED</a></div><div class="ttdeci">#define DEBUGGER_ERROR_BREAKPOINT_ALREADY_DISABLED</div><div class="ttdoc">error, breakpoint already disabled</div><div class="ttdef"><b>Definition</b> ErrorCodes.h:202</div></div>
<div class="ttc" id="a_error_codes_8h_html_aeba4471a71b03e65b21c42b9e077f508"><div class="ttname"><a href="_error_codes_8h.html#aeba4471a71b03e65b21c42b9e077f508">DEBUGGER_ERROR_BREAKPOINT_ALREADY_ENABLED</a></div><div class="ttdeci">#define DEBUGGER_ERROR_BREAKPOINT_ALREADY_ENABLED</div><div class="ttdoc">error, breakpoint already enabled</div><div class="ttdef"><b>Definition</b> ErrorCodes.h:208</div></div>
<div class="ttc" id="a_request_structures_8h_html_ad78b7fd71adbd22c68a264ac22df3847a2cccbcabca6974690342dd42a008743c"><div class="ttname"><a href="_request_structures_8h.html#ad78b7fd71adbd22c68a264ac22df3847a2cccbcabca6974690342dd42a008743c">DEBUGGEE_BREAKPOINT_MODIFICATION_REQUEST_DISABLE</a></div><div class="ttdeci">@ DEBUGGEE_BREAKPOINT_MODIFICATION_REQUEST_DISABLE</div><div class="ttdef"><b>Definition</b> RequestStructures.h:1048</div></div>
<div class="ttc" id="a_request_structures_8h_html_ad78b7fd71adbd22c68a264ac22df3847a9f9631d6daadb45dfce91baa33e5eb4e"><div class="ttname"><a href="_request_structures_8h.html#ad78b7fd71adbd22c68a264ac22df3847a9f9631d6daadb45dfce91baa33e5eb4e">DEBUGGEE_BREAKPOINT_MODIFICATION_REQUEST_LIST_BREAKPOINTS</a></div><div class="ttdeci">@ DEBUGGEE_BREAKPOINT_MODIFICATION_REQUEST_LIST_BREAKPOINTS</div><div class="ttdef"><b>Definition</b> RequestStructures.h:1046</div></div>
<div class="ttc" id="a_request_structures_8h_html_ad78b7fd71adbd22c68a264ac22df3847abaf5cd591c9f6ba6bb3f00cb3db2688f"><div class="ttname"><a href="_request_structures_8h.html#ad78b7fd71adbd22c68a264ac22df3847abaf5cd591c9f6ba6bb3f00cb3db2688f">DEBUGGEE_BREAKPOINT_MODIFICATION_REQUEST_ENABLE</a></div><div class="ttdeci">@ DEBUGGEE_BREAKPOINT_MODIFICATION_REQUEST_ENABLE</div><div class="ttdef"><b>Definition</b> RequestStructures.h:1047</div></div>
<div class="ttc" id="a_request_structures_8h_html_ad78b7fd71adbd22c68a264ac22df3847af7991c7bc2f097898dfaa6de3f57aba2"><div class="ttname"><a href="_request_structures_8h.html#ad78b7fd71adbd22c68a264ac22df3847af7991c7bc2f097898dfaa6de3f57aba2">DEBUGGEE_BREAKPOINT_MODIFICATION_REQUEST_CLEAR</a></div><div class="ttdeci">@ DEBUGGEE_BREAKPOINT_MODIFICATION_REQUEST_CLEAR</div><div class="ttdef"><b>Definition</b> RequestStructures.h:1049</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t_html_a25fc09d01ee64cca03420fd72f7e1d1c"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#a25fc09d01ee64cca03420fd72f7e1d1c">_DEBUGGEE_BP_LIST_OR_MODIFY_PACKET::BreakpointId</a></div><div class="ttdeci">UINT64 BreakpointId</div><div class="ttdef"><b>Definition</b> RequestStructures.h:1059</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t_html_acac6a7db2a769df61a984f3f1da846e2"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#acac6a7db2a769df61a984f3f1da846e2">_DEBUGGEE_BP_LIST_OR_MODIFY_PACKET::Result</a></div><div class="ttdeci">UINT32 Result</div><div class="ttdef"><b>Definition</b> RequestStructures.h:1061</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t_html_aebd996d558ebf1098a392d19289254f7"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___l_i_s_t___o_r___m_o_d_i_f_y___p_a_c_k_e_t.html#aebd996d558ebf1098a392d19289254f7">_DEBUGGEE_BP_LIST_OR_MODIFY_PACKET::Request</a></div><div class="ttdeci">DEBUGGEE_BREAKPOINT_MODIFICATION_REQUEST Request</div><div class="ttdef"><b>Definition</b> RequestStructures.h:1060</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af5a28890d7cdeb6e697ba8c41d2bbbe7" name="af5a28890d7cdeb6e697ba8c41d2bbbe7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5a28890d7cdeb6e697ba8c41d2bbbe7">&#9670;&#160;</a></span>BreakpointRemoveAllBreakpoints()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> BreakpointRemoveAllBreakpoints </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove all the breakpoints if possible. </p>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  550</span>{</div>
<div class="line"><span class="lineno">  551</span>    PLIST_ENTRY TempList = 0;</div>
<div class="line"><span class="lineno">  552</span> </div>
<div class="line"><span class="lineno">  553</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  554</span>    <span class="comment">// Iterate through the list of breakpoints</span></div>
<div class="line"><span class="lineno">  555</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  556</span>    TempList = &amp;<a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#abca944290c6a683f0821a9096472f7d4">g_BreakpointsListHead</a>;</div>
<div class="line"><span class="lineno">  557</span> </div>
<div class="line"><span class="lineno">  558</span>    <span class="keywordflow">while</span> (&amp;<a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#abca944290c6a683f0821a9096472f7d4">g_BreakpointsListHead</a> != TempList-&gt;Flink)</div>
<div class="line"><span class="lineno">  559</span>    {</div>
<div class="line"><span class="lineno">  560</span>        TempList                                      = TempList-&gt;Flink;</div>
<div class="line"><span class="lineno">  561</span>        <a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html">PDEBUGGEE_BP_DESCRIPTOR</a> CurrentBreakpointDesc = <a class="code hl_define" href="list_8h.html#adec42d53dc3b3e16ab7a1cd98af1c5fc">CONTAINING_RECORD</a>(TempList, <a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html">DEBUGGEE_BP_DESCRIPTOR</a>, BreakpointsList);</div>
<div class="line"><span class="lineno">  562</span> </div>
<div class="line"><span class="lineno">  563</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  564</span>        <span class="comment">// Clear and deallocate the breakpoint</span></div>
<div class="line"><span class="lineno">  565</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  566</span>        <a class="code hl_function" href="_breakpoint_commands_8c.html#a15e8a59a7b3e9d6c7fd68539075564c8">BreakpointClearAndDeallocateMemory</a>(CurrentBreakpointDesc);</div>
<div class="line"><span class="lineno">  567</span>    }</div>
<div class="line"><span class="lineno">  568</span>}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_53a6cdbae347618e9ee76d4be5c6ea96.html">hyperdbg</a></li><li class="navelem"><a class="el" href="dir_0f75a8685de99980df6b10136f072ea3.html">hprdbgkd</a></li><li class="navelem"><a class="el" href="dir_a49bef8785c3fd81042e69d2866eb23c.html">header</a></li><li class="navelem"><a class="el" href="dir_c5c32dbaf8d06eb5e35478b4712c2bd5.html">debugger</a></li><li class="navelem"><a class="el" href="dir_f353bd738039477edd8cc44a32311ebb.html">commands</a></li><li class="navelem"><a class="el" href="_breakpoint_commands_8h.html">BreakpointCommands.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
