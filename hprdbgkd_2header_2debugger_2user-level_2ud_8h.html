<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HyperDbg: hyperdbg/hprdbgkd/header/debugger/user-level/Ud.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">HyperDbg
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('hprdbgkd_2header_2debugger_2user-level_2ud_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Ud.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Header for routines related to user mode debugging.  
<a href="#details">More...</a></p>

<p><a href="hprdbgkd_2header_2debugger_2user-level_2ud_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a86574ff4fedfd90b7552bf5d4f8d66a2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hprdbgkd_2header_2debugger_2user-level_2ud_8h.html#a86574ff4fedfd90b7552bf5d4f8d66a2">UdInitializeUserDebugger</a> ()</td></tr>
<tr class="memdesc:a86574ff4fedfd90b7552bf5d4f8d66a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the user debugger in user mode.  <br /></td></tr>
<tr class="separator:a86574ff4fedfd90b7552bf5d4f8d66a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c8e27ff0bdd3e135b4e39c7cf7b5805"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hprdbgkd_2header_2debugger_2user-level_2ud_8h.html#a7c8e27ff0bdd3e135b4e39c7cf7b5805">UdUninitializeUserDebugger</a> ()</td></tr>
<tr class="memdesc:a7c8e27ff0bdd3e135b4e39c7cf7b5805"><td class="mdescLeft">&#160;</td><td class="mdescRight">Uninitialize the user debugger in user mode.  <br /></td></tr>
<tr class="separator:a7c8e27ff0bdd3e135b4e39c7cf7b5805"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ebe34618715108270c71344983e4af3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hprdbgkd_2header_2debugger_2user-level_2ud_8h.html#a5ebe34618715108270c71344983e4af3">UdCheckAndHandleBreakpointsAndDebugBreaks</a> (<a class="el" href="hprdbgkd_2header_2debugger_2core_2_state_8h.html#aa35afece6adc9a29a7bf7a2e76476037">PROCESSOR_DEBUGGING_STATE</a> *DbgState, <a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_connection_8h.html#ac834b5b60f3a3213636632ea482a26a3">DEBUGGEE_PAUSING_REASON</a> Reason, <a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ad502772c412e6f5dd67d557fdc3a4322">PDEBUGGER_TRIGGERED_EVENT_DETAILS</a> EventDetails)</td></tr>
<tr class="memdesc:a5ebe34618715108270c71344983e4af3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle #DBs and #BPs for kernel debugger.  <br /></td></tr>
<tr class="separator:a5ebe34618715108270c71344983e4af3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56a511f72fa77e4eadf393c2e0d6dc8f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hprdbgkd_2header_2debugger_2user-level_2ud_8h.html#a56a511f72fa77e4eadf393c2e0d6dc8f">UdDispatchUsermodeCommands</a> (<a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a510b3c0106ca6b73316f747e1557baef">PDEBUGGER_UD_COMMAND_PACKET</a> ActionRequest)</td></tr>
<tr class="memdesc:a56a511f72fa77e4eadf393c2e0d6dc8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dispatch the user-mode commands.  <br /></td></tr>
<tr class="separator:a56a511f72fa77e4eadf393c2e0d6dc8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe8e59191c78460477ae89d3e9daf751"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hprdbgkd_2header_2debugger_2user-level_2ud_8h.html#afe8e59191c78460477ae89d3e9daf751">UdCheckForCommand</a> ()</td></tr>
<tr class="memdesc:afe8e59191c78460477ae89d3e9daf751"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check for the user-mode commands.  <br /></td></tr>
<tr class="separator:afe8e59191c78460477ae89d3e9daf751"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Header for routines related to user mode debugging. </p>
<dl class="section author"><dt>Author</dt><dd>Sina Karvandi (<a href="#" onclick="location.href='mai'+'lto:'+'sin'+'a@'+'hyp'+'er'+'dbg'+'.o'+'rg'; return false;">sina@<span class="obfuscator">.nosp@m.</span>hype<span class="obfuscator">.nosp@m.</span>rdbg.<span class="obfuscator">.nosp@m.</span>org</a>)</dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2022-01-06</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>This project is released under the GNU Public License v3. </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a5ebe34618715108270c71344983e4af3" name="a5ebe34618715108270c71344983e4af3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ebe34618715108270c71344983e4af3">&#9670;&#160;</a></span>UdCheckAndHandleBreakpointsAndDebugBreaks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> UdCheckAndHandleBreakpointsAndDebugBreaks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hprdbgkd_2header_2debugger_2core_2_state_8h.html#aa35afece6adc9a29a7bf7a2e76476037">PROCESSOR_DEBUGGING_STATE</a> *&#160;</td>
          <td class="paramname"><em>DbgState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_connection_8h.html#ac834b5b60f3a3213636632ea482a26a3">DEBUGGEE_PAUSING_REASON</a>&#160;</td>
          <td class="paramname"><em>Reason</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ad502772c412e6f5dd67d557fdc3a4322">PDEBUGGER_TRIGGERED_EVENT_DETAILS</a>&#160;</td>
          <td class="paramname"><em>EventDetails</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle #DBs and #BPs for kernel debugger. </p>
<p>This function can be used in vmx-root</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">DbgState</td><td>The state of the debugger on the current core </td></tr>
    <tr><td class="paramname">Reason</td><td></td></tr>
    <tr><td class="paramname">EventDetails</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  473</span>{</div>
<div class="line"><span class="lineno">  474</span>    <a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html">DEBUGGEE_UD_PAUSED_PACKET</a>           PausePacket;</div>
<div class="line"><span class="lineno">  475</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a>                               ExitInstructionLength   = 0;</div>
<div class="line"><span class="lineno">  476</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>                              SizeOfSafeBufferToRead  = 0;</div>
<div class="line"><span class="lineno">  477</span>    RFLAGS                              Rflags                  = {0};</div>
<div class="line"><span class="lineno">  478</span>    <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html">PUSERMODE_DEBUGGING_PROCESS_DETAILS</a> ProcessDebuggingDetails = NULL;</div>
<div class="line"><span class="lineno">  479</span>    <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html">PUSERMODE_DEBUGGING_THREAD_DETAILS</a>  ThreadDebuggingDetails  = NULL;</div>
<div class="line"><span class="lineno">  480</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>                              LastVmexitRip           = <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#ad3bf3809af7905836fde46ee81e86cc7">VmFuncGetLastVmexitRip</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>);</div>
<div class="line"><span class="lineno">  481</span> </div>
<div class="line"><span class="lineno">  482</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  483</span>    <span class="comment">// Breaking only supported in vmx-root mode, and if user-debugger is</span></div>
<div class="line"><span class="lineno">  484</span>    <span class="comment">// loaded</span></div>
<div class="line"><span class="lineno">  485</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  486</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#ae304ded1a8cbb4e772d97aec7510c9d2">g_UserDebuggerState</a> &amp;&amp; <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a6bb41b474360ecdcb3ed9900aa17e008">VmFuncVmxGetCurrentExecutionMode</a>() == <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>)</div>
<div class="line"><span class="lineno">  487</span>    {</div>
<div class="line"><span class="lineno">  488</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  489</span>    }</div>
<div class="line"><span class="lineno">  490</span> </div>
<div class="line"><span class="lineno">  491</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  492</span>    <span class="comment">// Check entry of paused thread</span></div>
<div class="line"><span class="lineno">  493</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  494</span>    ProcessDebuggingDetails = <a class="code hl_function" href="_attaching_8c.html#a733d0f343ddcccaeec221bbbb20483c7">AttachingFindProcessDebuggingDetailsByProcessId</a>(PsGetCurrentProcessId());</div>
<div class="line"><span class="lineno">  495</span> </div>
<div class="line"><span class="lineno">  496</span>    <span class="keywordflow">if</span> (!ProcessDebuggingDetails)</div>
<div class="line"><span class="lineno">  497</span>    {</div>
<div class="line"><span class="lineno">  498</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  499</span>        <span class="comment">// Token not found!</span></div>
<div class="line"><span class="lineno">  500</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  501</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  502</span>    }</div>
<div class="line"><span class="lineno">  503</span> </div>
<div class="line"><span class="lineno">  504</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  505</span>    <span class="comment">// Find the thread entry and if not found, create one for it</span></div>
<div class="line"><span class="lineno">  506</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  507</span>    ThreadDebuggingDetails = <a class="code hl_function" href="_thread_holder_8c.html#ac752176641e6314d84738f2f323cec68">ThreadHolderFindOrCreateThreadDebuggingDetail</a>(PsGetCurrentThreadId(), ProcessDebuggingDetails);</div>
<div class="line"><span class="lineno">  508</span> </div>
<div class="line"><span class="lineno">  509</span>    <span class="keywordflow">if</span> (!ThreadDebuggingDetails)</div>
<div class="line"><span class="lineno">  510</span>    {</div>
<div class="line"><span class="lineno">  511</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  512</span>        <span class="comment">// Sth went wrong!</span></div>
<div class="line"><span class="lineno">  513</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  514</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  515</span>    }</div>
<div class="line"><span class="lineno">  516</span> </div>
<div class="line"><span class="lineno">  517</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  518</span>    <span class="comment">// Set it as active thread debugging</span></div>
<div class="line"><span class="lineno">  519</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  520</span>    ProcessDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#ac7497bb7cd3585fdc424075cae9ff98c">ActiveThreadId</a> = ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a726606b3498458de98f6cb19e6873df0">ThreadId</a>;</div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  523</span>    <span class="comment">// Perform the pre-pausing tasks</span></div>
<div class="line"><span class="lineno">  524</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  525</span>    <a class="code hl_function" href="_ud_8c.html#a6b34356fa5078db5eceab1194735f60a">UdPrePausingReasons</a>(DbgState, ThreadDebuggingDetails, Reason, EventDetails);</div>
<div class="line"><span class="lineno">  526</span> </div>
<div class="line"><span class="lineno">  527</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  528</span>    <span class="comment">// *** Fill the pausing structure ***</span></div>
<div class="line"><span class="lineno">  529</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  530</span> </div>
<div class="line"><span class="lineno">  531</span>    RtlZeroMemory(&amp;PausePacket, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html">DEBUGGEE_UD_PAUSED_PACKET</a>));</div>
<div class="line"><span class="lineno">  532</span> </div>
<div class="line"><span class="lineno">  533</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  534</span>    <span class="comment">// Set the pausing reason</span></div>
<div class="line"><span class="lineno">  535</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  536</span>    PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a18f93b90e7be5065db4ca0acf4addfdf">PausingReason</a> = Reason;</div>
<div class="line"><span class="lineno">  537</span> </div>
<div class="line"><span class="lineno">  538</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  539</span>    <span class="comment">// Set process debugging information</span></div>
<div class="line"><span class="lineno">  540</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  541</span>    PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#af634ca2741eb2f229798a1f0fb65511d">ProcessId</a>             = PsGetCurrentProcessId();</div>
<div class="line"><span class="lineno">  542</span>    PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#aeff5c8c0b5217e3f98b3d37e408f6283">ThreadId</a>              = PsGetCurrentThreadId();</div>
<div class="line"><span class="lineno">  543</span>    PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a8241688f61ab475b180e4686f3685723">ProcessDebuggingToken</a> = ProcessDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aac3f928359d06bdd7572a4bd67c86429">Token</a>;</div>
<div class="line"><span class="lineno">  544</span> </div>
<div class="line"><span class="lineno">  545</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  546</span>    <span class="comment">// Set the RIP and mode of execution</span></div>
<div class="line"><span class="lineno">  547</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  548</span>    PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a3e56574a7c4011c34c087b31cbb75979">Rip</a>     = LastVmexitRip;</div>
<div class="line"><span class="lineno">  549</span>    PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a7ae9dfd624d3677a5aaf1c13cfb587d8">Is32Bit</a> = <a class="code hl_function" href="_kd_8c.html#a814437795a9e923d352b848630625a56">KdIsGuestOnUsermode32Bit</a>();</div>
<div class="line"><span class="lineno">  550</span> </div>
<div class="line"><span class="lineno">  551</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  552</span>    <span class="comment">// Set rflags for finding the results of conditional jumps</span></div>
<div class="line"><span class="lineno">  553</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  554</span>    Rflags.AsUInt      = <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a4b045128fd323df34d999096f06d23d1">VmFuncGetRflags</a>();</div>
<div class="line"><span class="lineno">  555</span>    PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#aea873749ec75709b18d9b89fb20fde78">Rflags</a> = Rflags.AsUInt;</div>
<div class="line"><span class="lineno">  556</span> </div>
<div class="line"><span class="lineno">  557</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  558</span>    <span class="comment">// Set the event tag (if it&#39;s an event)</span></div>
<div class="line"><span class="lineno">  559</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  560</span>    <span class="keywordflow">if</span> (EventDetails != NULL)</div>
<div class="line"><span class="lineno">  561</span>    {</div>
<div class="line"><span class="lineno">  562</span>        PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#abd4a87f9106cc80d3d2a35f418684b86">EventTag</a> = EventDetails-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html#a4eed19d8d35fa2c8378db39e95dd9ef2">Tag</a>;</div>
<div class="line"><span class="lineno">  563</span>    }</div>
<div class="line"><span class="lineno">  564</span> </div>
<div class="line"><span class="lineno">  565</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  566</span>    <span class="comment">// Read the instruction len</span></div>
<div class="line"><span class="lineno">  567</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  568</span>    <span class="keywordflow">if</span> (DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac0735b6e84ce3ae397f74cfd5b4eabb4">InstructionLengthHint</a> != 0)</div>
<div class="line"><span class="lineno">  569</span>    {</div>
<div class="line"><span class="lineno">  570</span>        ExitInstructionLength = DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac0735b6e84ce3ae397f74cfd5b4eabb4">InstructionLengthHint</a>;</div>
<div class="line"><span class="lineno">  571</span>    }</div>
<div class="line"><span class="lineno">  572</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  573</span>    {</div>
<div class="line"><span class="lineno">  574</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  575</span>        <span class="comment">// Reading instruction length (VMCS_VMEXIT_INSTRUCTION_LENGTH) proved to</span></div>
<div class="line"><span class="lineno">  576</span>        <span class="comment">// provide wrong results, so we won&#39;t use it</span></div>
<div class="line"><span class="lineno">  577</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  578</span> </div>
<div class="line"><span class="lineno">  579</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  580</span>        <span class="comment">// Compute the amount of buffer we can read without problem</span></div>
<div class="line"><span class="lineno">  581</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  582</span>        SizeOfSafeBufferToRead = LastVmexitRip &amp; 0xfff;</div>
<div class="line"><span class="lineno">  583</span>        SizeOfSafeBufferToRead += <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_constants_8h.html#abc19f528c1665033d9ac7f477a26c608">MAXIMUM_INSTR_SIZE</a>;</div>
<div class="line"><span class="lineno">  584</span> </div>
<div class="line"><span class="lineno">  585</span>        <span class="keywordflow">if</span> (SizeOfSafeBufferToRead &gt;= <a class="code hl_define" href="hprdbgctrl_2header_2common_8h.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a>)</div>
<div class="line"><span class="lineno">  586</span>        {</div>
<div class="line"><span class="lineno">  587</span>            SizeOfSafeBufferToRead = SizeOfSafeBufferToRead - <a class="code hl_define" href="hprdbgctrl_2header_2common_8h.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a>;</div>
<div class="line"><span class="lineno">  588</span>            SizeOfSafeBufferToRead = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_constants_8h.html#abc19f528c1665033d9ac7f477a26c608">MAXIMUM_INSTR_SIZE</a> - SizeOfSafeBufferToRead;</div>
<div class="line"><span class="lineno">  589</span>        }</div>
<div class="line"><span class="lineno">  590</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  591</span>        {</div>
<div class="line"><span class="lineno">  592</span>            SizeOfSafeBufferToRead = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_constants_8h.html#abc19f528c1665033d9ac7f477a26c608">MAXIMUM_INSTR_SIZE</a>;</div>
<div class="line"><span class="lineno">  593</span>        }</div>
<div class="line"><span class="lineno">  594</span> </div>
<div class="line"><span class="lineno">  595</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  596</span>        <span class="comment">// Set the length to notify debuggee</span></div>
<div class="line"><span class="lineno">  597</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  598</span>        ExitInstructionLength = SizeOfSafeBufferToRead;</div>
<div class="line"><span class="lineno">  599</span>    }</div>
<div class="line"><span class="lineno">  600</span> </div>
<div class="line"><span class="lineno">  601</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  602</span>    <span class="comment">// Set the reading length of bytes (for instruction disassembling)</span></div>
<div class="line"><span class="lineno">  603</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  604</span>    PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a2193543107e5c824870e3c027403db13">ReadInstructionLen</a> = ExitInstructionLength;</div>
<div class="line"><span class="lineno">  605</span> </div>
<div class="line"><span class="lineno">  606</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  607</span>    <span class="comment">// Find the current instruction</span></div>
<div class="line"><span class="lineno">  608</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  609</span>    <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#adce5c38c4030404a4cb1163a59fbcbb5">MemoryMapperReadMemorySafeOnTargetProcess</a>(LastVmexitRip,</div>
<div class="line"><span class="lineno">  610</span>                                              &amp;PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#adeb0d6f9464069094f3c730b848375cd">InstructionBytesOnRip</a>,</div>
<div class="line"><span class="lineno">  611</span>                                              ExitInstructionLength);</div>
<div class="line"><span class="lineno">  612</span> </div>
<div class="line"><span class="lineno">  613</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  614</span>    <span class="comment">// Copy registers to the pause packet</span></div>
<div class="line"><span class="lineno">  615</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  616</span>    RtlCopyMemory(&amp;PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a0145af02a2814d6a0272b961169d0356">GuestRegs</a>, DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a03193009392aadd7037d6d0ce743efd4">Regs</a>, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct_g_u_e_s_t___r_e_g_s.html">GUEST_REGS</a>));</div>
<div class="line"><span class="lineno">  617</span> </div>
<div class="line"><span class="lineno">  618</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  619</span>    <span class="comment">// Send the pause packet, along with RIP and an indication</span></div>
<div class="line"><span class="lineno">  620</span>    <span class="comment">// to pause to the user debugger</span></div>
<div class="line"><span class="lineno">  621</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  622</span>    <a class="code hl_function" href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_hyper_log_imports_8h.html#a04ba594e4260fe2d4e321c33b0e896d5">LogCallbackSendBuffer</a>(<a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_constants_8h.html#a7d47482024b99d93c486dabbdbfca6d2">OPERATION_NOTIFICATION_FROM_USER_DEBUGGER_PAUSE</a>,</div>
<div class="line"><span class="lineno">  623</span>                          &amp;PausePacket,</div>
<div class="line"><span class="lineno">  624</span>                          <span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html">DEBUGGEE_UD_PAUSED_PACKET</a>),</div>
<div class="line"><span class="lineno">  625</span>                          <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><span class="lineno">  626</span> </div>
<div class="line"><span class="lineno">  627</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  628</span>    <span class="comment">// Halt the thread on nop sleds</span></div>
<div class="line"><span class="lineno">  629</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  630</span>    <a class="code hl_function" href="_ud_8c.html#a382dd16eb179d5548591aa4468ffbc05">UdSpinThreadOnNop</a>(ThreadDebuggingDetails, ProcessDebuggingDetails);</div>
<div class="line"><span class="lineno">  631</span> </div>
<div class="line"><span class="lineno">  632</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  633</span>    <span class="comment">// Everything was okay</span></div>
<div class="line"><span class="lineno">  634</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  635</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  636</span>}</div>
<div class="ttc" id="a_attaching_8c_html_a733d0f343ddcccaeec221bbbb20483c7"><div class="ttname"><a href="_attaching_8c.html#a733d0f343ddcccaeec221bbbb20483c7">AttachingFindProcessDebuggingDetailsByProcessId</a></div><div class="ttdeci">PUSERMODE_DEBUGGING_PROCESS_DETAILS AttachingFindProcessDebuggingDetailsByProcessId(UINT32 ProcessId)</div><div class="ttdoc">Find user-mode debugging details for threads by process Id.</div><div class="ttdef"><b>Definition:</b> Attaching.c:187</div></div>
<div class="ttc" id="a_kd_8c_html_a814437795a9e923d352b848630625a56"><div class="ttname"><a href="_kd_8c.html#a814437795a9e923d352b848630625a56">KdIsGuestOnUsermode32Bit</a></div><div class="ttdeci">BOOLEAN KdIsGuestOnUsermode32Bit()</div><div class="ttdoc">determines if the guest was in 32-bit user-mode or 64-bit (long mode)</div><div class="ttdef"><b>Definition:</b> Kd.c:2571</div></div>
<div class="ttc" id="a_thread_holder_8c_html_ac752176641e6314d84738f2f323cec68"><div class="ttname"><a href="_thread_holder_8c.html#ac752176641e6314d84738f2f323cec68">ThreadHolderFindOrCreateThreadDebuggingDetail</a></div><div class="ttdeci">PUSERMODE_DEBUGGING_THREAD_DETAILS ThreadHolderFindOrCreateThreadDebuggingDetail(UINT32 ThreadId, PUSERMODE_DEBUGGING_PROCESS_DETAILS ProcessDebuggingDetail)</div><div class="ttdoc">Find or create user-mode debugging details for threads.</div><div class="ttdef"><b>Definition:</b> ThreadHolder.c:257</div></div>
<div class="ttc" id="a_ud_8c_html_a382dd16eb179d5548591aa4468ffbc05"><div class="ttname"><a href="_ud_8c.html#a382dd16eb179d5548591aa4468ffbc05">UdSpinThreadOnNop</a></div><div class="ttdeci">VOID UdSpinThreadOnNop(PUSERMODE_DEBUGGING_THREAD_DETAILS ThreadDebuggingDetails, PUSERMODE_DEBUGGING_PROCESS_DETAILS ProcessDebuggingDetails)</div><div class="ttdoc">Spin on nop sled in user-mode to halt the debuggee.</div><div class="ttdef"><b>Definition:</b> Ud.c:376</div></div>
<div class="ttc" id="a_ud_8c_html_a6b34356fa5078db5eceab1194735f60a"><div class="ttname"><a href="_ud_8c.html#a6b34356fa5078db5eceab1194735f60a">UdPrePausingReasons</a></div><div class="ttdeci">VOID UdPrePausingReasons(PROCESSOR_DEBUGGING_STATE *DbgState, PUSERMODE_DEBUGGING_THREAD_DETAILS ThreadDebuggingDetails, DEBUGGEE_PAUSING_REASON Reason, PDEBUGGER_TRIGGERED_EVENT_DETAILS EventDetails)</div><div class="ttdoc">Handle special reasons pre-pausings.</div><div class="ttdef"><b>Definition:</b> Ud.c:435</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:50</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:49</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h_html_aae17ebb9ef7279d026817fb22f8aebe9"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></div><div class="ttdeci">unsigned __int64 UINT64</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:19</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h_html_af632da489ebc3708ec3ab6791ee53fa4"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a></div><div class="ttdeci">unsigned long ULONG</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:35</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_constants_8h_html_a7d47482024b99d93c486dabbdbfca6d2"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_constants_8h.html#a7d47482024b99d93c486dabbdbfca6d2">OPERATION_NOTIFICATION_FROM_USER_DEBUGGER_PAUSE</a></div><div class="ttdeci">#define OPERATION_NOTIFICATION_FROM_USER_DEBUGGER_PAUSE</div><div class="ttdef"><b>Definition:</b> Constants.h:356</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_constants_8h_html_abc19f528c1665033d9ac7f477a26c608"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_constants_8h.html#abc19f528c1665033d9ac7f477a26c608">MAXIMUM_INSTR_SIZE</a></div><div class="ttdeci">#define MAXIMUM_INSTR_SIZE</div><div class="ttdoc">maximum instruction size in Intel</div><div class="ttdef"><b>Definition:</b> Constants.h:428</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_hyper_log_imports_8h_html_a04ba594e4260fe2d4e321c33b0e896d5"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_hyper_log_imports_8h.html#a04ba594e4260fe2d4e321c33b0e896d5">LogCallbackSendBuffer</a></div><div class="ttdeci">IMPORT_EXPORT_HYPERLOG BOOLEAN LogCallbackSendBuffer(_In_ UINT32 OperationCode, _In_reads_bytes_(BufferLength) PVOID Buffer, _In_ UINT32 BufferLength, _In_ BOOLEAN Priority)</div><div class="ttdoc">routines callback for sending buffer</div><div class="ttdef"><b>Definition:</b> Callback.c:102</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_a4b045128fd323df34d999096f06d23d1"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a4b045128fd323df34d999096f06d23d1">VmFuncGetRflags</a></div><div class="ttdeci">IMPORT_EXPORT_VMM UINT64 VmFuncGetRflags()</div><div class="ttdoc">Read guest's RFLAGS.</div><div class="ttdef"><b>Definition:</b> Export.c:340</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_a6bb41b474360ecdcb3ed9900aa17e008"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#a6bb41b474360ecdcb3ed9900aa17e008">VmFuncVmxGetCurrentExecutionMode</a></div><div class="ttdeci">IMPORT_EXPORT_VMM BOOLEAN VmFuncVmxGetCurrentExecutionMode()</div><div class="ttdoc">Get the current vmx opeation state.</div><div class="ttdef"><b>Definition:</b> Export.c:484</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_ad3bf3809af7905836fde46ee81e86cc7"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#ad3bf3809af7905836fde46ee81e86cc7">VmFuncGetLastVmexitRip</a></div><div class="ttdeci">IMPORT_EXPORT_VMM UINT64 VmFuncGetLastVmexitRip(UINT32 CoreId)</div><div class="ttdoc">get the last vm-exit RIP</div><div class="ttdef"><b>Definition:</b> Export.c:306</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h_html_adce5c38c4030404a4cb1163a59fbcbb5"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_imports_2_hyper_dbg_vmm_imports_8h.html#adce5c38c4030404a4cb1163a59fbcbb5">MemoryMapperReadMemorySafeOnTargetProcess</a></div><div class="ttdeci">IMPORT_EXPORT_VMM BOOLEAN MemoryMapperReadMemorySafeOnTargetProcess(_In_ UINT64 VaAddressToRead, _Inout_ PVOID BufferToSaveMemory, _In_ SIZE_T SizeToRead)</div></div>
<div class="ttc" id="ahprdbgctrl_2header_2common_8h_html_a7d467c1d283fdfa1f2081ba1e0d01b6e"><div class="ttname"><a href="hprdbgctrl_2header_2common_8h.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a></div><div class="ttdeci">#define PAGE_SIZE</div><div class="ttdoc">Size of each page (4096 bytes)</div><div class="ttdef"><b>Definition:</b> common.h:59</div></div>
<div class="ttc" id="ahprdbgkd_2header_2globals_2_global_8h_html_ae304ded1a8cbb4e772d97aec7510c9d2"><div class="ttname"><a href="hprdbgkd_2header_2globals_2_global_8h.html#ae304ded1a8cbb4e772d97aec7510c9d2">g_UserDebuggerState</a></div><div class="ttdeci">BOOLEAN g_UserDebuggerState</div><div class="ttdoc">shows whether the user debugger is enabled or disabled</div><div class="ttdef"><b>Definition:</b> Global.h:103</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html">_DEBUGGEE_UD_PAUSED_PACKET</a></div><div class="ttdoc">The structure of pausing packet in uHyperDbg.</div><div class="ttdef"><b>Definition:</b> DataTypes.h:177</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_a0145af02a2814d6a0272b961169d0356"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a0145af02a2814d6a0272b961169d0356">_DEBUGGEE_UD_PAUSED_PACKET::GuestRegs</a></div><div class="ttdeci">GUEST_REGS GuestRegs</div><div class="ttdef"><b>Definition:</b> DataTypes.h:188</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_a18f93b90e7be5065db4ca0acf4addfdf"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a18f93b90e7be5065db4ca0acf4addfdf">_DEBUGGEE_UD_PAUSED_PACKET::PausingReason</a></div><div class="ttdeci">DEBUGGEE_PAUSING_REASON PausingReason</div><div class="ttdef"><b>Definition:</b> DataTypes.h:181</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_a2193543107e5c824870e3c027403db13"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a2193543107e5c824870e3c027403db13">_DEBUGGEE_UD_PAUSED_PACKET::ReadInstructionLen</a></div><div class="ttdeci">UINT16 ReadInstructionLen</div><div class="ttdef"><b>Definition:</b> DataTypes.h:187</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_a3e56574a7c4011c34c087b31cbb75979"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a3e56574a7c4011c34c087b31cbb75979">_DEBUGGEE_UD_PAUSED_PACKET::Rip</a></div><div class="ttdeci">UINT64 Rip</div><div class="ttdef"><b>Definition:</b> DataTypes.h:178</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_a7ae9dfd624d3677a5aaf1c13cfb587d8"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a7ae9dfd624d3677a5aaf1c13cfb587d8">_DEBUGGEE_UD_PAUSED_PACKET::Is32Bit</a></div><div class="ttdeci">BOOLEAN Is32Bit</div><div class="ttdef"><b>Definition:</b> DataTypes.h:180</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_a8241688f61ab475b180e4686f3685723"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a8241688f61ab475b180e4686f3685723">_DEBUGGEE_UD_PAUSED_PACKET::ProcessDebuggingToken</a></div><div class="ttdeci">UINT64 ProcessDebuggingToken</div><div class="ttdef"><b>Definition:</b> DataTypes.h:179</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_abd4a87f9106cc80d3d2a35f418684b86"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#abd4a87f9106cc80d3d2a35f418684b86">_DEBUGGEE_UD_PAUSED_PACKET::EventTag</a></div><div class="ttdeci">UINT64 EventTag</div><div class="ttdef"><b>Definition:</b> DataTypes.h:184</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_adeb0d6f9464069094f3c730b848375cd"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#adeb0d6f9464069094f3c730b848375cd">_DEBUGGEE_UD_PAUSED_PACKET::InstructionBytesOnRip</a></div><div class="ttdeci">BYTE InstructionBytesOnRip[MAXIMUM_INSTR_SIZE]</div><div class="ttdef"><b>Definition:</b> DataTypes.h:186</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_aea873749ec75709b18d9b89fb20fde78"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#aea873749ec75709b18d9b89fb20fde78">_DEBUGGEE_UD_PAUSED_PACKET::Rflags</a></div><div class="ttdeci">UINT64 Rflags</div><div class="ttdef"><b>Definition:</b> DataTypes.h:185</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_aeff5c8c0b5217e3f98b3d37e408f6283"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#aeff5c8c0b5217e3f98b3d37e408f6283">_DEBUGGEE_UD_PAUSED_PACKET::ThreadId</a></div><div class="ttdeci">UINT32 ThreadId</div><div class="ttdef"><b>Definition:</b> DataTypes.h:183</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_af634ca2741eb2f229798a1f0fb65511d"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#af634ca2741eb2f229798a1f0fb65511d">_DEBUGGEE_UD_PAUSED_PACKET::ProcessId</a></div><div class="ttdeci">UINT32 ProcessId</div><div class="ttdef"><b>Definition:</b> DataTypes.h:182</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s_html_a4eed19d8d35fa2c8378db39e95dd9ef2"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html#a4eed19d8d35fa2c8378db39e95dd9ef2">_DEBUGGER_TRIGGERED_EVENT_DETAILS::Tag</a></div><div class="ttdeci">UINT64 Tag</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:115</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html_a03193009392aadd7037d6d0ce743efd4"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a03193009392aadd7037d6d0ce743efd4">_PROCESSOR_DEBUGGING_STATE::Regs</a></div><div class="ttdeci">GUEST_REGS * Regs</div><div class="ttdef"><b>Definition:</b> State.h:109</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html_a090832a74d330cde891a17bdd5b236e3"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">_PROCESSOR_DEBUGGING_STATE::CoreId</a></div><div class="ttdeci">UINT32 CoreId</div><div class="ttdef"><b>Definition:</b> State.h:110</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html_ac0735b6e84ce3ae397f74cfd5b4eabb4"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac0735b6e84ce3ae397f74cfd5b4eabb4">_PROCESSOR_DEBUGGING_STATE::InstructionLengthHint</a></div><div class="ttdeci">UINT16 InstructionLengthHint</div><div class="ttdef"><b>Definition:</b> State.h:121</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s_html"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html">_USERMODE_DEBUGGING_PROCESS_DETAILS</a></div><div class="ttdoc">Description of each active thread in user-mode attaching mechanism.</div><div class="ttdef"><b>Definition:</b> Attaching.h:49</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s_html_aac3f928359d06bdd7572a4bd67c86429"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aac3f928359d06bdd7572a4bd67c86429">_USERMODE_DEBUGGING_PROCESS_DETAILS::Token</a></div><div class="ttdeci">UINT64 Token</div><div class="ttdef"><b>Definition:</b> Attaching.h:50</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s_html_ac7497bb7cd3585fdc424075cae9ff98c"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#ac7497bb7cd3585fdc424075cae9ff98c">_USERMODE_DEBUGGING_PROCESS_DETAILS::ActiveThreadId</a></div><div class="ttdeci">UINT32 ActiveThreadId</div><div class="ttdef"><b>Definition:</b> Attaching.h:53</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s_html"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html">_USERMODE_DEBUGGING_THREAD_DETAILS</a></div><div class="ttdoc">Details of each thread in process.</div><div class="ttdef"><b>Definition:</b> ThreadHolder.h:33</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s_html_a726606b3498458de98f6cb19e6873df0"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a726606b3498458de98f6cb19e6873df0">_USERMODE_DEBUGGING_THREAD_DETAILS::ThreadId</a></div><div class="ttdeci">UINT32 ThreadId</div><div class="ttdef"><b>Definition:</b> ThreadHolder.h:34</div></div>
<div class="ttc" id="astruct_g_u_e_s_t___r_e_g_s_html"><div class="ttname"><a href="struct_g_u_e_s_t___r_e_g_s.html">GUEST_REGS</a></div><div class="ttdef"><b>Definition:</b> BasicTypes.h:65</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afe8e59191c78460477ae89d3e9daf751" name="afe8e59191c78460477ae89d3e9daf751"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe8e59191c78460477ae89d3e9daf751">&#9670;&#160;</a></span>UdCheckForCommand()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> UdCheckForCommand </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check for the user-mode commands. </p>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  255</span>{</div>
<div class="line"><span class="lineno">  256</span>    <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html">PUSERMODE_DEBUGGING_THREAD_DETAILS</a> ThreadDebuggingDetails;</div>
<div class="line"><span class="lineno">  257</span> </div>
<div class="line"><span class="lineno">  258</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  259</span>    <span class="comment">// Check if user-debugger is initialized or not</span></div>
<div class="line"><span class="lineno">  260</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  261</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="hprdbgkd_2header_2globals_2_global_8h.html#ae304ded1a8cbb4e772d97aec7510c9d2">g_UserDebuggerState</a>)</div>
<div class="line"><span class="lineno">  262</span>    {</div>
<div class="line"><span class="lineno">  263</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  264</span>    }</div>
<div class="line"><span class="lineno">  265</span> </div>
<div class="line"><span class="lineno">  266</span>    ThreadDebuggingDetails = <a class="code hl_function" href="_thread_holder_8c.html#aae54fde00233fd8e30b197ab1a64a555">ThreadHolderGetProcessThreadDetailsByProcessIdAndThreadId</a>(PsGetCurrentProcessId(),</div>
<div class="line"><span class="lineno">  267</span>                                                                                       PsGetCurrentThreadId());</div>
<div class="line"><span class="lineno">  268</span> </div>
<div class="line"><span class="lineno">  269</span>    <span class="keywordflow">if</span> (!ThreadDebuggingDetails)</div>
<div class="line"><span class="lineno">  270</span>    {</div>
<div class="line"><span class="lineno">  271</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  272</span>    }</div>
<div class="line"><span class="lineno">  273</span> </div>
<div class="line"><span class="lineno">  274</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  275</span>    <span class="comment">// If we reached here, the current thread is in debugger attached mechanism</span></div>
<div class="line"><span class="lineno">  276</span>    <span class="comment">// now we check whether it&#39;s a regular CPUID or a debugger paused thread CPUID</span></div>
<div class="line"><span class="lineno">  277</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  278</span>    <span class="keywordflow">if</span> (!ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#afcd7f63e2118dbfefdac3e7c79fda7fc">IsPaused</a>)</div>
<div class="line"><span class="lineno">  279</span>    {</div>
<div class="line"><span class="lineno">  280</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  281</span>    }</div>
<div class="line"><span class="lineno">  282</span> </div>
<div class="line"><span class="lineno">  283</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  284</span>    <span class="comment">// Here, we&#39;re sure that this thread is looking for command, let</span></div>
<div class="line"><span class="lineno">  285</span>    <span class="comment">// see if we find anything</span></div>
<div class="line"><span class="lineno">  286</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  287</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_define" href="_attaching_8h.html#a71a7b969b4769247f9e1c54276f6514f">MAX_USER_ACTIONS_FOR_THREADS</a>; i++)</div>
<div class="line"><span class="lineno">  288</span>    {</div>
<div class="line"><span class="lineno">  289</span>        <span class="keywordflow">if</span> (ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a0342fbe7f03915834f74d7154874145f">ActionType</a> != <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#ad87c3f70d0c62885d9fa07518b5802a1a8d10bc5059f14f2b3d00d7d6edb4182a">DEBUGGER_UD_COMMAND_ACTION_TYPE_NONE</a>)</div>
<div class="line"><span class="lineno">  290</span>        {</div>
<div class="line"><span class="lineno">  291</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  292</span>            <span class="comment">// Perform the command</span></div>
<div class="line"><span class="lineno">  293</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  294</span>            <a class="code hl_function" href="_ud_8c.html#a1952ae25243278fc748ce38a16183410">UdPerformCommand</a>(ThreadDebuggingDetails,</div>
<div class="line"><span class="lineno">  295</span>                             ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a0342fbe7f03915834f74d7154874145f">ActionType</a>,</div>
<div class="line"><span class="lineno">  296</span>                             ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a479258f824cfd17a0f610d9bcefce1a1">OptionalParam1</a>,</div>
<div class="line"><span class="lineno">  297</span>                             ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#ad76de86942302644cd6c27e446bb9b4a">OptionalParam2</a>,</div>
<div class="line"><span class="lineno">  298</span>                             ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a5bd4a1a8d6a407cf98eb4f84597fa233">OptionalParam3</a>,</div>
<div class="line"><span class="lineno">  299</span>                             ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a5e2412025f8524952d364840ba658829">OptionalParam4</a>);</div>
<div class="line"><span class="lineno">  300</span> </div>
<div class="line"><span class="lineno">  301</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  302</span>            <span class="comment">// Remove the command</span></div>
<div class="line"><span class="lineno">  303</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  304</span>            ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a479258f824cfd17a0f610d9bcefce1a1">OptionalParam1</a> = NULL;</div>
<div class="line"><span class="lineno">  305</span>            ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#ad76de86942302644cd6c27e446bb9b4a">OptionalParam2</a> = NULL;</div>
<div class="line"><span class="lineno">  306</span>            ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a5bd4a1a8d6a407cf98eb4f84597fa233">OptionalParam3</a> = NULL;</div>
<div class="line"><span class="lineno">  307</span>            ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a5e2412025f8524952d364840ba658829">OptionalParam4</a> = NULL;</div>
<div class="line"><span class="lineno">  308</span> </div>
<div class="line"><span class="lineno">  309</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  310</span>            <span class="comment">// At last disable it</span></div>
<div class="line"><span class="lineno">  311</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  312</span>            ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a0342fbe7f03915834f74d7154874145f">ActionType</a> = <a class="code hl_enumvalue" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#ad87c3f70d0c62885d9fa07518b5802a1a8d10bc5059f14f2b3d00d7d6edb4182a">DEBUGGER_UD_COMMAND_ACTION_TYPE_NONE</a>;</div>
<div class="line"><span class="lineno">  313</span> </div>
<div class="line"><span class="lineno">  314</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  315</span>            <span class="comment">// only one command at a time</span></div>
<div class="line"><span class="lineno">  316</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  317</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  318</span>        }</div>
<div class="line"><span class="lineno">  319</span>    }</div>
<div class="line"><span class="lineno">  320</span> </div>
<div class="line"><span class="lineno">  321</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  322</span>    <span class="comment">// Won&#39;t change the registers for cpuid</span></div>
<div class="line"><span class="lineno">  323</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  324</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  325</span>}</div>
<div class="ttc" id="a_attaching_8h_html_a71a7b969b4769247f9e1c54276f6514f"><div class="ttname"><a href="_attaching_8h.html#a71a7b969b4769247f9e1c54276f6514f">MAX_USER_ACTIONS_FOR_THREADS</a></div><div class="ttdeci">#define MAX_USER_ACTIONS_FOR_THREADS</div><div class="ttdoc">Maximum actions in paused threads storage.</div><div class="ttdef"><b>Definition:</b> Attaching.h:22</div></div>
<div class="ttc" id="a_thread_holder_8c_html_aae54fde00233fd8e30b197ab1a64a555"><div class="ttname"><a href="_thread_holder_8c.html#aae54fde00233fd8e30b197ab1a64a555">ThreadHolderGetProcessThreadDetailsByProcessIdAndThreadId</a></div><div class="ttdeci">PUSERMODE_DEBUGGING_THREAD_DETAILS ThreadHolderGetProcessThreadDetailsByProcessIdAndThreadId(UINT32 ProcessId, UINT32 ThreadId)</div><div class="ttdoc">Find the active threads of the process from process id.</div><div class="ttdef"><b>Definition:</b> ThreadHolder.c:109</div></div>
<div class="ttc" id="a_ud_8c_html_a1952ae25243278fc748ce38a16183410"><div class="ttname"><a href="_ud_8c.html#a1952ae25243278fc748ce38a16183410">UdPerformCommand</a></div><div class="ttdeci">BOOLEAN UdPerformCommand(PUSERMODE_DEBUGGING_THREAD_DETAILS ThreadDebuggingDetails, DEBUGGER_UD_COMMAND_ACTION_TYPE UserAction, UINT64 OptionalParam1, UINT64 OptionalParam2, UINT64 OptionalParam3, UINT64 OptionalParam4)</div><div class="ttdoc">Perform the user-mode commands.</div><div class="ttdef"><b>Definition:</b> Ud.c:206</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h_html_ad87c3f70d0c62885d9fa07518b5802a1a8d10bc5059f14f2b3d00d7d6edb4182a"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#ad87c3f70d0c62885d9fa07518b5802a1a8d10bc5059f14f2b3d00d7d6edb4182a">DEBUGGER_UD_COMMAND_ACTION_TYPE_NONE</a></div><div class="ttdeci">@ DEBUGGER_UD_COMMAND_ACTION_TYPE_NONE</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:818</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n_html_a0342fbe7f03915834f74d7154874145f"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a0342fbe7f03915834f74d7154874145f">_DEBUGGER_UD_COMMAND_ACTION::ActionType</a></div><div class="ttdeci">DEBUGGER_UD_COMMAND_ACTION_TYPE ActionType</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:831</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n_html_a479258f824cfd17a0f610d9bcefce1a1"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a479258f824cfd17a0f610d9bcefce1a1">_DEBUGGER_UD_COMMAND_ACTION::OptionalParam1</a></div><div class="ttdeci">UINT64 OptionalParam1</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:832</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n_html_a5bd4a1a8d6a407cf98eb4f84597fa233"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a5bd4a1a8d6a407cf98eb4f84597fa233">_DEBUGGER_UD_COMMAND_ACTION::OptionalParam3</a></div><div class="ttdeci">UINT64 OptionalParam3</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:834</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n_html_a5e2412025f8524952d364840ba658829"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a5e2412025f8524952d364840ba658829">_DEBUGGER_UD_COMMAND_ACTION::OptionalParam4</a></div><div class="ttdeci">UINT64 OptionalParam4</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:835</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n_html_ad76de86942302644cd6c27e446bb9b4a"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#ad76de86942302644cd6c27e446bb9b4a">_DEBUGGER_UD_COMMAND_ACTION::OptionalParam2</a></div><div class="ttdeci">UINT64 OptionalParam2</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:833</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s_html_a9b52613ecdffc1e60ac1ca9e956d1416"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">_USERMODE_DEBUGGING_THREAD_DETAILS::UdAction</a></div><div class="ttdeci">DEBUGGER_UD_COMMAND_ACTION UdAction[MAX_USER_ACTIONS_FOR_THREADS]</div><div class="ttdef"><b>Definition:</b> ThreadHolder.h:38</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s_html_afcd7f63e2118dbfefdac3e7c79fda7fc"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#afcd7f63e2118dbfefdac3e7c79fda7fc">_USERMODE_DEBUGGING_THREAD_DETAILS::IsPaused</a></div><div class="ttdeci">BOOLEAN IsPaused</div><div class="ttdef"><b>Definition:</b> ThreadHolder.h:36</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a56a511f72fa77e4eadf393c2e0d6dc8f" name="a56a511f72fa77e4eadf393c2e0d6dc8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56a511f72fa77e4eadf393c2e0d6dc8f">&#9670;&#160;</a></span>UdDispatchUsermodeCommands()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> UdDispatchUsermodeCommands </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_request_structures_8h.html#a510b3c0106ca6b73316f747e1557baef">PDEBUGGER_UD_COMMAND_PACKET</a>&#160;</td>
          <td class="paramname"><em>ActionRequest</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dispatch the user-mode commands. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ActionRequest</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  335</span>{</div>
<div class="line"><span class="lineno">  336</span>    <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html">PUSERMODE_DEBUGGING_PROCESS_DETAILS</a> ProcessDebuggingDetails;</div>
<div class="line"><span class="lineno">  337</span> </div>
<div class="line"><span class="lineno">  338</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  339</span>    <span class="comment">// Find the thread debugging detail of the thread</span></div>
<div class="line"><span class="lineno">  340</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  341</span>    ProcessDebuggingDetails = <a class="code hl_function" href="_attaching_8c.html#ab826f65586e0a294b97e505c6affe8b5">AttachingFindProcessDebuggingDetailsByToken</a>(ActionRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___p_a_c_k_e_t.html#ae384ab33099a5fc4d9d5b3b597ae1b39">ProcessDebuggingDetailToken</a>);</div>
<div class="line"><span class="lineno">  342</span> </div>
<div class="line"><span class="lineno">  343</span>    <span class="keywordflow">if</span> (!ProcessDebuggingDetails)</div>
<div class="line"><span class="lineno">  344</span>    {</div>
<div class="line"><span class="lineno">  345</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  346</span>        <span class="comment">// Token not found!</span></div>
<div class="line"><span class="lineno">  347</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  348</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  349</span>    }</div>
<div class="line"><span class="lineno">  350</span> </div>
<div class="line"><span class="lineno">  351</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  352</span>    <span class="comment">// Based on the documentation, HyperDbg stops intercepting threads</span></div>
<div class="line"><span class="lineno">  353</span>    <span class="comment">// when the debugger sent the first command, but if user presses</span></div>
<div class="line"><span class="lineno">  354</span>    <span class="comment">// CTRL+C again, all the threads (or new threads) that will enter</span></div>
<div class="line"><span class="lineno">  355</span>    <span class="comment">// the user-mode will be intercepted</span></div>
<div class="line"><span class="lineno">  356</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  357</span>    <span class="keywordflow">if</span> (ProcessDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#ad3d6574cef84c00d549493d88c62e68f">IsOnThreadInterceptingPhase</a>)</div>
<div class="line"><span class="lineno">  358</span>    {</div>
<div class="line"><span class="lineno">  359</span>        <a class="code hl_function" href="_attaching_8c.html#a7f67611f7474cb9199c0b941fcf82a85">AttachingConfigureInterceptingThreads</a>(ProcessDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aac3f928359d06bdd7572a4bd67c86429">Token</a>, <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><span class="lineno">  360</span>    }</div>
<div class="line"><span class="lineno">  361</span> </div>
<div class="line"><span class="lineno">  362</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  363</span>    <span class="comment">// Apply the command to all threads or just one thread</span></div>
<div class="line"><span class="lineno">  364</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  365</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="_thread_holder_8c.html#a090fda3da0d1eaee5abdaf2fe8d6079c">ThreadHolderApplyActionToPausedThreads</a>(ProcessDebuggingDetails, ActionRequest);</div>
<div class="line"><span class="lineno">  366</span>}</div>
<div class="ttc" id="a_attaching_8c_html_a7f67611f7474cb9199c0b941fcf82a85"><div class="ttname"><a href="_attaching_8c.html#a7f67611f7474cb9199c0b941fcf82a85">AttachingConfigureInterceptingThreads</a></div><div class="ttdeci">BOOLEAN AttachingConfigureInterceptingThreads(UINT64 ProcessDebuggingToken, BOOLEAN Enable)</div><div class="ttdoc">Enable or disable the thread intercepting phase.</div><div class="ttdef"><b>Definition:</b> Attaching.c:634</div></div>
<div class="ttc" id="a_attaching_8c_html_ab826f65586e0a294b97e505c6affe8b5"><div class="ttname"><a href="_attaching_8c.html#ab826f65586e0a294b97e505c6affe8b5">AttachingFindProcessDebuggingDetailsByToken</a></div><div class="ttdeci">PUSERMODE_DEBUGGING_PROCESS_DETAILS AttachingFindProcessDebuggingDetailsByToken(UINT64 Token)</div><div class="ttdoc">Find user-mode debugging details for threads by token.</div><div class="ttdef"><b>Definition:</b> Attaching.c:164</div></div>
<div class="ttc" id="a_thread_holder_8c_html_a090fda3da0d1eaee5abdaf2fe8d6079c"><div class="ttname"><a href="_thread_holder_8c.html#a090fda3da0d1eaee5abdaf2fe8d6079c">ThreadHolderApplyActionToPausedThreads</a></div><div class="ttdeci">BOOLEAN ThreadHolderApplyActionToPausedThreads(PUSERMODE_DEBUGGING_PROCESS_DETAILS ProcessDebuggingDetails, PDEBUGGER_UD_COMMAND_PACKET ActionRequest)</div><div class="ttdoc">Apply the action of the user debugger to a specific thread or all threads.</div><div class="ttdef"><b>Definition:</b> ThreadHolder.c:364</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___p_a_c_k_e_t_html_ae384ab33099a5fc4d9d5b3b597ae1b39"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___p_a_c_k_e_t.html#ae384ab33099a5fc4d9d5b3b597ae1b39">_DEBUGGER_UD_COMMAND_PACKET::ProcessDebuggingDetailToken</a></div><div class="ttdeci">UINT64 ProcessDebuggingDetailToken</div><div class="ttdef"><b>Definition:</b> RequestStructures.h:846</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s_html_ad3d6574cef84c00d549493d88c62e68f"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#ad3d6574cef84c00d549493d88c62e68f">_USERMODE_DEBUGGING_PROCESS_DETAILS::IsOnThreadInterceptingPhase</a></div><div class="ttdeci">BOOLEAN IsOnThreadInterceptingPhase</div><div class="ttdef"><b>Definition:</b> Attaching.h:64</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a86574ff4fedfd90b7552bf5d4f8d66a2" name="a86574ff4fedfd90b7552bf5d4f8d66a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86574ff4fedfd90b7552bf5d4f8d66a2">&#9670;&#160;</a></span>UdInitializeUserDebugger()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> UdInitializeUserDebugger </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the user debugger in user mode. </p>
<dl class="section return"><dt>Returns</dt><dd>VOID</dd></dl>
<p>Initialize the user debugger in user mode.</p>
<p>this function should be called on vmx non-root</p>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   30</span>{</div>
<div class="line"><span class="lineno">   31</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="ud_8cpp.html#a5f11dde5b4669d77996f8ae794368127">g_IsUserDebuggerInitialized</a>)</div>
<div class="line"><span class="lineno">   32</span>    {</div>
<div class="line"><span class="lineno">   33</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   34</span>        <span class="comment">// Initialize the handle table</span></div>
<div class="line"><span class="lineno">   35</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   36</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_define" href="hprdbgctrl_2header_2debugger_8h.html#ab2d93302f6217632bfff37d358773953">DEBUGGER_MAXIMUM_SYNCRONIZATION_USER_DEBUGGER_OBJECTS</a>; i++)</div>
<div class="line"><span class="lineno">   37</span>        {</div>
<div class="line"><span class="lineno">   38</span>            <a class="code hl_variable" href="ud_8cpp.html#a36113a502dd15e3863d6c08981f80d7d">g_UserSyncronizationObjectsHandleTable</a>[i].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_y_n_c_r_o_n_i_z_a_t_i_o_n___e_v_e_n_t_s___s_t_a_t_e.html#aef7053cd3be5d917524afa71fdc24e48">IsOnWaitingState</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">   39</span>            <a class="code hl_variable" href="ud_8cpp.html#a36113a502dd15e3863d6c08981f80d7d">g_UserSyncronizationObjectsHandleTable</a>[i].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_y_n_c_r_o_n_i_z_a_t_i_o_n___e_v_e_n_t_s___s_t_a_t_e.html#ab845e27caa4c157798721890a5a854de">EventHandle</a>      = CreateEvent(NULL, <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, NULL);</div>
<div class="line"><span class="lineno">   40</span>        }</div>
<div class="line"><span class="lineno">   41</span> </div>
<div class="line"><span class="lineno">   42</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   43</span>        <span class="comment">// Indicate that it&#39;s initialized</span></div>
<div class="line"><span class="lineno">   44</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   45</span>        <a class="code hl_variable" href="ud_8cpp.html#a5f11dde5b4669d77996f8ae794368127">g_IsUserDebuggerInitialized</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">   46</span>    }</div>
<div class="line"><span class="lineno">   47</span>}</div>
<div class="ttc" id="ahprdbgctrl_2header_2debugger_8h_html_ab2d93302f6217632bfff37d358773953"><div class="ttname"><a href="hprdbgctrl_2header_2debugger_8h.html#ab2d93302f6217632bfff37d358773953">DEBUGGER_MAXIMUM_SYNCRONIZATION_USER_DEBUGGER_OBJECTS</a></div><div class="ttdeci">#define DEBUGGER_MAXIMUM_SYNCRONIZATION_USER_DEBUGGER_OBJECTS</div><div class="ttdoc">Maximum number of event handles in user-debugger.</div><div class="ttdef"><b>Definition:</b> debugger.h:86</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___s_y_n_c_r_o_n_i_z_a_t_i_o_n___e_v_e_n_t_s___s_t_a_t_e_html_ab845e27caa4c157798721890a5a854de"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___s_y_n_c_r_o_n_i_z_a_t_i_o_n___e_v_e_n_t_s___s_t_a_t_e.html#ab845e27caa4c157798721890a5a854de">_DEBUGGER_SYNCRONIZATION_EVENTS_STATE::EventHandle</a></div><div class="ttdeci">HANDLE EventHandle</div><div class="ttdef"><b>Definition:</b> debugger.h:109</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___s_y_n_c_r_o_n_i_z_a_t_i_o_n___e_v_e_n_t_s___s_t_a_t_e_html_aef7053cd3be5d917524afa71fdc24e48"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___s_y_n_c_r_o_n_i_z_a_t_i_o_n___e_v_e_n_t_s___s_t_a_t_e.html#aef7053cd3be5d917524afa71fdc24e48">_DEBUGGER_SYNCRONIZATION_EVENTS_STATE::IsOnWaitingState</a></div><div class="ttdeci">BOOLEAN IsOnWaitingState</div><div class="ttdef"><b>Definition:</b> debugger.h:110</div></div>
<div class="ttc" id="aud_8cpp_html_a36113a502dd15e3863d6c08981f80d7d"><div class="ttname"><a href="ud_8cpp.html#a36113a502dd15e3863d6c08981f80d7d">g_UserSyncronizationObjectsHandleTable</a></div><div class="ttdeci">DEBUGGER_SYNCRONIZATION_EVENTS_STATE g_UserSyncronizationObjectsHandleTable[DEBUGGER_MAXIMUM_SYNCRONIZATION_USER_DEBUGGER_OBJECTS]</div><div class="ttdoc">In debugger (not debuggee), we save the handle of the user-mode listening thread for pauses here for ...</div><div class="ttdef"><b>Definition:</b> globals.h:176</div></div>
<div class="ttc" id="aud_8cpp_html_a5f11dde5b4669d77996f8ae794368127"><div class="ttname"><a href="ud_8cpp.html#a5f11dde5b4669d77996f8ae794368127">g_IsUserDebuggerInitialized</a></div><div class="ttdeci">BOOLEAN g_IsUserDebuggerInitialized</div><div class="ttdoc">Whether the user debugger is initialized or not.</div><div class="ttdef"><b>Definition:</b> globals.h:167</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c8e27ff0bdd3e135b4e39c7cf7b5805" name="a7c8e27ff0bdd3e135b4e39c7cf7b5805"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c8e27ff0bdd3e135b4e39c7cf7b5805">&#9670;&#160;</a></span>UdUninitializeUserDebugger()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> UdUninitializeUserDebugger </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Uninitialize the user debugger in user mode. </p>
<dl class="section return"><dt>Returns</dt><dd>VOID</dd></dl>
<p>Uninitialize the user debugger in user mode.</p>
<p>this function should be called on vmx non-root</p>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   57</span>{</div>
<div class="line"><span class="lineno">   58</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="ud_8cpp.html#a5f11dde5b4669d77996f8ae794368127">g_IsUserDebuggerInitialized</a>)</div>
<div class="line"><span class="lineno">   59</span>    {</div>
<div class="line"><span class="lineno">   60</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   61</span>        <span class="comment">// Remove the active process</span></div>
<div class="line"><span class="lineno">   62</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   63</span>        <a class="code hl_function" href="ud_8cpp.html#a2cc6b6660ea24b3d4183100eb36b5e73">UdRemoveActiveDebuggingProcess</a>(<a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><span class="lineno">   64</span> </div>
<div class="line"><span class="lineno">   65</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   66</span>        <span class="comment">// Initialize the handle table</span></div>
<div class="line"><span class="lineno">   67</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   68</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_define" href="hprdbgctrl_2header_2debugger_8h.html#ab2d93302f6217632bfff37d358773953">DEBUGGER_MAXIMUM_SYNCRONIZATION_USER_DEBUGGER_OBJECTS</a>; i++)</div>
<div class="line"><span class="lineno">   69</span>        {</div>
<div class="line"><span class="lineno">   70</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="ud_8cpp.html#a36113a502dd15e3863d6c08981f80d7d">g_UserSyncronizationObjectsHandleTable</a>[i].EventHandle != NULL)</div>
<div class="line"><span class="lineno">   71</span>            {</div>
<div class="line"><span class="lineno">   72</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="ud_8cpp.html#a36113a502dd15e3863d6c08981f80d7d">g_UserSyncronizationObjectsHandleTable</a>[i].IsOnWaitingState)</div>
<div class="line"><span class="lineno">   73</span>                {</div>
<div class="line"><span class="lineno">   74</span>                    <a class="code hl_define" href="hprdbgctrl_2header_2ud_8h.html#ab918356e0d16e9935f9f0423cdf82a6b">DbgReceivedUserResponse</a>(i);</div>
<div class="line"><span class="lineno">   75</span>                }</div>
<div class="line"><span class="lineno">   76</span> </div>
<div class="line"><span class="lineno">   77</span>                CloseHandle(<a class="code hl_variable" href="ud_8cpp.html#a36113a502dd15e3863d6c08981f80d7d">g_UserSyncronizationObjectsHandleTable</a>[i].EventHandle);</div>
<div class="line"><span class="lineno">   78</span>                <a class="code hl_variable" href="ud_8cpp.html#a36113a502dd15e3863d6c08981f80d7d">g_UserSyncronizationObjectsHandleTable</a>[i].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_y_n_c_r_o_n_i_z_a_t_i_o_n___e_v_e_n_t_s___s_t_a_t_e.html#ab845e27caa4c157798721890a5a854de">EventHandle</a> = NULL;</div>
<div class="line"><span class="lineno">   79</span>            }</div>
<div class="line"><span class="lineno">   80</span>        }</div>
<div class="line"><span class="lineno">   81</span> </div>
<div class="line"><span class="lineno">   82</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   83</span>        <span class="comment">// Indicate that user debuggger is not initialized</span></div>
<div class="line"><span class="lineno">   84</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   85</span>        <a class="code hl_variable" href="ud_8cpp.html#a5f11dde5b4669d77996f8ae794368127">g_IsUserDebuggerInitialized</a> = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">   86</span>    }</div>
<div class="line"><span class="lineno">   87</span>}</div>
<div class="ttc" id="ahprdbgctrl_2header_2ud_8h_html_ab918356e0d16e9935f9f0423cdf82a6b"><div class="ttname"><a href="hprdbgctrl_2header_2ud_8h.html#ab918356e0d16e9935f9f0423cdf82a6b">DbgReceivedUserResponse</a></div><div class="ttdeci">#define DbgReceivedUserResponse(UserSyncObjectId)</div><div class="ttdef"><b>Definition:</b> ud.h:28</div></div>
<div class="ttc" id="aud_8cpp_html_a2cc6b6660ea24b3d4183100eb36b5e73"><div class="ttname"><a href="ud_8cpp.html#a2cc6b6660ea24b3d4183100eb36b5e73">UdRemoveActiveDebuggingProcess</a></div><div class="ttdeci">VOID UdRemoveActiveDebuggingProcess(BOOLEAN DontSwitchToNewProcess)</div><div class="ttdoc">Remove the current active debugging process (thread)</div><div class="ttdef"><b>Definition:</b> ud.cpp:128</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_53a6cdbae347618e9ee76d4be5c6ea96.html">hyperdbg</a></li><li class="navelem"><a class="el" href="dir_0f75a8685de99980df6b10136f072ea3.html">hprdbgkd</a></li><li class="navelem"><a class="el" href="dir_a49bef8785c3fd81042e69d2866eb23c.html">header</a></li><li class="navelem"><a class="el" href="dir_c5c32dbaf8d06eb5e35478b4712c2bd5.html">debugger</a></li><li class="navelem"><a class="el" href="dir_9e8ec990904d7c59af6008ef1e6d228d.html">user-level</a></li><li class="navelem"><a class="el" href="hprdbgkd_2header_2debugger_2user-level_2ud_8h.html">Ud.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
