<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HyperDbg: hyperdbg/hprdbgctrl/code/debugger/communication/forwarding.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">HyperDbg
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('forwarding_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">forwarding.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;pch.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a740430838e3e9b71ad6131ae48554ff7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwarding_8cpp.html#a740430838e3e9b71ad6131ae48554ff7">ForwardingGetNewOutputSourceTag</a> ()</td></tr>
<tr class="memdesc:a740430838e3e9b71ad6131ae48554ff7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the output source tag and increase the global variable for tag.  <br /></td></tr>
<tr class="separator:a740430838e3e9b71ad6131ae48554ff7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15edd4f350e120500db07b5a60e6e145"><td class="memItemLeft" align="right" valign="top"><a class="el" href="forwarding_8h.html#acfb9eb7c766687abbd105c83ce4310f5">DEBUGGER_OUTPUT_SOURCE_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwarding_8cpp.html#a15edd4f350e120500db07b5a60e6e145">ForwardingOpenOutputSource</a> (<a class="el" href="forwarding_8h.html#aedffd28ff7da7c4ddae96f692c4d0eda">PDEBUGGER_EVENT_FORWARDING</a> SourceDescriptor)</td></tr>
<tr class="memdesc:a15edd4f350e120500db07b5a60e6e145"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opens the output source.  <br /></td></tr>
<tr class="separator:a15edd4f350e120500db07b5a60e6e145"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a004d6080788ef354b01fc0b08a5f7609"><td class="memItemLeft" align="right" valign="top"><a class="el" href="forwarding_8h.html#acfb9eb7c766687abbd105c83ce4310f5">DEBUGGER_OUTPUT_SOURCE_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwarding_8cpp.html#a004d6080788ef354b01fc0b08a5f7609">ForwardingCloseOutputSource</a> (<a class="el" href="forwarding_8h.html#aedffd28ff7da7c4ddae96f692c4d0eda">PDEBUGGER_EVENT_FORWARDING</a> SourceDescriptor)</td></tr>
<tr class="memdesc:a004d6080788ef354b01fc0b08a5f7609"><td class="mdescLeft">&#160;</td><td class="mdescRight">Closes the output source.  <br /></td></tr>
<tr class="separator:a004d6080788ef354b01fc0b08a5f7609"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba217dc9d1f2e242793541a92097a922"><td class="memItemLeft" align="right" valign="top">HANDLE&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwarding_8cpp.html#aba217dc9d1f2e242793541a92097a922">ForwardingCreateOutputSource</a> (<a class="el" href="forwarding_8h.html#a729462f999e9bd091d2b38a2be323eac">DEBUGGER_EVENT_FORWARDING_TYPE</a> SourceType, const string &amp;Description, SOCKET *Socket)</td></tr>
<tr class="memdesc:aba217dc9d1f2e242793541a92097a922"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new source (create handle from the source)  <br /></td></tr>
<tr class="separator:aba217dc9d1f2e242793541a92097a922"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac84663bef0772945782e2533e31a07d2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwarding_8cpp.html#ac84663bef0772945782e2533e31a07d2">ForwardingPerformEventForwarding</a> (<a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a785bb4a350ef4f18bd7101ab77c88148">PDEBUGGER_GENERAL_EVENT_DETAIL</a> EventDetail, <a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *Message, <a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> MessageLength)</td></tr>
<tr class="memdesc:ac84663bef0772945782e2533e31a07d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send the event result to the corresponding sources.  <br /></td></tr>
<tr class="separator:ac84663bef0772945782e2533e31a07d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60c79833ff7c6757b8806a8266f31353"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwarding_8cpp.html#a60c79833ff7c6757b8806a8266f31353">ForwardingWriteToFile</a> (HANDLE <a class="el" href="_hooks_8h.html#a74bc6881ecc918d83da9c92e3b2bcc04">FileHandle</a>, <a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *Message, <a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> MessageLength)</td></tr>
<tr class="memdesc:a60c79833ff7c6757b8806a8266f31353"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write the output results to the file.  <br /></td></tr>
<tr class="separator:a60c79833ff7c6757b8806a8266f31353"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d46ef4cad8ecde3ccebe8703dd4fd8d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwarding_8cpp.html#a9d46ef4cad8ecde3ccebe8703dd4fd8d">ForwardingSendToNamedPipe</a> (HANDLE NamedPipeHandle, <a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *Message, <a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> MessageLength)</td></tr>
<tr class="memdesc:a9d46ef4cad8ecde3ccebe8703dd4fd8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send the output results to the namedpipe.  <br /></td></tr>
<tr class="separator:a9d46ef4cad8ecde3ccebe8703dd4fd8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e3c56ef206a16780f2372db0df9039a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwarding_8cpp.html#a0e3c56ef206a16780f2372db0df9039a">ForwardingSendToTcpSocket</a> (SOCKET TcpSocket, <a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *Message, <a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> MessageLength)</td></tr>
<tr class="memdesc:a0e3c56ef206a16780f2372db0df9039a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send the output results to the tcp socket.  <br /></td></tr>
<tr class="separator:a0e3c56ef206a16780f2372db0df9039a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a53d533d7b64b079d3416e18143cad0fe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwarding_8cpp.html#a53d533d7b64b079d3416e18143cad0fe">g_OutputSourceTag</a></td></tr>
<tr class="memdesc:a53d533d7b64b079d3416e18143cad0fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">This variable holds the trace and generate numbers for unique tag of the output resources.  <br /></td></tr>
<tr class="separator:a53d533d7b64b079d3416e18143cad0fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd85daad5afd0daf8ce46b7200a89276"><td class="memItemLeft" align="right" valign="top">LIST_ENTRY&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="forwarding_8cpp.html#acd85daad5afd0daf8ce46b7200a89276">g_OutputSources</a></td></tr>
<tr class="memdesc:acd85daad5afd0daf8ce46b7200a89276"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds a list of output sources created by output command.  <br /></td></tr>
<tr class="separator:acd85daad5afd0daf8ce46b7200a89276"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a004d6080788ef354b01fc0b08a5f7609" name="a004d6080788ef354b01fc0b08a5f7609"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a004d6080788ef354b01fc0b08a5f7609">&#9670;&#160;</a></span>ForwardingCloseOutputSource()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="forwarding_8h.html#acfb9eb7c766687abbd105c83ce4310f5">DEBUGGER_OUTPUT_SOURCE_STATUS</a> ForwardingCloseOutputSource </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="forwarding_8h.html#aedffd28ff7da7c4ddae96f692c4d0eda">PDEBUGGER_EVENT_FORWARDING</a>&#160;</td>
          <td class="paramname"><em>SourceDescriptor</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Closes the output source. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">SourceDescriptor</td><td>Descriptor of the source</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>DEBUGGER_OUTPUT_SOURCE_STATUS return status of the closing function </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  102</span>{</div>
<div class="line"><span class="lineno">  103</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  104</span>    <span class="comment">// Check if already closed</span></div>
<div class="line"><span class="lineno">  105</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  106</span>    <span class="keywordflow">if</span> (SourceDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g.html#a6a5265e3ca564346caf72692b4f3c654">State</a> == <a class="code hl_enumvalue" href="forwarding_8h.html#a42e89d95ef5380838b8a9076a408974ca9717cfd3666009a027267d27bcb4bc95">EVENT_FORWARDING_CLOSED</a>)</div>
<div class="line"><span class="lineno">  107</span>    {</div>
<div class="line"><span class="lineno">  108</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="forwarding_8h.html#ac82f26f4aa50aede627e9d8ee40c6312ac199631b173e6c1619ab8460454f1a69">DEBUGGER_OUTPUT_SOURCE_STATUS_ALREADY_CLOSED</a>;</div>
<div class="line"><span class="lineno">  109</span>    }</div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  112</span>    <span class="comment">// Check if not opened</span></div>
<div class="line"><span class="lineno">  113</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  114</span>    <span class="keywordflow">if</span> (SourceDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g.html#a6a5265e3ca564346caf72692b4f3c654">State</a> == <a class="code hl_enumvalue" href="forwarding_8h.html#a42e89d95ef5380838b8a9076a408974cacc15feb95f39c0d93c48e4376775e838">EVENT_FORWARDING_STATE_NOT_OPENED</a> ||</div>
<div class="line"><span class="lineno">  115</span>        SourceDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g.html#a6a5265e3ca564346caf72692b4f3c654">State</a> != <a class="code hl_enumvalue" href="forwarding_8h.html#a42e89d95ef5380838b8a9076a408974ca76464720e795c18ee1c6192f18684279">EVENT_FORWARDING_STATE_OPENED</a>)</div>
<div class="line"><span class="lineno">  116</span>    {</div>
<div class="line"><span class="lineno">  117</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  118</span>        <span class="comment">// Not opennd ? or state other than opened ?</span></div>
<div class="line"><span class="lineno">  119</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  120</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="forwarding_8h.html#ac82f26f4aa50aede627e9d8ee40c6312a68dfc99955fa2f449c2fe77a1870d9ee">DEBUGGER_OUTPUT_SOURCE_STATUS_UNKNOWN_ERROR</a>;</div>
<div class="line"><span class="lineno">  121</span>    }</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  124</span>    <span class="comment">// Set the state</span></div>
<div class="line"><span class="lineno">  125</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  126</span>    SourceDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g.html#a6a5265e3ca564346caf72692b4f3c654">State</a> = <a class="code hl_enumvalue" href="forwarding_8h.html#a42e89d95ef5380838b8a9076a408974ca9717cfd3666009a027267d27bcb4bc95">EVENT_FORWARDING_CLOSED</a>;</div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  129</span>    <span class="comment">// Now, it&#39;s time to close the source based on its type</span></div>
<div class="line"><span class="lineno">  130</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  131</span>    <span class="keywordflow">if</span> (SourceDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g.html#a1f41501d1db9767cfdb8d1b2114e6ee8">Type</a> == <a class="code hl_enumvalue" href="forwarding_8h.html#ad1e352ad6958db92e803af5dc0f245f7ae22cdf27af7d9a9c0a4c316dbbc4bdd1">EVENT_FORWARDING_FILE</a>)</div>
<div class="line"><span class="lineno">  132</span>    {</div>
<div class="line"><span class="lineno">  133</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  134</span>        <span class="comment">// Close the hanlde</span></div>
<div class="line"><span class="lineno">  135</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  136</span>        CloseHandle(SourceDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g.html#a63e9f48b3c26fe64dff7cffef5890b4c">Handle</a>);</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  139</span>        <span class="comment">// Return the status</span></div>
<div class="line"><span class="lineno">  140</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  141</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="forwarding_8h.html#ac82f26f4aa50aede627e9d8ee40c6312ab9a5a8225ce8367269bc24e035e27021">DEBUGGER_OUTPUT_SOURCE_STATUS_SUCCESSFULLY_CLOSED</a>;</div>
<div class="line"><span class="lineno">  142</span>    }</div>
<div class="line"><span class="lineno">  143</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SourceDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g.html#a1f41501d1db9767cfdb8d1b2114e6ee8">Type</a> == <a class="code hl_enumvalue" href="forwarding_8h.html#ad1e352ad6958db92e803af5dc0f245f7a06e104b57293169bf78d16d3171acb81">EVENT_FORWARDING_TCP</a>)</div>
<div class="line"><span class="lineno">  144</span>    {</div>
<div class="line"><span class="lineno">  145</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  146</span>        <span class="comment">// Shutdown connection</span></div>
<div class="line"><span class="lineno">  147</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  148</span>        <a class="code hl_function" href="tcpclient_8cpp.html#a4c233fdcd647c012b372e62f81daae97">CommunicationClientShutdownConnection</a>(SourceDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g.html#aab93c0ef794702cd4d8595be8d314a27">Socket</a>);</div>
<div class="line"><span class="lineno">  149</span> </div>
<div class="line"><span class="lineno">  150</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  151</span>        <span class="comment">// Cleanup</span></div>
<div class="line"><span class="lineno">  152</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  153</span>        <a class="code hl_function" href="tcpclient_8cpp.html#a4c9294eb185750c0579f9793b4f78d98">CommunicationClientCleanup</a>(SourceDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g.html#aab93c0ef794702cd4d8595be8d314a27">Socket</a>);</div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  156</span>        <span class="comment">// Return the status</span></div>
<div class="line"><span class="lineno">  157</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  158</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="forwarding_8h.html#ac82f26f4aa50aede627e9d8ee40c6312ab9a5a8225ce8367269bc24e035e27021">DEBUGGER_OUTPUT_SOURCE_STATUS_SUCCESSFULLY_CLOSED</a>;</div>
<div class="line"><span class="lineno">  159</span>    }</div>
<div class="line"><span class="lineno">  160</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SourceDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g.html#a1f41501d1db9767cfdb8d1b2114e6ee8">Type</a> == <a class="code hl_enumvalue" href="forwarding_8h.html#ad1e352ad6958db92e803af5dc0f245f7af010f7ac3a7a606129bf3affe7e0206f">EVENT_FORWARDING_NAMEDPIPE</a>)</div>
<div class="line"><span class="lineno">  161</span>    {</div>
<div class="line"><span class="lineno">  162</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  163</span>        <span class="comment">// Close the file</span></div>
<div class="line"><span class="lineno">  164</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  165</span>        <a class="code hl_function" href="hprdbgctrl_2code_2debugger_2communication_2namedpipe_8cpp.html#a8d45324d70d94d8081f7d6ed841fd236">NamedPipeClientClosePipe</a>(SourceDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g.html#a63e9f48b3c26fe64dff7cffef5890b4c">Handle</a>);</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  168</span>        <span class="comment">// Return the status</span></div>
<div class="line"><span class="lineno">  169</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  170</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="forwarding_8h.html#ac82f26f4aa50aede627e9d8ee40c6312ab9a5a8225ce8367269bc24e035e27021">DEBUGGER_OUTPUT_SOURCE_STATUS_SUCCESSFULLY_CLOSED</a>;</div>
<div class="line"><span class="lineno">  171</span>    }</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="forwarding_8h.html#ac82f26f4aa50aede627e9d8ee40c6312a68dfc99955fa2f449c2fe77a1870d9ee">DEBUGGER_OUTPUT_SOURCE_STATUS_UNKNOWN_ERROR</a>;</div>
<div class="line"><span class="lineno">  174</span>}</div>
<div class="ttc" id="aforwarding_8h_html_a42e89d95ef5380838b8a9076a408974ca76464720e795c18ee1c6192f18684279"><div class="ttname"><a href="forwarding_8h.html#a42e89d95ef5380838b8a9076a408974ca76464720e795c18ee1c6192f18684279">EVENT_FORWARDING_STATE_OPENED</a></div><div class="ttdeci">@ EVENT_FORWARDING_STATE_OPENED</div><div class="ttdef"><b>Definition:</b> forwarding.h:42</div></div>
<div class="ttc" id="aforwarding_8h_html_a42e89d95ef5380838b8a9076a408974ca9717cfd3666009a027267d27bcb4bc95"><div class="ttname"><a href="forwarding_8h.html#a42e89d95ef5380838b8a9076a408974ca9717cfd3666009a027267d27bcb4bc95">EVENT_FORWARDING_CLOSED</a></div><div class="ttdeci">@ EVENT_FORWARDING_CLOSED</div><div class="ttdef"><b>Definition:</b> forwarding.h:43</div></div>
<div class="ttc" id="aforwarding_8h_html_a42e89d95ef5380838b8a9076a408974cacc15feb95f39c0d93c48e4376775e838"><div class="ttname"><a href="forwarding_8h.html#a42e89d95ef5380838b8a9076a408974cacc15feb95f39c0d93c48e4376775e838">EVENT_FORWARDING_STATE_NOT_OPENED</a></div><div class="ttdeci">@ EVENT_FORWARDING_STATE_NOT_OPENED</div><div class="ttdef"><b>Definition:</b> forwarding.h:41</div></div>
<div class="ttc" id="aforwarding_8h_html_ac82f26f4aa50aede627e9d8ee40c6312a68dfc99955fa2f449c2fe77a1870d9ee"><div class="ttname"><a href="forwarding_8h.html#ac82f26f4aa50aede627e9d8ee40c6312a68dfc99955fa2f449c2fe77a1870d9ee">DEBUGGER_OUTPUT_SOURCE_STATUS_UNKNOWN_ERROR</a></div><div class="ttdeci">@ DEBUGGER_OUTPUT_SOURCE_STATUS_UNKNOWN_ERROR</div><div class="ttdef"><b>Definition:</b> forwarding.h:58</div></div>
<div class="ttc" id="aforwarding_8h_html_ac82f26f4aa50aede627e9d8ee40c6312ab9a5a8225ce8367269bc24e035e27021"><div class="ttname"><a href="forwarding_8h.html#ac82f26f4aa50aede627e9d8ee40c6312ab9a5a8225ce8367269bc24e035e27021">DEBUGGER_OUTPUT_SOURCE_STATUS_SUCCESSFULLY_CLOSED</a></div><div class="ttdeci">@ DEBUGGER_OUTPUT_SOURCE_STATUS_SUCCESSFULLY_CLOSED</div><div class="ttdef"><b>Definition:</b> forwarding.h:55</div></div>
<div class="ttc" id="aforwarding_8h_html_ac82f26f4aa50aede627e9d8ee40c6312ac199631b173e6c1619ab8460454f1a69"><div class="ttname"><a href="forwarding_8h.html#ac82f26f4aa50aede627e9d8ee40c6312ac199631b173e6c1619ab8460454f1a69">DEBUGGER_OUTPUT_SOURCE_STATUS_ALREADY_CLOSED</a></div><div class="ttdeci">@ DEBUGGER_OUTPUT_SOURCE_STATUS_ALREADY_CLOSED</div><div class="ttdef"><b>Definition:</b> forwarding.h:57</div></div>
<div class="ttc" id="aforwarding_8h_html_ad1e352ad6958db92e803af5dc0f245f7a06e104b57293169bf78d16d3171acb81"><div class="ttname"><a href="forwarding_8h.html#ad1e352ad6958db92e803af5dc0f245f7a06e104b57293169bf78d16d3171acb81">EVENT_FORWARDING_TCP</a></div><div class="ttdeci">@ EVENT_FORWARDING_TCP</div><div class="ttdef"><b>Definition:</b> forwarding.h:32</div></div>
<div class="ttc" id="aforwarding_8h_html_ad1e352ad6958db92e803af5dc0f245f7ae22cdf27af7d9a9c0a4c316dbbc4bdd1"><div class="ttname"><a href="forwarding_8h.html#ad1e352ad6958db92e803af5dc0f245f7ae22cdf27af7d9a9c0a4c316dbbc4bdd1">EVENT_FORWARDING_FILE</a></div><div class="ttdeci">@ EVENT_FORWARDING_FILE</div><div class="ttdef"><b>Definition:</b> forwarding.h:31</div></div>
<div class="ttc" id="aforwarding_8h_html_ad1e352ad6958db92e803af5dc0f245f7af010f7ac3a7a606129bf3affe7e0206f"><div class="ttname"><a href="forwarding_8h.html#ad1e352ad6958db92e803af5dc0f245f7af010f7ac3a7a606129bf3affe7e0206f">EVENT_FORWARDING_NAMEDPIPE</a></div><div class="ttdeci">@ EVENT_FORWARDING_NAMEDPIPE</div><div class="ttdef"><b>Definition:</b> forwarding.h:30</div></div>
<div class="ttc" id="ahprdbgctrl_2code_2debugger_2communication_2namedpipe_8cpp_html_a8d45324d70d94d8081f7d6ed841fd236"><div class="ttname"><a href="hprdbgctrl_2code_2debugger_2communication_2namedpipe_8cpp.html#a8d45324d70d94d8081f7d6ed841fd236">NamedPipeClientClosePipe</a></div><div class="ttdeci">VOID NamedPipeClientClosePipe(HANDLE PipeHandle)</div><div class="ttdoc">close named pipe handle of client</div><div class="ttdef"><b>Definition:</b> namedpipe.cpp:369</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g_html_a1f41501d1db9767cfdb8d1b2114e6ee8"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g.html#a1f41501d1db9767cfdb8d1b2114e6ee8">_DEBUGGER_EVENT_FORWARDING::Type</a></div><div class="ttdeci">DEBUGGER_EVENT_FORWARDING_TYPE Type</div><div class="ttdef"><b>Definition:</b> forwarding.h:67</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g_html_a63e9f48b3c26fe64dff7cffef5890b4c"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g.html#a63e9f48b3c26fe64dff7cffef5890b4c">_DEBUGGER_EVENT_FORWARDING::Handle</a></div><div class="ttdeci">HANDLE Handle</div><div class="ttdef"><b>Definition:</b> forwarding.h:69</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g_html_a6a5265e3ca564346caf72692b4f3c654"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g.html#a6a5265e3ca564346caf72692b4f3c654">_DEBUGGER_EVENT_FORWARDING::State</a></div><div class="ttdeci">DEBUGGER_EVENT_FORWARDING_STATE State</div><div class="ttdef"><b>Definition:</b> forwarding.h:68</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g_html_aab93c0ef794702cd4d8595be8d314a27"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g.html#aab93c0ef794702cd4d8595be8d314a27">_DEBUGGER_EVENT_FORWARDING::Socket</a></div><div class="ttdeci">SOCKET Socket</div><div class="ttdef"><b>Definition:</b> forwarding.h:70</div></div>
<div class="ttc" id="atcpclient_8cpp_html_a4c233fdcd647c012b372e62f81daae97"><div class="ttname"><a href="tcpclient_8cpp.html#a4c233fdcd647c012b372e62f81daae97">CommunicationClientShutdownConnection</a></div><div class="ttdeci">int CommunicationClientShutdownConnection(SOCKET ConnectSocket)</div><div class="ttdoc">shutdown the connection as a client</div><div class="ttdef"><b>Definition:</b> tcpclient.cpp:137</div></div>
<div class="ttc" id="atcpclient_8cpp_html_a4c9294eb185750c0579f9793b4f78d98"><div class="ttname"><a href="tcpclient_8cpp.html#a4c9294eb185750c0579f9793b4f78d98">CommunicationClientCleanup</a></div><div class="ttdeci">int CommunicationClientCleanup(SOCKET ConnectSocket)</div><div class="ttdoc">cleanup the connection as client</div><div class="ttdef"><b>Definition:</b> tcpclient.cpp:216</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aba217dc9d1f2e242793541a92097a922" name="aba217dc9d1f2e242793541a92097a922"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba217dc9d1f2e242793541a92097a922">&#9670;&#160;</a></span>ForwardingCreateOutputSource()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HANDLE ForwardingCreateOutputSource </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="forwarding_8h.html#a729462f999e9bd091d2b38a2be323eac">DEBUGGER_EVENT_FORWARDING_TYPE</a>&#160;</td>
          <td class="paramname"><em>SourceType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const string &amp;&#160;</td>
          <td class="paramname"><em>Description</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SOCKET *&#160;</td>
          <td class="paramname"><em>Socket</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a new source (create handle from the source) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">SourceType</td><td>Type of the source </td></tr>
    <tr><td class="paramname">Description</td><td>Description of the source </td></tr>
    <tr><td class="paramname">Socket</td><td>Socket object in the case of TCP connection</td></tr>
  </table>
  </dd>
</dl>
<p>If the target connection is a tcp connection then there is no handle and instead there is a socket, this way we pass a valid value for handle (TRUE) which is not a valid handle but it indicates that the operation was successful and the caller can use the pointer that it passed as the socket. On anything other than tcp sockets, the socket pointer in not modified; thus, it's not value</p>
<dl class="section return"><dt>Returns</dt><dd>HANDLE returns handle of the source </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  196</span>{</div>
<div class="line"><span class="lineno">  197</span>    <span class="keywordtype">string</span> IpPortDelimiter;</div>
<div class="line"><span class="lineno">  198</span>    <span class="keywordtype">string</span> Ip;</div>
<div class="line"><span class="lineno">  199</span>    <span class="keywordtype">string</span> Port;</div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span>    <span class="keywordflow">if</span> (SourceType == <a class="code hl_enumvalue" href="forwarding_8h.html#ad1e352ad6958db92e803af5dc0f245f7ae22cdf27af7d9a9c0a4c316dbbc4bdd1">EVENT_FORWARDING_FILE</a>)</div>
<div class="line"><span class="lineno">  202</span>    {</div>
<div class="line"><span class="lineno">  203</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  204</span>        <span class="comment">// Create a new file</span></div>
<div class="line"><span class="lineno">  205</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  206</span>        HANDLE <a class="code hl_variable" href="_hooks_8h.html#a74bc6881ecc918d83da9c92e3b2bcc04">FileHandle</a> = CreateFileA(Description.c_str(), GENERIC_WRITE, 0, NULL, OPEN_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL);</div>
<div class="line"><span class="lineno">  207</span> </div>
<div class="line"><span class="lineno">  208</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  209</span>        <span class="comment">// The handle might be INVALID_HANDLE_VALUE which will be</span></div>
<div class="line"><span class="lineno">  210</span>        <span class="comment">// checked by the caller</span></div>
<div class="line"><span class="lineno">  211</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  212</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="_hooks_8h.html#a74bc6881ecc918d83da9c92e3b2bcc04">FileHandle</a>;</div>
<div class="line"><span class="lineno">  213</span>    }</div>
<div class="line"><span class="lineno">  214</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SourceType == <a class="code hl_enumvalue" href="forwarding_8h.html#ad1e352ad6958db92e803af5dc0f245f7af010f7ac3a7a606129bf3affe7e0206f">EVENT_FORWARDING_NAMEDPIPE</a>)</div>
<div class="line"><span class="lineno">  215</span>    {</div>
<div class="line"><span class="lineno">  216</span>        HANDLE PipeHandle = <a class="code hl_function" href="hprdbgctrl_2code_2debugger_2communication_2namedpipe_8cpp.html#a7603196b784c96a750aeb3aaf3e1a360">NamedPipeClientCreatePipe</a>(Description.c_str());</div>
<div class="line"><span class="lineno">  217</span> </div>
<div class="line"><span class="lineno">  218</span>        <span class="keywordflow">if</span> (!PipeHandle)</div>
<div class="line"><span class="lineno">  219</span>        {</div>
<div class="line"><span class="lineno">  220</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  221</span>            <span class="comment">// Unable to create handle</span></div>
<div class="line"><span class="lineno">  222</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  223</span>            <span class="keywordflow">return</span> INVALID_HANDLE_VALUE;</div>
<div class="line"><span class="lineno">  224</span>        }</div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span>        <span class="keywordflow">return</span> PipeHandle;</div>
<div class="line"><span class="lineno">  227</span>    }</div>
<div class="line"><span class="lineno">  228</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SourceType == <a class="code hl_enumvalue" href="forwarding_8h.html#ad1e352ad6958db92e803af5dc0f245f7a06e104b57293169bf78d16d3171acb81">EVENT_FORWARDING_TCP</a>)</div>
<div class="line"><span class="lineno">  229</span>    {</div>
<div class="line"><span class="lineno">  230</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  231</span>        <span class="comment">// Check if the port is included in the description string or not</span></div>
<div class="line"><span class="lineno">  232</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  233</span>        <span class="keywordflow">if</span> (Description.find(<span class="charliteral">&#39;:&#39;</span>) != std::string::npos)</div>
<div class="line"><span class="lineno">  234</span>        {</div>
<div class="line"><span class="lineno">  235</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  236</span>            <span class="comment">// Split the ip and port by : delimiter</span></div>
<div class="line"><span class="lineno">  237</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  238</span>            IpPortDelimiter = <span class="charliteral">&#39;:&#39;</span>;</div>
<div class="line"><span class="lineno">  239</span>            <span class="keywordtype">size_t</span> find     = Description.find(IpPortDelimiter);</div>
<div class="line"><span class="lineno">  240</span>            Ip              = Description.substr(0, find);</div>
<div class="line"><span class="lineno">  241</span>            Port            = Description.substr(find + 1, find + Description.size());</div>
<div class="line"><span class="lineno">  242</span> </div>
<div class="line"><span class="lineno">  243</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  244</span>            <span class="comment">// Connect to server, in this function 0 means there was no error</span></div>
<div class="line"><span class="lineno">  245</span>            <span class="comment">// and 1 means there was an error</span></div>
<div class="line"><span class="lineno">  246</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  247</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="tcpclient_8cpp.html#a85f0659745121533284636d51a5e0b7f">CommunicationClientConnectToServer</a>(Ip.c_str(), Port.c_str(), Socket) == 0)</div>
<div class="line"><span class="lineno">  248</span>            {</div>
<div class="line"><span class="lineno">  249</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  250</span>                <span class="comment">// Send a fake handle just to avoid sending INVALID_HANDLE_VALUE</span></div>
<div class="line"><span class="lineno">  251</span>                <span class="comment">// because this functionality doesn&#39;t work with handlers; however,</span></div>
<div class="line"><span class="lineno">  252</span>                <span class="comment">// send 1 or TRUE is a valid handle</span></div>
<div class="line"><span class="lineno">  253</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  254</span>                <span class="keywordflow">return</span> (HANDLE)<a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  255</span>            }</div>
<div class="line"><span class="lineno">  256</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  257</span>            {</div>
<div class="line"><span class="lineno">  258</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  259</span>                <span class="comment">// There was an error in connecting to the server</span></div>
<div class="line"><span class="lineno">  260</span>                <span class="comment">// so return an invalid handle</span></div>
<div class="line"><span class="lineno">  261</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  262</span>                <span class="keywordflow">return</span> INVALID_HANDLE_VALUE;</div>
<div class="line"><span class="lineno">  263</span>            }</div>
<div class="line"><span class="lineno">  264</span>        }</div>
<div class="line"><span class="lineno">  265</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  266</span>        {</div>
<div class="line"><span class="lineno">  267</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  268</span>            <span class="comment">// Invalid address format</span></div>
<div class="line"><span class="lineno">  269</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  270</span>            <span class="keywordflow">return</span> INVALID_HANDLE_VALUE;</div>
<div class="line"><span class="lineno">  271</span>        }</div>
<div class="line"><span class="lineno">  272</span>    }</div>
<div class="line"><span class="lineno">  273</span> </div>
<div class="line"><span class="lineno">  274</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  275</span>    <span class="comment">// By default, handle is invalid</span></div>
<div class="line"><span class="lineno">  276</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  277</span>    <span class="keywordflow">return</span> INVALID_HANDLE_VALUE;</div>
<div class="line"><span class="lineno">  278</span>}</div>
<div class="ttc" id="a_hooks_8h_html_a74bc6881ecc918d83da9c92e3b2bcc04"><div class="ttname"><a href="_hooks_8h.html#a74bc6881ecc918d83da9c92e3b2bcc04">FileHandle</a></div><div class="ttdeci">PHANDLE FileHandle</div><div class="ttdef"><b>Definition:</b> Hooks.h:128</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:50</div></div>
<div class="ttc" id="ahprdbgctrl_2code_2debugger_2communication_2namedpipe_8cpp_html_a7603196b784c96a750aeb3aaf3e1a360"><div class="ttname"><a href="hprdbgctrl_2code_2debugger_2communication_2namedpipe_8cpp.html#a7603196b784c96a750aeb3aaf3e1a360">NamedPipeClientCreatePipe</a></div><div class="ttdeci">HANDLE NamedPipeClientCreatePipe(LPCSTR PipeName)</div><div class="ttdoc">Create a client named pipe.</div><div class="ttdef"><b>Definition:</b> namedpipe.cpp:187</div></div>
<div class="ttc" id="atcpclient_8cpp_html_a85f0659745121533284636d51a5e0b7f"><div class="ttname"><a href="tcpclient_8cpp.html#a85f0659745121533284636d51a5e0b7f">CommunicationClientConnectToServer</a></div><div class="ttdeci">int CommunicationClientConnectToServer(PCSTR Ip, PCSTR Port, SOCKET *ConnectSocketArg)</div><div class="ttdoc">communication for client, connecting to the server</div><div class="ttdef"><b>Definition:</b> tcpclient.cpp:23</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a740430838e3e9b71ad6131ae48554ff7" name="a740430838e3e9b71ad6131ae48554ff7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a740430838e3e9b71ad6131ae48554ff7">&#9670;&#160;</a></span>ForwardingGetNewOutputSourceTag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> ForwardingGetNewOutputSourceTag </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the output source tag and increase the global variable for tag. </p>
<dl class="section return"><dt>Returns</dt><dd>UINT64 </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   28</span>{</div>
<div class="line"><span class="lineno">   29</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="forwarding_8cpp.html#a53d533d7b64b079d3416e18143cad0fe">g_OutputSourceTag</a>++;</div>
<div class="line"><span class="lineno">   30</span>}</div>
<div class="ttc" id="aforwarding_8cpp_html_a53d533d7b64b079d3416e18143cad0fe"><div class="ttname"><a href="forwarding_8cpp.html#a53d533d7b64b079d3416e18143cad0fe">g_OutputSourceTag</a></div><div class="ttdeci">UINT64 g_OutputSourceTag</div><div class="ttdoc">This variable holds the trace and generate numbers for unique tag of the output resources.</div><div class="ttdef"><b>Definition:</b> globals.h:376</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a15edd4f350e120500db07b5a60e6e145" name="a15edd4f350e120500db07b5a60e6e145"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15edd4f350e120500db07b5a60e6e145">&#9670;&#160;</a></span>ForwardingOpenOutputSource()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="forwarding_8h.html#acfb9eb7c766687abbd105c83ce4310f5">DEBUGGER_OUTPUT_SOURCE_STATUS</a> ForwardingOpenOutputSource </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="forwarding_8h.html#aedffd28ff7da7c4ddae96f692c4d0eda">PDEBUGGER_EVENT_FORWARDING</a>&#160;</td>
          <td class="paramname"><em>SourceDescriptor</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opens the output source. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">SourceDescriptor</td><td>Descriptor of the source</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>DEBUGGER_OUTPUT_SOURCE_STATUS return status of the opening function </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   40</span>{</div>
<div class="line"><span class="lineno">   41</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   42</span>    <span class="comment">// Check if already closed</span></div>
<div class="line"><span class="lineno">   43</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   44</span>    <span class="keywordflow">if</span> (SourceDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g.html#a6a5265e3ca564346caf72692b4f3c654">State</a> == <a class="code hl_enumvalue" href="forwarding_8h.html#a42e89d95ef5380838b8a9076a408974ca9717cfd3666009a027267d27bcb4bc95">EVENT_FORWARDING_CLOSED</a>)</div>
<div class="line"><span class="lineno">   45</span>    {</div>
<div class="line"><span class="lineno">   46</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="forwarding_8h.html#ac82f26f4aa50aede627e9d8ee40c6312ac199631b173e6c1619ab8460454f1a69">DEBUGGER_OUTPUT_SOURCE_STATUS_ALREADY_CLOSED</a>;</div>
<div class="line"><span class="lineno">   47</span>    }</div>
<div class="line"><span class="lineno">   48</span> </div>
<div class="line"><span class="lineno">   49</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   50</span>    <span class="comment">// check if already opened</span></div>
<div class="line"><span class="lineno">   51</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   52</span>    <span class="keywordflow">if</span> (SourceDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g.html#a6a5265e3ca564346caf72692b4f3c654">State</a> == <a class="code hl_enumvalue" href="forwarding_8h.html#a42e89d95ef5380838b8a9076a408974ca76464720e795c18ee1c6192f18684279">EVENT_FORWARDING_STATE_OPENED</a>)</div>
<div class="line"><span class="lineno">   53</span>    {</div>
<div class="line"><span class="lineno">   54</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="forwarding_8h.html#ac82f26f4aa50aede627e9d8ee40c6312a9c59fa835c556a02f9af97243c466f02">DEBUGGER_OUTPUT_SOURCE_STATUS_ALREADY_OPENED</a>;</div>
<div class="line"><span class="lineno">   55</span>    }</div>
<div class="line"><span class="lineno">   56</span> </div>
<div class="line"><span class="lineno">   57</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   58</span>    <span class="comment">// Set the status to opened</span></div>
<div class="line"><span class="lineno">   59</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   60</span>    SourceDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g.html#a6a5265e3ca564346caf72692b4f3c654">State</a> = <a class="code hl_enumvalue" href="forwarding_8h.html#a42e89d95ef5380838b8a9076a408974ca76464720e795c18ee1c6192f18684279">EVENT_FORWARDING_STATE_OPENED</a>;</div>
<div class="line"><span class="lineno">   61</span> </div>
<div class="line"><span class="lineno">   62</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   63</span>    <span class="comment">// Now, it&#39;s time to open the source based on its type</span></div>
<div class="line"><span class="lineno">   64</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   65</span>    <span class="keywordflow">if</span> (SourceDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g.html#a1f41501d1db9767cfdb8d1b2114e6ee8">Type</a> == <a class="code hl_enumvalue" href="forwarding_8h.html#ad1e352ad6958db92e803af5dc0f245f7ae22cdf27af7d9a9c0a4c316dbbc4bdd1">EVENT_FORWARDING_FILE</a>)</div>
<div class="line"><span class="lineno">   66</span>    {</div>
<div class="line"><span class="lineno">   67</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   68</span>        <span class="comment">// Nothing special to do here, file is opened with CreateFile</span></div>
<div class="line"><span class="lineno">   69</span>        <span class="comment">// and nothing should be called to open the handle</span></div>
<div class="line"><span class="lineno">   70</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   71</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="forwarding_8h.html#ac82f26f4aa50aede627e9d8ee40c6312a2c48c6088027600725c9d54179ff2f87">DEBUGGER_OUTPUT_SOURCE_STATUS_SUCCESSFULLY_OPENED</a>;</div>
<div class="line"><span class="lineno">   72</span>    }</div>
<div class="line"><span class="lineno">   73</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SourceDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g.html#a1f41501d1db9767cfdb8d1b2114e6ee8">Type</a> == <a class="code hl_enumvalue" href="forwarding_8h.html#ad1e352ad6958db92e803af5dc0f245f7af010f7ac3a7a606129bf3affe7e0206f">EVENT_FORWARDING_NAMEDPIPE</a>)</div>
<div class="line"><span class="lineno">   74</span>    {</div>
<div class="line"><span class="lineno">   75</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   76</span>        <span class="comment">// Nothing special to do here, namedpipe is opened with CreateFile</span></div>
<div class="line"><span class="lineno">   77</span>        <span class="comment">// and nothing should be called to open the handle</span></div>
<div class="line"><span class="lineno">   78</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   79</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="forwarding_8h.html#ac82f26f4aa50aede627e9d8ee40c6312a2c48c6088027600725c9d54179ff2f87">DEBUGGER_OUTPUT_SOURCE_STATUS_SUCCESSFULLY_OPENED</a>;</div>
<div class="line"><span class="lineno">   80</span>    }</div>
<div class="line"><span class="lineno">   81</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SourceDescriptor-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g.html#a1f41501d1db9767cfdb8d1b2114e6ee8">Type</a> == <a class="code hl_enumvalue" href="forwarding_8h.html#ad1e352ad6958db92e803af5dc0f245f7a06e104b57293169bf78d16d3171acb81">EVENT_FORWARDING_TCP</a>)</div>
<div class="line"><span class="lineno">   82</span>    {</div>
<div class="line"><span class="lineno">   83</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   84</span>        <span class="comment">// Nothing special to do here, tcp socket is opened with</span></div>
<div class="line"><span class="lineno">   85</span>        <span class="comment">// CommunicationClientConnectToServer and nothing should be</span></div>
<div class="line"><span class="lineno">   86</span>        <span class="comment">// called to open the socket</span></div>
<div class="line"><span class="lineno">   87</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   88</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="forwarding_8h.html#ac82f26f4aa50aede627e9d8ee40c6312a2c48c6088027600725c9d54179ff2f87">DEBUGGER_OUTPUT_SOURCE_STATUS_SUCCESSFULLY_OPENED</a>;</div>
<div class="line"><span class="lineno">   89</span>    }</div>
<div class="line"><span class="lineno">   90</span> </div>
<div class="line"><span class="lineno">   91</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="forwarding_8h.html#ac82f26f4aa50aede627e9d8ee40c6312a68dfc99955fa2f449c2fe77a1870d9ee">DEBUGGER_OUTPUT_SOURCE_STATUS_UNKNOWN_ERROR</a>;</div>
<div class="line"><span class="lineno">   92</span>}</div>
<div class="ttc" id="aforwarding_8h_html_ac82f26f4aa50aede627e9d8ee40c6312a2c48c6088027600725c9d54179ff2f87"><div class="ttname"><a href="forwarding_8h.html#ac82f26f4aa50aede627e9d8ee40c6312a2c48c6088027600725c9d54179ff2f87">DEBUGGER_OUTPUT_SOURCE_STATUS_SUCCESSFULLY_OPENED</a></div><div class="ttdeci">@ DEBUGGER_OUTPUT_SOURCE_STATUS_SUCCESSFULLY_OPENED</div><div class="ttdef"><b>Definition:</b> forwarding.h:54</div></div>
<div class="ttc" id="aforwarding_8h_html_ac82f26f4aa50aede627e9d8ee40c6312a9c59fa835c556a02f9af97243c466f02"><div class="ttname"><a href="forwarding_8h.html#ac82f26f4aa50aede627e9d8ee40c6312a9c59fa835c556a02f9af97243c466f02">DEBUGGER_OUTPUT_SOURCE_STATUS_ALREADY_OPENED</a></div><div class="ttdeci">@ DEBUGGER_OUTPUT_SOURCE_STATUS_ALREADY_OPENED</div><div class="ttdef"><b>Definition:</b> forwarding.h:56</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac84663bef0772945782e2533e31a07d2" name="ac84663bef0772945782e2533e31a07d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac84663bef0772945782e2533e31a07d2">&#9670;&#160;</a></span>ForwardingPerformEventForwarding()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ForwardingPerformEventForwarding </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_events_8h.html#a785bb4a350ef4f18bd7101ab77c88148">PDEBUGGER_GENERAL_EVENT_DETAIL</a>&#160;</td>
          <td class="paramname"><em>EventDetail</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *&#160;</td>
          <td class="paramname"><em>Message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td>
          <td class="paramname"><em>MessageLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send the event result to the corresponding sources. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">EventDetail</td><td>Description saved about the event in the user-mode </td></tr>
    <tr><td class="paramname">MessageLength</td><td>Length of the message</td></tr>
  </table>
  </dd>
</dl>
<p>This function will not check whether the event has an output source or not, the caller if this function should make sure that the following event has valid output sources or not</p>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN whether sending results was successful or not </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  295</span>{</div>
<div class="line"><span class="lineno">  296</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>     Result   = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  297</span>    PLIST_ENTRY TempList = 0;</div>
<div class="line"><span class="lineno">  298</span> </div>
<div class="line"><span class="lineno">  299</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_constants_8h.html#a6001b7f3e551dc3ee3f8aa36afa00026">DebuggerOutputSourceMaximumRemoteSourceForSingleEvent</a>;</div>
<div class="line"><span class="lineno">  300</span>         i++)</div>
<div class="line"><span class="lineno">  301</span>    {</div>
<div class="line"><span class="lineno">  302</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  303</span>        <span class="comment">// Check whether we reached to the end of the events</span></div>
<div class="line"><span class="lineno">  304</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  305</span>        <span class="keywordflow">if</span> (EventDetail-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___g_e_n_e_r_a_l___e_v_e_n_t___d_e_t_a_i_l.html#aaae9e92b5e1a3c48a87a4c0af53cabe7">OutputSourceTags</a>[i] == NULL)</div>
<div class="line"><span class="lineno">  306</span>        {</div>
<div class="line"><span class="lineno">  307</span>            <span class="keywordflow">return</span> Result;</div>
<div class="line"><span class="lineno">  308</span>        }</div>
<div class="line"><span class="lineno">  309</span> </div>
<div class="line"><span class="lineno">  310</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  311</span>        <span class="comment">// If we reach here then the output tag is not null</span></div>
<div class="line"><span class="lineno">  312</span>        <span class="comment">// means that we should find the event tag from list</span></div>
<div class="line"><span class="lineno">  313</span>        <span class="comment">// of tags</span></div>
<div class="line"><span class="lineno">  314</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  315</span>        TempList = &amp;<a class="code hl_variable" href="forwarding_8cpp.html#acd85daad5afd0daf8ce46b7200a89276">g_OutputSources</a>;</div>
<div class="line"><span class="lineno">  316</span> </div>
<div class="line"><span class="lineno">  317</span>        <span class="keywordflow">while</span> (&amp;<a class="code hl_variable" href="forwarding_8cpp.html#acd85daad5afd0daf8ce46b7200a89276">g_OutputSources</a> != TempList-&gt;Flink)</div>
<div class="line"><span class="lineno">  318</span>        {</div>
<div class="line"><span class="lineno">  319</span>            TempList = TempList-&gt;Flink;</div>
<div class="line"><span class="lineno">  320</span> </div>
<div class="line"><span class="lineno">  321</span>            <a class="code hl_struct" href="struct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g.html">PDEBUGGER_EVENT_FORWARDING</a> CurrentOutputSourceDetails = <a class="code hl_define" href="list_8h.html#adec42d53dc3b3e16ab7a1cd98af1c5fc">CONTAINING_RECORD</a>(</div>
<div class="line"><span class="lineno">  322</span>                TempList,</div>
<div class="line"><span class="lineno">  323</span>                <a class="code hl_struct" href="struct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g.html">DEBUGGER_EVENT_FORWARDING</a>,</div>
<div class="line"><span class="lineno">  324</span>                OutputSourcesList);</div>
<div class="line"><span class="lineno">  325</span> </div>
<div class="line"><span class="lineno">  326</span>            <span class="keywordflow">if</span> (EventDetail-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___g_e_n_e_r_a_l___e_v_e_n_t___d_e_t_a_i_l.html#aaae9e92b5e1a3c48a87a4c0af53cabe7">OutputSourceTags</a>[i] ==</div>
<div class="line"><span class="lineno">  327</span>                CurrentOutputSourceDetails-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g.html#ad4e075974aaa8822472f7e587dc7ca57">OutputUniqueTag</a>)</div>
<div class="line"><span class="lineno">  328</span>            {</div>
<div class="line"><span class="lineno">  329</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  330</span>                <span class="comment">// Indicate that we found a tag that matches this item</span></div>
<div class="line"><span class="lineno">  331</span>                <span class="comment">// Now, we should check whether the output is opened or</span></div>
<div class="line"><span class="lineno">  332</span>                <span class="comment">// not closed</span></div>
<div class="line"><span class="lineno">  333</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  334</span>                <span class="keywordflow">if</span> (CurrentOutputSourceDetails-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g.html#a6a5265e3ca564346caf72692b4f3c654">State</a> ==</div>
<div class="line"><span class="lineno">  335</span>                    <a class="code hl_enumvalue" href="forwarding_8h.html#a42e89d95ef5380838b8a9076a408974ca76464720e795c18ee1c6192f18684279">EVENT_FORWARDING_STATE_OPENED</a>)</div>
<div class="line"><span class="lineno">  336</span>                {</div>
<div class="line"><span class="lineno">  337</span>                    <span class="keywordflow">switch</span> (CurrentOutputSourceDetails-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g.html#a1f41501d1db9767cfdb8d1b2114e6ee8">Type</a>)</div>
<div class="line"><span class="lineno">  338</span>                    {</div>
<div class="line"><span class="lineno">  339</span>                    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="forwarding_8h.html#ad1e352ad6958db92e803af5dc0f245f7af010f7ac3a7a606129bf3affe7e0206f">EVENT_FORWARDING_NAMEDPIPE</a>:</div>
<div class="line"><span class="lineno">  340</span>                        Result = <a class="code hl_function" href="forwarding_8cpp.html#a9d46ef4cad8ecde3ccebe8703dd4fd8d">ForwardingSendToNamedPipe</a>(</div>
<div class="line"><span class="lineno">  341</span>                            CurrentOutputSourceDetails-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g.html#a63e9f48b3c26fe64dff7cffef5890b4c">Handle</a>,</div>
<div class="line"><span class="lineno">  342</span>                            Message,</div>
<div class="line"><span class="lineno">  343</span>                            MessageLength);</div>
<div class="line"><span class="lineno">  344</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  345</span>                    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="forwarding_8h.html#ad1e352ad6958db92e803af5dc0f245f7ae22cdf27af7d9a9c0a4c316dbbc4bdd1">EVENT_FORWARDING_FILE</a>:</div>
<div class="line"><span class="lineno">  346</span>                        Result = <a class="code hl_function" href="forwarding_8cpp.html#a60c79833ff7c6757b8806a8266f31353">ForwardingWriteToFile</a>(CurrentOutputSourceDetails-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g.html#a63e9f48b3c26fe64dff7cffef5890b4c">Handle</a>,</div>
<div class="line"><span class="lineno">  347</span>                                                       Message,</div>
<div class="line"><span class="lineno">  348</span>                                                       MessageLength);</div>
<div class="line"><span class="lineno">  349</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  350</span>                    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="forwarding_8h.html#ad1e352ad6958db92e803af5dc0f245f7a06e104b57293169bf78d16d3171acb81">EVENT_FORWARDING_TCP</a>:</div>
<div class="line"><span class="lineno">  351</span>                        Result = <a class="code hl_function" href="forwarding_8cpp.html#a0e3c56ef206a16780f2372db0df9039a">ForwardingSendToTcpSocket</a>(</div>
<div class="line"><span class="lineno">  352</span>                            CurrentOutputSourceDetails-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g.html#aab93c0ef794702cd4d8595be8d314a27">Socket</a>,</div>
<div class="line"><span class="lineno">  353</span>                            Message,</div>
<div class="line"><span class="lineno">  354</span>                            MessageLength);</div>
<div class="line"><span class="lineno">  355</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  356</span>                    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  357</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  358</span>                    }</div>
<div class="line"><span class="lineno">  359</span>                }</div>
<div class="line"><span class="lineno">  360</span> </div>
<div class="line"><span class="lineno">  361</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  362</span>                <span class="comment">// No need to search through the list anymore</span></div>
<div class="line"><span class="lineno">  363</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  364</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  365</span>            }</div>
<div class="line"><span class="lineno">  366</span>        }</div>
<div class="line"><span class="lineno">  367</span>    }</div>
<div class="line"><span class="lineno">  368</span> </div>
<div class="line"><span class="lineno">  369</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  370</span>}</div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h_html_a1cb18096b299d23458d3c7b85fd86555"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></div><div class="ttdeci">UCHAR BOOLEAN</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:37</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:49</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_constants_8h_html_a6001b7f3e551dc3ee3f8aa36afa00026"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_constants_8h.html#a6001b7f3e551dc3ee3f8aa36afa00026">DebuggerOutputSourceMaximumRemoteSourceForSingleEvent</a></div><div class="ttdeci">#define DebuggerOutputSourceMaximumRemoteSourceForSingleEvent</div><div class="ttdoc">Determines how many sources a debugger can have for a single event.</div><div class="ttdef"><b>Definition:</b> Constants.h:275</div></div>
<div class="ttc" id="aforwarding_8cpp_html_a0e3c56ef206a16780f2372db0df9039a"><div class="ttname"><a href="forwarding_8cpp.html#a0e3c56ef206a16780f2372db0df9039a">ForwardingSendToTcpSocket</a></div><div class="ttdeci">BOOLEAN ForwardingSendToTcpSocket(SOCKET TcpSocket, CHAR *Message, UINT32 MessageLength)</div><div class="ttdoc">Send the output results to the tcp socket.</div><div class="ttdef"><b>Definition:</b> forwarding.cpp:476</div></div>
<div class="ttc" id="aforwarding_8cpp_html_a60c79833ff7c6757b8806a8266f31353"><div class="ttname"><a href="forwarding_8cpp.html#a60c79833ff7c6757b8806a8266f31353">ForwardingWriteToFile</a></div><div class="ttdeci">BOOLEAN ForwardingWriteToFile(HANDLE FileHandle, CHAR *Message, UINT32 MessageLength)</div><div class="ttdoc">Write the output results to the file.</div><div class="ttdef"><b>Definition:</b> forwarding.cpp:384</div></div>
<div class="ttc" id="aforwarding_8cpp_html_a9d46ef4cad8ecde3ccebe8703dd4fd8d"><div class="ttname"><a href="forwarding_8cpp.html#a9d46ef4cad8ecde3ccebe8703dd4fd8d">ForwardingSendToNamedPipe</a></div><div class="ttdeci">BOOLEAN ForwardingSendToNamedPipe(HANDLE NamedPipeHandle, CHAR *Message, UINT32 MessageLength)</div><div class="ttdoc">Send the output results to the namedpipe.</div><div class="ttdef"><b>Definition:</b> forwarding.cpp:443</div></div>
<div class="ttc" id="aforwarding_8cpp_html_acd85daad5afd0daf8ce46b7200a89276"><div class="ttname"><a href="forwarding_8cpp.html#acd85daad5afd0daf8ce46b7200a89276">g_OutputSources</a></div><div class="ttdeci">LIST_ENTRY g_OutputSources</div><div class="ttdoc">Holds a list of output sources created by output command.</div><div class="ttdef"><b>Definition:</b> globals.h:411</div></div>
<div class="ttc" id="alist_8h_html_adec42d53dc3b3e16ab7a1cd98af1c5fc"><div class="ttname"><a href="list_8h.html#adec42d53dc3b3e16ab7a1cd98af1c5fc">CONTAINING_RECORD</a></div><div class="ttdeci">#define CONTAINING_RECORD(address, type, field)</div><div class="ttdef"><b>Definition:</b> list.h:14</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g_html"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g.html">_DEBUGGER_EVENT_FORWARDING</a></div><div class="ttdoc">structures hold the detail of event forwarding</div><div class="ttdef"><b>Definition:</b> forwarding.h:66</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g_html_ad4e075974aaa8822472f7e587dc7ca57"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___e_v_e_n_t___f_o_r_w_a_r_d_i_n_g.html#ad4e075974aaa8822472f7e587dc7ca57">_DEBUGGER_EVENT_FORWARDING::OutputUniqueTag</a></div><div class="ttdeci">UINT64 OutputUniqueTag</div><div class="ttdef"><b>Definition:</b> forwarding.h:71</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___g_e_n_e_r_a_l___e_v_e_n_t___d_e_t_a_i_l_html_aaae9e92b5e1a3c48a87a4c0af53cabe7"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___g_e_n_e_r_a_l___e_v_e_n_t___d_e_t_a_i_l.html#aaae9e92b5e1a3c48a87a4c0af53cabe7">_DEBUGGER_GENERAL_EVENT_DETAIL::OutputSourceTags</a></div><div class="ttdeci">UINT64 OutputSourceTags[DebuggerOutputSourceMaximumRemoteSourceForSingleEvent]</div><div class="ttdef"><b>Definition:</b> Events.h:312</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9d46ef4cad8ecde3ccebe8703dd4fd8d" name="a9d46ef4cad8ecde3ccebe8703dd4fd8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d46ef4cad8ecde3ccebe8703dd4fd8d">&#9670;&#160;</a></span>ForwardingSendToNamedPipe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ForwardingSendToNamedPipe </td>
          <td>(</td>
          <td class="paramtype">HANDLE&#160;</td>
          <td class="paramname"><em>NamedPipeHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *&#160;</td>
          <td class="paramname"><em>Message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td>
          <td class="paramname"><em>MessageLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send the output results to the namedpipe. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">NamedPipeHandle</td><td>Handle of the target namedpipe </td></tr>
    <tr><td class="paramname">Message</td><td>The message that should be sent to namedpipe </td></tr>
    <tr><td class="paramname">MessageLength</td><td>Length of the message</td></tr>
  </table>
  </dd>
</dl>
<p>This function will not check whether the event has an output source or not, the caller if this function should make sure that the following event has valid output sources or not</p>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN whether the sending to the namedpipe was successful or not </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  444</span>{</div>
<div class="line"><span class="lineno">  445</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> SentMessageResult;</div>
<div class="line"><span class="lineno">  446</span> </div>
<div class="line"><span class="lineno">  447</span>    SentMessageResult =</div>
<div class="line"><span class="lineno">  448</span>        <a class="code hl_function" href="hprdbgctrl_2code_2debugger_2communication_2namedpipe_8cpp.html#afcb96019b2e2b6d2544c6647e6546baa">NamedPipeClientSendMessage</a>(NamedPipeHandle, Message, MessageLength);</div>
<div class="line"><span class="lineno">  449</span> </div>
<div class="line"><span class="lineno">  450</span>    <span class="keywordflow">if</span> (!SentMessageResult)</div>
<div class="line"><span class="lineno">  451</span>    {</div>
<div class="line"><span class="lineno">  452</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  453</span>        <span class="comment">// Sending error</span></div>
<div class="line"><span class="lineno">  454</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  455</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  456</span>    }</div>
<div class="line"><span class="lineno">  457</span> </div>
<div class="line"><span class="lineno">  458</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  459</span>    <span class="comment">// Successfully sent</span></div>
<div class="line"><span class="lineno">  460</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  461</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  462</span>}</div>
<div class="ttc" id="ahprdbgctrl_2code_2debugger_2communication_2namedpipe_8cpp_html_afcb96019b2e2b6d2544c6647e6546baa"><div class="ttname"><a href="hprdbgctrl_2code_2debugger_2communication_2namedpipe_8cpp.html#afcb96019b2e2b6d2544c6647e6546baa">NamedPipeClientSendMessage</a></div><div class="ttdeci">BOOLEAN NamedPipeClientSendMessage(HANDLE PipeHandle, char *BufferToSend, int BufferSize)</div><div class="ttdoc">send client message over named pipe</div><div class="ttdef"><b>Definition:</b> namedpipe.cpp:292</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0e3c56ef206a16780f2372db0df9039a" name="a0e3c56ef206a16780f2372db0df9039a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e3c56ef206a16780f2372db0df9039a">&#9670;&#160;</a></span>ForwardingSendToTcpSocket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ForwardingSendToTcpSocket </td>
          <td>(</td>
          <td class="paramtype">SOCKET&#160;</td>
          <td class="paramname"><em>TcpSocket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *&#160;</td>
          <td class="paramname"><em>Message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td>
          <td class="paramname"><em>MessageLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send the output results to the tcp socket. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TcpSocket</td><td>Socket object of the target tcp socket </td></tr>
    <tr><td class="paramname">Message</td><td>The message that should be sent to the tcp socket </td></tr>
    <tr><td class="paramname">MessageLength</td><td>Length of the message</td></tr>
  </table>
  </dd>
</dl>
<p>This function will not check whether the event has an output source or not, the caller if this function should make sure that the following event has valid output sources or not</p>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN whether the sending to the tcp socket was successful or not </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  477</span>{</div>
<div class="line"><span class="lineno">  478</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="tcpclient_8cpp.html#affc5b7bf7131d6d874b21c4de66fe5db">CommunicationClientSendMessage</a>(TcpSocket, Message, MessageLength) != 0)</div>
<div class="line"><span class="lineno">  479</span>    {</div>
<div class="line"><span class="lineno">  480</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  481</span>        <span class="comment">// Failed to send</span></div>
<div class="line"><span class="lineno">  482</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  483</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  484</span>    }</div>
<div class="line"><span class="lineno">  485</span> </div>
<div class="line"><span class="lineno">  486</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  487</span>    <span class="comment">// Successfully sent</span></div>
<div class="line"><span class="lineno">  488</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  489</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  490</span>}</div>
<div class="ttc" id="atcpclient_8cpp_html_affc5b7bf7131d6d874b21c4de66fe5db"><div class="ttname"><a href="tcpclient_8cpp.html#affc5b7bf7131d6d874b21c4de66fe5db">CommunicationClientSendMessage</a></div><div class="ttdeci">int CommunicationClientSendMessage(SOCKET ConnectSocket, const char *sendbuf, int buflen)</div><div class="ttdoc">Send message a client.</div><div class="ttdef"><b>Definition:</b> tcpclient.cpp:111</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a60c79833ff7c6757b8806a8266f31353" name="a60c79833ff7c6757b8806a8266f31353"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60c79833ff7c6757b8806a8266f31353">&#9670;&#160;</a></span>ForwardingWriteToFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ForwardingWriteToFile </td>
          <td>(</td>
          <td class="paramtype">HANDLE&#160;</td>
          <td class="paramname"><em>FileHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *&#160;</td>
          <td class="paramname"><em>Message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td>
          <td class="paramname"><em>MessageLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write the output results to the file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">FileHandle</td><td>Handle of the target file </td></tr>
    <tr><td class="paramname">Message</td><td>The message that should be written to file </td></tr>
    <tr><td class="paramname">MessageLength</td><td>Length of the message</td></tr>
  </table>
  </dd>
</dl>
<p>This function will not check whether the event has an output source or not, the caller if this function should make sure that the following event has valid output sources or not</p>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN whether the writing to the file was successful or not </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  385</span>{</div>
<div class="line"><span class="lineno">  386</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> BytesWritten = 0;</div>
<div class="line"><span class="lineno">  387</span>    <a class="code hl_typedef" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a>  ErrorFlag    = <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  388</span> </div>
<div class="line"><span class="lineno">  389</span>    ErrorFlag = WriteFile(<a class="code hl_variable" href="_hooks_8h.html#a74bc6881ecc918d83da9c92e3b2bcc04">FileHandle</a>,    <span class="comment">// open file handle</span></div>
<div class="line"><span class="lineno">  390</span>                          Message,       <span class="comment">// start of data to write</span></div>
<div class="line"><span class="lineno">  391</span>                          MessageLength, <span class="comment">// number of bytes to write</span></div>
<div class="line"><span class="lineno">  392</span>                          &amp;BytesWritten, <span class="comment">// number of bytes that were written</span></div>
<div class="line"><span class="lineno">  393</span>                          NULL);         <span class="comment">// no overlapped structure</span></div>
<div class="line"><span class="lineno">  394</span> </div>
<div class="line"><span class="lineno">  395</span>    <span class="keywordflow">if</span> (ErrorFlag == <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>)</div>
<div class="line"><span class="lineno">  396</span>    {</div>
<div class="line"><span class="lineno">  397</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  398</span>        <span class="comment">// Err, terminal failure: Unable to write to file</span></div>
<div class="line"><span class="lineno">  399</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  400</span> </div>
<div class="line"><span class="lineno">  401</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  402</span>    }</div>
<div class="line"><span class="lineno">  403</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  404</span>    {</div>
<div class="line"><span class="lineno">  405</span>        <span class="keywordflow">if</span> (BytesWritten != MessageLength)</div>
<div class="line"><span class="lineno">  406</span>        {</div>
<div class="line"><span class="lineno">  407</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  408</span>            <span class="comment">// This is an error because a synchronous write that results in</span></div>
<div class="line"><span class="lineno">  409</span>            <span class="comment">// success (WriteFile returns TRUE) should write all data as</span></div>
<div class="line"><span class="lineno">  410</span>            <span class="comment">// requested. This would not necessarily be the case for</span></div>
<div class="line"><span class="lineno">  411</span>            <span class="comment">// asynchronous writes.</span></div>
<div class="line"><span class="lineno">  412</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  413</span> </div>
<div class="line"><span class="lineno">  414</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  415</span>        }</div>
<div class="line"><span class="lineno">  416</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  417</span>        {</div>
<div class="line"><span class="lineno">  418</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  419</span>            <span class="comment">// Successfully wrote</span></div>
<div class="line"><span class="lineno">  420</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  421</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  422</span>        }</div>
<div class="line"><span class="lineno">  423</span>    }</div>
<div class="line"><span class="lineno">  424</span> </div>
<div class="line"><span class="lineno">  425</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  426</span>    <span class="comment">// by default we assume there was an error</span></div>
<div class="line"><span class="lineno">  427</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  428</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  429</span>}</div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h_html_a050c65e107f0c828f856a231f4b4e788"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a></div><div class="ttdeci">int BOOL</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:21</div></div>
<div class="ttc" id="abuild_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h_html_ad342ac907eb044443153a22f964bf0af"><div class="ttname"><a href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a></div><div class="ttdeci">unsigned long DWORD</div><div class="ttdef"><b>Definition:</b> BasicTypes.h:20</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="acd85daad5afd0daf8ce46b7200a89276" name="acd85daad5afd0daf8ce46b7200a89276"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd85daad5afd0daf8ce46b7200a89276">&#9670;&#160;</a></span>g_OutputSources</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">LIST_ENTRY g_OutputSources</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Holds a list of output sources created by output command. </p>
<p>user-mode events and output sources are two separate things in HyperDbg </p>

</div>
</div>
<a id="a53d533d7b64b079d3416e18143cad0fe" name="a53d533d7b64b079d3416e18143cad0fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53d533d7b64b079d3416e18143cad0fe">&#9670;&#160;</a></span>g_OutputSourceTag</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="build_2bin_2debug_2_s_d_k_2_headers_2_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> g_OutputSourceTag</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This variable holds the trace and generate numbers for unique tag of the output resources. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_53a6cdbae347618e9ee76d4be5c6ea96.html">hyperdbg</a></li><li class="navelem"><a class="el" href="dir_2ba950cbe69a0dd8a769d65244bdf310.html">hprdbgctrl</a></li><li class="navelem"><a class="el" href="dir_4019f5a1570d89900466aa79df5bc710.html">code</a></li><li class="navelem"><a class="el" href="dir_e6568b8d62607999c7b318cd4eb69b86.html">debugger</a></li><li class="navelem"><a class="el" href="dir_9835b3432a65d5c894fd23091d85dda2.html">communication</a></li><li class="navelem"><a class="el" href="forwarding_8cpp.html">forwarding.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
